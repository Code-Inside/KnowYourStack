{"Data":{"GitHub":{"Issues":[{"Id":"1851245498","IsPullRequest":true,"CreatedAt":"2023-08-16T02:54:24","Actor":"LeafShi1","Number":"9723","RawContent":null,"Title":"Merge main to feature 9.0 - 2023/8/15","State":"closed","Body":"Merge main into feature/9.0 branch manually following the steps:\r\n\r\n1. `git pull origin feature/9.0`\r\n2. `git checkout main`\t\r\n3. `git merge feature/9.0`\t Resolve conflicts on 2 files (winforms/src/System.Windows.Forms/src/PublicAPI.Shipped.txt, winforms/src/System.Windows.Forms/src/PublicAPI.Unshipped.txt) by manual\r\n\r\n1. `git commit`\r\n2. `git push -u origin main`","Url":"https://github.com/dotnet/winforms/pull/9723","RelatedDescription":"Closed or merged PR \"Merge main to feature 9.0 - 2023/8/15\" (#9723)"},{"Id":"1852389942","IsPullRequest":true,"CreatedAt":"2023-08-16T02:04:29","Actor":"JeremyKuhne","Number":"9732","RawContent":null,"Title":"Fix IRawElementProviderSimple.GetPropertyValue","State":"open","Body":"Our interop handle structs (such as HWND) cannot be marshalled directly and will fail \"silently\" on callbacks (they will throw but the marshaller will convert that to an HRESULT that we won't see unless first-chance exceptions are on when we're debugging).\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9732)","Url":"https://github.com/dotnet/winforms/pull/9732","RelatedDescription":"Open PR \"Fix IRawElementProviderSimple.GetPropertyValue\" (#9732)"},{"Id":"1852332788","IsPullRequest":true,"CreatedAt":"2023-08-16T00:45:37","Actor":"Tanya-Solyanik","Number":"9731","RawContent":null,"Title":"Merge from feature/9.0 into main","State":"open","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9731)","Url":"https://github.com/dotnet/winforms/pull/9731","RelatedDescription":"Open PR \"Merge from feature/9.0 into main\" (#9731)"},{"Id":"1852133993","IsPullRequest":false,"CreatedAt":"2023-08-15T21:12:16","Actor":"Tanya-Solyanik","Number":"9730","RawContent":null,"Title":"Notification: Main is now a .NET 9.0 alpha branch","State":"open","Body":"Main branch is a .NET 9.0 alpha branch.\r\nrelease/8.0-rc1 branch is a .NET 8.0 RC1 branch (ASK mode, M2 and tactics approval)\r\nrelease/8.0 branch is a .NET 8.0 RC2 branch (ASK mode, M2 approval)\r\nRelease branches will not flow into main automatically, All .NET 8.0 fixes should be merged into both branches. ","Url":"https://github.com/dotnet/winforms/issues/9730","RelatedDescription":"Open issue \"Notification: Main is now a .NET 9.0 alpha branch\" (#9730)"},{"Id":"1851886299","IsPullRequest":false,"CreatedAt":"2023-08-15T17:52:59","Actor":"lyndaidaii","Number":"9729","RawContent":null,"Title":"[Documentation]System.Drawing.Common is missing NuGet package README file","State":"open","Body":"### Description\n\n\r\n\r\nWe noticed that your NuGet package is missing a README file and are reaching out to ask you do add a README file to your NuGet package.\r\n\r\nThe README file is an essential part of your package as it provides important information to users and helps them understand what the package is and what it does quickly. Also, README is the first things for users when they view your package on NuGet.org and soon Visual Studio/Visual Studio Code, it is crucial for package authors to write and include high-quality READMEs for their packages.\r\n\r\nTo help you get started, we suggest the following steps to include a README in your packages listed below:\r\n \r\n•\tIf you are new to NuGet README, learn more about [how to add a README to your NuGet Package](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdevblogs.microsoft.com%2Fnuget%2Fadd-a-readme-to-your-nuget-package%2F&data=05%7C01%7CLynn.Dai%40microsoft.com%7C104a7d575aa945c929e408db97e8d3cf%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638270798485909796%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=0OcAUfiee90eoUxIVEc0FLIh4juGuque56O3lBBdElw%3D&reserved=0).\r\n•\tFollow the [README template](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fraw.githubusercontent.com%2Flyndaidaii%2FNuGetReadMeTemplate%2Fmain%2FREADME.md&data=05%7C01%7CLynn.Dai%40microsoft.com%7C104a7d575aa945c929e408db97e8d3cf%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638270798485909796%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=XNUA17w6bfKoax%2FSIEAMRQMY%2Fk1E4wEwFzvSDK6M6BA%3D&reserved=0) and [blog post](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdevblogs.microsoft.com%2Fnuget%2Fwrite-a-high-quality-readme-for-nuget-packages%2F&data=05%7C01%7CLynn.Dai%40microsoft.com%7C104a7d575aa945c929e408db97e8d3cf%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638270798485909796%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=VT0JizwK%2B2mk5qz97r5W2NDNS9eRIplqEg%2BOsNab39Q%3D&reserved=0) for  best practices.\r\n•\tCheck out a great [example](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdotnet%2Fruntime%2Fpull%2F90102&data=05%7C01%7CLynn.Dai%40microsoft.com%7C104a7d575aa945c929e408db97e8d3cf%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638270798485909796%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=UbbSUPhoulewaR9S%2BspYeBS8tCYrTKBQKSPjYSxfGCI%3D&reserved=0) README for System.Text.Json that can be used for .NET libraries.\r\n•\tReach out to us for review or help.\r\nIf you have any questions or need assistance in creating your README, please don't hesitate to reach out.\r\n\r\n### Page / URL\r\nhttps://www.nuget.org/packages/System.Drawing.Common/8.0.0-preview.7.23375.5\r\n\n\n### Reproduction Steps\n\ngo to https://www.nuget.org/packages/System.Drawing.Common/8.0.0-preview.7.23375.5, is missing readme file. \r\n\n\n### Expected behavior\n\nDisplay readme file on NuGet.org\n\n### Actual behavior\n\nRight now it is missing README file, it only displays project description instead of readme.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Impact\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/winforms/issues/9729","RelatedDescription":"Open issue \"[Documentation]System.Drawing.Common is missing NuGet package README file\" (#9729)"},{"Id":"1851429256","IsPullRequest":true,"CreatedAt":"2023-08-15T17:49:55","Actor":"halgab","Number":"9728","RawContent":null,"Title":"Use throw helpers for ArgumentOutOfRangeException: manual cases","State":"closed","Body":"This is the first follow-up to #9713. These are all the cases not caught by CA1512 but are legitimate uses of the new `ArgumentOutOfRangeException` throw helpers, because the error message is not overridden.\r\n\r\n## Proposed changes\r\n\r\n- Use ArgumentOutOfRangeException throw helpers\r\n\r\n## Risk\r\n\r\n- low, but higher than the pure fixer modifications. I still used the IDE as much as possible (e.g. to break if clauses into 2) so that CA1512 could apply\r\n\r\n## Test methodology\r\n\r\n- CI\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9728)","Url":"https://github.com/dotnet/winforms/pull/9728","RelatedDescription":"Closed or merged PR \"Use throw helpers for ArgumentOutOfRangeException: manual cases\" (#9728)"},{"Id":"1850835620","IsPullRequest":true,"CreatedAt":"2023-08-15T16:15:42","Actor":"LeafShi1","Number":"9720","RawContent":null,"Title":".NET 9.0 template changes.","State":"closed","Body":"Template changes for 9.0 TFM. These were supposed to be done along with branding.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9720)","Url":"https://github.com/dotnet/winforms/pull/9720","RelatedDescription":"Closed or merged PR \".NET 9.0 template changes.\" (#9720)"},{"Id":"1851412597","IsPullRequest":false,"CreatedAt":"2023-08-15T13:05:15","Actor":"andrekoehler","Number":"9727","RawContent":null,"Title":"Simplest Form not garbage collected when it contains an ElementHost control","State":"open","Body":"### .NET version\r\n\r\n7.0\r\n\r\n### Did it work in .NET Framework?\r\n\r\nNo\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\n_No response_\r\n\r\n### Issue description\r\n\r\nAfter a Form that contains a single ElementHost control is closed, it will never be garbage collected.\r\n\r\n### Steps to reproduce\r\n\r\n[WinFormsApp1.zip](https://github.com/dotnet/winforms/files/12344147/WinFormsApp1.zip)\r\n\r\nMinimal reproduction:\r\n1. Create new WinForms app (Reproduces with net48 and net70)\r\n2. Create new Form (\"Form2\") and add 1 GB byte array to it to easier observe the memory leak\r\n3. Add ElementHost control to Form2.\r\n4. Add button to Form1 to show Form2\r\n5. Compile and launch App\r\n6. Press button to open Form2\r\n7. Close Form2\r\n8. Wait a few seconds\r\n9. Observe that memory usage in Visual Studio debugger stays at 1 GB\r\n\r\nI added the following code to Form1 to force garbage collection every second:\r\n```\r\nvar timer = new System.Windows.Forms.Timer();\r\ntimer.Tick += (object? sender, EventArgs e) => GC.Collect();\r\ntimer.Interval = 1000;\r\ntimer.Start();\r\n```\r\nThis alone does not fix the issue.\r\n\r\n<img width=\"291\" alt=\"leak\" src=\"https://github.com/dotnet/winforms/assets/22099714/be2ad0cb-8e72-456d-a1ff-4da870122480\">\r\n\r\nI even took a memory snapshot which proves, that Form2 is not garbage collected, because element host is still referenced by InputManager:\r\n![grafik](https://github.com/dotnet/winforms/assets/22099714/0cbc5cb9-38ab-4d4a-9909-e9ec2d2a2cd1)\r\n\r\nIn JetBrains dotMemory it looks like this:\r\n![grafik](https://github.com/dotnet/winforms/assets/22099714/5b512a8f-6370-4694-9602-9fca5feb90a2)\r\n\r\nI found a simple workaround: If I manually dispose the ElementHost control in the FormClosing event handler, then the Form will be garbage collected after a few seconds:\r\n<img width=\"289\" alt=\"manual_dispose\" src=\"https://github.com/dotnet/winforms/assets/22099714/f20f80b8-e0e0-4579-97ca-a4c17c57ba71\">\r\n\r\nBut I believe it should not be necessary to manually dispose any class that derives from System.Windows.Forms.Control even though it implements IDisposable because I was under the impression that nobody does that for other controls like Button or TextBox and the Windows Forms Designer does not generate code for that.\r\n\r\nUPDATE:\r\nI found out, that a control disposes of all its children during its own Dispose method: https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/Control.cs,6038\r\n\r\nIn my attached project, Form2.Dispose is only called (by the finalizer) if I do not add ElementHost to Form2.\r\nIf ElementHost is added to Form2 then the finalizer for Form2 never runs, so Form2.Dispose is never called, so ElementHost.Dispose is not called either.","Url":"https://github.com/dotnet/winforms/issues/9727","RelatedDescription":"Open issue \"Simplest Form not garbage collected when it contains an ElementHost control\" (#9727)"},{"Id":"1851321374","IsPullRequest":true,"CreatedAt":"2023-08-15T12:26:53","Actor":"dotnet-maestro[bot]","Number":"9725","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20230815.2\r\n- **Date Produced**: August 15, 2023 11:35:30 AM UTC\r\n- **Commit**: 1eb702ce1efe3581488a37704cee47603a291069\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Management**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Speech**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.1.23414.1 to 8.0.0-rc.1.23415.2][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/8986374ea7...1eb702ce1e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9725)","Url":"https://github.com/dotnet/winforms/pull/9725","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#9725)"},{"Id":"1851320586","IsPullRequest":true,"CreatedAt":"2023-08-15T12:26:10","Actor":"dotnet-maestro[bot]","Number":"9724","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20230814.5\r\n- **Date Produced**: August 14, 2023 5:52:21 PM UTC\r\n- **Commit**: d3b8861e20aaf0179034c6076d156e2442b26f9b\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 8.0.0-beta.23411.1 to 8.0.0-beta.23414.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/9b2af35a67...d3b8861e20\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9724)","Url":"https://github.com/dotnet/winforms/pull/9724","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#9724)"},{"Id":"1851328670","IsPullRequest":false,"CreatedAt":"2023-08-15T12:07:10","Actor":"halgab","Number":"9726","RawContent":null,"Title":"Review replacing ArgumentOutOfRangeException with custom error messages with default ones using its throw helpers ","State":"open","Body":"In dotnet/runtime#79460, a choice was made to replace several `throw new ArgumentOutOfRangeException` with custom error messages with `ArgumentOutOfRangeException.ThrowIf` methods that use a standard message. As a follow up to #9713, we could do the same in the winforms repo","Url":"https://github.com/dotnet/winforms/issues/9726","RelatedDescription":"Open issue \"Review replacing ArgumentOutOfRangeException with custom error messages with default ones using its throw helpers \" (#9726)"},{"Id":"1851152508","IsPullRequest":true,"CreatedAt":"2023-08-15T11:02:04","Actor":"LeafShi1","Number":"9722","RawContent":null,"Title":"Merge main into feature/9.0 branch - 8/15/2023","State":"closed","Body":"Merge main into feature/9.0 branch\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9722)","Url":"https://github.com/dotnet/winforms/pull/9722","RelatedDescription":"Closed or merged PR \"Merge main into feature/9.0 branch - 8/15/2023\" (#9722)"},{"Id":"1850888062","IsPullRequest":false,"CreatedAt":"2023-08-15T04:26:15","Actor":"mgaffigan","Number":"9721","RawContent":null,"Title":"Hang during exit if `WM_SETTINGCHANGE` is received","State":"open","Body":"### .NET version\n\n7.0.9-servicing.23321.6+dd121ee97234c7490f6111cf0c7bfa9235923f81\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nDue to the race condition nature of the issue, it is unclear whether the issue exists at a lower frequency or does not exist on prior versions.  I was unable to reproduce the issue in .Net 4.7.2 or net5.  The issue occurs reliably with .net 7.\n\n### Issue description\n\nWhen a `WM_SETTINGCHANGE` message is received after the main form of an application has started closing, the application hangs.  The use case where this happens reliably is when the window is an [App Bar](https://learn.microsoft.com/en-us/windows/win32/shell/application-desktop-toolbars), as it will always generate a desktop change when the window closes.\r\n\r\nApparent timeline of events:\r\n\r\n1. On main thread, in closing the only Form, a change to the desktop layout is triggered (specifically due to removing an AppBar with `SHAppBarMessage(ABM_REMOVE, ...)`)\r\n2. The main thread begins shutting down (disposing controls, form, etc...)\r\n3. The \".NET System Events\" thread receives `WM_SETTINGCHANGE` and Invokes to the main thread\r\n4. Since the main thread has not shutdown, the [test at `WindowsFormsSynchronizationContext.Send:82`](https://source.dot.net/#System.Windows.Forms/System/Windows/Forms/WindowsFormsSynchronizationContext.cs,82) succeeds\r\n5. The \".Net System Events\" thread enters a `WaitHandle`\r\n6. The main thread, having had its main form closed, exits the message loop and `Main` returns\r\n7. Hang\r\n\r\nCall stacks at hang:\r\n\r\nMain Thread (no .Net stack, only native)\r\n\r\n    win32u.dll!NtUserMsgWaitForMultipleObjectsEx()\r\n    combase.dll!CCliModalLoop::BlockFn(void * * ahEvent, unsigned long cEvents, unsigned long * lpdwSignaled) Line 2108\r\n    combase.dll!ClassicSTAThreadWaitForHandles(unsigned long dwFlags, unsigned long dwTimeout, unsigned long cHandles, void * * pHandles, unsigned long * pdwIndex) Line 54\r\n    combase.dll!CoWaitForMultipleHandles(unsigned long dwFlags, unsigned long dwTimeout, unsigned long cHandles, void * * pHandles, unsigned long * lpdwindex) Line 126\r\n    [Inline Frame] hostpolicy.dll!coreclr_t::shutdown(int *) Line 152\r\n    hostpolicy.dll!run_app_for_context(const hostpolicy_context_t & context, int argc, const wchar_t * * argv) Line 264\r\n    ...snip...\r\n\r\n.NET System Events thread\r\n\r\n\tSystem.Private.CoreLib.dll!System.Threading.WaitHandle.WaitOneNoCheck(int millisecondsTimeout) Line 139\r\n\t\tat /_/src/libraries/System.Private.CoreLib/src/System/Threading/WaitHandle.cs(139)\r\n\tSystem.Windows.Forms.dll!System.Windows.Forms.Control.WaitForWaitHandle(System.Threading.WaitHandle waitHandle) Line 3967\r\n\t\tat /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs(3967)\r\n\tSystem.Windows.Forms.dll!System.Windows.Forms.Control.MarshaledInvoke(System.Windows.Forms.Control caller, System.Delegate method, object[] args, bool synchronous) Line 7141\r\n\t\tat /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs(7141)\r\n\tSystem.Windows.Forms.dll!System.Windows.Forms.Control.Invoke(System.Delegate method, object[] args) Line 6587\r\n\t\tat /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs(6587)\r\n\tSystem.Windows.Forms.dll!System.Windows.Forms.WindowsFormsSynchronizationContext.Send(System.Threading.SendOrPostCallback d, object state) Line 88\r\n\t\tat /_/src/System.Windows.Forms/src/System/Windows/Forms/WindowsFormsSynchronizationContext.cs(88)\r\n\tMicrosoft.Win32.SystemEvents.dll!Microsoft.Win32.SystemEvents.SystemEventInvokeInfo.Invoke(bool checkFinalization, object[] args) Line 35\r\n\t\tat Microsoft.Win32\\SystemEvents.cs(35)\r\n\tMicrosoft.Win32.SystemEvents.dll!Microsoft.Win32.SystemEvents.RaiseEvent(bool checkFinalization, object key, object[] args) Line 850\r\n\t\tat Microsoft.Win32\\SystemEvents.cs(850)\r\n\t\tlocals:\r\n\t\t\tarray[0] \r\n\t\t\t\t._delegate = System.Windows.Forms.VisualStyles.VisualStyleRenderer.OnUserPreferenceChanging\r\n\t\t\t\t._syncCtx = System.Windows.Forms.WindowsFormsSynchronizationContext\r\n\tMicrosoft.Win32.SystemEvents.dll!Microsoft.Win32.SystemEvents.WindowProc(nint hWnd, int msg, nint wParam, nint lParam) Line 961\r\n\t\tat Microsoft.Win32\\SystemEvents.cs(961)\r\n\t\tlocals:\r\n\t\t\tmsg = 8218\r\n\t\t\twParam = 0x2f\r\n\t\t\tlParam = 0\r\n\t[Native to Managed Transition]\r\n\t[Managed to Native Transition]\r\n\tMicrosoft.Win32.SystemEvents.dll!Interop.User32.DispatchMessageW.____PInvoke|210_0(Interop.User32.MSG* msg)\r\n\tMicrosoft.Win32.SystemEvents.dll!Microsoft.Win32.SystemEvents.WindowThreadProc() Line 1038\r\n\t\tat Microsoft.Win32\\SystemEvents.cs(1038)\r\n\r\nNotes:\r\n\r\n- There are no controls being created on background threads ([Debugging Windows Forms Application Hangs During SystemEvents.UserPreferenceChanged](https://learn.microsoft.com/en-us/archive/blogs/dsui_team/debugging-windows-forms-application-hangs-during-systemevents-userpreferencechanged) does not apply)\r\n- At least one control is required on the form (to cause `SystemEvents.UserPreferenceChanging` to be created via `VisualStyleRenderer..cctor`)\n\n### Steps to reproduce\n\nClone either the [appbar sample](https://github.com/mgaffigan/AppBarHangRepro/blob/master/Form1.cs) or the [minimal `SendMessageTimeout` sample](https://github.com/mgaffigan/AppBarHangRepro/blob/minimal/Form1.cs).  Run the application and close the window which opens.  After waiting a few seconds, pause the debugger to observe that the main thread has exited .Net user code and is hung waiting for ???, and that .NET System Events is hung on an invoke to the now destroyed main thread.\r\n\r\nThe minimal sample can be prepared from an empty winforms project by adding an `OnHandleDestroyed` override to `Form1`:\r\n\r\n        [DllImport(\"USER32.dll\", ExactSpelling = true, EntryPoint = \"SendMessageTimeoutW\", SetLastError = true)]\r\n        internal static extern nint SendMessageTimeout(nint hWnd, uint Msg, nint wParam, nint lParam, uint fuFlags, uint uTimeout, IntPtr lpdwResult);\r\n\r\n        protected override void OnHandleDestroyed(EventArgs e)\r\n        {\r\n            base.OnHandleDestroyed(e);\r\n\r\n            // Simulate bad luck in timing or an appbar exiting\r\n            var lp = Marshal.StringToHGlobalUni(\"TapsEnabled\");\r\n            SendMessageTimeout(0x0000FFFF /* HWND_BROADCAST */, 26 /* WM_SETTINGCHANGE */, 0, lp, 0, 1000, (IntPtr)0);\r\n        }\r\n\r\nAlternatively, examine the [dump file of the hung appbar sample](https://github.com/mgaffigan/AppBarHangRepro/blob/master/WinFormsSystemEventsHangRepro.dmp.zip).","Url":"https://github.com/dotnet/winforms/issues/9721","RelatedDescription":"Open issue \"Hang during exit if `WM_SETTINGCHANGE` is received\" (#9721)"},{"Id":"1850774380","IsPullRequest":true,"CreatedAt":"2023-08-15T02:19:29","Actor":"Tanya-Solyanik","Number":"9719","RawContent":null,"Title":"Update release/8.0 to have pre-release iteration 2, pre-release label rc","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9719)","Url":"https://github.com/dotnet/winforms/pull/9719","RelatedDescription":"Closed or merged PR \"Update release/8.0 to have pre-release iteration 2, pre-release label rc\" (#9719)"},{"Id":"1850769604","IsPullRequest":true,"CreatedAt":"2023-08-15T01:30:28","Actor":"LeafShi1","Number":"9718","RawContent":null,"Title":"Update branding in main to 9.0 Preview1","State":"closed","Body":"Update branding in main to 9.0 Preview1 by update the Verison.props and fabricbot.json\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9718)","Url":"https://github.com/dotnet/winforms/pull/9718","RelatedDescription":"Closed or merged PR \"Update branding in main to 9.0 Preview1\" (#9718)"},{"Id":"1850651044","IsPullRequest":true,"CreatedAt":"2023-08-14T23:52:55","Actor":"Tanya-Solyanik","Number":"9717","RawContent":null,"Title":"Published unpublished API - run .\\eng\\ApiCompatibility\\mark-shipped.cmd.","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9717)","Url":"https://github.com/dotnet/winforms/pull/9717","RelatedDescription":"Closed or merged PR \"Published unpublished API - run .\\eng\\ApiCompatibility\\mark-shipped.cmd.\" (#9717)"},{"Id":"1848610313","IsPullRequest":true,"CreatedAt":"2023-08-14T22:21:12","Actor":"halgab","Number":"9713","RawContent":null,"Title":"Use throw helpers for ArgumentOutOfRangeException","State":"closed","Body":"I applied the CA1512 fixer across the codebase, and just deleted some blank lines manually.\r\n\r\nThere are places that the analyzer did not fix. I'm doing a manual pass locally and can follow-up on that.\r\n\r\nAlso, in dotnet/runtime#79460, custom error messages were replaced by the standard one. If that's something that we are willing to consider here, I can follow-up with another commit/PR\r\n\r\n## Proposed changes\r\n\r\n- Apply CA1512 fixer: Use ArgumentOutOfRangeException throw helper\r\n\r\n## Risk\r\n\r\n- low: changes are from anaylzers\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- CI\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9713)","Url":"https://github.com/dotnet/winforms/pull/9713","RelatedDescription":"Closed or merged PR \"Use throw helpers for ArgumentOutOfRangeException\" (#9713)"},{"Id":"1846002319","IsPullRequest":true,"CreatedAt":"2023-08-14T22:17:10","Actor":"dotnet-bot","Number":"9708","RawContent":null,"Title":"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2242979","State":"closed","Body":"This is the pull request automatically created by the OneLocBuild task in the build process to check-in localized files generated based upon translation source files (.lcl files) handed-back from the downstream localization pipeline. If there are issues in translations, visit https://aka.ms/icxLocBug and log bugs for fixes. The OneLocBuild wiki is https://aka.ms/onelocbuild and the localization process in general is documented at https://aka.ms/AllAboutLoc.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9708)","Url":"https://github.com/dotnet/winforms/pull/9708","RelatedDescription":"Closed or merged PR \"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2242979\" (#9708)"},{"Id":"1849343196","IsPullRequest":true,"CreatedAt":"2023-08-14T21:12:28","Actor":"LeafShi1","Number":"9715","RawContent":null,"Title":"Merge main into feature/9.0 branch - 8/14/2023","State":"closed","Body":"Merge main into feature/9.0 branch\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9715)","Url":"https://github.com/dotnet/winforms/pull/9715","RelatedDescription":"Closed or merged PR \"Merge main into feature/9.0 branch - 8/14/2023\" (#9715)"},{"Id":"1847756763","IsPullRequest":true,"CreatedAt":"2023-08-14T16:03:46","Actor":"mataqvazadeh","Number":"9712","RawContent":null,"Title":"remove useless semicolon","State":"closed","Body":"Hi,\r\nI just remove a useless semicolon from this file.\r\n\r\nGood Luck\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9712)","Url":"https://github.com/dotnet/winforms/pull/9712","RelatedDescription":"Closed or merged PR \"remove useless semicolon\" (#9712)"},{"Id":"1849641698","IsPullRequest":true,"CreatedAt":"2023-08-14T12:26:58","Actor":"dotnet-maestro[bot]","Number":"9716","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20230814.1\r\n- **Date Produced**: August 14, 2023 10:35:21 AM UTC\r\n- **Commit**: 8986374ea73f1e5b1977dd0058fbdf591936408a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Management**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Speech**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.1.23410.15 to 8.0.0-rc.1.23414.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/786b9872ad...8986374ea7\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9716)","Url":"https://github.com/dotnet/winforms/pull/9716","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#9716)"},{"Id":"1846494413","IsPullRequest":true,"CreatedAt":"2023-08-14T01:34:58","Actor":"LeafShi1","Number":"9710","RawContent":null,"Title":"Fixing indeterminate image color","State":"closed","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #9166 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Add HighContrast judgment when drawing indeterminate image in file ToolStripRenderer.cs\r\n- When the item is selected or under HC black theme, revert the image color\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- The color contrast of indeterminate state icon can be showed clearly\r\n\r\n## Regression? \r\n\r\n-  No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n**Windows 11 non-focused:**\r\n![image](https://github.com/dotnet/winforms/assets/132890443/7431f34e-95e4-42d8-b9e9-6abb5e4a4597)\r\n\r\n**Windows 11 mouse over:**\r\n![image](https://github.com/dotnet/winforms/assets/132890443/83ff5a06-ffec-4e61-9e06-bcaf0fdadd14)\r\n\r\n### After\r\n![image](https://github.com/dotnet/winforms/assets/132890443/e133d8a0-839b-4d64-adb9-637ab605af92)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 8.0.0-rc.1.23409.17\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9710)","Url":"https://github.com/dotnet/winforms/pull/9710","RelatedDescription":"Closed or merged PR \"Fixing indeterminate image color\" (#9710)"},{"Id":"1848624498","IsPullRequest":false,"CreatedAt":"2023-08-13T14:50:59","Actor":"rafcolson","Number":"9714","RawContent":null,"Title":"Designer crashes when running Visual Studio 17.7.0 as a DpiUnaware process","State":"open","Body":"### Environment\n\nVersion 17.7.0\n\n### .NET version\n\n.NET 6.0\n\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\n\nSame issue as described in #7609. Reemerged after the last update released on August 8th, 2023 (Visual Studio 2022 version 17.7).\n\n### Issue description\n\nIn order to run VS in DpiUnaware mode, I use this registry setting:\r\n\r\n`\r\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers]\r\n\"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\2022\\\\Community\\\\Common7\\\\IDE\\\\devenv.exe\"=\"DPIUNAWARE\"\r\n`\r\n\r\nHaving added the key and value to the registry, VS fails to launch the designer when viewing the form's designer in my solution, throwing this error:\r\n\r\n```[15:35:29.751860] warn: DPI mode SystemAware specified for the project is different from the DPI mode specified for the designer. Winforms designer will have DPI mode DpiUnaware \r\n[15:35:39.852848] fail: [MyProject]: Failed to launch design tools server process process\r\n                        System.InvalidOperationException: Failed to set process DPI mode value to: DpiUnaware.\r\n                           at Microsoft.WinForms.Utilities.Desktop.DpiHelper.SetDesignerProcessDpiAwareness(DpiAwarenessContext dpiContext)\r\n                           at Microsoft.DotNet.DesignTools.Server.Program.<>c__DisplayClass2_0.<<Main>b__1>d.MoveNext()\r\n\r\n                        For information on how to troubleshoot the designer refer to the guide at https://aka.ms/winforms/designer/troubleshooting.\r\n```\n\n### Steps to reproduce\n\n- add key and value to the registry\r\n- open solution\r\n- view the form's designer (Right-click on the form and choose \"View Designer\")\n\n### Diagnostics\n\n_No response_","Url":"https://github.com/dotnet/winforms/issues/9714","RelatedDescription":"Open issue \"Designer crashes when running Visual Studio 17.7.0 as a DpiUnaware process\" (#9714)"},{"Id":"1846703972","IsPullRequest":true,"CreatedAt":"2023-08-11T12:27:01","Actor":"dotnet-maestro[bot]","Number":"9711","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20230810.15\r\n- **Date Produced**: August 11, 2023 7:00:13 AM UTC\r\n- **Commit**: 786b9872ad306d5b0febdc2e6c820b69e0e232dc\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Management**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Speech**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.1.23409.17 to 8.0.0-rc.1.23410.15][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/3b21b909f4...786b9872ad\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9711)","Url":"https://github.com/dotnet/winforms/pull/9711","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#9711)"},{"Id":"1846117013","IsPullRequest":true,"CreatedAt":"2023-08-11T02:39:09","Actor":"LeafShi1","Number":"9709","RawContent":null,"Title":"Add \"SetTextualDefaultProperty = false\" for MaskedTextBox","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nRelated #4908 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Add \"SetTextualDefaultProperty = false\" for MaskedTextBoxDesigner\r\n- Add test for MaskedTextBoxDesigner in DemoConsole project\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- The default mask value will be null\r\n\r\n## Regression? \r\n\r\n-  No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\nThe default Mask value of the MaskedTextBox is M_skedTextBox1\r\n![image](https://github.com/dotnet/winforms/assets/132890443/921ffc21-58e4-460d-a04a-d1aba698022f)\r\n\r\n\r\n### After\r\n\r\nThe default Mask value is null\r\n\r\n![image](https://github.com/dotnet/winforms/assets/132890443/e5eb8dee-d2c4-4b39-ae87-e587658a8534)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually (added TrackBarDesigner to DemoConsole test app)\r\n\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 8.0.0-rc.1.23409.17\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9709)","Url":"https://github.com/dotnet/winforms/pull/9709","RelatedDescription":"Open PR \"Add \"SetTextualDefaultProperty = false\" for MaskedTextBox\" (#9709)"},{"Id":"1844705523","IsPullRequest":true,"CreatedAt":"2023-08-11T00:14:49","Actor":"LeafShi1","Number":"9705","RawContent":null,"Title":"Merge main into feature/9.0 branch - 8/10/2023 ","State":"closed","Body":"Merge main into feature/9.0 branch\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9705)","Url":"https://github.com/dotnet/winforms/pull/9705","RelatedDescription":"Closed or merged PR \"Merge main into feature/9.0 branch - 8/10/2023 \" (#9705)"},{"Id":"1845039703","IsPullRequest":true,"CreatedAt":"2023-08-10T21:57:48","Actor":"dotnet-maestro[bot]","Number":"9706","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20230809.17\r\n- **Date Produced**: August 10, 2023 4:18:32 AM UTC\r\n- **Commit**: 3b21b909f47ee07ec7f4cad0edde5404ebd85dd2\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Management**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Speech**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.1.23408.18 to 8.0.0-rc.1.23409.17][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/88633ae045...3b21b909f4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9706)","Url":"https://github.com/dotnet/winforms/pull/9706","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#9706)"},{"Id":"1845519043","IsPullRequest":true,"CreatedAt":"2023-08-10T16:29:16","Actor":"halgab","Number":"9707","RawContent":null,"Title":"Enable nullability in MaskDescriptor","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in `MaskDescriptor`\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9707)","Url":"https://github.com/dotnet/winforms/pull/9707","RelatedDescription":"Open PR \"Enable nullability in MaskDescriptor\" (#9707)"},{"Id":"1844443645","IsPullRequest":true,"CreatedAt":"2023-08-10T05:31:50","Actor":"gpetrou","Number":"9704","RawContent":null,"Title":"Enable nullability in DataGridViewDataConnection","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in DataGridViewDataConnection.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9704)","Url":"https://github.com/dotnet/winforms/pull/9704","RelatedDescription":"Open PR \"Enable nullability in DataGridViewDataConnection\" (#9704)"},{"Id":"1844332977","IsPullRequest":true,"CreatedAt":"2023-08-10T03:05:30","Actor":"LeafShi1","Number":"9703","RawContent":null,"Title":"Port TrackBarDesigner to runtime","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #4908 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Port TrackBarDesigner.cs to runtime\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- TrackBarDesigner can be designed in runtime\r\n\r\n## Regression? \r\n\r\n-  No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n![image](https://github.com/dotnet/winforms/assets/132890443/65c0abb4-f319-4d82-864d-e20539762117)\r\n\r\n### After\r\n\r\n![AfterChang](https://github.com/dotnet/winforms/assets/132890443/36da7c1c-6a0d-4fa3-bf50-69221c72ef82)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually (added TrackBarDesigner to DemoConsole test app)\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 8.0.100-rc.1.23407.2\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9703)","Url":"https://github.com/dotnet/winforms/pull/9703","RelatedDescription":"Open PR \"Port TrackBarDesigner to runtime\" (#9703)"}],"ResultType":"GitHubIssue"}},"RunOn":"2023-08-16T03:30:28.8772479Z","RunDurationInMilliseconds":528}