{"Data":{"GitHub":{"Issues":[{"Id":"1452538145","IsPullRequest":true,"CreatedAt":"2022-11-17T01:16:44","Actor":"lonitra","Number":"8216","RawContent":null,"Title":"Update MediaPlayer Test","State":"open","Body":"Remove manually added dlls and add core project that targets Framework to reference MediaPlayer dlls. This added project will be used to add in and write tests other ActiveX controls.\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8216)","Url":"https://github.com/dotnet/winforms/pull/8216","RelatedDescription":"Open PR \"Update MediaPlayer Test\" (#8216)"},{"Id":"1452532317","IsPullRequest":true,"CreatedAt":"2022-11-17T01:09:29","Actor":"Jericho","Number":"8215","RawContent":null,"Title":"Refactor UndoEngine to use List<T> instead of ArrayList","State":"open","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8215)","Url":"https://github.com/dotnet/winforms/pull/8215","RelatedDescription":"Open PR \"Refactor UndoEngine to use List<T> instead of ArrayList\" (#8215)"},{"Id":"1452511393","IsPullRequest":true,"CreatedAt":"2022-11-17T00:46:35","Actor":"Jericho","Number":"8214","RawContent":null,"Title":"Refactor CodeDomComponentSerializationService to use List<T> instead of ArrayList","State":"open","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8214)","Url":"https://github.com/dotnet/winforms/pull/8214","RelatedDescription":"Open PR \"Refactor CodeDomComponentSerializationService to use List<T> instead of ArrayList\" (#8214)"},{"Id":"1452491809","IsPullRequest":true,"CreatedAt":"2022-11-17T00:26:00","Actor":"elachlan","Number":"8213","RawContent":null,"Title":"Refactor AssemblyNamesTypeResolutionService to replace HashTable","State":"open","Body":"Replaced the Hashtables, enabled nullability, removed `AssemblyName.CodeBase` call.\r\n\r\nRelated: #8143, #7308\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8213)","Url":"https://github.com/dotnet/winforms/pull/8213","RelatedDescription":"Open PR \"Refactor AssemblyNamesTypeResolutionService to replace HashTable\" (#8213)"},{"Id":"1452453206","IsPullRequest":true,"CreatedAt":"2022-11-16T23:42:12","Actor":"Jericho","Number":"8212","RawContent":null,"Title":"Refactor TableLayoutStyleCollection to use List<TableLayoutStyle> instead of ArrayList","State":"open","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8212)","Url":"https://github.com/dotnet/winforms/pull/8212","RelatedDescription":"Open PR \"Refactor TableLayoutStyleCollection to use List<TableLayoutStyle> instead of ArrayList\" (#8212)"},{"Id":"1452446367","IsPullRequest":true,"CreatedAt":"2022-11-16T23:34:10","Actor":"elachlan","Number":"8211","RawContent":null,"Title":"Convert more `ObjectDisposedExceptions` to use `ThrowIf`","State":"open","Body":"Fixes #8184\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8211)","Url":"https://github.com/dotnet/winforms/pull/8211","RelatedDescription":"Open PR \"Convert more `ObjectDisposedExceptions` to use `ThrowIf`\" (#8211)"},{"Id":"1452383120","IsPullRequest":true,"CreatedAt":"2022-11-16T22:44:56","Actor":"Jericho","Number":"8210","RawContent":null,"Title":"Refactor PropertyGridView to use List<GridEntryCollection> instead of ArrayList","State":"open","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8210)","Url":"https://github.com/dotnet/winforms/pull/8210","RelatedDescription":"Open PR \"Refactor PropertyGridView to use List<GridEntryCollection> instead of ArrayList\" (#8210)"},{"Id":"1452295616","IsPullRequest":false,"CreatedAt":"2022-11-16T21:27:31","Actor":"pedautreppe","Number":"8209","RawContent":null,"Title":"Form designer does not display","State":"open","Body":"### Environment\n\nVersion 17.4.1\n\n### .NET version\n\nHas been reproed in \r\n- .NET 5\r\n- .NET 6\r\n- .NET 7\n\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\n\n_No response_\n\n### Issue description\n\nWhen creating a new winform project (whatever the .net version - .NET5+), Visual Studio cannot open the Form Designer.\r\nThe log (see diags below for full log) displays an error \"Illegal characters in path\".\r\n\r\nI have checked : \r\n- The flag Switch.System.IO.UseLegacyPathHandling is **not set** in the devenv.exe.config\r\n- The flag Switch.System.IO.UseLegacyPathHandling is **not set** in the registry (in both keys HKLM\\SOFTWARE\\Microsoft\\.NETFramework\\AppContext and HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework\\AppContext)\r\n\r\nI have tried :\r\n- to explicitely add the flag Switch.System.IO.UseLegacyPathHandling to false in the devenv.exe.config --> same exception\r\n- to run VS in admin mode --> same exception\r\n- to create the folder myself before --> same exception\n\n### Steps to reproduce\n\n- Create a new Winform project and target .net 5 (or 6 or 7)\r\n- Open the newly created form\n\n### Diagnostics\n\n```text\n[22:16:48.043750] info: Creating VsDesignerLoader\r\n[22:16:49.227075] info: [Thread 1] Creating design-time ITypeResolutionService.\r\n[22:16:50.626294] info: Start processing enqueued assemblies\r\n[22:16:50.628291] trce: Loaded Microsoft.WinForms.DesignTools.Protocol in 00:00:00.0000525 [thread 97]\r\n[22:16:51.888562] trce: Processed 'Microsoft.WinForms.DesignTools.Protocol' in 00:00:01.2603981\r\n[22:16:51.940532] info: Added 'Microsoft.WinForms.DesignTools.Protocol'\r\n[22:16:51.943529] trce: Loaded Microsoft.WinForms.DesignTools.Client in 00:00:00.0000619 [thread 26]\r\n[22:16:52.297326] trce: Processed 'Microsoft.WinForms.DesignTools.Client' in 00:00:00.3534021\r\n[22:16:52.331309] info: Added 'Microsoft.WinForms.DesignTools.Client'\r\n[22:16:55.474517] info: Visual Studio culture: en-US (0x0409)\r\n[22:16:55.474517] info: [Thread 62] Launching server...\r\n[22:16:55.584469] info: Is processor architecture ARM64: False\r\n[22:16:57.164555] trce: Processed 'System.Windows.Forms' in 00:00:00.0411825\r\n[22:16:57.377433] info: Added 'System.Windows.Forms'\r\n[22:16:57.377433] trce: Loaded System in 00:00:00.0000748 [thread 65]\r\n[22:16:57.387437] trce: Processed 'System' in 00:00:00.0099693\r\n[22:16:57.627303] info: Added 'System'\r\n[22:16:57.627303] trce: Loaded System.Drawing in 00:00:00.0000568 [thread 95]\r\n[22:16:57.628291] trce: Processed 'System.Drawing' in 00:00:00.0011485\r\n[22:16:57.654284] info: Added 'System.Drawing'\r\n[22:16:57.654284] trce: Loaded System.Design in 00:00:00.0001140 [thread 95]\r\n[22:16:59.223385] trce: Processed 'System.Design' in 00:00:01.5679662\r\n[22:16:59.368300] info: Added 'System.Design'\r\n[22:16:59.368300] trce: Loaded System.Drawing.Design in 00:00:00.0001933 [thread 84]\r\n[22:16:59.369309] trce: Processed 'System.Drawing.Design' in 00:00:00.0010410\r\n[22:16:59.374309] info: Added 'System.Drawing.Design'\r\n[22:17:10.032227] info: Shadow cache base directory: C:\\Users\\pierr\\AppData\\Local\\Microsoft\\VisualStudio\\17.0_c8ea3289\\WinFormsDesigner\r\n[22:17:10.363043] fail: System.ArgumentException: Illegal characters in path.\r\n                           at System.Security.Permissions.FileIOPermission.EmulateFileIOPermissionChecks(String fullPath)\r\n                           at System.IO.Directory.InternalCreateDirectoryHelper(String path, Boolean checkHost)\r\n                           at Microsoft.WinForms.Utilities.Shared.ShadowCacheFolder..ctor(String shadowCacheBaseDirectory, Boolean isNetCoreProject)\r\n                           at Microsoft.DotNet.DesignTools.Client.Host.ServerLayout.<CreateAsync>d__8.MoveNext()\r\n                        --- End of stack trace from previous location where exception was thrown ---\r\n                           at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                           at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                           at Microsoft.DotNet.DesignTools.Client.Host.ServerProcess.<CreateAsync>d__21.MoveNext()\r\n                        --- End of stack trace from previous location where exception was thrown ---\r\n                           at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                           at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                           at Microsoft.DotNet.DesignTools.Client.Host.ServerHostFactory.<CreateHostAsync>d__8.MoveNext()\r\n                        --- End of stack trace from previous location where exception was thrown ---\r\n                           at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                           at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                           at Microsoft.DotNet.DesignTools.Client.DesignToolsClientLoader.<CreateClientAsync>d__29.MoveNext()\r\n\r\n                        For information on how to troubleshoot the designer refer to the guide at https://aka.ms/winforms/designer/troubleshooting.\r\n[22:17:13.147454] warn: Cannot update selection in server process as Session is not connected.\n```\n","Url":"https://github.com/dotnet/winforms/issues/8209","RelatedDescription":"Open issue \"Form designer does not display\" (#8209)"},{"Id":"1452277729","IsPullRequest":false,"CreatedAt":"2022-11-16T21:10:42","Actor":"pedautreppe","Number":"8208","RawContent":null,"Title":"BindingNavigator no longer appears in the Toolbox (and does not have a designer)","State":"open","Body":"### Environment\n\nProblem identified on Visual Studio\r\n* Version 17.4.1\r\n* Version 16.11.19\r\n\n\n### .NET version\n\n.NET 5\r\n.NET 6\r\n.NET 7\n\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\n\nWas working on .NET 4.x\n\n### Issue description\n\nWhen creating a new form, you cannot choose to add a BindingNavigator : he is not available in the Toolbox.\r\nIf you add it manually in the Designer file, it works correctly, but you do not benefit of the designer calling the \"AddStandardItems\" to automatically add the first buttons.\r\n\r\nI don't know if this is related, but when investigating in the source code, the BindingNavigator refers to the BindingNavigatorDesigner class (in System.Design 4.0.0.0), but there is no Type Forwarding to the new System.Windows.Forms.Design dll and anyway, the designer does not exist in that new DLL.\r\n\r\nI also tried to create a class inheriting from BindingNavigator (see below). \r\n```csharp\r\n[Designer(typeof(MediaBindingNavigatorDesigner))]\r\npublic class MediaBindingNavigator : BindingNavigator\r\n{\r\n    [EditorBrowsable(EditorBrowsableState.Never)]\r\n    public MediaBindingNavigator() { }\r\n    public MediaBindingNavigator(BindingSource bindingSource) : base(bindingSource) { }\r\n    [EditorBrowsable(EditorBrowsableState.Never)]\r\n    public MediaBindingNavigator(IContainer container) : base(container) { }\r\n    public MediaBindingNavigator(bool addStandardItems) : base(addStandardItems: addStandardItems) { }\r\n}\r\n```\r\nI tried to create my own custom designer to be able to at least call the AddStandardItems methods, but for some reason I don't understand, this designer is not used at design time.\r\n\r\nI have the following warning displaying (see full log in the diags below)\r\n[22:07:40.7412379] [ACQ]: warn: Microsoft.DotNet.DesignTools.TypeRouting.TypeRoutingService[0]\r\n[22:07:40.7412379] [ACQ]:       Falling back to 'Microsoft.DotNet.DesignTools.Designers.ControlDesigner' for 'ACQ.MediaBindingNavigatorDesigner'\r\n\n\n### Steps to reproduce\n\n- Create a new .NET Windows Forms app\r\n- Open the newly created Form1\r\n- Open the Toolbox --> The BindingNavigator is not present\r\n\r\nWhen going to the \"Choose Items\", you can see that the BindingNavigator is correctly selected.\r\nDeselect it and open the \"Choose Items\" windows --> Still checked\r\n\n\n### Diagnostics\n\n```text\n[22:07:40.7372505] Sending request: Controls/GetAncestors\r\n[22:07:40.7382394] Controls/GetAncestors took 00:00:00.0013195.\r\n[22:07:40.7392394] Sending request: Transactions/Open\r\n[22:07:40.7402385] Transactions/Open took 00:00:00.0010285.\r\n[22:07:40.7402385] Notifying 1 'Undo/UndoUnitCreated' handlers\r\n[22:07:40.7402385] 'Undo/UndoUnitCreated' notification received: Creating components in tool 'MediaBindingNavigator'.62aa060d-3693-42d5-9986-819f26c5b264\r\n[22:07:40.7402385] Notifying 1 'Transactions/Opening' handlers\r\n[22:07:40.7402385] Notifying 1 'Transactions/Opened' handlers\r\n[22:07:40.7402385] Sending request: DesignerHosts/CreateComponent\r\n[22:07:40.7412379] [ACQ]: warn: Microsoft.DotNet.DesignTools.TypeRouting.TypeRoutingService[0]\r\n[22:07:40.7412379] [ACQ]:       Falling back to 'Microsoft.DotNet.DesignTools.Designers.ControlDesigner' for 'ACQ.MediaBindingNavigatorDesigner'\r\n[22:07:40.7538628] DesignerHosts/CreateComponent took 00:00:00.0136782.\r\n[22:07:40.7538628] Notifying 1 'Components/Added' handlers\r\n[22:07:40.7548765] Sending request: Objects/GetAttributes [137]\r\n[22:07:40.7579094] Objects/GetAttributes took 00:00:00.0027005.\r\n[22:07:40.7579094] Added designer component: 'mediaBindingNavigator2'\r\n[22:07:40.7579094] Notifying 1 'Components/Changing' handlers\r\n[22:07:40.7579094] 'Components/Changing' notification received: mediaBindingNavigator2.Text\r\n[22:07:40.7579094] Sending request: Objects/GetProperties\r\n[22:07:40.7913385] Objects/GetProperties took 00:00:00.0329720.\r\n[22:07:40.7923383] Notifying 1 'Components/Changed' handlers\r\n[22:07:40.7923383] 'Components/Changed' notification received: mediaBindingNavigator2.Text\r\n[22:07:40.7923383] Notifying 1 'Components/Changing' handlers\r\n[22:07:40.7923383] 'Components/Changing' notification received: Form1.Controls\r\n[22:07:40.7933519] Notifying 1 'Components/Changing' handlers\r\n[22:07:40.7933519] 'Components/Changing' notification received: mediaBindingNavigator2.Size\r\n[22:07:40.7933519] Notifying 1 'Components/Changed' handlers\r\n[22:07:40.7933519] 'Components/Changed' notification received: mediaBindingNavigator2.Size\r\n[22:07:40.7943368] Notifying 1 'Components/Changing' handlers\r\n[22:07:40.7943368] 'Components/Changing' notification received: mediaBindingNavigator2.Location\r\n[22:07:40.7943368] Notifying 1 'Components/Changed' handlers\r\n[22:07:40.7943368] 'Components/Changed' notification received: mediaBindingNavigator2.Location\r\n[22:07:40.7943368] Notifying 1 'Components/Changed' handlers\r\n[22:07:40.7943368] 'Components/Changed' notification received: Form1.Controls\r\n[22:07:40.7953366] Notifying 1 'Components/Changing' handlers\r\n[22:07:40.7953366] 'Components/Changing' notification received: mediaBindingNavigator2.Text\r\n[22:07:40.7953366] Notifying 1 'Components/Changed' handlers\r\n[22:07:40.7953366] 'Components/Changed' notification received: mediaBindingNavigator2.Text\r\n[22:07:40.7963361] Sending request: Transactions/Close: Cancel = False\r\n[22:07:40.7973221] Transactions/Close took 00:00:00.0009933.\r\n[22:07:40.7973221] Notifying 1 'Transactions/Closing' handlers\r\n[22:07:40.7973221] Notifying 1 'Undo/UndoUnitAdded' handlers\r\n[22:07:40.7973221] 'Undo/UndoUnitAdded' notification received: 62aa060d-3693-42d5-9986-819f26c5b264\r\n[22:07:40.7973221] Notifying 1 'Transactions/Closed' handlers\r\n[22:07:40.8003341] Updating selection in server process.\r\n[22:07:40.8003341] Sending request: Selection/UpdateSelection\r\n[22:07:40.8003341] [ACQ]: info: Microsoft.DotNet.DesignTools.Host.RemoteSelectionService[0]\r\n[22:07:40.8003341] [ACQ]:       Attempting to update selection: 1 components, Replace\r\n[22:07:40.8043510] [ACQ]: info: Microsoft.DotNet.DesignTools.Host.RemoteSelectionService[0]\r\n[22:07:40.8043510] [ACQ]:       Made change: True\r\n[22:07:40.8043510] Selection/UpdateSelection took 00:00:00.0046853.\r\n[22:07:40.8043510] Notifying 1 'Selection/Changed' handlers\r\n[22:07:40.8053509] Sending request: Properties/GetValue\r\n[22:07:40.8103481] Properties/GetValue took 00:00:00.0046069.\r\n[22:07:40.8113492] Sending request: Controls/GetParent\r\n[22:07:40.8123471] Controls/GetParent took 00:00:00.0007074.\r\n[22:07:40.8123471] Sending request: Controls/GetParent\r\n[22:07:40.8123471] Controls/GetParent took 00:00:00.0006207.\r\n[22:07:40.8123471] Sending request: Controls/GetParent\r\n[22:07:40.8133471] Controls/GetParent took 00:00:00.0005641.\r\n[22:07:40.8143548] Sending request: Commands/HasLockedControl\r\n[22:07:40.8153551] Commands/HasLockedControl took 00:00:00.0005484.\r\n[22:07:41.1534121] Sending request: Designers/GetDesignerVerbs\r\n[22:07:41.1554152] Designers/GetDesignerVerbs took 00:00:00.0014788.\r\n[22:07:41.1554152] Sending request: Designers/GetDesignerActionLists\r\n[22:07:41.1564145] Designers/GetDesignerActionLists took 00:00:00.0011682.\r\n[22:07:41.8184104] [ACQ]: Sending request to remove roots:\r\n[22:07:41.8184104] [ACQ]:   - f1: 2 root(s).\r\n[22:07:41.8184104] Sending request: Objects/RemoveObjectRoots\r\n[22:07:41.8194139] Objects/RemoveObjectRoots took 00:00:00.0007642.\n```\n","Url":"https://github.com/dotnet/winforms/issues/8208","RelatedDescription":"Open issue \"BindingNavigator no longer appears in the Toolbox (and does not have a designer)\" (#8208)"},{"Id":"1450497035","IsPullRequest":true,"CreatedAt":"2022-11-16T20:37:12","Actor":"elachlan","Number":"8202","RawContent":null,"Title":"Refactor ArrangedElementCollection to replace ArrayList","State":"closed","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8202)","Url":"https://github.com/dotnet/winforms/pull/8202","RelatedDescription":"Closed or merged PR \"Refactor ArrangedElementCollection to replace ArrayList\" (#8202)"},{"Id":"1451989683","IsPullRequest":true,"CreatedAt":"2022-11-16T17:23:46","Actor":"Jericho","Number":"8207","RawContent":null,"Title":"Refactor ArrangedElementCollection to use List<IArrangedElement> instead of ArrayList","State":"open","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8207)","Url":"https://github.com/dotnet/winforms/pull/8207","RelatedDescription":"Open PR \"Refactor ArrangedElementCollection to use List<IArrangedElement> instead of ArrayList\" (#8207)"},{"Id":"1451802348","IsPullRequest":true,"CreatedAt":"2022-11-16T15:24:24","Actor":"v-elnovikova","Number":"8206","RawContent":null,"Title":"Added unit tests for \"AccessibleObject.FragmentNavigate\" method in PropertyGridAccessibleObject class","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nPart of #6094\r\n\r\n\r\n## Proposed changes\r\n\r\n- Add missing unit tests to check the method behavior in PropertyGridAccessibleObject class\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .NET 7.0.0-rc.2.22472.3\r\n- Windows 11\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8206)","Url":"https://github.com/dotnet/winforms/pull/8206","RelatedDescription":"Open PR \"Added unit tests for \"AccessibleObject.FragmentNavigate\" method in PropertyGridAccessibleObject class\" (#8206)"},{"Id":"1451119749","IsPullRequest":false,"CreatedAt":"2022-11-16T08:27:25","Actor":"awaescher","Number":"8205","RawContent":null,"Title":"Windows Forms Out-of-process designer can't make use of transient references","State":"open","Body":"### Environment\r\n\r\nVisual Studio Professional 2022 (64-bit) Version 17.4.0\r\n\r\n\r\n### .NET version\r\n\r\n.NET 6.0\r\n\r\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\r\n\r\nWorks as soon as .NET Framework is used in the same projects. Does also work with multitargeting.\r\n\r\n### Issue description\r\n\r\nThe new out-of-process Windows Forms designer shows the following error when the base form of the form that is currently opened in the designer implements an interface from a transitive referenced project:\r\n\r\n![error](https://raw.githubusercontent.com/awaescher/DesignerVsInterfaces/main/media/error-designer.png)\r\n![log](https://raw.githubusercontent.com/awaescher/DesignerVsInterfaces/main/media/error-log.png)\r\n\r\nIt took me quite a while to hunt this down but it seems that the new designer shows this error if ...\r\n\r\n - the form in question is derived from a base form (from the same or another project)\r\n - the base form implements an interface\r\n - the interface is defined in another project\r\n - the other project is **referenced over an transient project reference**\r\n\r\nIn this case the base form still can be designed. The designer however crashes when openening the derived form. The error disappears as soon a direct project reference is added.\r\n\r\n### References overview\r\n![log](https://raw.githubusercontent.com/awaescher/DesignerVsInterfaces/main/media/diagram.png)\r\n\r\n---\r\n\r\nMore details and a repro under https://github.com/awaescher/DesignerVsInterfaces\r\n\r\n\r\n### Steps to reproduce\r\n\r\n - clone the repository https://github.com/awaescher/DesignerVsInterfaces\r\n - build\r\n - open the designer for both base forms: should work\r\n - open the designer for GoodDerivedForm: should work\r\n - open the designer for BadDerivedForm: should cause the **error** shown above\r\n\r\n### Diagnostics\r\n\r\n```text\r\n// complete log when opening BadDerivedForm from the repro repository\r\n\r\n[09:19:17.934946] info: Creating VsDesignerLoader\r\n[09:19:17.938946] trce: Sending request: Sessions/Create\r\n[09:19:17.939981] trce: Sessions/Create took 00:00:00.0015269.\r\n[09:19:17.940945] trce: Sending request: Options/SetOptions\r\n[09:19:17.940945] trce: Options/SetOptions took 00:00:00.0007348.\r\n[09:19:17.941961] trce: Sending request: Sessions/BeginLoad\r\n[09:19:17.941961] trce: Sessions/BeginLoad took 00:00:00.0005457.\r\n[09:19:17.959431] trce: Sending request: Sessions/DesignerActivated\r\n[09:19:17.960400] trce: Sessions/DesignerActivated took 00:00:00.0007037.\r\n[09:19:18.044542] info: Created VsCodeDomProvider for 'C:\\Users\\daw\\Source\\repos\\DesignerVsInterfaces\\DesignerVsInterfacesUI\\BadDerivedForm.cs'\r\n[09:19:18.049542] info: Created VsCodeDomProvider for 'C:\\Users\\daw\\Source\\repos\\DesignerVsInterfaces\\DesignerVsInterfacesUI\\BadDerivedForm.Designer.cs'\r\n[09:19:18.050543] trce: ProcessNamespace: DesignerVsInterfacesUI\r\n[09:19:18.051543] trce: ProcessClass: BadDerivedForm\r\n[09:19:18.052543] trce: ProcessConstructor\r\n[09:19:18.053542] trce: ProcessNamespace: DesignerVsInterfacesUI\r\n[09:19:18.054542] trce: ProcessClass: BadDerivedForm\r\n[09:19:18.055542] trce: ProcessField: components\r\n[09:19:18.057542] trce: ProcessMethod: Dispose\r\n[09:19:18.058543] trce: ProcessMethod: InitializeComponent\r\n[09:19:18.059542] trce: Sending request: Sessions/FindDesignableClass\r\n[09:19:18.061560] trce: Sessions/FindDesignableClass took 00:00:00.0022300.\r\n[09:19:18.061560] fail: Request failures: Sessions/FindDesignableClass.\r\n                        Microsoft.DotNet.DesignTools.Client.DesignToolsServerException: The designer could not be shown for this file because none of the classes within it can be designed.  The designer inspected the following classes in the file: \\r\\n\r\n                        \tBadDerivedForm --- The base class 'DesignerVsInterfacesUI.BaseFormReferencingBaseLibrary' could not be loaded.  Ensure the assembly has been referenced and that all projects have been built.\r\n\r\n                        For information on how to troubleshoot the designer refer to the guide at https://aka.ms/winforms/designer/troubleshooting.\r\n[09:19:18.065425] trce: Updating selection in server process.\r\n[09:19:18.065425] trce: Sending request: Selection/UpdateSelection\r\n[09:19:18.066433] trce: [DesignerVsInterfacesUI]: Attempting to update selection: 0 components, Replace\r\n[09:19:18.066433] trce: [DesignerVsInterfacesUI]: Made change: False\r\n[09:19:18.066433] trce: Selection/UpdateSelection took 00:00:00.0007927.\r\n[09:19:18.066433] trce: Sending request: Sessions/Unload\r\n[09:19:18.067067] trce: Sessions/Unload took 00:00:00.0004503.\r\n[09:19:18.067067] trce: Sending request: Sessions/EndLoad\r\n[09:19:18.067067] trce: Sessions/EndLoad took 00:00:00.0004010.\r\n[09:19:23.422459] trce: [DesignerVsInterfacesUI]: Sending request to remove roots:\r\n                          - 289: 1 root(s).\r\n                          ...\r\n                          - 1d9: 2 root(s).\r\n                          - 1d8: 6 root(s).\r\n                        \r\n[09:19:23.422459] trce: Sending request: Objects/RemoveObjectRoots\r\n[09:19:23.425472] trce: [DesignerVsInterfacesUI]: Objects/RemoveObjectRoots request received for 293 object(s).\r\n                          - 289: 1 root(s).\r\n                          ...\r\n                          - 1d9: 2 root(s).\r\n                          - 1d8: 6 root(s).\r\n                        \r\n[09:19:23.425472] trce: Objects/RemoveObjectRoots took 00:00:00.0033258.\r\n```\r\n","Url":"https://github.com/dotnet/winforms/issues/8205","RelatedDescription":"Open issue \"Windows Forms Out-of-process designer can't make use of transient references\" (#8205)"},{"Id":"1450704364","IsPullRequest":false,"CreatedAt":"2022-11-16T02:15:12","Actor":"RussKie","Number":"8204","RawContent":null,"Title":"[Announcement] Signing off","State":"open","Body":"After three and a half years of being the repository owner and maintainer I'm moving to another .NET team and, thus, signing off here. It was an awesome ride, and together we've built an amazing community. Windows Forms has a special place in my heart, and I expect to stick around, though, more in a role of a contributor.\r\n\r\nFeel free to tag me in issues and pull-requests, though I can't guarantee the same level of responsiveness as you've come to expect of me.\r\n\r\nThank you all, and happy coding!\r\nIgor","Url":"https://github.com/dotnet/winforms/issues/8204","RelatedDescription":"Open issue \"[Announcement] Signing off\" (#8204)"},{"Id":"1450669094","IsPullRequest":false,"CreatedAt":"2022-11-16T01:38:27","Actor":"JeremyKuhne","Number":"8203","RawContent":null,"Title":"Use interpolated strings in WinForms","State":"open","Body":"WinForms formatted string usages should be converted to interpolated strings where possible to get the various performance benefits.\r\n\r\nhttps://learn.microsoft.com/dotnet/csharp/language-reference/tokens/interpolated\r\n\r\nThis is a good community contribution issue. Details:\r\n\r\n- Keep PRs to a manageable size\r\n- This includes usages of `+` to concat strings\r\n- `string.Format` is still needed for anything that gets localized strings (`SR.*`)\r\n- In most cases we don't need to specify culture\r\n  - Not needed ever for integers or booleans that aren't special formatted\r\n  - Never really needed in Debug statements\r\n\r\n\r\nExamples of changes:\r\n\r\n``` C#\r\n// No culture needed - non localized string, debug only, boolean\r\nDebug.WriteLineIf(CompModSwitches.ImeMode.Level >= TraceLevel.Info, string.Format(CultureInfo.CurrentCulture, \"Inside get_CanEnableIme(), value = {0}, this = {1}\", ImeSupported, this));\r\n\r\n// Becomes...\r\n\r\nDebug.WriteLineIf(CompModSwitches.ImeMode.Level >= TraceLevel.Info, $\"Inside get_CanEnableIme(), value = {ImeSupported}, this = {this}\");\r\n\r\n\r\n\r\nDebug.WriteLineIf(CompModSwitches.ImeMode.Level >= TraceLevel.Info, \"Inside get_CurrentImeContextMode(), this = \" + this)\r\n\r\n// Becomes...\r\n\r\nDebug.WriteLineIf(CompModSwitches.ImeMode.Level >= TraceLevel.Info, $\"Inside get_CurrentImeContextMode(), this = {this}\")\r\n```\r\n\r\nI don't think we have many cases where [raw string literals](https://learn.microsoft.com/dotnet/csharp/language-reference/proposals/csharp-11.0/raw-string-literal) are needed, but that can be included in this work if any come up. (`$\"\"\"Count {0}\"\"\"`)\r\n\r\nWe should also identify and collect places in the WinForms code where we're frequently passing formatted strings that may not be used so we can look for ways to leverage skipping formatting in much the same way that `Debug.WriteLineIf`, etc. do.\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/8203","RelatedDescription":"Open issue \"Use interpolated strings in WinForms\" (#8203)"},{"Id":"1449090209","IsPullRequest":true,"CreatedAt":"2022-11-16T01:12:30","Actor":"RussKie","Number":"8197","RawContent":null,"Title":"Tweak \"Add no recent activity label to issues and pull requests\" task","State":"closed","Body":"The task appears to have not been run for awhile, tweak the settings in hope to revive the task.\r\n![image](https://user-images.githubusercontent.com/4403806/201817886-dd075aa4-44da-435f-9ba5-027440189b3c.png)\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8197)","Url":"https://github.com/dotnet/winforms/pull/8197","RelatedDescription":"Closed or merged PR \"Tweak \"Add no recent activity label to issues and pull requests\" task\" (#8197)"},{"Id":"1448999843","IsPullRequest":true,"CreatedAt":"2022-11-16T01:06:09","Actor":"elachlan","Number":"8196","RawContent":null,"Title":"Add CSharpIsNull Analyzer","State":"closed","Body":"Related: #3459\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8196)","Url":"https://github.com/dotnet/winforms/pull/8196","RelatedDescription":"Closed or merged PR \"Add CSharpIsNull Analyzer\" (#8196)"},{"Id":"1449260789","IsPullRequest":true,"CreatedAt":"2022-11-16T01:02:50","Actor":"elachlan","Number":"8200","RawContent":null,"Title":"Refactor CommandSet and associated classes to use List<T> and Dictionary<TKey, TValue>","State":"closed","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8200)","Url":"https://github.com/dotnet/winforms/pull/8200","RelatedDescription":"Closed or merged PR \"Refactor CommandSet and associated classes to use List<T> and Dictionary<TKey, TValue>\" (#8200)"},{"Id":"1449182338","IsPullRequest":true,"CreatedAt":"2022-11-16T00:44:58","Actor":"elachlan","Number":"8199","RawContent":null,"Title":"Refactor ResizeBehavior to replace ArrayList","State":"closed","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8199)","Url":"https://github.com/dotnet/winforms/pull/8199","RelatedDescription":"Closed or merged PR \"Refactor ResizeBehavior to replace ArrayList\" (#8199)"},{"Id":"1450309279","IsPullRequest":true,"CreatedAt":"2022-11-15T20:02:18","Actor":"dreddy-work","Number":"8201","RawContent":null,"Title":"Fix anchors in nested UserControls","State":"open","Body":"This is not a regression, but the root cause is different in Framework vs .NET 8.0. In .NET 8.0 Anchor calculations are delayed until after the Handles are created. This is problematic in the scenarios where UserControls containing anchored controls are nested and resized. See below example.\r\n\r\nex:\r\n-  User control has a TextBox anchored in all directions.\r\n-  User control is then added to Form and resized, Textbox anchors should have been calculated based on the UserControls original size and grow/shrink on this resize event. However, in runtime while deserializing this, none of the Handles have been created yet and thus anchor calculations computed with the new size for UserControl, when their Handles are created.\r\n\r\nOnly reason we delayed anchors calculation in .NET8.0 is to accommodate initialization to complete, and all parenting and sizes are applied on the controls. We can achieve this by delaying anchors calculation until after the parent layout is resumed. When handles are created, DPI is applied to handles and WinForms runtime scales controls and anchors (if applicable).\r\n\r\nFixes #6381.\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8201)","Url":"https://github.com/dotnet/winforms/pull/8201","RelatedDescription":"Open PR \"Fix anchors in nested UserControls\" (#8201)"},{"Id":"1448551326","IsPullRequest":true,"CreatedAt":"2022-11-15T19:08:38","Actor":"Jericho","Number":"8189","RawContent":null,"Title":"Refactor WeakRefCollection to use List<WeakRefObject?> instead of ArrayList ","State":"closed","Body":"Related: #8140 \n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8189)","Url":"https://github.com/dotnet/winforms/pull/8189","RelatedDescription":"Closed or merged PR \"Refactor WeakRefCollection to use List<WeakRefObject?> instead of ArrayList \" (#8189)"},{"Id":"1447682746","IsPullRequest":true,"CreatedAt":"2022-11-15T18:09:11","Actor":"elachlan","Number":"8187","RawContent":null,"Title":"Refactor BehaviorService to use List<T> instead of ArrayList","State":"closed","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8187)","Url":"https://github.com/dotnet/winforms/pull/8187","RelatedDescription":"Closed or merged PR \"Refactor BehaviorService to use List<T> instead of ArrayList\" (#8187)"},{"Id":"1448893219","IsPullRequest":true,"CreatedAt":"2022-11-15T17:55:11","Actor":"elachlan","Number":"8195","RawContent":null,"Title":"Refactor ToolStripKeyboardHandlingService to use List<T> instead of ArrayList","State":"closed","Body":"Plus other refactors.\r\n\r\nRelated: #8140, #3459\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8195)","Url":"https://github.com/dotnet/winforms/pull/8195","RelatedDescription":"Closed or merged PR \"Refactor ToolStripKeyboardHandlingService to use List<T> instead of ArrayList\" (#8195)"},{"Id":"1449179315","IsPullRequest":true,"CreatedAt":"2022-11-15T05:12:19","Actor":"elachlan","Number":"8198","RawContent":null,"Title":"Refactor DesignerActionService to replace Hashtable and ArrayList","State":"open","Body":"Related: #8140, #8143\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8198)","Url":"https://github.com/dotnet/winforms/pull/8198","RelatedDescription":"Open PR \"Refactor DesignerActionService to replace Hashtable and ArrayList\" (#8198)"},{"Id":"1448880062","IsPullRequest":true,"CreatedAt":"2022-11-15T02:39:07","Actor":"elachlan","Number":"8194","RawContent":null,"Title":"Refactor DocumentDesigner to use List<T> instead of ArrayList","State":"closed","Body":"Related: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8194)","Url":"https://github.com/dotnet/winforms/pull/8194","RelatedDescription":"Closed or merged PR \"Refactor DocumentDesigner to use List<T> instead of ArrayList\" (#8194)"},{"Id":"1448879750","IsPullRequest":true,"CreatedAt":"2022-11-15T02:38:33","Actor":"elachlan","Number":"8193","RawContent":null,"Title":"Refactor PbrsForward to use List<T> instead of ArrayList","State":"closed","Body":"As well as other refactors.\r\n\r\nRelated: #8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8193)","Url":"https://github.com/dotnet/winforms/pull/8193","RelatedDescription":"Closed or merged PR \"Refactor PbrsForward to use List<T> instead of ArrayList\" (#8193)"},{"Id":"1448760195","IsPullRequest":true,"CreatedAt":"2022-11-14T22:14:46","Actor":"dotnet-maestro[bot]","Number":"8192","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:84f431dc-3375-4a46-af87-08d961c59698)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 84f431dc-3375-4a46-af87-08d961c59698\r\n- **Build**: 20221111.1\r\n- **Date Produced**: November 11, 2022 6:08:35 PM UTC\r\n- **Commit**: 0967701e5527a1be21d9473821077c3f4be7f9dc\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 6.0.0-beta.22560.1 to 6.0.0-beta.22561.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/a0fd54b...0967701\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:84f431dc-3375-4a46-af87-08d961c59698)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8192)","Url":"https://github.com/dotnet/winforms/pull/8192","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#8192)"},{"Id":"1448561203","IsPullRequest":true,"CreatedAt":"2022-11-14T20:41:52","Actor":"dotnet-maestro[bot]","Number":"8190","RawContent":null,"Title":"[release/7.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:1bb79c46-2599-4c95-8164-08da7ef6284d)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 1bb79c46-2599-4c95-8164-08da7ef6284d\r\n- **Build**: 20221111.2\r\n- **Date Produced**: November 11, 2022 6:35:12 PM UTC\r\n- **Commit**: f36ea231c234560514ede4c2747897a737ced28f\r\n- **Branch**: refs/heads/release/7.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22558.4 to 7.0.0-beta.22561.2][2]\r\n\r\n[2]: https://github.com/dotnet/arcade/compare/3f3c360...f36ea23\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:1bb79c46-2599-4c95-8164-08da7ef6284d)\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8190)\r\n","Url":"https://github.com/dotnet/winforms/pull/8190","RelatedDescription":"Closed or merged PR \"[release/7.0] Update dependencies from dotnet/arcade\" (#8190)"},{"Id":"1448565450","IsPullRequest":true,"CreatedAt":"2022-11-14T19:18:40","Actor":"dotnet-maestro[bot]","Number":"8191","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:84f431dc-3375-4a46-af87-08d961c59698)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 84f431dc-3375-4a46-af87-08d961c59698\r\n- **Build**: 20221110.1\r\n- **Date Produced**: November 11, 2022 4:38:15 PM UTC\r\n- **Commit**: a0fd54b5c2dc3e23aa8466bd4638462df4303633\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 6.0.0-beta.22558.7 to 6.0.0-beta.22560.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/a7773a9...a0fd54b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:84f431dc-3375-4a46-af87-08d961c59698)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8191)","Url":"https://github.com/dotnet/winforms/pull/8191","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#8191)"},{"Id":"1448531270","IsPullRequest":true,"CreatedAt":"2022-11-14T18:19:12","Actor":"Jericho","Number":"8188","RawContent":null,"Title":"Refactor several data grid view classes to use List<T> instead of ArrayList","State":"open","Body":"Related: https://github.com/dotnet/winforms/issues/8140\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/8188)","Url":"https://github.com/dotnet/winforms/pull/8188","RelatedDescription":"Open PR \"Refactor several data grid view classes to use List<T> instead of ArrayList\" (#8188)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-11-17T03:32:08.3459797Z","RunDurationInMilliseconds":639}