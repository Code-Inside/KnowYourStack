{"Data":{"GitHub":{"Issues":[{"Id":"1877706493","IsPullRequest":true,"CreatedAt":"2023-09-02T01:29:57","Actor":"KlausLoeffelmann","Number":"9832","RawContent":null,"Title":"Update System.Drawing.Common README.md","State":"closed","Body":"This fixes https://github.com/dotnet/winforms/issues/9729.\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9832)","Url":"https://github.com/dotnet/winforms/pull/9832","RelatedDescription":"Closed or merged PR \"Update System.Drawing.Common README.md\" (#9832)"},{"Id":"1877950288","IsPullRequest":true,"CreatedAt":"2023-09-01T19:26:51","Actor":"lonitra","Number":"9834","RawContent":null,"Title":"Remove Tracing from AxHost","State":"open","Body":"We have trace statements everywhere in AxHost and most of our trace statements do not seem to add much value as it just highlights what methods were entered. If needed, we can use debug actions in VS to output messages capturing points of interest when debugging instead of having traces throughout our code, so removing them.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9834)","Url":"https://github.com/dotnet/winforms/pull/9834","RelatedDescription":"Open PR \"Remove Tracing from AxHost\" (#9834)"},{"Id":"1876061222","IsPullRequest":true,"CreatedAt":"2023-09-01T17:36:40","Actor":"vseanreesermsft","Number":"9820","RawContent":null,"Title":"Update branding to 6.0.23","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9820)","Url":"https://github.com/dotnet/winforms/pull/9820","RelatedDescription":"Closed or merged PR \"Update branding to 6.0.23\" (#9820)"},{"Id":"1876061522","IsPullRequest":true,"CreatedAt":"2023-09-01T17:36:22","Actor":"vseanreesermsft","Number":"9821","RawContent":null,"Title":"Update branding to 7.0.12","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9821)","Url":"https://github.com/dotnet/winforms/pull/9821","RelatedDescription":"Closed or merged PR \"Update branding to 7.0.12\" (#9821)"},{"Id":"1876387347","IsPullRequest":true,"CreatedAt":"2023-09-01T17:14:21","Actor":"dotnet-maestro[bot]","Number":"9826","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: 5f9d099d-0d05-4b82-cc41-08db9e4039c1\r\n- **Build**: 20230831.9\r\n- **Date Produced**: August 31, 2023 9:57:25 PM UTC\r\n- **Commit**: 3c48925a6c1ab31865b4438a6cb88242d1a8fe4d\r\n- **Branch**: refs/heads/release/8.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Management**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Speech**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.2.23430.5 to 8.0.0-rc.2.23431.9][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/40d2134aa5...3c48925a6c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9826)","Url":"https://github.com/dotnet/winforms/pull/9826","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/runtime\" (#9826)"},{"Id":"1877721307","IsPullRequest":false,"CreatedAt":"2023-09-01T16:33:11","Actor":"SlugFiller","Number":"9833","RawContent":null,"Title":"Resizing an editable combobox triggers autocomplete","State":"open","Body":"### .NET version\n\n.NET SDK (reflecting any global.json):\r\n Version:   6.0.413\r\n Commit:    10710f7d8e\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.19045\r\n OS Platform: Windows\r\n RID:         win10-x64\r\n Base Path:   D:\\Program Files\\dotnet\\sdk\\6.0.413\\\r\n\r\nglobal.json file:\r\n  Not found\r\n\r\nHost:\r\n  Version:      6.0.21\r\n  Architecture: x64\r\n  Commit:       e40b3abf1b\r\n\r\n.NET SDKs installed:\r\n  6.0.413 [D:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 6.0.21 [D:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 6.0.21 [D:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 6.0.21 [D:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n\r\nDownload .NET:\r\n  https://aka.ms/dotnet-download\r\n\r\nLearn about .NET Runtimes and SDKs:\r\n  https://aka.ms/dotnet/runtimes-sdk-info\r\n\n\n### Did it work in .NET Framework?\n\nNot tested/verified\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\nChanging the width of an editable ComboBox, while the text contains a prefix of one of its options, causes the text to be replaced with that option. The value of `AutoCompleteMode` has no influence on this.\r\n\r\n[combobox_bug.webm](https://github.com/dotnet/winforms/assets/5435495/fd44f124-8679-44f8-acb1-5b71b6c6f897)\r\n\n\n### Steps to reproduce\n\n- Create a combobox, setting anchors that cause it to resize with the window\r\n- Fill the combobox with options\r\n- Type in a text that is a prefix of one of the options\r\n- Resize the window\r\n\r\nMinimal reproducible program:\r\n[combobox_bug_mrp.zip](https://github.com/dotnet/winforms/files/12499853/combobox_bug_mrp.zip)\r\n","Url":"https://github.com/dotnet/winforms/issues/9833","RelatedDescription":"Open issue \"Resizing an editable combobox triggers autocomplete\" (#9833)"},{"Id":"1877367248","IsPullRequest":true,"CreatedAt":"2023-09-01T13:14:30","Actor":"dotnet-maestro[bot]","Number":"9831","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:bcf5aa31-6777-442e-8e36-08db9e435944)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: bcf5aa31-6777-442e-8e36-08db9e435944\r\n- **Build**: 20230831.2\r\n- **Date Produced**: August 31, 2023 5:26:31 PM UTC\r\n- **Commit**: ec030fdef9faf8b2bd6f5f422545e8d8f7054e48\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/804d586c07...ec030fdef9\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:bcf5aa31-6777-442e-8e36-08db9e435944)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9831)","Url":"https://github.com/dotnet/winforms/pull/9831","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/arcade\" (#9831)"},{"Id":"1877298773","IsPullRequest":true,"CreatedAt":"2023-09-01T12:27:41","Actor":"dotnet-maestro[bot]","Number":"9830","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20230831.2\r\n- **Date Produced**: August 31, 2023 5:26:31 PM UTC\r\n- **Commit**: ec030fdef9faf8b2bd6f5f422545e8d8f7054e48\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 8.0.0-beta.23429.1 to 8.0.0-beta.23431.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/804d586c07...ec030fdef9\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9830)","Url":"https://github.com/dotnet/winforms/pull/9830","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#9830)"},{"Id":"1876938478","IsPullRequest":false,"CreatedAt":"2023-09-01T07:56:54","Actor":"Olina-Zhang","Number":"9829","RawContent":null,"Title":"[.Net 9.0] Accessibility tools: An unhandled exception pops up when editing list item in ListView with View modes: LargeIcon/SmallIcon/List","State":"open","Body":"### .NET version\n\n.Net 8.0+ private binaries built from Winforms **main** branch \n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nYes, this issue cannot repro in the latest .Net 8.0 RC2 build and previous versions, regressed from GH PR: https://github.com/dotnet/winforms/pull/9782\n\n### Issue description\n\nAfter the PR: https://github.com/dotnet/winforms/pull/9782, it just works well in ListView with View mode: Details/Tile, and for other values: LargeIcon/SmallIcon/List, there has an exception unhandled when using Accessibility tools to edit ListItem\r\n\r\n![image](https://github.com/dotnet/winforms/assets/26474449/758754eb-1e99-4504-9d26-c689244c9789)\r\n\r\n_System.ArgumentNullException\r\n  HResult=0x80004003\r\n  Message=Value cannot be null. (Parameter 'owningListView._listViewSubItem')\r\n  Source=System.Private.CoreLib\r\n  StackTrace:\r\n   at System.ArgumentNullException.Throw(String paramName)\r\n   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)\r\n   at System.Windows.Forms.ArgumentValidation.OrThrowIfNull[T](T argument, String paramName)\r\n   at System.Windows.Forms.ListViewLabelEditAccessibleObject..ctor(ListView owningListView, ListViewLabelEditNativeWindow labelEdit)\r\n   at System.Windows.Forms.ListViewLabelEditNativeWindow.get_AccessibilityObject()\r\n   at System.Windows.Forms.ListViewLabelEditNativeWindow.<WmGetObject>g__EnsureWinEventHooksInstalledAndGetAccessibilityObject|19_0()\r\n   at System.Windows.Forms.ListViewLabelEditNativeWindow.WmGetObject(Message& m)\r\n   at System.Windows.Forms.ListViewLabelEditNativeWindow.WndProc(Message& m)\r\n   at System.Windows.Forms.NativeWindow.Callback(HWND hWnd, MessageId msg, WPARAM wparam, LPARAM lparam)_\r\n\r\n![Exception_ListView](https://github.com/dotnet/winforms/assets/26474449/7c15b7d5-db5c-4463-a219-cced3cba8ddd)\r\n\n\n### Steps to reproduce\n\nSampe application: \r\n[ListViewDemo.zip](https://github.com/dotnet/winforms/files/12495697/ListViewDemo.zip)\r\n","Url":"https://github.com/dotnet/winforms/issues/9829","RelatedDescription":"Open issue \"[.Net 9.0] Accessibility tools: An unhandled exception pops up when editing list item in ListView with View modes: LargeIcon/SmallIcon/List\" (#9829)"},{"Id":"1876828328","IsPullRequest":false,"CreatedAt":"2023-09-01T06:31:16","Actor":"Olina-Zhang","Number":"9828","RawContent":null,"Title":"Accessibility: Narrator cannot focus entire texts and announce \"Document selected\" when pressing Ctrl+A to choose all texts in TextBox/ComboBox/DomainUpDown/NumericUpDown","State":"open","Body":"### .NET version\n\n.Net 8.0: 8.0.100-rc.2.23431.5\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nYes, this issue cannot repro in .Net 6.0 and .Net 7.0 for TextBox/DomainUpDown/NumericUpDown, but repro in ComboBox\n\n### Issue description\n\nWhen using keyboard: Ctrl+A or mouse to choose all texts in TextBox/ComboBox/DomainUpDown/NumericUpDown, Narrator cannot focus entire texts and announce \"Document selected\" to user\r\n\r\nThis issue cannot repro in MaskedTextBox/RichTextBox\r\n\r\n**The result in .Net 8.0 RC2 latest build:**\r\n![image](https://github.com/dotnet/winforms/assets/26474449/7c340f96-19c7-4e48-bdcc-32524ad7ca93)\r\n![SelectAll_8 0](https://github.com/dotnet/winforms/assets/26474449/29680e97-46da-4c28-9e55-0702722fce0c)\r\n\r\n**The result in .Net 7.0:**\r\n![image](https://github.com/dotnet/winforms/assets/26474449/ddedbe40-8585-4983-8aab-01ec61d30308)\r\n![SelectAll_7 0](https://github.com/dotnet/winforms/assets/26474449/95017d39-af03-471c-8ade-f17a54c10835)\r\n\r\n\n\n### Steps to reproduce\n\n1. Create a winforms .Net Core application with targeting .Net 8.0\r\n2. Add these controls: TextBox/ComboBox/DomainUpDown/NumericUpDown with texts\r\n3. Build and run \r\n4. Use Narrator to focus on the individual text in these controls, then presse Ctrl+A to select all texts\r\n\r\nor use the sample application:\r\n[WinFormsApp16.zip](https://github.com/dotnet/winforms/files/12495019/WinFormsApp16.zip)\r\n","Url":"https://github.com/dotnet/winforms/issues/9828","RelatedDescription":"Open issue \"Accessibility: Narrator cannot focus entire texts and announce \"Document selected\" when pressing Ctrl+A to choose all texts in TextBox/ComboBox/DomainUpDown/NumericUpDown\" (#9828)"},{"Id":"1876450140","IsPullRequest":true,"CreatedAt":"2023-08-31T23:52:15","Actor":"KlausLoeffelmann","Number":"9827","RawContent":null,"Title":"Implement first draft of Control.InvokeAsync, MessageBox.ShowAsync an…","State":"open","Body":"Draft PR for getting this started for .NET 9.\r\n\r\n* `Control.InvokeAsync`.\r\n* `MessageBox.ShowAsync`.\r\n* `Form.ShowAsync`.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9827)","Url":"https://github.com/dotnet/winforms/pull/9827","RelatedDescription":"Open PR \"Implement first draft of Control.InvokeAsync, MessageBox.ShowAsync an…\" (#9827)"},{"Id":"1876330586","IsPullRequest":false,"CreatedAt":"2023-08-31T21:18:19","Actor":"lonitra","Number":"9825","RawContent":null,"Title":"Move to use Cswin32 for TaskDialogIndirect","State":"open","Body":"`TaskDialog` utilizes `Comctrl.TaskDialogIndirect`, which needs to move to Cswin32 along with the rest that are in the folder. \r\n\r\nThis is set as a work item for .NET 9, but any help on this would be appreciate :)","Url":"https://github.com/dotnet/winforms/issues/9825","RelatedDescription":"Open issue \"Move to use Cswin32 for TaskDialogIndirect\" (#9825)"},{"Id":"1876313808","IsPullRequest":false,"CreatedAt":"2023-08-31T21:09:23","Actor":"lonitra","Number":"9824","RawContent":null,"Title":"Move Mshtml to Cswin32","State":"open","Body":"Interop.Mshtml has quite a few COM interfaces that need to be moved to use Cswin32 to support trimming/AOT","Url":"https://github.com/dotnet/winforms/issues/9824","RelatedDescription":"Open issue \"Move Mshtml to Cswin32\" (#9824)"},{"Id":"1876273404","IsPullRequest":false,"CreatedAt":"2023-08-31T20:41:59","Actor":"JeremyKuhne","Number":"9823","RawContent":null,"Title":"RichEdit control needs moved to CsWin32","State":"open","Body":"This is particularly important as it has a few COM interfaces that need to be moved to native pointers to support AOT/Trimming.\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/9823","RelatedDescription":"Open issue \"RichEdit control needs moved to CsWin32\" (#9823)"},{"Id":"1876261802","IsPullRequest":false,"CreatedAt":"2023-08-31T20:32:58","Actor":"leind375","Number":"9822","RawContent":null,"Title":"Accessibility: Can't select TreeView items using UIAutomation SelectionItem.Select","State":"open","Body":"### .NET version\n\n8.0 Preview 7.\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n.NET 6 was working\n\n### Issue description\n\nUsing UIAutomation API to select a TreeView item fails - the root item gets selected but not the desired item.\n\n### Steps to reproduce\n\nCreate a basic WinForms app and add a TreeView. Edit the Nodes collection and add a root and 5 children. Run the app.\r\nUsing Inspect.exe (included in Visual Studio), expand the app and the tree and the root node. Click on one of the nodes then in the menu select Action=>SelectionItem.Select. Note that the node does not get selected. This is a regression from .NET 6 (didn't try 7).","Url":"https://github.com/dotnet/winforms/issues/9822","RelatedDescription":"Open issue \"Accessibility: Can't select TreeView items using UIAutomation SelectionItem.Select\" (#9822)"},{"Id":"1874667850","IsPullRequest":true,"CreatedAt":"2023-08-31T17:20:48","Actor":"JeremyKuhne","Number":"9818","RawContent":null,"Title":"Fix Accessibility COM related issues (#9804)","State":"closed","Body":"## Ports #9804\r\n\r\n- AccessibleObject.Navigate was not returning results from SysNavigate\r\n- Change SysNavigate to return AccessibleObject to allow both use cases\r\n- Update comments around SysNavigate/GetSysChild\r\n- Add release for IDispatch in TryGetAccessibleObject when it fails\r\n- Various other comment cleanup\r\n- Tolerate incoming VT_INT in AccessibleObjectExtensions\r\n- Turn ControlTabOrderHolder into record struct with clearer terms\r\n- Make ControlTabOrderComparer static and add comments\r\n- Use Assert.Fail for clarity in PropertyGridTests\r\n- Add tests for AccessibleObject.Navigate\r\n- Avoid potential issues trying to use the original AgileComPointer pointer.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9818)","Url":"https://github.com/dotnet/winforms/pull/9818","RelatedDescription":"Closed or merged PR \"Fix Accessibility COM related issues (#9804)\" (#9818)"},{"Id":"1874542737","IsPullRequest":true,"CreatedAt":"2023-08-31T16:15:32","Actor":"KlausLoeffelmann","Number":"9817","RawContent":null,"Title":"Select correct thread when dispatching to StartupNextInstance in VB AppFramework.","State":"closed","Body":"This fixes #8441.\r\n\r\n![image](https://github.com/dotnet/winforms/assets/9663150/1d683d9c-9c4a-47ab-82ec-d3a8e9888641)\r\n\r\n \r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9817)","Url":"https://github.com/dotnet/winforms/pull/9817","RelatedDescription":"Closed or merged PR \"Select correct thread when dispatching to StartupNextInstance in VB AppFramework.\" (#9817)"},{"Id":"1874969816","IsPullRequest":true,"CreatedAt":"2023-08-31T07:45:27","Actor":"LeafShi1","Number":"9819","RawContent":null,"Title":"Look up Font on the parent before setting font for *strip controls","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #5391\r\n\r\n\r\n## Proposed changes\r\n\r\n- Add the judgment `IsParentFontSet()` of the parent window before setting the font of the Strip control\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- *Strips control fonts will be displayed based on their own font settings and application font settings\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\nThe font for these controls: ToolStrip/menuStrip/StatusStrip are not rendered after setting an application font, is not same as button's\r\n![image](https://github.com/dotnet/winforms/assets/132890443/734f52a8-dda0-43f6-a407-56a3324efcce)\r\n\r\n### After\r\nThe font for these controls: ToolStrip/menuStrip/StatusStrip are not rendered base on application font when its own font properties are not set\r\n![image](https://github.com/dotnet/winforms/assets/132890443/8c4672b8-487a-433d-9dcf-eb5eb7dd7a92)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually\r\n- Unit tests\r\n\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 8.0.0-rc.1.23416.31\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9819)","Url":"https://github.com/dotnet/winforms/pull/9819","RelatedDescription":"Open PR \"Look up Font on the parent before setting font for *strip controls\" (#9819)"},{"Id":"1874449611","IsPullRequest":true,"CreatedAt":"2023-08-31T00:17:07","Actor":"dotnet-maestro[bot]","Number":"9814","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: 5f9d099d-0d05-4b82-cc41-08db9e4039c1\r\n- **Build**: 20230830.5\r\n- **Date Produced**: August 30, 2023 9:48:40 PM UTC\r\n- **Commit**: 40d2134aa50389d70fd845a7a6c06f46383e602e\r\n- **Branch**: refs/heads/release/8.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Management**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Speech**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.2.23429.20 to 8.0.0-rc.2.23430.5][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/36b3790bfc...40d2134aa5\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9814)","Url":"https://github.com/dotnet/winforms/pull/9814","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/runtime\" (#9814)"},{"Id":"1874520249","IsPullRequest":false,"CreatedAt":"2023-08-30T23:37:22","Actor":"JeremyKuhne","Number":"9816","RawContent":null,"Title":"Handle wrapping COM pointers in managed objects","State":"open","Body":"Built-in COM interop is not available when trimming or AOT are enabled. We need to use `ComWrappers` in those scenarios. This is important where we currently publicly expose COM RCWs. One concrete example of this is in `AxHost`. `AxHost.GetOcx` exposes the ActiveX instance and it is also exposed via the customizable construction virtual `AxHost.CreateInstanceCore(Guid clsid)`.\r\n\r\nWe need to add a helper in `ComHelpers` that handles falling back to `ComWrappers` when necessary. The simple implementation would be something like this:\r\n\r\n``` C#\r\ninternal static unsafe partial class ComHelpers\r\n{\r\n    internal static bool BuiltInComSupported { get; }\r\n        = AppContext.TryGetSwitch(\"System.Runtime.InteropServices.BuiltInComInterop.IsSupported\", out bool supported)\r\n            ? supported\r\n            : true;\r\n\r\n    public static object GetObjectForIUnknown(IUnknown* unknown)\r\n        => BuiltInComSupported\r\n            ? Marshal.GetObjectForIUnknown((nint)unknown)\r\n            : ComInterfaceMarshaller<object>.ConvertToManaged(unknown).OrThrowIfNull();\r\n}\r\n```\r\n\r\nWe should also consider a switch that allows forcing the `ComInterfaceMarshaller` and potentially picking it by default if the reflection based support for casting to `[ComImport]` interfaces is enabled. (\"System.Runtime.InteropServices.Marshalling.EnableGeneratedComInterfaceComImportInterop\" AppContext flag or \"EnableGeneratedComInterfaceComImportInterop\" in MSBuild)\r\n\r\nThe only issue with the `ComInterfaceMarshaller` is that presumes objects are free-threaded. We can deal with this by implementing our own `IUnknownStrategy` that wraps the GIT much as our `AgileComPointer` does. This would require deriving from `StrategyBasedComWrappers` and returning a new instance of the strategy by overriding `GetOrCreateIUnknownStrategy()`.","Url":"https://github.com/dotnet/winforms/issues/9816","RelatedDescription":"Open issue \"Handle wrapping COM pointers in managed objects\" (#9816)"},{"Id":"1874491035","IsPullRequest":false,"CreatedAt":"2023-08-30T22:58:44","Actor":"JeremyKuhne","Number":"9815","RawContent":null,"Title":"Optimize AccessibleObject when transitioning to support trimming","State":"open","Body":"There are numerous places in the WinForms code that we do a lot of wasted work to satisfy public virtual methods. This often shows up as object creation for methods that don't technically need to be created.\r\n\r\nA common strategy to use is to check the type in a method to see if the current instance is the internal class and therefore a virtual defined in the class hasn't been overridden. A theoretical example:\r\n\r\n``` C#\r\nif (GetType() == typeof(Button))\r\n{\r\n    // Not derived, take an optimized path\r\n}\r\nelse\r\n{\r\n    // Derived class, take the less optimized path\r\n}\r\n```\r\n\r\nWhile this works, it doesn't scale to more complicated scenarios. `AccessibleObject`, for example, has a complicated tree.\r\n\r\nIn `AccessibleObject` the thing we would probably do is something like this:\r\n\r\n``` C#\r\ninternal static class TypeExtensions\r\n{\r\n    private static readonly Assembly s_windowsFormsAssembly = typeof(Control).Assembly;\r\n    public static bool IsWindowsFormsAssemblyType(this Type type) => type.Assembly == s_windowsFormsAssembly;\r\n}\r\n\r\npublic class AccessibleObject\r\n{\r\n    private protected bool IsWindowsFormsAssemblyType { get; }\r\n    public AccessibleObject() => IsWindowsFormsAssemblyType = GetType().IsWindowsFormsAssemblyType();\r\n}\r\n```\r\n\r\nThen we could leverage that to avoid extra work:\r\n\r\n``` C#\r\npublic virtual AccessibleObject? Parent => TryGetAccessibleObject(GetParentDispatch());\r\n\r\nprivate protected virtual bool UseGetParentDispatchForParent => IsWindowsFormsAssemblyType;\r\n\r\nprivate protected virtual IDispatch* GetParentDispatch()\r\n{\r\n    using var accessible = SystemIAccessible.TryGetIAccessible(out HRESULT result);\r\n    if (result.Succeeded)\r\n    {\r\n        IDispatch* dispatch;\r\n        result = accessible.Value->get_accParent(&dispatch);\r\n        return dispatch;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\n// ...\r\n\r\n/// <inheritdoc cref=\"UIA.IAccessible.get_accParent(IDispatch**)\"/>\r\nHRESULT UIA.IAccessible.Interface.get_accParent(IDispatch** ppdispParent)\r\n{\r\n    if (ppdispParent is null)\r\n    {\r\n        return HRESULT.E_POINTER;\r\n    }\r\n\r\n    if (UseGetParentDispatchForParent)\r\n    {\r\n        *ppdispParent = GetParentDispatch();\r\n        return *ppdispParent is null ? HRESULT.S_FALSE : HRESULT.S_OK;\r\n    }\r\n\r\n    AccessibleObject? accessibleObject = Parent;\r\n    if (accessibleObject is null)\r\n    {\r\n        *ppdispParent = null;\r\n        return HRESULT.S_FALSE;\r\n    }\r\n\r\n    *ppdispParent = ComHelpers.GetComPointer<IDispatch>(accessibleObject);\r\n    return HRESULT.S_OK;\r\n}\r\n\r\nobject? IAccessible.accParent\r\n{\r\n    get\r\n    {\r\n        IDispatch* dispatch = null;\r\n        ((UIA.IAccessible.Interface)this).get_accParent(&dispatch);\r\n        return Marshal.GetObjectForIUnknown((nint)(void*)dispatch);\r\n    }\r\n}\r\n```\r\n\r\nThis avoids unnecessary wrapping of native handles and is trim/AOT friendly.","Url":"https://github.com/dotnet/winforms/issues/9815","RelatedDescription":"Open issue \"Optimize AccessibleObject when transitioning to support trimming\" (#9815)"},{"Id":"1872944196","IsPullRequest":true,"CreatedAt":"2023-08-30T16:04:59","Actor":"dotnet-maestro[bot]","Number":"9808","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: 5f9d099d-0d05-4b82-cc41-08db9e4039c1\r\n- **Build**: 20230829.20\r\n- **Date Produced**: August 30, 2023 5:18:18 AM UTC\r\n- **Commit**: 36b3790bfc6fe077c4047aec0d64a0157c0c7928\r\n- **Branch**: refs/heads/release/8.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Management**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Speech**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.2.23429.12 to 8.0.0-rc.2.23429.20][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/bbaba10171...36b3790bfc\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9808)","Url":"https://github.com/dotnet/winforms/pull/9808","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/runtime\" (#9808)"},{"Id":"1873611149","IsPullRequest":true,"CreatedAt":"2023-08-30T13:13:01","Actor":"dotnet-maestro[bot]","Number":"9813","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:bcf5aa31-6777-442e-8e36-08db9e435944)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: bcf5aa31-6777-442e-8e36-08db9e435944\r\n- **Build**: 20230829.1\r\n- **Date Produced**: August 29, 2023 9:53:41 AM UTC\r\n- **Commit**: 804d586c07a6c598551a2913f0958680cb9135a9\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/3d92d0bfd8...804d586c07\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:bcf5aa31-6777-442e-8e36-08db9e435944)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9813)","Url":"https://github.com/dotnet/winforms/pull/9813","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/arcade\" (#9813)"},{"Id":"1873535111","IsPullRequest":true,"CreatedAt":"2023-08-30T12:27:41","Actor":"dotnet-maestro[bot]","Number":"9812","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20230830.1\r\n- **Date Produced**: August 30, 2023 11:25:36 AM UTC\r\n- **Commit**: 03d25cd9f3868c92554e27048a57c49a39ce07c9\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.23429.1 to 9.0.0-alpha.1.23430.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/86252f7b72...03d25cd9f3\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9812)","Url":"https://github.com/dotnet/winforms/pull/9812","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#9812)"},{"Id":"1873534698","IsPullRequest":true,"CreatedAt":"2023-08-30T12:27:25","Actor":"dotnet-maestro[bot]","Number":"9811","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20230829.1\r\n- **Date Produced**: August 29, 2023 9:53:41 AM UTC\r\n- **Commit**: 804d586c07a6c598551a2913f0958680cb9135a9\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 8.0.0-beta.23428.2 to 8.0.0-beta.23429.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/3d92d0bfd8...804d586c07\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9811)","Url":"https://github.com/dotnet/winforms/pull/9811","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#9811)"},{"Id":"1872971368","IsPullRequest":false,"CreatedAt":"2023-08-30T06:05:22","Actor":"LeafShi1","Number":"9810","RawContent":null,"Title":"Support AxDesigner, AxHostDesigner and WebBrowserDesigner capabilities at runtime","State":"open","Body":"* The following designers need to be supported in runtime repo:\r\n  - [ ] System.Windows.Forms.Design.AxDesigner\r\n  - [ ] System.Windows.Forms.Design.AxHostDesigner\r\n  - [ ] System.Windows.Forms.Design.WebBrowserDesigner \r\n","Url":"https://github.com/dotnet/winforms/issues/9810","RelatedDescription":"Open issue \"Support AxDesigner, AxHostDesigner and WebBrowserDesigner capabilities at runtime\" (#9810)"},{"Id":"1872946579","IsPullRequest":true,"CreatedAt":"2023-08-30T05:45:37","Actor":"gpetrou","Number":"9809","RawContent":null,"Title":"Enable nullability in some TreeView members","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in some TreeView members.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9809)","Url":"https://github.com/dotnet/winforms/pull/9809","RelatedDescription":"Open PR \"Enable nullability in some TreeView members\" (#9809)"},{"Id":"1872748335","IsPullRequest":false,"CreatedAt":"2023-08-30T01:48:30","Actor":"KlausLoeffelmann","Number":"9807","RawContent":null,"Title":"Refactor VB's Application Framework Network Class","State":"open","Body":"The class [`Microsoft.VisualBasic.Devices.Network`](https://github.com/dotnet/winforms/blob/e47bebd2e1c8ce466f16ab0d40d0d7d60d5dcffa/src/Microsoft.VisualBasic.Forms/src/Microsoft/VisualBasic/Devices/Network.vb#L37), which is part of the Visual Basic Application Framework, is based on the obsoleted [`WebClient`](https://learn.microsoft.com/en-us/dotnet/api/system.net.webclient?view=net-7.0) class.\r\n\r\nWe need to modernize this part of the Application Framework to avoid breaking changes, should the `WebClient` class no longer be included in future versions of .NET.\r\n\r\nThis should be done in the .NET 9-time frame.\r\n\r\nThis also addresses https://github.com/dotnet/winforms/issues/3936.\r\n\r\nHere is a potential general approach, which uses `HttpClient` instead of `WebClient`.\r\n(!not tested, and my last Web-dev-experiences is quite a while, so, please double-check me here!)\r\n\r\n```VB\r\nImports System.IO\r\nImports System.Net\r\nImports System.Net.Http\r\n\r\nPublic Class Network\r\n\r\n    Public Async Function DownloadFileWithCredentialsAndProgressAsAStartingPointAsync(\r\n        url As String,\r\n        destinationPath As String,\r\n        credentials As NetworkCredential,\r\n        progress As IProgress(Of Double)) As Task\r\n\r\n        Dim handler As New HttpClientHandler() With\r\n        {\r\n            .Credentials = credentials\r\n        }\r\n\r\n        Using httpClient As New HttpClient(handler)\r\n\r\n            Dim response = Await httpClient.GetAsync(url, HttpCompletionOption.ResponseHeadersRead)\r\n            Dim contentLength = response.Content.Headers.ContentLength\r\n\r\n            Using responseStream As Stream = Await response.Content.ReadAsStreamAsync()\r\n                Using fileStream As New FileStream(destinationPath, FileMode.Create, FileAccess.Write, FileShare.None)\r\n\r\n                    Dim buffer(8191) As Byte\r\n                    Dim totalBytesRead As Long = 0\r\n                    Dim bytesRead As Integer\r\n\r\n                    While (Await responseStream.ReadAsync(buffer, 0, buffer.Length)) > 0\r\n                        Await fileStream.WriteAsync(buffer, 0, bytesRead)\r\n                        totalBytesRead += bytesRead\r\n\r\n                        If contentLength.HasValue Then\r\n                            Dim percentage As Double = (CDbl(totalBytesRead) / CDbl(contentLength.Value)) * 100\r\n                            progress.Report(percentage)\r\n                        End If\r\n\r\n                    End While\r\n                End Using\r\n            End Using\r\n        End Using\r\n    End Function\r\nEnd Class\r\n```\r\n","Url":"https://github.com/dotnet/winforms/issues/9807","RelatedDescription":"Open issue \"Refactor VB's Application Framework Network Class\" (#9807)"},{"Id":"1872542034","IsPullRequest":true,"CreatedAt":"2023-08-30T00:20:50","Actor":"dotnet-maestro[bot]","Number":"9806","RawContent":null,"Title":"[release/8.0] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: 5f9d099d-0d05-4b82-cc41-08db9e4039c1\r\n- **Build**: 20230829.12\r\n- **Date Produced**: August 29, 2023 9:27:22 PM UTC\r\n- **Commit**: bbaba10171c0e8d26b9d31877799d2ebe309c7ee\r\n- **Branch**: refs/heads/release/8.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.CodeDom**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.ComponentModel.Composition**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Data.Odbc**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Data.OleDb**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.DirectoryServices**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.DirectoryServices.Protocols**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.IO.Packaging**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.IO.Ports**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Management**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Reflection.Context**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Resources.Extensions**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Runtime.Caching**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Security.Permissions**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.ServiceModel.Syndication**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Speech**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Text.Encoding.CodePages**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Text.Encodings.Web**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Text.Json**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Threading.AccessControl**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **System.Windows.Extensions**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-rc.2.23426.4 to 8.0.0-rc.2.23429.12][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/4122c63a13...bbaba10171\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:5f9d099d-0d05-4b82-cc41-08db9e4039c1)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/9806)","Url":"https://github.com/dotnet/winforms/pull/9806","RelatedDescription":"Closed or merged PR \"[release/8.0] Update dependencies from dotnet/runtime\" (#9806)"},{"Id":"1872512714","IsPullRequest":false,"CreatedAt":"2023-08-29T21:33:37","Actor":"JeremyKuhne","Number":"9805","RawContent":null,"Title":"Need to handle incoming IDataObject pointers for AOT","State":"open","Body":"In order to support trimming/AOT we'll be moving our OLE interactions to native pointers and `ComWrappers`. In doing that we'll need to handle incoming IDataObject pointers. This issue is to capture some of what this entails.\r\n\r\nWhen we get `IDataObject*` from OLE (for drag/drop and clipboard) we have a number of cases:\r\n\r\n1. The `IDataObject*` is a CCW from COM interop.\r\n2. The `IDataObject*` is a CCW from `ComWrappers`\r\n3. The `IDataObject*` is neither (originally created in native code - that is originating outside of .NET).\r\n\r\nIn the first case we need to recognize that and unwrap the managed object if it was one that we populated. It is possible someone else may have manually P/Invoked data out and we need to be aware of it and consider if we're breaking any casting support that COM interop provides.\r\n\r\nThe second case is much the same, we want to get the original `DataObject` out and not try and wrap in a `ComWrappers` RCW.\r\n\r\nThird case is a bit more tricky. Historically we have wrapped this in a COM interop RCW. This allows dynamic casting of any supported COM interface via `QueryInterface`. While we can create a `ComWrappers` RCW, we wouldn't get this behavior anymore in that case.\r\n\r\nFor example in `CreateDragEventArgs`:\r\n\r\n``` C#\r\nobject? obj = Marshal.GetObjectForIUnknown((nint)pDataObj);\r\nif (obj is IDataObject dataObject)\r\n{\r\n    data = dataObject;\r\n}\r\nelse if (obj is ComTypes.IDataObject nativeDataObject)\r\n{\r\n    data = new DataObject(nativeDataObject);\r\n}\r\n```\r\n\r\nBecause of this lack of dynamic casting we'll have to either use built in COM when it is available and/or allow configuring the behavior based on config switches.","Url":"https://github.com/dotnet/winforms/issues/9805","RelatedDescription":"Open issue \"Need to handle incoming IDataObject pointers for AOT\" (#9805)"}],"ResultType":"GitHubIssue"}},"RunOn":"2023-09-02T03:30:29.0137286Z","RunDurationInMilliseconds":464}