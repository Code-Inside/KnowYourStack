{"Data":{"GitHub":{"Issues":[{"Id":"2071383948","IsPullRequest":true,"CreatedAt":"2024-01-10T00:33:10","Actor":"elachlan","Number":"10612","RawContent":null,"Title":"Fix `WinformsControlsTest` MessageBox to avoid exception","State":"closed","Body":"Fixes #10513\r\n\r\n- Don't pass owner when `MessageBoxOptions.ServiceNotification | MessageBoxOptions.DefaultDesktopOnly` is specified. \r\n- Changed help file name as the old one was missing.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10612)","Url":"https://github.com/dotnet/winforms/pull/10612","RelatedDescription":"Closed or merged PR \"Fix `WinformsControlsTest` MessageBox to avoid exception\" (#10612)"},{"Id":"2073323542","IsPullRequest":true,"CreatedAt":"2024-01-09T23:38:07","Actor":"Tanya-Solyanik","Number":"10627","RawContent":null,"Title":"added hash algorithm value to the assembly table in metadata for Accessibility.dll","State":"closed","Body":"Other .NET and .NET Framework assemblies have this value set to SHA1. And Accessibility.dll in .NET Framework has the same value. This issue is unlikely to cause any problems, it only looks inconsistent. Most likely we had overlooked this attribute when editing the IL when moving to Core.\r\nPer @marklio this value is used for:\r\n```\r\n•\tcalculating the hashes for File table metadata. This is used in multi-file and multi-module assembly scenarios, which are rarer (multi-module basically only happens in System.EnterpriseServices and no where else, multi-file is more common, but isn't in play for Accessibility.dll)\r\n•\tCalculating the \"strong name signature\" data used in validating strong names. The content of the file is hashed with that algorithm and then signed with the private key and stored in these bytes, and can be validated using the public key that exists in the Assembly table. Without the algorithm, you can't validate the signature. I haven't validated whether the strong name signature is present and is a SHA1, but that is what I suspect (the strong name signature bytes are non-zero, which suggests that it is appropriately signed).\r\n```\r\n\r\n.NET9 before:\r\n![image](https://github.com/dotnet/winforms/assets/15823268/e0def302-4181-40d6-b840-e1dc27621c79)\r\n\r\n.NET Framework\r\n![image](https://github.com/dotnet/winforms/assets/15823268/f0b47eeb-176d-41d9-b2c8-3f606c41daed)\r\n\r\n.NET 9 after\r\n![image](https://github.com/dotnet/winforms/assets/15823268/299da745-a075-4a45-9652-e6e58e43fa7b)\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10627)","Url":"https://github.com/dotnet/winforms/pull/10627","RelatedDescription":"Closed or merged PR \"added hash algorithm value to the assembly table in metadata for Accessibility.dll\" (#10627)"},{"Id":"2073272353","IsPullRequest":true,"CreatedAt":"2024-01-09T23:03:59","Actor":"lonitra","Number":"10625","RawContent":null,"Title":"Disable Removing Milestones from Closed Issues","State":"closed","Body":"We want to stop the bot from removing milestones off of closed issues to better track what work has been done in different previews.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10625)","Url":"https://github.com/dotnet/winforms/pull/10625","RelatedDescription":"Closed or merged PR \"Disable Removing Milestones from Closed Issues\" (#10625)"},{"Id":"2073278736","IsPullRequest":true,"CreatedAt":"2024-01-09T22:32:43","Actor":"halgab","Number":"10626","RawContent":null,"Title":"Replace `ArrayList` usage in `ToolStripItemDataObject` with `List`","State":"open","Body":"Contributes to #8140\r\n\r\n\r\n## Proposed changes\r\n\r\n- Replace `ArrayList` usage in `ToolStripItemDataObject` with `List`\r\n- Update relevant call sites to move off `IList` and `ICollection` interfaces\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10626)","Url":"https://github.com/dotnet/winforms/pull/10626","RelatedDescription":"Open PR \"Replace `ArrayList` usage in `ToolStripItemDataObject` with `List`\" (#10626)"},{"Id":"2073258767","IsPullRequest":false,"CreatedAt":"2024-01-09T22:12:50","Actor":"merriemcgaw","Number":"10624","RawContent":null,"Title":"[Tracking] CSWin32 Migration tasks for .NET 9 Preview 1","State":"open","Body":"This is to track the CSWin32 migrations in the repo for .NET 9\r\n- [x] #9824 \r\n- [ ] #10348 \r\n- [x] Convert System.Drawing.Printing\r\n- [x] https://github.com/dotnet/winforms/pull/10525\r\n- [x] Convert AccessibleObject\r\n- [ ] #9805 \r\n","Url":"https://github.com/dotnet/winforms/issues/10624","RelatedDescription":"Open issue \"[Tracking] CSWin32 Migration tasks for .NET 9 Preview 1\" (#10624)"},{"Id":"2073128103","IsPullRequest":true,"CreatedAt":"2024-01-09T20:55:50","Actor":"JeremyKuhne","Number":"10623","RawContent":null,"Title":"Rename scope files to match","State":"closed","Body":"Updating scopes to match their type name.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10623)","Url":"https://github.com/dotnet/winforms/pull/10623","RelatedDescription":"Closed or merged PR \"Rename scope files to match\" (#10623)"},{"Id":"2073080228","IsPullRequest":true,"CreatedAt":"2024-01-09T20:47:22","Actor":"JeremyKuhne","Number":"10622","RawContent":null,"Title":"Simplify System.Drawing project","State":"closed","Body":"Making changes is complicated currently. Moved to recursive include with special case exceptions. There were a few dead files hanging around, removed them.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10622)","Url":"https://github.com/dotnet/winforms/pull/10622","RelatedDescription":"Closed or merged PR \"Simplify System.Drawing project\" (#10622)"},{"Id":"2073039632","IsPullRequest":true,"CreatedAt":"2024-01-09T20:42:46","Actor":"vseanreesermsft","Number":"10621","RawContent":null,"Title":"Merging internal commits for release/8.0","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10621)","Url":"https://github.com/dotnet/winforms/pull/10621","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/8.0\" (#10621)"},{"Id":"2073033518","IsPullRequest":true,"CreatedAt":"2024-01-09T20:42:29","Actor":"vseanreesermsft","Number":"10620","RawContent":null,"Title":"Merging internal commits for release/7.0","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10620)","Url":"https://github.com/dotnet/winforms/pull/10620","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/7.0\" (#10620)"},{"Id":"2073028493","IsPullRequest":true,"CreatedAt":"2024-01-09T20:42:07","Actor":"vseanreesermsft","Number":"10619","RawContent":null,"Title":"Merging internal commits for release/6.0","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10619)","Url":"https://github.com/dotnet/winforms/pull/10619","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/6.0\" (#10619)"},{"Id":"2072338139","IsPullRequest":true,"CreatedAt":"2024-01-09T19:05:52","Actor":"dotnet-maestro[bot]","Number":"10617","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240108.11\r\n- **Date Produced**: January 9, 2024 9:23:16 AM UTC\r\n- **Commit**: 17cc1028f4b6ad92e2226d67ae75b83e48dfe061\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24057.2 to 9.0.0-alpha.1.24058.11][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/21b4a85853...17cc1028f4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10617)","Url":"https://github.com/dotnet/winforms/pull/10617","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10617)"},{"Id":"2071626228","IsPullRequest":true,"CreatedAt":"2024-01-09T18:59:48","Actor":"JeremyKuhne","Number":"10613","RawContent":null,"Title":"More interop cleanup","State":"closed","Body":"Some more interop cleanup in preparation of moving other Win32 interop to a shared model with System.Drawing.\r\n\r\n- Add System and System.Collections.Generic to global usings for System.Drawing\r\n- Move Libraries and NullHandle to Core\r\n- Move scopes to Gdi32 namespace and out of PInvoke (necessary for now as we now have multiple PInvoke classes)\r\n- Move COM related stuff to Com namespace\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10613)","Url":"https://github.com/dotnet/winforms/pull/10613","RelatedDescription":"Closed or merged PR \"More interop cleanup\" (#10613)"},{"Id":"2072336812","IsPullRequest":true,"CreatedAt":"2024-01-09T17:21:01","Actor":"dotnet-maestro[bot]","Number":"10616","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20240108.6\r\n- **Date Produced**: January 9, 2024 3:34:24 AM UTC\r\n- **Commit**: 05493e05d4bbf262f1be1bd517ac95f5bff3a2ef\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 9.0.0-beta.24055.2 to 9.0.0-beta.24058.6][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/bab85ba457...05493e05d4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10616)","Url":"https://github.com/dotnet/winforms/pull/10616","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#10616)"},{"Id":"2072365510","IsPullRequest":false,"CreatedAt":"2024-01-09T13:23:51","Actor":"sneha-latha-kv","Number":"10618","RawContent":null,"Title":"The horizontal scrollbar is unnecessarily visible in the listbox at a 110 scaling in Winforms.","State":"open","Body":"### .NET version\r\n\r\n.Net 7.0\r\n\r\n### Did it work in .NET Framework?\r\n\r\nNo\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nNO\r\n\r\n### Issue description\r\n\r\nWhen using the listbox at a 110 scaling , the horizontal scrollbar is visible, whereas in 125 or 150 scaling, the horizontal scrollbar is not visible.\r\n![image](https://github.com/dotnet/winforms/assets/121555390/991df866-0557-421a-80f0-2e3458ab650b)\r\n\r\n\r\n### Steps to reproduce\r\n\r\nSet the Screen scaling to 110\r\nAdd listbox into the form with HorizontalScrollbar property set to true\r\nRun the Sample\r\nNote that the HorizontalScrollbar will be visible\r\nNow change the scaling to 125 OR 150 , Note that the HorizontalScrollbar will not be visible now\r\n[HorizontalScrollBar.zip](https://github.com/dotnet/winforms/files/13874386/HorizontalScrollBar.zip)\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/10618","RelatedDescription":"Open issue \"The horizontal scrollbar is unnecessarily visible in the listbox at a 110 scaling in Winforms.\" (#10618)"},{"Id":"2071954828","IsPullRequest":false,"CreatedAt":"2024-01-09T09:22:01","Actor":"Junjun-zhao","Number":"10615","RawContent":null,"Title":"[9.0.100-alpha.1.24055.6] HtmlDocument.Write() throw System.Runtime.InteropServices.COMException (0x80020008): Bad variable type.","State":"open","Body":"### .NET version\n\n```\r\n.NET SDK:\r\n Version:           9.0.100-alpha.1.24055.6\r\n Commit:            ca1439c8ae\r\n Workload version:  9.0.100-manifests.f3b52893\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.19044\r\n OS Platform: Windows\r\n RID:         win-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24055.6\\\r\n\r\n.NET workloads installed:\r\n There are no installed workloads to display\r\n\r\n\r\nHost:\r\n  Version:      9.0.0-alpha.1.24054.18\r\n  Architecture: x64\r\n  Commit:       9325d3836d\r\n\r\n.NET SDKs installed:\r\n    9.0.100-alpha.1.24055.6 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 9.0.0-alpha.1.24055.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 9.0.0-alpha.1.24054.18 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 9.0.0-alpha.1.24055.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n```\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nYes\r\n1. Windows10 21h2 x64 + dotnet-sdk-7.0.405: Pass\r\n2. Windows10 21h2 x64 + dotnet-sdk-8.0.101： Pass\r\n3. Windows10 21h2 x64 + dotnet-sdk-9.0.100-alpha.1.24055.6: Fail\n\n### Issue description\n\nWhen calling ```HtmlDocument.Write()``` to write a HTML page on dotnet-sdk-9.0.100-alpha.1.24055.6, it throws ```\"System.Runtime.InteropServices.COMException (0x80020008): Bad variable type\"``` exception.\r\n\r\n**Application Name**: Character-Builder-5\r\n**OS**： Windows 10 21H2\r\n**CPU**: X64\r\n**.NET Build Number**: dotnet-sdk-9.0.100-alpha.1.24055.6\r\n**App or App source checking at:**  https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1936945\r\n\r\n**Github link:** https://github.com/MalukuSeito/Character-Builder-5\r\n\n\n### Steps to reproduce\n\n**Minimal Repro steps (Demo attached):**\r\n[BadVariableDemo.zip](https://github.com/dotnet/winforms/files/13871376/BadVariableDemo.zip)\r\n\r\n**The machine has dotnet-sdk-9.0.100-alpha.1.24055.6 installed.**\r\n\r\n​​1.Create a .NET 7 or .NET 8 WinForm project.\r\n2. Add following code in Form1.cs file:\r\n```\r\npublic Form1()\r\n{\r\n    InitializeComponent();\r\n        \r\n    WebBrowser webBrowser = new WebBrowser();\r\n    string s = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-16\\\"?>\\r\\n<html>\\r\\n</html>\";\r\n    webBrowser.Navigate(\"about:blank\");\r\n    webBrowser.Document.Write(s);\r\n}\r\n```\r\n4. Build the project.\r\n5. Update the runtime config file to .NET 9 versions:\r\n```\r\n\"frameworks\": [\r\n      {\r\n        \"name\": \"Microsoft.NETCore.App\",\r\n        \"version\": \"9.0.0-alpha.1.24054.18\"\r\n      },\r\n      {\r\n        \"name\": \"Microsoft.WindowsDesktop.App\",\r\n        \"version\": \"9.0.0-alpha.1.24055.1\"\r\n      }\r\n    ],\r\n```\r\n7. Launch the app\r\n\r\n**Expected Result:**\r\nApp launch successfully.\r\n\r\n**Actual Result:**\r\nApp launch failed with Bad variable type exception.\r\n\r\n**StackTrace:**\r\n```\r\nException Info: System.Runtime.InteropServices.COMException (0x80020008): Bad variable type.\r\n\r\n   at System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode, IntPtr errorInfo)\r\n   at Windows.Win32.Foundation.HRESULT.ThrowOnFailure(IntPtr errorInfo)\r\n   at System.Windows.Forms.HtmlDocument.Write(String text)\r\n   at BadVariableDemo.Form1..ctor() in E:\\Demos\\BadVariableDemo\\BadVariableDemo\\Form1.cs:line 12\r\n   at BadVariableDemo.Program.Main() in E:\\Demos\\BadVariableDemo\\BadVariableDemo\\Program.cs:line 14\r\n```\r\n@dotnet-actwx-bot @dotnet/compat\r\n","Url":"https://github.com/dotnet/winforms/issues/10615","RelatedDescription":"Open issue \"[9.0.100-alpha.1.24055.6] HtmlDocument.Write() throw System.Runtime.InteropServices.COMException (0x80020008): Bad variable type.\" (#10615)"},{"Id":"2071954145","IsPullRequest":false,"CreatedAt":"2024-01-09T09:21:40","Actor":"Junjun-zhao","Number":"10614","RawContent":null,"Title":"[9.0.100-alpha.1.24055.6] WPF uses WinForm PropertyGrid Tooltip get \"Adding the tip to the native ToolTip control did not succeed.\" exception","State":"open","Body":"### .NET version\n\n```\r\n.NET SDK:\r\n Version:           9.0.100-alpha.1.24055.6\r\n Commit:            ca1439c8ae\r\n Workload version:  9.0.100-manifests.f3b52893\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.19044\r\n OS Platform: Windows\r\n RID:         win-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24055.6\\\r\n\r\n.NET workloads installed:\r\n There are no installed workloads to display\r\n\r\n\r\nHost:\r\n  Version:      9.0.0-alpha.1.24054.18\r\n  Architecture: x64\r\n  Commit:       9325d3836d\r\n\r\n.NET SDKs installed:\r\n    9.0.100-alpha.1.24055.6 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 9.0.0-alpha.1.24055.3 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 9.0.0-alpha.1.24054.18 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 9.0.0-alpha.1.24055.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n```\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nYes\r\n1. Windows10 21h2 x64 + dotnet-sdk-7.0.405: Pass\r\n2. Windows10 21h2 x64 + dotnet-sdk-8.0.101: Pass\r\n3. Windows10 21h2 x64 + dotnet-sdk-9.0.100-alpha.1.24055.6: Fail\n\n### Issue description\n\nWhen using WinForm PropertyGrid control in WPF app, the tooltip in PropertyGrid will throw \"System.InvalidOperationException: Adding the tip to the native ToolTip control did not succeed.\" exception.\r\n\r\n**Application Name**: AvalonEdit\r\n**OS**： Windows 10 21H2\r\n**CPU**: X64\r\n**.NET Build Number**: dotnet-sdk-9.0.100-alpha.1.24055.6\r\n**App or App source checking at:** https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1936985\r\n**Github Link:** https://github.com/icsharpcode/AvalonEdit\n\n### Steps to reproduce\n\n**Minimal Repro steps** (Demo attached [TooltipDemo.zip](https://github.com/dotnet/winforms/files/13871438/TooltipDemo.zip)):\r\n**The machine has dotnet-sdk-9.0.100-alpha.1.24055.6 installed.**\r\n\r\n​​1.Create a .NET 7 or .NET 8 WPF project.\r\n2. Add ```<UseWindowsForms>true</UseWindowsForms> ```to project file:\r\n```\r\n <PropertyGroup>\r\n   <OutputType>WinExe</OutputType>\r\n   <TargetFramework>net8.0-windows</TargetFramework>\r\n   <Nullable>enable</Nullable>\r\n   <ImplicitUsings>enable</ImplicitUsings>\r\n   <UseWPF>true</UseWPF>\r\n   <UseWindowsForms>true</UseWindowsForms>\r\n </PropertyGroup>\r\n```\r\n3. Add PropertyGrid control to MainWindow.xaml:\r\n```\r\n<Window x:Class=\"ToolTipsDemo.MainWindow\"\r\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\r\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\r\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\r\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\r\n        xmlns:local=\"clr-namespace:ToolTipsDemo\"\r\n        xmlns:forms=\"clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms\"\r\n        mc:Ignorable=\"d\"\r\n        Title=\"MainWindow\" Height=\"450\" Width=\"800\">\r\n    <Grid>\r\n        <WindowsFormsHost Name=\"propertyGridHost\">\r\n            <forms:PropertyGrid x:Name=\"propertyGrid\"/>\r\n        </WindowsFormsHost>\r\n       \r\n    </Grid>\r\n</Window>\r\n```\r\n4. Build the project.\r\n5. Update the runtime config file to .NET 9 versions:\r\n```\r\n\"frameworks\": [\r\n      {\r\n        \"name\": \"Microsoft.NETCore.App\",\r\n        \"version\": \"9.0.0-alpha.1.24054.18\"\r\n      },\r\n      {\r\n        \"name\": \"Microsoft.WindowsDesktop.App\",\r\n        \"version\": \"9.0.0-alpha.1.24055.1\"\r\n      }\r\n    ],\r\n```\r\n6. Launch the app.\r\n7. Move the mouse to \"Alphabetical\" button of PropertyGrid.\r\n\r\n**Expected Result:**\r\nTooltip for \"Alphabetical\" button will appear.\r\n\r\n**Actual Result:**\r\nException window pops up:\r\n![image](https://github.com/dotnet/winforms/assets/83067197/f6c351e7-2712-495d-8594-540ef76d767d)\r\n\r\n\r\n**Findings:**\r\n\r\nIn WPF project, any controls that has tooltip in PropertyGrid will cause this exception.\r\nIn WPF project, default WPF controls, like a button, when adding tooltip for them, they are working as normal.\r\nIn WinForm project, the tooltip in PropertyGrid doesn't have this issue.\r\n\r\nStackTrace:\r\n```\r\nSystem.InvalidOperationException: Adding the tip to the native ToolTip control did not succeed.\r\n   at System.Windows.Forms.ToolTip.SetToolInfo(Control control, String caption)\r\n   at System.Windows.Forms.ToolTip.Hide(IWin32Window win)\r\n   at System.Windows.Forms.ToolStrip.UpdateToolTip(ToolStripItem item, Boolean refresh)\r\n   at System.Windows.Forms.ToolStripItem.HandleMouseLeave(EventArgs e)\r\n   at System.Windows.Forms.ToolStrip.HandleMouseLeave()\r\n   at System.Windows.Forms.ToolStrip.OnMouseLeave(EventArgs e)\r\n   at System.Windows.Forms.Control.WndProc(Message& m)\r\n   at System.Windows.Forms.ToolStrip.WndProc(Message& m)\r\n   at System.Windows.Forms.NativeWindow.Callback(HWND hWnd, MessageId msg, WPARAM wparam, LPARAM lparam)\r\n```\r\n@dotnet-actwx-bot @dotnet/compat\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/10614","RelatedDescription":"Open issue \"[9.0.100-alpha.1.24055.6] WPF uses WinForm PropertyGrid Tooltip get \"Adding the tip to the native ToolTip control did not succeed.\" exception\" (#10614)"},{"Id":"2071142292","IsPullRequest":true,"CreatedAt":"2024-01-08T21:03:45","Actor":"JeremyKuhne","Number":"10611","RawContent":null,"Title":"Move HTML help to CsWin32","State":"closed","Body":"Move HTML help to CsWin32. Also sort NativeMethods.txt.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10611)","Url":"https://github.com/dotnet/winforms/pull/10611","RelatedDescription":"Closed or merged PR \"Move HTML help to CsWin32\" (#10611)"},{"Id":"2071140338","IsPullRequest":false,"CreatedAt":"2024-01-08T20:06:31","Actor":"cadilhac","Number":"10610","RawContent":null,"Title":"KeyxConverter.GetStandardValues() throws an exception","State":"open","Body":"### .NET version\r\n\r\n8.0.100\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nUsed to work in .Net 6 and 7.\r\n\r\n### Issue description\r\n\r\nSimply calling\r\n\r\n`var test = new KeysConverter().GetStandardValues();`\r\n\r\nthrows the exception:\r\n\r\n> System.Collections.Generic.KeyNotFoundException: 'The given key 'en-US' was not present in the dictionary.'\r\n\r\nLooking at the KeysConverter source code, it's easy to see that the CultureToKeyName property is initialized only with the invariant culture at construction time. Other cultures are added only if ConvertFrom() or ConvertTo() are called first. This is a serious breaking change.\r\n\r\nIf this was intended, is it documented? What is a workaround?\r\n\r\n### Steps to reproduce\r\n\r\nCreate a console app targetting .net 8. Simply add the code:\r\n\r\n`var test = new KeysConverter().GetStandardValues();`\r\n\r\n### Possible fix\r\n\r\nIn GetStandardValue(), this guard should be added:\r\n\r\n```\r\nif (!CultureToKeyName.ContainsKey(CultureInfo.CurrentCulture))\r\n\tAddLocalizedKeyNames(CultureInfo.CurrentCulture);\r\n```\r\n\r\nNote that I think CultureInfo.CurrentCulture was changed to CurrentUICulture in .Net 9 preview if I remember well a post that I saw previously.\r\n\r\nOn a deeper level, prior to .Net 8, ConvertTo, ConvertFrom and GetStandardValues were not using culture for localization. With .Net 8, it seems it changed but partially only. If it was working correctly, it seems that it is always expected that GetStandardValues() returns results for the current culture, although ConvertTo and ConvertFrom can adapt to any culture... ?","Url":"https://github.com/dotnet/winforms/issues/10610","RelatedDescription":"Open issue \"KeyxConverter.GetStandardValues() throws an exception\" (#10610)"},{"Id":"2068223857","IsPullRequest":true,"CreatedAt":"2024-01-08T20:01:27","Actor":"JeremyKuhne","Number":"10598","RawContent":null,"Title":"Convert the rest of System.Drawing printing to CsWin32","State":"closed","Body":"This moves the rest of System.Drawing.Printing to CsWin32.\r\n\r\n- Move now-shared API to Core assembly\r\n- Update calls to PInvokeCore for said calls\r\n- Add HdcHandle for HDCs that we have to keep in fields\r\n- Move printing DeviceContext usages to scopes\r\n- Use new printer dialog to get default printer names\r\n- Remove ScreenDC and use scope\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10598)","Url":"https://github.com/dotnet/winforms/pull/10598","RelatedDescription":"Closed or merged PR \"Convert the rest of System.Drawing printing to CsWin32\" (#10598)"},{"Id":"2069358560","IsPullRequest":false,"CreatedAt":"2024-01-08T19:11:36","Actor":"ghost","Number":"10606","RawContent":null,"Title":".NET 8.0 listview SelectedItems not working","State":"closed","Body":"### .NET version\r\n\r\n.NET 8.0\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\n.NET 4.8\r\n\r\n### Issue description\r\n\r\nWhen checking listviewitems in a listview , the SelectedItems  of the listview doesn't change.\r\n\r\n### Steps to reproduce\r\n\r\n1. create listview\r\n2. enable multi select for the listview and checkboxes too\r\n3. check some listviewitems with mouse\r\n4. the SelectedItems of listview is not updated after doing 3. If you check SelectedItems.Count, the value is always 0 which is impossible because you have selected more then 1 listviewitem in 3.","Url":"https://github.com/dotnet/winforms/issues/10606","RelatedDescription":"Closed issue \".NET 8.0 listview SelectedItems not working\" (#10606)"},{"Id":"2070978694","IsPullRequest":true,"CreatedAt":"2024-01-08T19:10:25","Actor":"lonitra","Number":"10609","RawContent":null,"Title":"Avoid System.Private.Windows.Core Package Reference in System.Drawing.Common","State":"closed","Body":"Helps fix build errors in https://github.com/dotnet/wpf/pull/8635\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10609)","Url":"https://github.com/dotnet/winforms/pull/10609","RelatedDescription":"Closed or merged PR \"Avoid System.Private.Windows.Core Package Reference in System.Drawing.Common\" (#10609)"},{"Id":"2069142948","IsPullRequest":true,"CreatedAt":"2024-01-08T17:23:54","Actor":"dotnet-bot","Number":"10605","RawContent":null,"Title":"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2347685","State":"closed","Body":"This is the pull request automatically created by the OneLocBuild task in the build process to check-in localized files generated based upon translation source files (.lcl files) handed-back from the downstream localization pipeline. If there are issues in translations, visit https://aka.ms/icxLocBug and log bugs for fixes. The OneLocBuild wiki is https://aka.ms/onelocbuild and the localization process in general is documented at https://aka.ms/AllAboutLoc.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10605)","Url":"https://github.com/dotnet/winforms/pull/10605","RelatedDescription":"Closed or merged PR \"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2347685\" (#10605)"},{"Id":"2070418343","IsPullRequest":true,"CreatedAt":"2024-01-08T13:29:22","Actor":"dotnet-maestro[bot]","Number":"10608","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240107.2\r\n- **Date Produced**: January 7, 2024 8:50:14 PM UTC\r\n- **Commit**: 21b4a8585362c1bc12d545b63e62a0d9dd4e8673\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24056.3 to 9.0.0-alpha.1.24057.2][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/445c4a0428...21b4a85853\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10608)","Url":"https://github.com/dotnet/winforms/pull/10608","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10608)"},{"Id":"2069963971","IsPullRequest":false,"CreatedAt":"2024-01-08T08:34:07","Actor":"LeafShi1","Number":"10607","RawContent":null,"Title":"The \"InheritedGlyph\" icon cannot be show in Inherited control","State":"open","Body":"In Demo project, the `InheritedGlyph ` icon doesn't show in inherited control `CustomButton `  \r\n![image](https://github.com/dotnet/winforms/assets/132890443/1ab8f89a-299c-4eb2-be2e-9aebd2a4ffda)\r\n\r\n\r\n**Expected**:\r\n1 Create a form with a button - Form1\r\n2. Build the app\r\n3. Create a form that inherits from Form1\r\n4. The \"InheritedGlyph\" icon show on the inherited control\r\n\r\n<img width=\"241\" alt=\"image\" src=\"https://github.com/dotnet/winforms/assets/15823268/21561755-c0fe-4b31-b02e-bde0703b9f35\">\r\n","Url":"https://github.com/dotnet/winforms/issues/10607","RelatedDescription":"Open issue \"The \"InheritedGlyph\" icon cannot be show in Inherited control\" (#10607)"},{"Id":"2069122192","IsPullRequest":true,"CreatedAt":"2024-01-07T13:23:56","Actor":"dotnet-maestro[bot]","Number":"10604","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240106.3\r\n- **Date Produced**: January 6, 2024 6:33:43 PM UTC\r\n- **Commit**: 445c4a0428679b90c55c3dc7d78ed97622d21a22\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24055.7 to 9.0.0-alpha.1.24056.3][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/adb4c18f5b...445c4a0428\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10604)","Url":"https://github.com/dotnet/winforms/pull/10604","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10604)"},{"Id":"2068787168","IsPullRequest":false,"CreatedAt":"2024-01-06T19:13:07","Actor":"JeremyKuhne","Number":"10603","RawContent":null,"Title":"Layering related functionality is awkward","State":"open","Body":"We have a number of assemblies that we produce where we share common static functionality that logically belongs together. Static classes contain this functionality but require naming changes and/or namespace isolation to implement. This is becoming even more awkward with the introduction of a shared interop assembly with System.Drawing.\r\n\r\nFor example, CsWin32 generates a static class for imports (defaulting to `PInvoke`). We have to have it generate different names now that we are using CsWin32 on multiple levels of the assembly dependency hierarchy. Currently we use `PInvokeCore` for the shared assembly and `PInvoke` for the upper layers.\r\n\r\nA similar thing occurs for helper classes such as `ScaleHelper`. We'll follow the same pattern (`ScaleHelperCore`) and (`ScaleHelper`) for non-shared functionality, but that only scales to two layers. For `System.Windows.Forms.Design` we have 4 layers of assemblies now.\r\n\r\nIdeally, we'd be able to \"append\" functionality to a common static base type, much like extension methods do. C# is considering something that might make this possible:\r\n\r\nhttps://github.com/dotnet/csharplang/issues/5497\r\nhttps://github.com/dotnet/csharplang/blob/1f55d3c05d549edc817589502bfee90db887d56e/proposals/extensions.md\r\n\r\nIf and when this is implemented, we should clean up our static helpers to allow using single, common names. A follow up should be made with CsWin32 to find a way to specify that we want the `PInvoke` class as an extension class.","Url":"https://github.com/dotnet/winforms/issues/10603","RelatedDescription":"Open issue \"Layering related functionality is awkward\" (#10603)"},{"Id":"2068610450","IsPullRequest":true,"CreatedAt":"2024-01-06T13:30:24","Actor":"dotnet-maestro[bot]","Number":"10602","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240105.7\r\n- **Date Produced**: January 6, 2024 3:33:04 AM UTC\r\n- **Commit**: adb4c18f5bcf6587230afe04cc6b61e2477f8137\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24054.18 to 9.0.0-alpha.1.24055.7][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/9325d3836d...adb4c18f5b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10602)","Url":"https://github.com/dotnet/winforms/pull/10602","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10602)"},{"Id":"2068609670","IsPullRequest":true,"CreatedAt":"2024-01-06T13:23:54","Actor":"dotnet-maestro[bot]","Number":"10601","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20240105.2\r\n- **Date Produced**: January 5, 2024 7:12:42 PM UTC\r\n- **Commit**: bab85ba4579526962b0dbb0aa4db625c50da8859\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 9.0.0-beta.24054.2 to 9.0.0-beta.24055.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/574b28f963...bab85ba457\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10601)","Url":"https://github.com/dotnet/winforms/pull/10601","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#10601)"},{"Id":"2068260883","IsPullRequest":true,"CreatedAt":"2024-01-06T07:30:54","Actor":"JeremyKuhne","Number":"10599","RawContent":null,"Title":"Remove Control ActiveX TraceSwitch","State":"closed","Body":"A significant amount of the code in some areas was just trace statements. We've removed them in other places as we have had trace breakpoints for nearly 20 years. The code is significantly easier to navigate without these.\r\n\r\nIn this particular case there also was an AV in debug for our NativeHost sample.\r\n\r\nAlso some minor cleanup, including a change to just return E_NOTIMPL from ActiveXImpl.DoVerb instead of throwing it.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10599)","Url":"https://github.com/dotnet/winforms/pull/10599","RelatedDescription":"Closed or merged PR \"Remove Control ActiveX TraceSwitch\" (#10599)"},{"Id":"2068395929","IsPullRequest":false,"CreatedAt":"2024-01-06T05:26:35","Actor":"beqabeqa473","Number":"10600","RawContent":null,"Title":"Add a possibility to override AccessibleObject methods like getPropertyValue and others in third-party code","State":"open","Body":"### .NET version\n\n8.0\n\n### Did it work in .NET Framework?\n\nNo\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\nHello.\r\n\r\nWe need to override getPropertyValue of a form at this moment to implement UIA_is_dialog_property_id in the form without showing it as a dialog, because an app, by design shouldn't be blocked, but we also need screenreader to read a label on focus as it is done when form is beeing showed as a dialog.\r\n\r\nIs there any other possiibility to do that at this moment?\r\n\r\nPlease consider making AccessibleObject methods public to make it possible for third-party developers to have more customizations in their apps.\n\n### Steps to reproduce\n\nTry to focus a form with label, progress bar and a cancel button with a screenreader\r\nIn our case label with information should be read\r\n","Url":"https://github.com/dotnet/winforms/issues/10600","RelatedDescription":"Open issue \"Add a possibility to override AccessibleObject methods like getPropertyValue and others in third-party code\" (#10600)"}],"ResultType":"GitHubIssue"}},"RunOn":"2024-01-10T03:30:29.3170195Z","RunDurationInMilliseconds":412}