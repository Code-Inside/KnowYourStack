{"Data":{"GitHub":{"Issues":[{"Id":"1173544943","IsPullRequest":true,"CreatedAt":"2022-03-23T02:35:36","Actor":"kant2002","Number":"6866","RawContent":null,"Title":"Remove not used interfaces","State":"closed","Body":"- IOmNavigator and IHTMLScreen do not used\r\n- IMallocSpy belongs to test project and as such moved there\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6866)","Url":"https://github.com/dotnet/winforms/pull/6866","RelatedDescription":"Closed or merged PR \"Remove not used interfaces\" (#6866)"},{"Id":"1174198078","IsPullRequest":true,"CreatedAt":"2022-03-23T02:19:56","Actor":"gpetrou","Number":"6872","RawContent":null,"Title":"Enable nullability in TextBox","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in TextBox.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6872)","Url":"https://github.com/dotnet/winforms/pull/6872","RelatedDescription":"Closed or merged PR \"Enable nullability in TextBox\" (#6872)"},{"Id":"1174204761","IsPullRequest":true,"CreatedAt":"2022-03-23T02:18:34","Actor":"gpetrou","Number":"6873","RawContent":null,"Title":"Enable nullability in CheckedListBox","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in CheckedListBox.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6873)","Url":"https://github.com/dotnet/winforms/pull/6873","RelatedDescription":"Closed or merged PR \"Enable nullability in CheckedListBox\" (#6873)"},{"Id":"1177360493","IsPullRequest":true,"CreatedAt":"2022-03-22T22:12:18","Actor":"dreddy-work","Number":"6891","RawContent":null,"Title":"Add release activities doc","State":"open","Body":"Adding release activities doc to the repo.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6891)","Url":"https://github.com/dotnet/winforms/pull/6891","RelatedDescription":"Open PR \"Add release activities doc\" (#6891)"},{"Id":"1177168913","IsPullRequest":true,"CreatedAt":"2022-03-22T18:47:14","Actor":"dreddy-work","Number":"6890","RawContent":null,"Title":"update branding for milestone","State":"closed","Body":"Update branding for preview4\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6890)","Url":"https://github.com/dotnet/winforms/pull/6890","RelatedDescription":"Closed or merged PR \"update branding for milestone\" (#6890)"},{"Id":"1177151141","IsPullRequest":true,"CreatedAt":"2022-03-22T18:32:19","Actor":"dreddy-work","Number":"6889","RawContent":null,"Title":"Disable loc on release branch","State":"closed","Body":"Disable loc on release branch.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6889)","Url":"https://github.com/dotnet/winforms/pull/6889","RelatedDescription":"Closed or merged PR \"Disable loc on release branch\" (#6889)"},{"Id":"1177146277","IsPullRequest":true,"CreatedAt":"2022-03-22T18:27:29","Actor":"dreddy-work","Number":"6888","RawContent":null,"Title":"Publish apis for the milestone","State":"closed","Body":"Publishing APIs for Preview 3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6888)","Url":"https://github.com/dotnet/winforms/pull/6888","RelatedDescription":"Closed or merged PR \"Publish apis for the milestone\" (#6888)"},{"Id":"1177074468","IsPullRequest":true,"CreatedAt":"2022-03-22T18:04:55","Actor":"dreddy-work","Number":"6887","RawContent":null,"Title":"Revert \"Fixing layout issues of Anchored/Docked controls in the MDI child forms\"","State":"closed","Body":"Reverts dotnet/winforms#6752\r\n\r\nRelated to #6259 \r\nThis is a recent fix but we found a regression in further testing the scenarios. Will be looking at this issue again and will be coming with broader fix. Re opened the issue again.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6887)","Url":"https://github.com/dotnet/winforms/pull/6887","RelatedDescription":"Closed or merged PR \"Revert \"Fixing layout issues of Anchored/Docked controls in the MDI child forms\"\" (#6887)"},{"Id":"1174251404","IsPullRequest":true,"CreatedAt":"2022-03-22T17:32:37","Actor":"dotnet-maestro[bot]","Number":"6877","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220321.6\r\n- **Date Produced**: March 22, 2022 8:31:18 AM UTC\r\n- **Commit**: ce813882f4061459dc62b63acb75add040f1f603\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22167.8 to 7.0.0-preview.3.22171.6][4]\r\n\r\n[4]: https://github.com/dotnet/runtime/compare/5371203...ce81388\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6877)\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/pull/6877","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6877)"},{"Id":"1176747438","IsPullRequest":true,"CreatedAt":"2022-03-22T12:58:35","Actor":"ArtemTatarinov","Number":"6886","RawContent":null,"Title":"Fixing TextBox accessible object leaks","State":"open","Body":"Fixes #6885\r\n\r\n## Proposed changes\r\n- Use the `UiaDisconnectProvider` method cascade through the hierarchy of the classes to free objects held by accessibility tool\r\n- Nullify needed objects\r\n\r\n## Customer Impact\r\n- TextBox memory will stop leaking\r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Screenshots\r\n\r\n### Before\r\n![image](https://user-images.githubusercontent.com/87859299/159485312-4729b9b1-19bd-425c-ace0-f44b484beb53.png)\r\n\r\n### After\r\n![image](https://user-images.githubusercontent.com/87859299/159485380-9b3d1f61-0460-40ea-b2a6-e3eff3695745.png)\r\n\r\n### Future\r\n![image](https://user-images.githubusercontent.com/87859299/159487064-78e2893a-ad41-4f2b-92d5-c1f4951b3dfa.png)\r\n\r\nThis fix isn't clearing all possible memory leaks. In the future nulling the `Owner` property at the `ControlAccessibleObject` class could be added:\r\n1. This method should be added to the ControlAccessibleObject class:\r\n```\r\n                internal void ClearOwnerControl()\r\n                {\r\n                    this.Owner = null;\r\n                }\r\n```\r\n2. Owner property shoud be changed from this\r\n`public Control Owner { get; }`\r\nto something like this\r\n`public Control? Owner { get; private set; }`\r\n3. Calling of the `ClearOwnerControl` should be added/uncommented at the `ClearObjects` method of the `TextBoxBaseAccessibleObject` class\r\n4. These changes will produce different sorts of warnings: non-nullable member will became nullable, additinal checks for null should be added, etc. We discussed it with @vladimir-krestov and decided, that it's better to fix this leak after Vladimir will add new `TextPattern` functionality to the Core branch.\r\n\r\n## Test methodology\r\n- Manual testing (_using WinDbg, see the screenshots above_)\r\n- CTI team\r\n\r\n## Test environment(s)\r\n- Microsoft Windows [Version 10.0.19043.1586]\r\n- .NET 7.0.0-preview.3.22159.12\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6886)","Url":"https://github.com/dotnet/winforms/pull/6886","RelatedDescription":"Open PR \"Fixing TextBox accessible object leaks\" (#6886)"},{"Id":"1176689783","IsPullRequest":true,"CreatedAt":"2022-03-22T12:45:06","Actor":"dotnet-maestro[bot]","Number":"6884","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220321.2\r\n- **Date Produced**: March 21, 2022 6:59:55 PM UTC\r\n- **Commit**: c8a95297e2622251c125aa5c0ef7c822275a792d\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22168.2 to 7.0.0-beta.22171.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/bafd559...c8a9529\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6884)","Url":"https://github.com/dotnet/winforms/pull/6884","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6884)"},{"Id":"1176712858","IsPullRequest":false,"CreatedAt":"2022-03-22T12:28:55","Actor":"ArtemTatarinov","Number":"6885","RawContent":null,"Title":"TextBox accessible objects are leaking in memory","State":"open","Body":"### .NET version\n\n7.0\n\n### Did it work in .NET Framework?\n\nNo\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNo\n\n### Issue description\n\n`TextBox` accessible objects are left in memory after the `TextBox` control instance was inspected with accessibility tool (like `Accessibility Insights` or `Inspect`) and the form with `TextBox` is closed, garbage is collected, but accessibility tool is still opened.\r\n\r\nReport from WinDbg:\r\n![image](https://user-images.githubusercontent.com/87859299/159481920-cf26ae86-0a41-4d7c-a26f-5cb9d91de3e1.png)\r\n\r\n**Expected behavior:**\r\nAmount of the leaked objects should be minimized to the uncleanable static objects only.\n\n### Steps to reproduce\n\n1. Create a parent form with two buttons: one will be opening a child form with the `TextBox` control and the other will collect the garbage.\r\n2. Press the second button to open the child form with `TextBox`.\r\n3. Start the `Accessibility Insights` tools.\r\n4. Run automated checks for the `TextBox` control using AI.\r\n5. Close the child form.\r\n6. Clear memory with the first button of the parent form.\r\n7. DON'T close the AI tool.\r\n8. Look for `TextBox` accessible objects left in memory (using `WinDbg`, or `dotMemory`, or another suitable tool).","Url":"https://github.com/dotnet/winforms/issues/6885","RelatedDescription":"Open issue \"TextBox accessible objects are leaking in memory\" (#6885)"},{"Id":"1175672006","IsPullRequest":true,"CreatedAt":"2022-03-22T07:39:45","Actor":"gpetrou","Number":"6880","RawContent":null,"Title":"Enable nullability in DataGridViewComboBoxEditingControlAccessibleObject","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in DataGridViewComboBoxEditingControlAccessibleObject.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6880)","Url":"https://github.com/dotnet/winforms/pull/6880","RelatedDescription":"Closed or merged PR \"Enable nullability in DataGridViewComboBoxEditingControlAccessibleObject\" (#6880)"},{"Id":"1175783564","IsPullRequest":false,"CreatedAt":"2022-03-22T06:46:34","Actor":"janseris","Number":"6882","RawContent":null,"Title":"Allow using ApplicationConfiguration when the project is not runnable","State":"closed","Body":"### Is your feature request related to a problem? Please describe\r\n\r\nHello,\r\n\r\ntoday I came across the new feature of WinForms in .NET 6 - ApplicationConfiguration  which is great. It allows configuring the UI of the application directly in project settings.\r\n\r\nI have a Windows Forms Application which uses backend with EF Core 6 etc. \r\nThere are multiple layers. \r\nDue to this, the application should consume IServiceProvider which provides the services, yet, not depend on Data Access Layer.\r\nDependency from Windows Forms application to Data Access Layer is created when singleton services are configured in the Wndows Forms application.\r\n\r\nBecause of this, I created a \"Launcher\" project which initializes the IServiceProvider and then passes it to the Windows Forms application Main method as an argument.\r\nThere is an issue when the Windows Forms application is not runnable, the new .NET 6 ApplicationConfiguration object disappears.\r\n![image](https://user-images.githubusercontent.com/64279914/159339936-e505993f-3d92-4ea4-af8c-08b86ec0ac8d.png)\r\n\r\n\r\nI need to run the WindowsFormsApplication as a class library from the launcher but at the same time, preserve ApplicationConfiguration which allows configuring Windows Forms properties in project settings.\r\n\r\n![image](https://user-images.githubusercontent.com/64279914/159340409-ae20cb4e-9050-4695-b5e8-f90353c52a15.png)\r\n\r\n\r\nIs that possible and if not what would be a workaround?\r\n\r\nNote: ApplicationContext is a custom class which needs to be used in UserControls because they don't allow constructor injection when they are wired into a Forms or other UserControls using the designer.\r\n![image](https://user-images.githubusercontent.com/64279914/159340833-b14628d9-825e-4654-870f-8d7ba2d67bef.png)\r\n![image](https://user-images.githubusercontent.com/64279914/159341079-544639bf-fb70-4008-bfd8-9f726dff98e0.png)\r\n\r\n\r\n\r\nThis is the proposed architecture and in this architecture, the Windows Forms GUI project is not directly executable because it depends on a IServiceProvider provided by the Launcher.\r\n\r\nDiagram with dependencies below:\r\nNote: the API layer contains interfaces for services and the Service layer implement these interfaces.\r\nleft: old architecture\r\nright: new architecture which cannot be used \r\n\r\n![winforms launcher](https://user-images.githubusercontent.com/64279914/159340512-d73d0240-d934-46ec-adc1-4f2dedc94025.png)\r\n\r\n\r\nThank you\r\n\r\n### Describe the solution you'd like and alternatives you've considered\r\n\r\nApplicationConfiguration  can be used in a WinForms project which is not runnable.\r\n\r\n### Will this feature affect UI controls?\r\n\r\nNo","Url":"https://github.com/dotnet/winforms/issues/6882","RelatedDescription":"Closed issue \"Allow using ApplicationConfiguration when the project is not runnable\" (#6882)"},{"Id":"1176320340","IsPullRequest":true,"CreatedAt":"2022-03-22T06:22:21","Actor":"RussKie","Number":"6883","RawContent":null,"Title":"Update troubleshooting.md","State":"open","Body":"Add troubleshooting scenario from https://github.com/dotnet/winforms/discussions/6826\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6883)","Url":"https://github.com/dotnet/winforms/pull/6883","RelatedDescription":"Open PR \"Update troubleshooting.md\" (#6883)"},{"Id":"1175725883","IsPullRequest":false,"CreatedAt":"2022-03-21T17:39:48","Actor":"StuAG","Number":"6881","RawContent":null,"Title":"Closing an old WinForm affects ToolStrip ImageLists in a new Winform ","State":"open","Body":"### .NET version\n\n.Net Core 6.0.200\r\n\r\n\r\n\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\nFor our WinForms Application, we have a number of global classes which are used between various forms. One of which is for ToolStrips where we store a global ImageList class, which is then loaded to each ToolStrip that is created on a form. This is to ensure only one ImageList needs to be created and icons are kept common between the ToolStrips we use throughout the application.\r\n\r\nHowever, we have found that when changing forms (by calling .Show() on the new form and .Close() straight after on the old form), it appeared to set the ImageList properties to empty in the ToolStrips on the new form, meaning none of the images would show on the ToolStrip. After debugging and stepping through every part of the code that may have cause the property to set to null, I found that the .Close() call on the old form was setting the ImageList on the ToolStrips to empty.\r\n\r\nThe forms and the code behind them were not changed at all when converting the project from .Net Framework to .Net Core. This only seems to affect the .Net Core project.\r\n\r\nI've created an example project with 2 identical forms, both having a tool strip with a single item and a button to open another form. The button image shows on Form1, and on Form2 when you open that, however the next time you click the button to switch forms, the image is no longer there.\r\n\r\n[ImageListExample.zip](https://github.com/dotnet/winforms/files/8317886/ImageListExample.zip)\r\n\r\nNot sure why this works on Framework and not Core. I have been able to get around the issue by loading the global ImageList each time rather than setting it at program start, but it's an extra processing step which could potentially lead to (albeit minor) slowdowns.\n\n### Steps to reproduce\n\n- Run the attached project\r\n- Click button1 on Form1, notice the toolstrip at the top of Form1 and Form2 have an image (just a black square)\r\n- Click button1 on Form2, notice the toolstrip no longer has an image displaying","Url":"https://github.com/dotnet/winforms/issues/6881","RelatedDescription":"Open issue \"Closing an old WinForm affects ToolStrip ImageLists in a new Winform \" (#6881)"},{"Id":"1174913959","IsPullRequest":true,"CreatedAt":"2022-03-21T06:40:30","Actor":"gpetrou","Number":"6879","RawContent":null,"Title":"Enable nullability in ConnectionPointCookie","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in ConnectionPointCookie.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6879)","Url":"https://github.com/dotnet/winforms/pull/6879","RelatedDescription":"Closed or merged PR \"Enable nullability in ConnectionPointCookie\" (#6879)"},{"Id":"1174219366","IsPullRequest":true,"CreatedAt":"2022-03-20T21:09:30","Actor":"gpetrou","Number":"6875","RawContent":null,"Title":"Enable nullability in PropertiesTab","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in PropertiesTab.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6875)","Url":"https://github.com/dotnet/winforms/pull/6875","RelatedDescription":"Closed or merged PR \"Enable nullability in PropertiesTab\" (#6875)"},{"Id":"1174193867","IsPullRequest":true,"CreatedAt":"2022-03-20T04:15:07","Actor":"gpetrou","Number":"6871","RawContent":null,"Title":"Use ThrowIfFailed extension method where possible","State":"closed","Body":"## Proposed changes\r\n\r\n- Use ThrowIfFailed extension method where possible.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6871)","Url":"https://github.com/dotnet/winforms/pull/6871","RelatedDescription":"Closed or merged PR \"Use ThrowIfFailed extension method where possible\" (#6871)"},{"Id":"1174292214","IsPullRequest":true,"CreatedAt":"2022-03-19T15:39:58","Actor":"kirsan31","Number":"6878","RawContent":null,"Title":"Empty finalizers removed.","State":"open","Body":"Fixes #6858\r\n\r\n\r\n## Proposed changes\r\nRemove unnecessary empty finalizers.\r\n\r\n- [ResXResourceReader](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Resources/ResXResourceReader.cs#L194)\r\n- [ResXResourceWriter](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Resources/ResXResourceWriter.cs#L549)\r\n- [ApplicationContext](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/ApplicationContext.cs#L91)\r\n- [DataGridViewBand](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/DataGridViewBand.cs#L817)\r\n- [DataGridViewCell](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/DataGridViewCell.cs#L1313)\r\n- [HtmlShim](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/HtmlShim.cs#L107)\r\n- [HtmlShimManager](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/HtmlShimManager.cs#L229)\r\n- [FeedbackRectangle](https://github.com/dotnet/winforms/blob/55e1755b579395e7e22fecf340905c79ccfa9b1a/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripPanel.FeedbackRectangle.cs#L55)\r\n\r\n## Customer Impact\r\nGC will be more faster - overall improve performance (most impact on `DataGridView`).\r\nSimple `DataGridView` app, updating (replacing) `DataSource` every 1 sec with 10k unshared rows.\r\n\r\n![image](https://user-images.githubusercontent.com/17767561/159126815-c4fee2d4-c41c-4fbe-870e-24f1d730d874.png)\r\n~20sec measure time.\r\n\r\nLeft before, right -  after:\r\n![image](https://user-images.githubusercontent.com/17767561/159127155-948b23ee-424e-401b-8f84-9027eb4d834c.png)\r\n\r\nBefore:\r\n![image](https://user-images.githubusercontent.com/17767561/159127229-97a488ca-e0f2-48fd-a2fb-db0ed7adafcd.png)\r\n\r\nAfter:\r\n![image](https://user-images.githubusercontent.com/17767561/159127211-77b10655-14e6-40c1-b740-691fed26615e.png)\r\n\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n  We have a _problem_ here: some of this finalizers are **public** api:\r\n  - `~ResXResourceReader()`\r\n  - `~ResXResourceWriter()`\r\n  - `~ApplicationContext()`\r\n  - `~DataGridViewCell()`\r\n  - `~DataGridViewBand()` (absent in PublicAPI.Shipped.txt)\r\n\r\nTheoretically if some one had subclass this classes with real unmanaged resources, they may not implement their own finalizer but relay on fact that finalizer of base class will call `Dispose(false)`. And in this case it will be a breaking change 😔\r\nSo, in the end we can safety remove finalizers only in `HtmlShimManager`, `FeedbackRectangle`. `HtmlShim` is a question here - all his 3 child have `Marshal.FinalReleaseComObject` in Dispose, but only `HtmlElementShim` do it unconditionally in all cases:\r\n https://github.com/dotnet/winforms/blob/2e9abddc2bab0c22430ae62d4a348ed6ffef329b/src/System.Windows.Forms/src/System/Windows/Forms/HtmlElement.HtmlElementShim.cs#L134-L143\r\nhttps://github.com/dotnet/winforms/blob/2e9abddc2bab0c22430ae62d4a348ed6ffef329b/src/System.Windows.Forms/src/System/Windows/Forms/HtmlDocument.HtmlDocumentShim.cs#L112-L124\r\nhttps://github.com/dotnet/winforms/blob/2e9abddc2bab0c22430ae62d4a348ed6ffef329b/src/System.Windows.Forms/src/System/Windows/Forms/HtmlWindow.HtmlWindowShim.cs#L103-L115\r\n<br/>\r\n\r\nDuring investigation I found 2 [runtime](https://github.com/dotnet/runtime) types (**heavily** used in WinForms), that have same problem (in fact, there are many more):\r\n- `System.ComponentModel.Component` (public api)\r\n- `System.ComponentModel.Container`  (public api)\r\n\r\nThe most important question is what to do with the public api? As you can see, in case of `DataGridView`, **the benefit is very significant**. And if do such a braking change is not an option than we will need to rise https://github.com/dotnet/winforms/issues/6859 priority...<br/><br/><br/>\r\n\r\nP.S. Spent a few hours to run the application on the main branch - without effect 😥 Latest `dotnet-sdk-7.0.100-preview.3.22167.1-win-x64.exe` sdk is broken - it's need `7.0.0-preview.3.22158.1` to launch (no framework installed 😁) and with second available `dotnet-sdk-7.0.100-preview.2.22156.6-win-x64.exe`: \r\n![image](https://user-images.githubusercontent.com/17767561/159127784-f2a01cfa-818d-4214-8831-fc3bbf5763a7.png)\r\nSo, had to test on 6.0 branch...\r\nI think that [debug](https://github.com/dotnet/winforms/blob/main/docs/debugging.md) doc mast be updated with clarification on this (debug apps with changes in main branch):\r\n- you need to install preview sdk (**exact** (must update dynamically?) version and where to get it)\r\n- set preview sdk in VS settings\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6878)","Url":"https://github.com/dotnet/winforms/pull/6878","RelatedDescription":"Open PR \"Empty finalizers removed.\" (#6878)"},{"Id":"1174251242","IsPullRequest":true,"CreatedAt":"2022-03-19T12:44:48","Actor":"dotnet-maestro[bot]","Number":"6876","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220318.2\r\n- **Date Produced**: March 18, 2022 11:42:47 PM UTC\r\n- **Commit**: bafd55901b50d6fc3507c8ed96a7777fcca1796f\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22167.4 to 7.0.0-beta.22168.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/251034e...bafd559\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6876)","Url":"https://github.com/dotnet/winforms/pull/6876","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6876)"},{"Id":"1174216943","IsPullRequest":true,"CreatedAt":"2022-03-19T09:09:42","Actor":"gpetrou","Number":"6874","RawContent":null,"Title":"Enable nullability in MdiWindowDialog","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in MdiWindowDialog.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6874)","Url":"https://github.com/dotnet/winforms/pull/6874","RelatedDescription":"Open PR \"Enable nullability in MdiWindowDialog\" (#6874)"},{"Id":"1173822153","IsPullRequest":true,"CreatedAt":"2022-03-18T21:44:24","Actor":"gpetrou","Number":"6868","RawContent":null,"Title":"Enable nullability in CheckBox","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in CheckBox.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6868)","Url":"https://github.com/dotnet/winforms/pull/6868","RelatedDescription":"Closed or merged PR \"Enable nullability in CheckBox\" (#6868)"},{"Id":"1173585533","IsPullRequest":true,"CreatedAt":"2022-03-18T21:37:39","Actor":"kant2002","Number":"6867","RawContent":null,"Title":"Remove publishing TRX files from public CI","State":"closed","Body":"There no TRX files produced during tests runs anywhere.\r\nPractically this is does not affects anything (<1sec), buy whole idea \"to have step which do nothing\" seems to be off.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6867)","Url":"https://github.com/dotnet/winforms/pull/6867","RelatedDescription":"Closed or merged PR \"Remove publishing TRX files from public CI\" (#6867)"},{"Id":"1173963692","IsPullRequest":true,"CreatedAt":"2022-03-18T19:42:22","Actor":"gpetrou","Number":"6870","RawContent":null,"Title":"Enable nullability in FontDialog","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in FontDialog.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6870)","Url":"https://github.com/dotnet/winforms/pull/6870","RelatedDescription":"Open PR \"Enable nullability in FontDialog\" (#6870)"},{"Id":"1173932557","IsPullRequest":false,"CreatedAt":"2022-03-18T19:05:38","Actor":"janseris","Number":"6869","RawContent":null,"Title":"Cannot search in properties","State":"open","Body":"### Environment\r\n\r\nVS 2022 (17.1.1)\r\n\r\n### .NET version\r\n\r\n.NET 6\r\n\r\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\r\n\r\n.NET Framework 4.8\r\n\r\n### Issue description\r\n\r\nsearch bar in control properties is not present\r\n\r\n### Steps to reproduce\r\n\r\nopen Windows Forms designer, click F4 to show properties, select any designable control, search bar will be visible which allows to quickly find properties by substring\r\n- this is especially needed when using advanced controls with a lot of properties\r\n\r\n### Diagnostics\r\n\r\n_No response_","Url":"https://github.com/dotnet/winforms/issues/6869","RelatedDescription":"Open issue \"Cannot search in properties\" (#6869)"},{"Id":"1173519809","IsPullRequest":true,"CreatedAt":"2022-03-18T17:48:00","Actor":"dotnet-maestro[bot]","Number":"6864","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220317.4\r\n- **Date Produced**: March 17, 2022 10:58:04 PM UTC\r\n- **Commit**: 251034e7687335886c3774a0138a8584a782b0eb\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22166.1 to 7.0.0-beta.22167.4][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/c90e2d9...251034e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6864)","Url":"https://github.com/dotnet/winforms/pull/6864","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6864)"},{"Id":"1173521316","IsPullRequest":true,"CreatedAt":"2022-03-18T17:24:35","Actor":"dotnet-maestro[bot]","Number":"6865","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220317.8\r\n- **Date Produced**: March 18, 2022 8:32:30 AM UTC\r\n- **Commit**: 5371203d5820a21922357e954e8c43eb4b76fd1d\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22167.1 to 7.0.0-preview.3.22167.8][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/05cb7f5...5371203\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6865)","Url":"https://github.com/dotnet/winforms/pull/6865","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6865)"},{"Id":"1173370337","IsPullRequest":true,"CreatedAt":"2022-03-18T10:21:05","Actor":"kant2002","Number":"6862","RawContent":null,"Title":"Pedantically construct paths for XML files","State":"closed","Body":"Without these changes in binlog I see paths with `\\\\/` which is distraction and Explorer and a lot of other apps do not like paths like this.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6862)","Url":"https://github.com/dotnet/winforms/pull/6862","RelatedDescription":"Closed or merged PR \"Pedantically construct paths for XML files\" (#6862)"},{"Id":"1173416844","IsPullRequest":true,"CreatedAt":"2022-03-18T10:12:36","Actor":"SergeySmirnov-Akvelon","Number":"6863","RawContent":null,"Title":"Fixing  UIA tree for ToolStripDropDownMenu ","State":"open","Body":"Fixes #6763\r\n\r\n\r\n## Proposed changes\r\n- The issue is reproduced because we don't actually have interaction between the `ToolStripButtons` (`ToolStripSplitButton`, `ToolStripDropDownButton`, `ToolStripMenuItem`, `ToolStripOverflowButton`) and the `ToolStripDropDownMenu`  of those `ToolStripButtons`.\r\n\r\n- Added logic for interacting `ToolStripButtons`with their `ToolStripDropDownMenus` and `ToolStripButtons`with parent `ToolStripDropDownMenu`.\r\n\r\n- Added unit tests\r\n\r\n## Customer Impact\r\n**Before fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/158980700-a0f62800-3d05-4f59-882b-6f4e08fb42bf.png)\r\n\r\n**After fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/158980617-e403db2b-5873-4654-86e3-299d4a6eb86f.png)\r\n\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n- CTI team\r\n- Unit tests\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- Inspect\r\n- Accessibility Insights\r\n- Narrator\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19044.1466]\r\n- .NET Core SKD: 7.0.0-preview.3.22167.1\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6863)","Url":"https://github.com/dotnet/winforms/pull/6863","RelatedDescription":"Open PR \"Fixing  UIA tree for ToolStripDropDownMenu \" (#6863)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-03-23T03:30:33.0864149Z","RunDurationInMilliseconds":530}