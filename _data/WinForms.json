{"Data":{"GitHub":{"Issues":[{"Id":"1144827151","IsPullRequest":false,"CreatedAt":"2022-02-19T21:21:47","Actor":"nathan130200","Number":"6722","RawContent":null,"Title":"Designer load encountered an error. Please ensure that the project can be built successfully.","State":"closed","Body":"Again another problem with designtoolsserver (from #6420)\r\n\r\nOk, so i got new error (updated to latest preview version from VS2022)\r\n\r\n```cs\r\n[16:25:46.8925168] Creating VSCodeDomDesignerLoader\r\n[16:25:47.6300184] Processed 'System.Design' in 00:00:02.4840523\r\n[16:25:47.6830170] Added 'System.Design'\r\n[16:25:47.6840173] Loaded System.Drawing.Design in 00:00:00.0000227 [thread 56]\r\n[16:25:47.6890185] Processed 'System.Drawing.Design' in 00:00:00.0055732\r\n[16:25:47.6900189] Added 'System.Drawing.Design'\r\n[16:25:48.8251525] [Thread 1] Creating design-time ITypeResolutionService.\r\n[16:25:50.5392459] Start processing enqueued assemblies\r\n[16:25:50.5392459] Loaded Microsoft.WinForms.DesignTools.Protocol in 00:00:00.0000178 [thread 79]\r\n[16:25:50.7015014] Processed 'Microsoft.WinForms.DesignTools.Protocol' in 00:00:00.1625103\r\n[16:25:50.7055005] Added 'Microsoft.WinForms.DesignTools.Protocol'\r\n[16:25:50.7055005] Loaded Microsoft.WinForms.DesignTools.Client in 00:00:00.0000282 [thread 61]\r\n[16:25:50.8610191] Processed 'Microsoft.WinForms.DesignTools.Client' in 00:00:00.1546868\r\n[16:25:50.8630155] Added 'Microsoft.WinForms.DesignTools.Client'\r\n[16:25:51.3873048] [Thread 68] Launching server...\r\n[16:26:53.4778102] OutputGroupService didn't return output group DesignerRuntimeImplementationProjectOutputGroup.\r\n[16:26:53.4778102] Could not retrieve DesignerRuntimeImplementationProjectOutputGroupPaths for current project.\r\n[16:26:54.1809027] System.InvalidOperationException: Designer load encountered an error. Please ensure that the project can be built successfully.\r\n                      at Microsoft.DotNet.DesignTools.Client.Host.ProjectInfoProvider.<GetProjectInfoAsync>d__4.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                      at Microsoft.DotNet.DesignTools.Client.Host.ServerHostFactory.<CreateHostAsync>d__7.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                      at Microsoft.DotNet.DesignTools.Client.DesignToolsClientLoader.<CreateClientAsync>d__28.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at Microsoft.VisualStudio.Telemetry.WindowsErrorReporting.WatsonReport.GetClrWatsonExceptionInfo(Exception exceptionObject)\r\n[16:26:54.3889082] Cannot update selection in server process as Session is not connected.\r\n```\r\n\r\nUpdated to latest visual studio 2022 preview. Using .net6.0\r\n\r\nAnd in designer display this:\r\n\r\n![image](https://user-images.githubusercontent.com/14365254/154816146-356d4f12-6653-47d1-a655-e97d2ca6de79.png)\r\n\r\n\r\nAnd again i just created empty winforms project, and project can be built.\r\n\r\n![image](https://user-images.githubusercontent.com/14365254/154816222-52f613ab-5f62-433c-bcb9-d20625c32c02.png)\r\n\r\n\r\n### Same workaround from #6420 \r\nI must close then reopen project to design tools server start","Url":"https://github.com/dotnet/winforms/issues/6722","RelatedDescription":"Closed issue \"Designer load encountered an error. Please ensure that the project can be built successfully.\" (#6722)"},{"Id":"1144700838","IsPullRequest":true,"CreatedAt":"2022-02-19T13:45:48","Actor":"dotnet-maestro[bot]","Number":"6721","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220218.9\r\n- **Date Produced**: February 19, 2022 10:23:04 AM UTC\r\n- **Commit**: ca6f4206f535458ab82561cd517ded0615728d58\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22118.1 to 7.0.0-preview.3.22118.9][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/cc649ac...ca6f420\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6721)","Url":"https://github.com/dotnet/winforms/pull/6721","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6721)"},{"Id":"1144700577","IsPullRequest":true,"CreatedAt":"2022-02-19T13:39:53","Actor":"dotnet-maestro[bot]","Number":"6720","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220217.2\r\n- **Date Produced**: February 18, 2022 12:44:37 AM UTC\r\n- **Commit**: 49750c02e63d0ad3a77d035bba7498a0b1acd218\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22114.7 to 7.0.0-beta.22117.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/6d97726...49750c0\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6720)","Url":"https://github.com/dotnet/winforms/pull/6720","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6720)"},{"Id":"1143034014","IsPullRequest":true,"CreatedAt":"2022-02-18T20:07:36","Actor":"dotnet-maestro[bot]","Number":"6719","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220218.1\r\n- **Date Produced**: February 18, 2022 11:46:08 AM UTC\r\n- **Commit**: cc649acaec3cad932f593ab71a8da85bbf7aa49f\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22116.9 to 7.0.0-preview.3.22118.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/793185a...cc649ac\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6719)","Url":"https://github.com/dotnet/winforms/pull/6719","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6719)"},{"Id":"1142131116","IsPullRequest":true,"CreatedAt":"2022-02-18T18:36:53","Actor":"JeremyKuhne","Number":"6710","RawContent":null,"Title":"Pass SendKeys state by ref","State":"closed","Body":"Regression introduced in 90f7c1dd955c51c904efd496731a2394cacf578f.\r\n\r\nFixes #6666\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6710)","Url":"https://github.com/dotnet/winforms/pull/6710","RelatedDescription":"Closed or merged PR \"Pass SendKeys state by ref\" (#6710)"},{"Id":"1142954407","IsPullRequest":true,"CreatedAt":"2022-02-18T12:16:30","Actor":"SergeySmirnov-Akvelon","Number":"6718","RawContent":null,"Title":"Fixing incorrect name for NumericUpDown editor","State":"open","Body":"Fixes #6359\r\n\r\n\r\n## Proposed changes\r\n- The issue is reproduced when the NumericUpDown.AccessibleObject has no name. In this case, we simply announce the \"edit\" for text field. This behavior can be considered expected by default. But in accordance with the behavior of the combobox, I suggest announcing the default name for the editor (spinner) if the NumericUpDown.AccessibleObject  did not return a name.\r\n- Added default name for text field inside NumericUpDown.\r\n- Added unit tests\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n**Before fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/154681102-90d5e330-5521-42c7-9265-9d4ab90f7918.png)\r\n\r\n**After fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/154681006-e0ba622b-1df1-42ba-a111-b587b9edf9bf.png)\r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n-  Unit tests\r\n- CTI team\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- Narrator\r\n- NVDA\r\n- JAWS\r\n- Inspect\r\n- Accessibility Insights\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19044.1466]\r\n- .NET Core SDK: 7.0.0-preview.2.22113.2\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6718)","Url":"https://github.com/dotnet/winforms/pull/6718","RelatedDescription":"Open PR \"Fixing incorrect name for NumericUpDown editor\" (#6718)"},{"Id":"1142818454","IsPullRequest":false,"CreatedAt":"2022-02-18T10:43:54","Actor":"WolfgangHG","Number":"6717","RawContent":null,"Title":"[PerMonitorV2] Anchoring controls to Bottom/Right does not work property","State":"open","Body":"See attached .NET 6 sample: when moving the form from a screen at 100% to a screen at 125%, the controls anchored right/bottom are not rendered correct.\r\n[DpiSample.zip](https://github.com/dotnet/winforms/files/8096436/DpiSample.zip)\r\n\r\n\r\nThis is at 100%:\r\n![100](https://user-images.githubusercontent.com/138049/154667297-cd33fac0-7444-429a-b4a6-4a0dd740b595.png)\r\n\r\nThis is the result when moving the form to the 125% screen:\r\n![125](https://user-images.githubusercontent.com/138049/154667367-ccc9d37c-8102-4037-9a10-38ad3dab99ac.png)\r\nThe groupbox overlaps the button, and the margins to the right are larger than expected.\r\n\r\nIn the project file, I set this:\r\n`    <ApplicationHighDpiMode>PerMonitorV2</ApplicationHighDpiMode>`\r\n\r\nAnd the form applies the OS default font (but removing this line does not change the result):\r\n`this.Font = SystemFonts.MessageBoxFont;`\r\n\r\nI saw that there are several other issues about \"PerMonitorV2\", but I can't say whether this problem is reported elsewhere.","Url":"https://github.com/dotnet/winforms/issues/6717","RelatedDescription":"Open issue \"[PerMonitorV2] Anchoring controls to Bottom/Right does not work property\" (#6717)"},{"Id":"1142665140","IsPullRequest":true,"CreatedAt":"2022-02-18T08:58:11","Actor":"SergeySmirnov-Akvelon","Number":"6716","RawContent":null,"Title":"Added missing unit tests for deleting items from list controls","State":"open","Body":"## Proposed changes\r\n- Added missing unit tests for deleting items from list controls\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19044.1466]\r\n- .NET Core SDK: 7.0.0-preview.2.22113.2\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6716)","Url":"https://github.com/dotnet/winforms/pull/6716","RelatedDescription":"Open PR \"Added missing unit tests for deleting items from list controls\" (#6716)"},{"Id":"1142632408","IsPullRequest":false,"CreatedAt":"2022-02-18T08:36:40","Actor":"vsfeedback","Number":"6715","RawContent":null,"Title":"initialize of the Settings, does not work","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/initialize-of-the-Settings-does-not-wor/1587266)._\n\n---\n[severity:I'm unable to use this version] [regression] [worked-in:16.10]\r\nSystem.Configuration.ConfigurationErrorsException\n  HResult=0x80131902\n  Message=Configuration system failed to initialize\n  Source=System.Configuration.ConfigurationManager\n  StackTrace:\n   at System.Configuration.ClientConfigurationSystem.EnsureInit(String configKey)\n   at System.Configuration.ClientConfigurationSystem.PrepareClientConfigSystem(String sectionName)\n   at System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.RefreshConfig(String sectionName)\n   at System.Configuration.ConfigurationManager.RefreshSection(String sectionName)\n   at System.Configuration.ClientSettingsStore.ReadSettings(String sectionName, Boolean isUserScoped)\n   at System.Configuration.LocalFileSettingsProvider.GetPropertyValues(SettingsContext context, SettingsPropertyCollection properties)\n   at System.Configuration.SettingsBase.GetPropertiesFromProvider(SettingsProvider provider)\n   at System.Configuration.SettingsBase.GetPropertyValueByName(String propertyName)\n   at System.Configuration.SettingsBase.get_Item(String propertyName)\n   at System.Configuration.ApplicationSettingsBase.GetPropertyValue(String propertyName)\n   at System.Configuration.ApplicationSettingsBase.get_Item(String propertyName)\n   at testing_settings. My.MySettings.get_Setting_1() in C:\\Users\\DdeGelder\\OneDrive - Infrastructuur Nederland\\Documents\\Visual Studio 2022\\Projects\\testing_settings\\testing_settings\\My Project\\Settings1.Designer.vb:line 62\n   at testing_settings. Form1.Start_up(Object sender, EventArgs e) in C:\\Users\\DdeGelder\\OneDrive - Infrastructuur Nederland\\Documents\\Visual Studio 2022\\Projects\\testing_settings\\testing_settings\\Form1.vb:line 12\n   at System.Windows.Forms.Form.OnLoad(EventArgs e)\n   at System.Windows.Forms.Form.OnCreateControl()\n   at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)\n   at System.Windows.Forms.Control.CreateControl()\n   at System.Windows.Forms.Control.WmShowWindow(Message& m)\n   at System.Windows.Forms.Control.WndProc(Message& m)\n   at System.Windows.Forms.ScrollableControl.WndProc(Message& m)\n   at System.Windows.Forms.ContainerControl.WndProc(Message& m)\n   at System.Windows.Forms.Form.WmShowWindow(Message& m)\n   at System.Windows.Forms.Form.WndProc(Message& m)\n   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, WM msg, IntPtr wparam, IntPtr lparam)\n\nThis exception was originally thrown at this call stack:\n    [External Code]\n\nInner Exception 1:\nConfigurationErrorsException: Unrecognized configuration section system.diagnostics. (C:\\Users\\DdeGelder\\OneDrive - Infrastructuur Nederland\\Documents\\Visual Studio 2022\\Projects\\testing_settings\\testing_settings\\bin\\Debug\\net6.0-windows\\testing_settings.dll.config line 8)\n\n---\n### Original Comments\n\n#### Feedback Bot on 11/18/2021, 11:00 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Vritant Bhardwaj [MSFT] on 11/20/2021, 09:24 AM: \n\n<p>Thank you for reaching out to us with issue.</p>\n<p>On looking at the stack trace you have presented, I am unable to determine the exact issue you’re encountering. From the screenshot and stacktrace, you have encountered an error in code that is currently running (as I see in the picture attached) and am not able to relate it to a problem in Visual Studio. Could you please provide more details about your issue?</p>\n<p><strong>Why do we ask for more info?</strong><br>\nWe try to reproduce all issues reported with the information provided in the description and comments. When we can’t reproduce the issue, we ask you for more information so we can resolve the issue as quickly and efficiently as possible.<br>\nIn our <a target='_blank' href=\"https://aka.ms/vsfeedbackguidelines/#writing-a-good-bug-report-or-feature-suggestion\">guidelines</a>, you can get tips on how to provide clear and simple reproducible steps.</p>\n\n#### Dirk Gelder on 11/22/2021, 02:37 AM: \n\n(private comment, text removed)\n#### Dirk Gelder on 1/7/2022, 03:52 AM: \n\n<p>Because it has been a while and no solution has been found yet. Attached is even more information neatly according to your own suggested method.</p>\n<p><strong>File only one problem or feature request per issue:</strong> It’s about de Settings-file automaticly generated like the header says:<br>\n'------------------------------------------------------------------------------<br>\n’ &lt;auto-generated&gt;<br>\n’     This code was generated by a tool.<br>\n’     Runtime Version:4.0.30319.42000<br>\n’<br>\n’     Changes to this file may cause incorrect behavior and will be lost if<br>\n’     the code is regenerated.<br>\n’ &lt;/auto-generated&gt;<br>\n'------------------------------------------------------------------------------</p>\n<p><strong>The more information you can provide, the easier it will be for us to reproduce and fix your issue.</strong><br>\nIn the not public post of 21 nov '21 is a compleet project with the same problem, without any other possible problems.<br>\nHence this post filled in with your guidelines to give even more information in a structured way.</p>\n<p><strong>Include the following steps with each issue.</strong></p>\n<ol>\n<li><strong>Reproducible steps (1… 2… 3…) and what you expected versus what you experienced.</strong><br>\n1.1. I’m starting a new project<br>\n1.2. I opened the project properties<br>\n1.3. Went to the settings tab<br>\nThere was no standard fillable table here, but I had to click on a link first to have it create standard files.<br>\n1.4. So let’s create the standard files<br>\n1.5. Settings_1 (as string) and Settings_2 (for integer) created<br>\n1.6. In function ‘Start_up’ the value contained in a textbox and NumericUpDown<br>\nIn case of value change, adopt the value in the Settings<br>\nThen you run into the following problems when you debug, this is just the drawing of instructions like on various websites about how it should work.<br>\nThis is also what I have done in previous projects.</li>\n<li><strong>Images, animations, or a link to a video. Images and animations illustrate repro-steps but don’t replace them.</strong><br>\nSee the attachments</li>\n<li><strong>As appropriate, a code snippet that demonstrates the issue or a link to a code repository we can easily pull down onto our machine to recreate the issue.</strong><br>\nThe code of de project I made to repreduce the problem</li>\n</ol>\n<hr>\n<p>Public Class Form1<br>\nPrivate Sub Check_up_settings()<br>\n’ Controle of de User settings file in orde is<br>\nTry<br>\nMy.Settings.Reload()<br>\nCatch ex As Exception<br>\n’ Melding maken<br>\nMsgBox(ex.Message)<br>\nEnd Try<br>\nEnd Sub<br>\nPrivate Sub Start_up(sender As Object, e As EventArgs) Handles MyBase.Load<br>\nTextBox1.Text = My.Settings.Setting_1<br>\nNumericUpDown1.Value = My.Settings.Setting_2<br>\nEnd Sub</p>\n<pre><code>Private Sub Update_setting(sender As Object, e As EventArgs) Handles TextBox1.TextChanged, NumericUpDown1.ValueChanged\n    If sender.name = &quot;TextBox1&quot; Then My.Settings.Setting_1 = TextBox1.Text\n    If sender.name = &quot;NumericUpDown1&quot; Then My.Settings.Setting_2 = NumericUpDown1.Value\nEnd Sub\n</code></pre>\n<h2>End Class</h2>\n<p>**Remember to do the following steps:</p>\n<ul>\n<li>Search to see if there exists a duplicate. If so, vote up the existing issue, providing additional comments or clarifications as needed.</li>\n<li>Recreate the issue after disabling all extensions. If you find the issue is caused by an extension you’ve installed, file an issue on the extension respectively.</li>\n<li>Simplify your code around the issue so we can better isolate the problem.**<br>\nSee the attachment I, like they post of 21 nov '21 will be the testproject</li>\n</ul>\n<p><strong>Even with issues that include rich details, we may be unable to reproduce the issue and may ask for more information!</strong><br>\nNo problem, only you have to reacte at leatst with a specific request for more information. As far as I know this is all that I can provide.</p>\n<p>I also hope that perhapse a overactive community persone can help.</p>\n\n#### Feedback Bot on 1/14/2022, 05:42 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/winforms/issues/6715","RelatedDescription":"Open issue \"initialize of the Settings, does not work\" (#6715)"},{"Id":"1142434438","IsPullRequest":false,"CreatedAt":"2022-02-18T06:05:20","Actor":"vladimir-krestov","Number":"6714","RawContent":null,"Title":"Button_AchorNone_NoResizeOnWindowSizeTallerAsync test is flaky in x86 Release","State":"open","Body":"* Global Issue: #6690\r\n\r\n* .NET Core Version: 7.0\r\n\r\n* Have you experienced this same bug with .NET Framework?: No\r\n\r\n**Problem description:**\r\n- Button_AchorNone_NoResizeOnWindowSizeTallerAsync unit test fails sometime in x86 Release CI build for successful PRs, that blocking deployment of fixes into sdk.\r\n\r\n**Stack trace** ([System.Windows.Forms.UI.IntegrationTests_net7.0_x86.log](https://dev.azure.com/dnceng/public/_build/results?buildId=1611672&view=artifacts&pathAsName=false&type=publishedArtifacts)):\r\n```\r\nSystem.Windows.Forms.UITests.ButtonTests.Button_AchorNone_NoResizeOnWindowSizeTallerAsync [FAIL]\r\n      Assert.True() Failure\r\n      Expected: True\r\n      Actual:   False\r\n      Stack Trace:\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/ButtonTests.cs(151,0): at System.Windows.Forms.UITests.ButtonTests.<Button_AchorNone_NoResizeOnWindowSizeTallerAsync>b__6_0(Form form, Button button)\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/Infra/ControlTestBase.cs(244,0): at System.Windows.Forms.UITests.ControlTestBase.<>c__DisplayClass27_0`1.<<RunFormAsync>b__0>d.MoveNext()\r\n        --- End of stack trace from previous location ---\r\n           at Microsoft.VisualStudio.Threading.JoinableTask.JoinAsync(CancellationToken cancellationToken)\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/Infra/ControlTestBase.cs(255,0): at System.Windows.Forms.UITests.ControlTestBase.RunFormAsync[T](Func`1 createDialog, Func`3 testDriverAsync)\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/Infra/ControlTestBase.cs(173,0): at System.Windows.Forms.UITests.ControlTestBase.RunSingleControlTestAsync[T](Func`3 testDriverAsync, Func`1 createControl, Func`1 createForm)\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/ButtonTests.cs(394,0): at System.Windows.Forms.UITests.ButtonTests.RunTestAsync(Func`3 runTest)\r\n        /_/src/System.Windows.Forms/tests/IntegrationTests/UIIntegrationTests/ButtonTests.cs(136,0): at System.Windows.Forms.UITests.ButtonTests.Button_AchorNone_NoResizeOnWindowSizeTallerAsync()\r\n        --- End of stack trace from previous location ---\r\n      Output:\r\n        Moving mouse to (276, 318).\r\n        Screen resolution of (1024, 768) translates mouse to (17664, 27136).\r\n```\r\n\r\n\r\n**Expected behavior:**\r\n- All correct tests pass every time.\r\n\r\n**Minimal repro:**\r\n- Run unit tests on x86 environment (or create a PR with changes, CI build will do it)\r\n","Url":"https://github.com/dotnet/winforms/issues/6714","RelatedDescription":"Open issue \"Button_AchorNone_NoResizeOnWindowSizeTallerAsync test is flaky in x86 Release\" (#6714)"},{"Id":"1142413563","IsPullRequest":false,"CreatedAt":"2022-02-18T05:50:32","Actor":"vladimir-krestov","Number":"6713","RawContent":null,"Title":"Need to skip some flaky test to unblock CI build and deployment","State":"open","Body":"This Issue is a storage of all new flaky tests that should be skipped.\r\n\r\n* .NET Core Version: 7.0\r\n\r\n**Problem description:**\r\n- Some tests fail sometimes and block successful fixes deployment. We have to skip them now, to fix them later, but unblock CI build errors for successful PRs. The global Issue for fixing these tests: #6690.\r\n\r\n**Proposed changes:**\r\n- Skip some test cases.\r\n- Put skipped tests to [#6690](https://github.com/dotnet/winforms/issues/6690) to fix them later.\r\n\r\n**Expected behavior:**\r\n- Tests don't fail CI buiild for successful PRs\r\n","Url":"https://github.com/dotnet/winforms/issues/6713","RelatedDescription":"Open issue \"Need to skip some flaky test to unblock CI build and deployment\" (#6713)"},{"Id":"1142267075","IsPullRequest":true,"CreatedAt":"2022-02-18T03:16:35","Actor":"RussKie","Number":"6712","RawContent":null,"Title":"Update designer-related docs, add designer troubleshooting guide","State":"open","Body":"Closes #6705\r\nCloses #6492\r\nCloses #6420\r\n\r\nThe preview is available at https://github.com/RussKie/winforms/tree/designer_troubleshooting_guide/docs/designer.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6712)","Url":"https://github.com/dotnet/winforms/pull/6712","RelatedDescription":"Open PR \"Update designer-related docs, add designer troubleshooting guide\" (#6712)"},{"Id":"1142133764","IsPullRequest":true,"CreatedAt":"2022-02-18T00:56:06","Actor":"github-actions[bot]","Number":"6711","RawContent":null,"Title":"[release/6.0] Pass SendKeys state by ref","State":"open","Body":"Backport of #6710 to release/6.0\r\n\r\nRegression introduced in 90f7c1dd955c51c904efd496731a2394cacf578f.\r\n\r\nFixes #6666\r\n\r\n/cc @dreddy-work @JeremyKuhne\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6711)","Url":"https://github.com/dotnet/winforms/pull/6711","RelatedDescription":"Open PR \"[release/6.0] Pass SendKeys state by ref\" (#6711)"},{"Id":"1141520489","IsPullRequest":false,"CreatedAt":"2022-02-17T15:51:55","Actor":"jbhensley","Number":"6708","RawContent":null,"Title":"ListView.GroupCollapsedStateChanged fires with incorrect GroupIndex/doesn't fire at all","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n.NET Core Version:  \r\n\r\n* .NET Core SDK: 7.0.0-preview.2.22116.9\r\n\r\nHave you experienced this same bug with .NET Framework?: \r\nNo\r\n\r\n**Problem description:**\r\n\r\nWhen a key is pressed, `ListView` determines which group is affected by grabbing the `Group` property of the first selected item:\r\n\r\nhttps://github.com/dotnet/winforms/blob/150aabc4cf47c303f980fbc6313c329e6da8583c/src/System.Windows.Forms/src/System/Windows/Forms/ListView.cs#L6934-L6937\r\n\r\nThis is incorrect if an item is selected in one group, followed by subsequent selection of a second group which can be done by holding down Ctrl and selecting a different group's header.\r\n\r\nBehavior manifests different depending on whether changes in PR #6493 have been applied (note: PR not merged at time of issue creation).\r\n\r\n- On most recent build: `ListView.GroupCollapsedStateChanged` event fires with incorrect `GroupIndex`\r\n\r\n![ListViewGroup-unpatched](https://user-images.githubusercontent.com/13544395/154516336-a57ff954-fcda-4093-8c93-9a2fea7140a1.gif)\r\n\r\n- After #6493 , the event does not fire at all\r\n\r\n![ListViewGroup](https://user-images.githubusercontent.com/13544395/154516575-62709402-0a92-4ace-9579-1ea66eeef564.gif)\r\n\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\n\r\n\r\n**Expected behavior:**\r\n<!--\r\n    Provide details on expected behavior with screenshots/GIF, where ever possible.\r\n -->\r\n\r\n`ListView.GroupCollapsedStateChanged` should fire and have the correct value for `GroupIndex`\r\n\r\n**Minimal repro:**\r\n<!--\r\n    Provide step by step guide to repro this issue.  Incase repro steps are complex, It would be helpful if \r\n    you attach a GIF with repro actions. Attaching a sample app to repro the issue will help speed up the \r\n    resolution. \r\n -->\r\n\r\nCode used for animations:\r\n\r\n``` C#\r\nusing var form = new Form() { Size = new Size(808, 469) };\r\nusing var listView = new ListView();\r\nusing var textBox = new TextBox() { Multiline = true };\r\n\r\nform.Controls.Add(listView);\r\nlistView.Location = new Point(10, 10);\r\nlistView.Size = new Size(770, 200);\r\n\r\nform.Controls.Add(textBox);\r\ntextBox.Location = new Point(10, 220);\r\ntextBox.Size = new Size(770, 200);\r\n\r\nvar group1 = new ListViewGroup(\"Group 1\") { CollapsedState = ListViewGroupCollapsedState.Expanded };\r\nvar group2 = new ListViewGroup(\"Group 2\") { CollapsedState = ListViewGroupCollapsedState.Expanded };\r\n\r\nlistView.Groups.AddRange(new[] { group1, group2 });\r\nlistView.Items.Add(new ListViewItem(\"g1 - i1\", group1));\r\nlistView.Items.Add(new ListViewItem(\"g1 - i2\", group1));\r\nlistView.Items.Add(new ListViewItem(\"g1 - i3\", group1));\r\nlistView.Items.Add(new ListViewItem(\"g2 - i1\", group2));\r\nlistView.Items.Add(new ListViewItem(\"g2 - i2\", group2));\r\nlistView.Items.Add(new ListViewItem(\"g2 - i3\", group2));\r\n\r\nlistView.GroupCollapsedStateChanged += (_, e) =>\r\n{\r\n\ttextBox.Text = $\"{DateTime.Now.TimeOfDay}: CollapsedStateChanged for {listView.Groups[e.GroupIndex].Header}{Environment.NewLine}{textBox.Text}\";\r\n};\r\n\r\nform.ShowDialog();\r\n```","Url":"https://github.com/dotnet/winforms/issues/6708","RelatedDescription":"Open issue \"ListView.GroupCollapsedStateChanged fires with incorrect GroupIndex/doesn't fire at all\" (#6708)"},{"Id":"1141381370","IsPullRequest":false,"CreatedAt":"2022-02-17T14:04:31","Actor":"ThomasLee-Factbook","Number":"6707","RawContent":null,"Title":"NullReferenceException in CheckListBox","State":"open","Body":"* .NET Core Version: 6.0.102\r\n* Have you experienced this same bug with .NET Framework?: No\r\n\r\n**Problem description:**\r\nA NullReferenceException occurs in the CheckedListBox RefreshItems method when using a data source, see project [Example.zip](https://github.com/dotnet/winforms/files/8089130/Example.zip) .\r\n\r\n**Expected behavior:**\r\nNo exception is thrown.","Url":"https://github.com/dotnet/winforms/issues/6707","RelatedDescription":"Open issue \"NullReferenceException in CheckListBox\" (#6707)"},{"Id":"1141316013","IsPullRequest":true,"CreatedAt":"2022-02-17T13:38:26","Actor":"dotnet-maestro[bot]","Number":"6706","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220216.9\r\n- **Date Produced**: February 17, 2022 6:01:52 AM UTC\r\n- **Commit**: 793185a23907b941787fa5e9dab1524d0063df1f\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22115.15 to 7.0.0-preview.2.22116.9][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/32434f9...793185a\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6706)","Url":"https://github.com/dotnet/winforms/pull/6706","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6706)"},{"Id":"1141116408","IsPullRequest":false,"CreatedAt":"2022-02-17T09:58:22","Actor":"smohanty05","Number":"6705","RawContent":null,"Title":"WinForms Designer not loading  ","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: \r\n<!-- e.g. 3.0 Preview1, or daily build number, use `dotnet --info` -->\r\n6.0\r\n* Have you experienced this same bug with .NET Framework?: \r\n<!-- Yes / No -->\r\nNo\r\n**Problem description:**\r\n\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\nI have a solution file with 100+ projects. It is taking 1-5 to 2 minutes load a designer for a project. Other WinForm of the same project then loads quickly. But if we restart VS or reload project or make any changes to the project, then next WinForm load again taking 1-5 to 2 minutes.\r\nAlso I saw one case where it is not loading at all. Open one WinForm of Project1. While waiting, load another WinForm of Project2. After waiting for around 2 minutes, Project2 form designer opens. But Project1 form designer does not open at all. Even closing both forms and reopening Project1 form also does not solve it.\r\nWokaround: restart Visual Studio open the Project1 designer.\r\n\r\nHope you will resolve such issues.\r\n\r\n**Expected behavior:**\r\n<!--\r\n    Provide details on expected behavior with screenshots/GIF, where ever possible.\r\n -->\r\nWinForms designer should load always and also should not take long time to load.\r\n\r\n**Minimal repro:**\r\n<!--\r\n    Provide step by step guide to repro this issue.  Incase repro steps are complex, It would be helpful if \r\n    you attach a GIF with repro actions. Attaching a sample app to repro the issue will help speed up the \r\n    resolution. \r\n -->\r\nOpen one WinForm of Project1. \r\nWhile waiting, load another WinForm of Project2. After waiting for around 2 minutes,\r\n Project2 form designer opens. \r\nBut Project1 form designer does not open at all. Even closing both forms and reopening Project1 form also does not solve it.\r\n\r\nAfter that I tried couple of times, even after restating VS, Winforms not loading.\r\nGetting below error:\r\n[02:56:01.4218652] Processed 'System.Design' in 00:00:00.1833175\r\n[02:56:01.4788618] Added 'System.Design'\r\n[02:56:01.4788618] Loaded System.Drawing.Design in 00:00:00.0000201 [thread 30]\r\n[02:56:01.4818653] Processed 'System.Drawing.Design' in 00:00:00.0033208\r\n[02:56:01.4838625] Added 'System.Drawing.Design'\r\n[02:56:01.4988609] Creating VSCodeDomDesignerLoader\r\n[02:56:03.3968614] Current VS Version = 17.0\r\n[02:56:03.4029064] Start processing enqueued assemblies\r\n[02:56:05.4728612] Loaded Microsoft.WinForms.DesignTools.Protocol in 00:00:00.0000229 [thread 15]\r\n[02:56:05.4728612] Processed 'Microsoft.WinForms.DesignTools.Protocol' in 00:00:00.0000847\r\n[02:56:05.4758617] Added 'Microsoft.WinForms.DesignTools.Protocol'\r\n[02:56:05.4768616] Loaded Microsoft.WinForms.DesignTools.Client in 00:00:00.0000129 [thread 15]\r\n[02:56:05.4768616] Processed 'Microsoft.WinForms.DesignTools.Client' in 00:00:00.0000517\r\n[02:56:05.4788609] Added 'Microsoft.WinForms.DesignTools.Client'\r\n[02:56:26.4448613] [TestProj]: Preparing shadow cache folder\r\n[02:56:26.5018603] [TestProj]: Copying design tools server common files from: 'c:\\program files\\microsoft visual studio\\2022\\professional\\common7\\ide\\commonextensions\\microsoft\\windows.forms\\DesignToolsServer\\Common'\r\n[02:56:43.1938610] [TestProj]: Copying design tool server platform-specific files from: 'c:\\program files\\microsoft visual studio\\2022\\professional\\common7\\ide\\commonextensions\\microsoft\\windows.forms\\DesignToolsServer\\x64'\r\n[02:56:43.7488646] [TestProj]: Copying project output folder from: 'C:\\Users\\admin\\Test\\Core\\Goods\\Debug\\net6.0-windows'\r\n[02:58:09.7628609] [TestProj]: Copying 'C:\\Users\\admin\\Test\\TestProj\\obj\\Debug\\net6.0-windows\\TestProj.designer.deps.json' to 'DesignToolsServer.deps.json'\r\n[02:58:10.0968584] [TestProj]: Copying 'C:\\Users\\admin\\Test\\TestProj\\obj\\Debug\\net6.0-windows\\TestProj.designer.runtimeconfig.json' to 'DesignToolsServer.runtimeconfig.json'\r\n[02:59:02.5368609] [TestProj]: Launching design tools server process...\r\n[02:59:10.6518617] [TestProj]: Connected to named pipe: DesignToolsServer.8e987606-f748-4d4d-85e1-8371114185ed\r\n[02:59:10.6718605] [TestProj]: info: Design Tools Server[0]\r\n[02:59:10.6718605] [TestProj]:       Connecting to pipe: DesignToolsServer.8e987606-f748-4d4d-85e1-8371114185ed... \r\n[02:59:10.6868563] [TestProj]: info: Design Tools Server[0]\r\n[02:59:10.6868563] [TestProj]:       Successfully connected to pipe: DesignToolsServer.8e987606-f748-4d4d-85e1-8371114185ed\r\n[02:59:10.6868563] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:10.6868563] [TestProj]:       Creating DesignToolsServer [thread 1]\r\n[02:59:10.6988609] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:10.6988609] [TestProj]:       Performing start up tasks [thread 7]\r\n[02:59:10.7178614] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:10.7178614] [TestProj]:       Starting UI thread [thread 1]\r\n[02:59:11.3908585] [TestProj]: info: Design Tools Server[0]\r\n[02:59:11.3908585] [TestProj]:       UI thread started\r\n[02:59:11.4128615] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:11.4128615] [TestProj]:       Wait for start up tasks to complete... [thread 8]\r\n[02:59:11.9358620] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:11.9358620] [TestProj]:       Loaded server manifest [thread 7]\r\n[02:59:11.9468571] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.DesignToolsServer[0]\r\n[02:59:11.9468571] [TestProj]:       Loading design-time assemblies [thread 7]\r\n[02:59:18.6108583] [TestProj]: info: Microsoft.DotNet.DesignTools.Server.ServerProtocolContext[0]\r\n[02:59:18.6118592] [TestProj]:       Building MEF composition\r\n[02:59:20.7198643] [TestProj]: Timed out waiting for the design tools server process launch to complete.\r\n[02:59:20.7668637] Microsoft.DotNet.DesignTools.Client.ServerException: Timed out waiting for the design tools server process launch to complete.\r\n                      at Microsoft.DotNet.DesignTools.Client.Host.ServerProcess.<LaunchAsync>d__25.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                      at Microsoft.DotNet.DesignTools.Client.Host.ServerHostFactory.<CreateHostAsync>d__7.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n                      at Microsoft.DotNet.DesignTools.Client.DesignToolsClientLoader.<CreateClientAsync>d__35.MoveNext()\r\n                   --- End of stack trace from previous location where exception was thrown ---\r\n                      at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n                      at Microsoft.VisualStudio.Telemetry.WindowsErrorReporting.WatsonReport.GetClrWatsonExceptionInfo(Exception exceptionObject)\r\n\r\nError seen when opening any other WinForm of different project. Then I again reloaded project and this time it opened.\r\n\r\nSo the behavior is not consistent.","Url":"https://github.com/dotnet/winforms/issues/6705","RelatedDescription":"Open issue \"WinForms Designer not loading  \" (#6705)"},{"Id":"1140944782","IsPullRequest":false,"CreatedAt":"2022-02-17T06:54:35","Actor":"Amy-Li03","Number":"6704","RawContent":null,"Title":"Exception when clicking on the value of PropertyGrid's property under JAWS tool ","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: \r\n.NET SDK 7.0.100-preview.2.22103\r\n\r\n* Have you experienced this same bug with .NET Framework?: \r\nNo\r\n\r\n* More info: \r\n1. This issue reproduces on .NET 5.0 & .NET 6.0 & .NET 7.0 \r\n2. This issue doesn't repro on .NET Core 3.1 \r\n3. VS with other tool(e.g. Narrator) doesn't repro this issue \r\n\r\n**Steps to reproduce:**\r\n[TestApp.zip](https://github.com/dotnet/winforms/files/8086107/TestApp.zip)\r\n\r\n1. Create a .NET Core WinForms projects with any control added(E.g. Checkbox) \r\n2. Set the SelelctedObject property of propertyGrid to the checkBox control \r\n3. Run this project \r\n4. Launch the **JAWS** tool \r\n5. Clicking using mouse or press \"Tab\" keyboard on the value of propertyGrid's property \r\n![Actual](https://user-images.githubusercontent.com/62929087/154419615-f42458cc-c068-4610-94a3-61cfb5235bf8.gif)\r\n\r\n**Expected behavior:**\r\nNo exception was throwing.\r\n\r\n**Actual behavior:**\r\nThere is an exception was throwing \r\n![image](https://user-images.githubusercontent.com/62929087/154417935-4640850f-1776-4c47-9354-05da7615e447.png)\r\n\r\n**Call Stack:**\r\nSystem.ExecutionEngineException\r\n  HResult=0x80131506\r\n  Source= Cannot evaluate the exception source\r\n  StackTrace: Cannot evaluate the exception stack trace","Url":"https://github.com/dotnet/winforms/issues/6704","RelatedDescription":"Open issue \"Exception when clicking on the value of PropertyGrid's property under JAWS tool \" (#6704)"},{"Id":"1140931043","IsPullRequest":false,"CreatedAt":"2022-02-17T06:32:01","Actor":"greengumby","Number":"6703","RawContent":null,"Title":"winforms .net 6.0.2 SetHighDpiMode","State":"open","Body":".net 6.0.2 desktop sdk \r\n\r\nI am trying to understand how the following line impacts the scaling of controls.\r\n\r\nApplication.SetHighDpiMode(HighDpiMode.SystemAware);\r\n\r\nSpecifically a statusStrip with an embedded progress bar. (Splash Screen)\r\n\r\nIf I run the application without the SetHighDpiMode the progress bar is the correct height however with the SetHighDpiMode enabled the height seems to be around 300% larger vertically.  Horizontally there is no change to the design view.\r\n\r\nIn addition I have copied the form and startup code into a new project with no other dependencies and no vertical scaling is occurring.\r\n\r\nSo my question is where should I be looking to figure out what is influencing this control's height.  Other controls are impacted by this but as this is the first screen aka splash screen I thought it a simple form to start with.\r\n\r\nEdit:\r\n\r\nFound a setting under Display Settings -> Advanced Scaling Options -> Fix scaling for apps.\r\n\r\nToggling this setting off and then on seemed to fix the problem for the progress bar but the icons all still look very small. I'm guessing its supposed to scale the icon size but something is preventing this?\r\n\r\n\r\nThanks for any assistance you can provide.\r\n\r\n \r\n","Url":"https://github.com/dotnet/winforms/issues/6703","RelatedDescription":"Open issue \"winforms .net 6.0.2 SetHighDpiMode\" (#6703)"},{"Id":"1139768154","IsPullRequest":false,"CreatedAt":"2022-02-17T03:52:29","Actor":"Junjun-zhao","Number":"6700","RawContent":null,"Title":"[dotnet-sdk-7.0.100-preview.2.22114.1] DbTool get exception after launch and app crashs","State":"closed","Body":"**Application Name**: DbTool\r\n**OS**: Windows 10 RS5\r\n**CPU**: X64\r\n**.NET Build Number**: dotnet-sdk-7.0.100-preview.2.22114.1\r\n\r\n**Verify Scenarios:**\r\n1). Windows10 RS5 x64+dotnet-sdk-7.0.100-preview.2.22114.1: Fail\r\n2). Windows10 RS5 x64+dotnet-sdk-7.0.100-preview.1.22110.4: Pass\r\n3). Windows10 RS5 x64+dotnet-sdk-5.0.405-win-x64 (Default SDK): Pass\r\n\r\n**Github link for source code:**\r\nhttps://github.com/WeihanLi/DbTool\r\n\r\n**App Source and App Check at :** https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1483884\r\n\r\n\r\n**Findings**:\r\nWhen we create FolderBrowserDialog object, this issue only repro if we init Description property.\r\n\r\n   Description = \"this is test\", //if you remove this line, issue not repro\r\n\r\n**Minimal Repro steps:**\r\ndotnet-sdk-7.0.100-preview.2.22114.1 sdk should be installed on the machine. \r\nSample code attached. \r\n[WinFormsApp1 (1).zip](https://github.com/dotnet/winforms/files/8078546/WinFormsApp1.1.zip)\r\n\r\n1) Create .net7 Winform app\r\n2) Add FolderBrowserDialog and Button Component to form\r\n3) In Button click event, write this :\r\n```\r\n  private void button1_Click(object sender, EventArgs e)\r\n        {\r\n            var dialog = new System.Windows.Forms.FolderBrowserDialog\r\n            {\r\n                Description = \"this is test\", //if you remove this line, issue not repro\r\n                ShowNewFolderButton = true\r\n            };\r\n            if (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK) //error here\r\n            {\r\n\r\n            }\r\n        }\r\n```\r\n\r\n**Expected Result**: \r\nDialog will be closed.\r\n\r\n**Actual Result**:\r\nGet below exception:\r\n```\r\nSystem.InvalidCastException\r\n  HResult=0x80004002\r\n  Message=Unable to cast object of type 'FileOpenDialogWrapper' to type 'IFileDialogCustomize'.\r\n  Source=System.Private.CoreLib\r\n  StackTrace:\r\n   at System.Runtime.CompilerServices.CastHelpers.ChkCast_Helper(Void* toTypeHnd, Object obj)\r\n   at System.Windows.Forms.FolderBrowserDialog.SetDialogProperties(IFileDialog dialog)\r\n   at System.Windows.Forms.FolderBrowserDialog.TryRunDialogVista(IntPtr owner, Boolean& returnValue)\r\n   at System.Windows.Forms.FolderBrowserDialog.RunDialog(IntPtr hWndOwner)\r\n   at System.Windows.Forms.CommonDialog.ShowDialog(IWin32Window owner)\r\n   at WinFormsApp1.Form1.button1_Click(Object sender, EventArgs e) in C:\\Users\\v-altunc\\source\\repos\\WpfApp2\\WinFormsApp1\\Form1.cs:line 17\r\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\r\n   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)\r\n   at System.Windows.Forms.Control.WndProc(Message& m)\r\n   at System.Windows.Forms.ButtonBase.WndProc(Message& m)\r\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)\r\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, WM msg, IntPtr wparam, IntPtr lparam)\r\n   at Interop.User32.DispatchMessageW(MSG& msg)\r\n   at System.Windows.Forms.Application.ComponentManager.Interop.Mso.IMsoComponentManager.FPushMessageLoop(UIntPtr dwComponentID, msoloop uReason, Void* pvLoopData)\r\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(msoloop reason, ApplicationContext context)\r\n   at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(msoloop reason, ApplicationContext context)\r\n   at WinFormsApp1.Program.Main() in C:\\Users\\v-altunc\\source\\repos\\WpfApp2\\WinFormsApp1\\Program.cs:line 14\r\n\r\n  This exception was originally thrown at this call stack:\r\n    System.Windows.Forms.FolderBrowserDialog.SetDialogProperties(Interop.Shell32.IFileDialog)\r\n    System.Windows.Forms.FolderBrowserDialog.TryRunDialogVista(System.IntPtr, out bool)\r\n    System.Windows.Forms.FolderBrowserDialog.RunDialog(System.IntPtr)\r\n    System.Windows.Forms.CommonDialog.ShowDialog(System.Windows.Forms.IWin32Window)\r\n    WinFormsApp1.Form1.button1_Click(object, System.EventArgs) in Form1.cs\r\n    System.Windows.Forms.Button.OnMouseUp(System.Windows.Forms.MouseEventArgs)\r\n    System.Windows.Forms.Control.WmMouseUp(ref System.Windows.Forms.Message, System.Windows.Forms.MouseButtons, int)\r\n    System.Windows.Forms.Control.WndProc(ref System.Windows.Forms.Message)\r\n    System.Windows.Forms.ButtonBase.WndProc(ref System.Windows.Forms.Message)\r\n    System.Windows.Forms.Control.ControlNativeWindow.WndProc(ref System.Windows.Forms.Message)\r\n    ...\r\n    [Call Stack Truncated]\r\n```\r\n**Repro steps for affected app:**\r\n**This is .Net 5.0 app, but we are running it on 7.0, machine only have 7.0 installed, and DOTNET_ROLL_FORWARD_ON_NO_CANDIDATE_FX=2, so it runs on 7.0**\r\n1.Launch DbTool.exe.\r\n3.Input connection string: Server=(localdb)\\MSSQLLocalDB;Database=master.\r\n4.Select “SqlServer” item.\r\n5.Click Connect button.\r\n6.Check the item MSreplicationoptions.\r\n7.Click “导出C# Code” button.\r\n\r\n**Expected Result:**\r\nExport successful.\r\n\r\n**Actual Result:**\r\nIt shows error and crash.\r\n```\r\nApplication: DbTool.exe\r\nCoreCLR Version: 7.0.22.10302\r\n.NET Version: 7.0.0-preview.2.22103.2\r\nDescription: The process was terminated due to an unhandled exception.\r\nException Info: System.InvalidCastException: Unable to cast object of type 'FileOpenDialogWrapper' to type 'IFileDialogCustomize'.\r\nat System.Windows.Forms.FolderBrowserDialog.SetDialogProperties(IFileDialog dialog)\r\nat System.Windows.Forms.FolderBrowserDialog.TryRunDialogVista(IntPtr owner, Boolean& returnValue)\r\nat System.Windows.Forms.FolderBrowserDialog.RunDialog(IntPtr hWndOwner)\r\nat System.Windows.Forms.CommonDialog.ShowDialog(IWin32Window owner)\r\nat DbTool.MainWindow.ChooseFolder() in C:\\sourcr\\DbTool\\src\\DbTool\\MainWindow.xaml.cs:line 395\r\nat DbTool.MainWindow.ExportModel_Click(Object sender, RoutedEventArgs e) in C:\\sourcr\\DbTool\\src\\DbTool\\MainWindow.xaml.cs:line 145\r\nat System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\nat System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\r\nat System.Windows.Controls.Primitives.ButtonBase.OnClick()\r\nat System.Windows.Controls.Button.OnClick()\r\nat System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)\r\nat System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)\r\nat System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\nat System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)\r\nat System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)\r\nat System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\nat System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\r\nat System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)\r\nat System.Windows.Input.InputManager.ProcessStagingArea()\r\nat System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)\r\nat System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)\r\nat System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nat System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nat MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nat MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\r\nat System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\nat System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\nat System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)\r\nat MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\r\nat MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)\r\nat System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\r\nat System.Windows.Application.RunDispatcher(Object ignore)\r\nat System.Windows.Application.RunInternal(Window window)\r\nat DbTool.App.Main() in C:\\sourcr\\DbTool\\src\\DbTool\\obj\\Debug\\net5.0-windows\\App.g.cs:line 51\r\n\r\n```\r\n@dotnet-actwx-bot @dotnet/compat\r\n","Url":"https://github.com/dotnet/winforms/issues/6700","RelatedDescription":"Closed issue \"[dotnet-sdk-7.0.100-preview.2.22114.1] DbTool get exception after launch and app crashs\" (#6700)"},{"Id":"1140807295","IsPullRequest":false,"CreatedAt":"2022-02-17T02:40:42","Actor":"VinoWang01","Number":"6702","RawContent":null,"Title":"[Win11][.NETCore3.1]The project stops working when running Narrator and clicking the dropdown button several times on the propertyGrid control in runtime","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n**.NET Core Version:**\r\n\r\n- .NET Core 3.1.22\r\n\r\n<!-- e.g. 3.0 Preview1, or daily build number, use `dotnet --info` -->\r\n\r\n**Have you experienced this same bug with .NET Framework?:**\r\n\r\n- No\r\n\r\n<!-- Yes / No -->\r\n\r\n**Problem description:**\r\nThe application has stopped working when running Narrator and clicking the dropdown button several times on the propertyGrid control in runtime.\r\n![3 1_Win11_PropertyGrid_Crash](https://user-images.githubusercontent.com/90816462/154393478-2894e47f-9b8f-4924-92aa-9cbf97682d58.gif)\r\n\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\n![StopWorking](https://user-images.githubusercontent.com/90816462/154393703-d7bcc83a-619f-4c07-88b3-a83cabdc0ee8.png)\r\n\r\n\r\n**Expected behavior:**\r\nProject and Narrator both work well.\r\n<!--\r\n    Provide details on expected behavior with screenshots/GIF, where ever possible.\r\n -->\r\n\r\n**Minimal repro:**\r\n1. Create a .NET Core 3.1 Winforms project with ProeprtyGrid control added. \r\n2. Set the SelectedObject property to Form1. \r\n3. Build and run the project. \r\n4. Launch Narrator, then click the drop down button in the PropertyGrid control. \r\nor run the attached project and execute Step4.[3.1CoreApp.zip](https://github.com/dotnet/winforms/files/8085114/3.1CoreApp.zip)\r\n\r\n<!--\r\n    Provide step by step guide to repro this issue.  Incase repro steps are complex, It would be helpful if \r\n    you attach a GIF with repro actions. Attaching a sample app to repro the issue will help speed up the \r\n    resolution. \r\n -->\r\n**More Info:**\r\n1. This issue can't reproduce on win10. \r\n2. This issue can't reproduce with .net5.0, .net6.0, .net7.0. ","Url":"https://github.com/dotnet/winforms/issues/6702","RelatedDescription":"Open issue \"[Win11][.NETCore3.1]The project stops working when running Narrator and clicking the dropdown button several times on the propertyGrid control in runtime\" (#6702)"},{"Id":"1140001916","IsPullRequest":true,"CreatedAt":"2022-02-16T18:11:25","Actor":"dotnet-maestro[bot]","Number":"6701","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220215.15\r\n- **Date Produced**: February 16, 2022 10:44:27 AM UTC\r\n- **Commit**: 32434f9007428d7d806df6afce80c36a308c2fa0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22115.15][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/14e6411...32434f9\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6701)","Url":"https://github.com/dotnet/winforms/pull/6701","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6701)"},{"Id":"1139691075","IsPullRequest":false,"CreatedAt":"2022-02-16T08:31:19","Actor":"VinoWang01","Number":"6699","RawContent":null,"Title":"The ListView's GroupCollapsedStateChanged events no longer fire even if the CollapsedState is actually changed ","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n.NET Core Version: \r\n\r\n- .NET Core SDK: 7.0.100-PREVIEW.2.22115.2\r\n<!-- e.g. 3.0 Preview1, or daily build number, use `dotnet --info` -->\r\n\r\nHave you experienced this same bug with .NET Framework?: \r\n\r\n- No. `ListViewGroup.CollapsedState` was implemented in .NET Core 5.0 (https://github.com/dotnet/winforms/pull/3155) and from (https://github.com/dotnet/winforms/issues/5960)\r\n\r\n<!-- Yes / No -->\r\n\r\n**Problem description:**\r\nThe `expand/collapse` state is changed correctly, but the `GroupCollapsedStateChanged` events no longer fire.\r\n![NoFireEvent_Keyboard](https://user-images.githubusercontent.com/90816462/154224888-d0ac9441-0513-4d88-b553-00ea5bee94b6.gif)\r\n\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\n\r\n\r\n**Expected behavior:**\r\nThe `expand/collapse` state should be changed correctly and the `GroupCollapsedStateChanged` events should be fired.\r\n![NoFireEvent_Mouse](https://user-images.githubusercontent.com/90816462/154224933-cb42374a-7b82-4d11-b489-b6d8f01ab083.gif)\r\n\r\n<!--\r\n    Provide details on expected behavior with screenshots/GIF, where ever possible.\r\n -->\r\n\r\n**Minimal repro:**\r\n\r\n1. Run the Test app. [ListViewGroupState.zip](https://github.com/dotnet/winforms/files/8078074/ListViewGroupState.zip)\r\n2. Collapse the second ListViewGoup -- 'Expanded ListViewGroup'. \r\n3. Focus on the third `ListViewGroup group header` using keyboard -- 'Collapsed ListViewGroup'. \r\n4. Press left and right key arrows to see the behavior. \r\n\r\n<!--\r\n    Provide step by step guide to repro this issue.  Incase repro steps are complex, It would be helpful if \r\n    you attach a GIF with repro actions. Attaching a sample app to repro the issue will help speed up the \r\n    resolution. \r\n -->\r\n**More Info:**\r\nThis issue can't reproduce when the second ListViewGoup -- 'Expanded ListViewGroup' is keeping Expanded. ","Url":"https://github.com/dotnet/winforms/issues/6699","RelatedDescription":"Open issue \"The ListView's GroupCollapsedStateChanged events no longer fire even if the CollapsedState is actually changed \" (#6699)"},{"Id":"1139338981","IsPullRequest":true,"CreatedAt":"2022-02-16T00:53:17","Actor":"dreddy-work","Number":"6698","RawContent":null,"Title":"branding for 7.0 preview 3","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6698)","Url":"https://github.com/dotnet/winforms/pull/6698","RelatedDescription":"Closed or merged PR \"branding for 7.0 preview 3\" (#6698)"},{"Id":"1139334732","IsPullRequest":true,"CreatedAt":"2022-02-15T23:57:33","Actor":"dreddy-work","Number":"6697","RawContent":null,"Title":"7.0 preview 2 publishing APIs","State":"closed","Body":"none.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6697)","Url":"https://github.com/dotnet/winforms/pull/6697","RelatedDescription":"Closed or merged PR \"7.0 preview 2 publishing APIs\" (#6697)"},{"Id":"1138672507","IsPullRequest":true,"CreatedAt":"2022-02-15T18:01:07","Actor":"dotnet-maestro[bot]","Number":"6694","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220214.7\r\n- **Date Produced**: February 14, 2022 6:39:03 PM UTC\r\n- **Commit**: 6d977266bcc193caedb60a27ae44d14d9a11a040\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22111.10 to 7.0.0-beta.22114.7][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/ff6cc4e...6d97726\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6694)","Url":"https://github.com/dotnet/winforms/pull/6694","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6694)"},{"Id":"1138673626","IsPullRequest":true,"CreatedAt":"2022-02-15T13:45:45","Actor":"dotnet-maestro[bot]","Number":"6695","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220214.13\r\n- **Date Produced**: February 15, 2022 7:29:18 AM UTC\r\n- **Commit**: 14e64115c99bbad6f22a8e8331052c89e7006a89\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22113.2 to 7.0.0-preview.2.22114.13][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/6e05d78...14e6411\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6695)","Url":"https://github.com/dotnet/winforms/pull/6695","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6695)"},{"Id":"1138225228","IsPullRequest":false,"CreatedAt":"2022-02-15T06:26:10","Actor":"SimonCropp","Number":"6693","RawContent":null,"Title":"Did the System.Windows.Forms assembly version intentionally change in 6.0.2?","State":"closed","Body":"i updated my CI server to sdk 6.0.102 not when i try to run the output i get\r\n\r\n```\r\nUnhandled exception. System.IO.FileLoadException: Could not load file or assembly 'System.Windows.Forms, Version=6.0.2.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'. The located assembly's manifest definition does not match the assembly reference. (0x80131040)\r\nFile name: 'System.Windows.Forms, Version=6.0.2.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'\r\n   at Program.Main()\r\n   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.Start[TStateMachine](TStateMachine& stateMachine)\r\n   at Program.Main()\r\n   at Program.<Main>()\r\n```","Url":"https://github.com/dotnet/winforms/issues/6693","RelatedDescription":"Closed issue \"Did the System.Windows.Forms assembly version intentionally change in 6.0.2?\" (#6693)"},{"Id":"1138093918","IsPullRequest":true,"CreatedAt":"2022-02-15T02:28:07","Actor":"kant2002","Number":"6692","RawContent":null,"Title":"Explicitly use ComWrappers for file dialogs","State":"open","Body":"Do not use COM interfaces for file dialogs at all except IFileDialogEvents\r\nRight now each CoClass created using CoCreateInstance represented as unique RCW\r\nThat RCW still uses interfaces, but all important methods are implicitly declares\r\nNo explicit interface method of IFileDialog, IOpenFileDialog and ISaveFileDialog\r\nare used.\r\nIShellItem and IShellItemArray still used, but that usage comes from IXXXFileDialog\r\ninterfaces. If I remove them, I can be explicit about wrappers.\r\n\r\nAfter this point, there two options\r\n- Leave interfaces as is, wasteful RCW, good for documentation\r\n- Remove interfaces, simplify RCW even more. Keeping track of method table would be problematic.\r\n\r\nRelated to #5163\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6692)","Url":"https://github.com/dotnet/winforms/pull/6692","RelatedDescription":"Open PR \"Explicitly use ComWrappers for file dialogs\" (#6692)"},{"Id":"1137279251","IsPullRequest":true,"CreatedAt":"2022-02-14T13:43:54","Actor":"dotnet-maestro[bot]","Number":"6691","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220213.2\r\n- **Date Produced**: February 13, 2022 7:28:25 PM UTC\r\n- **Commit**: 6e05d78deba320a54ef10a265c6025bbb686efe6\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22112.5 to 7.0.0-preview.2.22113.2][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/78c6505...6e05d78\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6691)","Url":"https://github.com/dotnet/winforms/pull/6691","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6691)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-02-20T03:30:34.9453233Z","RunDurationInMilliseconds":563}