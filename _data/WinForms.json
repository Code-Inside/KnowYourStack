{"Data":{"GitHub":{"Issues":[{"Id":"3683728520","IsPullRequest":true,"CreatedAt":"2025-12-02T03:14:47","Actor":"dotnet-maestro[bot]","Number":"14097","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251201.7](https://dev.azure.com/dnceng/internal/_build/results?buildId=2851238) ([292866](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/292866))\n- **Date Produced**: December 1, 2025 9:17:43 PM UTC\n- **Commit**: [5b183502227a7fe4bec508d1513c016f6eb9783e](https://github.com/dotnet/dotnet/commit/5b183502227a7fe4bec508d1513c016f6eb9783e)\n- **Commit Diff**: [3b5d49b...5b18350](https://github.com/dotnet/dotnet/compare/3b5d49bb1053c228d431a7ea95a8bec6f9f16ab1...5b183502227a7fe4bec508d1513c016f6eb9783e)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25578.104 to 11.0.0-beta.25601.107][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25578.104 to 10.0.0-rc.3.25601.107][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/3b5d49bb10...5b18350222\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/efcore/compare/f564ef9aaa805ae393fc3c55c085faf9fd5fb4d8...94ccee9f77787d406c5ac65e51303189f68640b2\n- https://github.com/dotnet/fsharp/compare/5aa719d00236821810ec93eeafbfa834be60b5a9...0e969242d8e7a71e025ed965246e7b033b0d2b17\n- https://github.com/microsoft/vstest/compare/81d120f85fbdddc7b981e910a127bd6ef913cd42...154e8babf0b97312a403b6ccf84cf1498a32ecea\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:5b183502227a7fe4bec508d1513c016f6eb9783e..https://github.com/dotnet/winforms:darc-main-83372f92-4d3d-413c-b0c8-878e962b69c0\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14097)","Url":"https://github.com/dotnet/winforms/pull/14097","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14097)"},{"Id":"3683686851","IsPullRequest":true,"CreatedAt":"2025-12-02T02:08:41","Actor":"dotnet-maestro[bot]","Number":"14096","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"open","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20251201.2](https://dev.azure.com/dnceng/internal/_build/results?buildId=2850897) ([292766](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/292766))\n- **Date Produced**: December 1, 2025 4:54:07 PM UTC\n- **Commit**: [f2d1a92c2429848e41e78af560381a597f933090](https://github.com/dotnet/dotnet/commit/f2d1a92c2429848e41e78af560381a597f933090)\n- **Commit Diff**: [9a7c556...f2d1a92](https://github.com/dotnet/dotnet/compare/9a7c556a0ae21ca493352b21bd297e00e8a5f26d...f2d1a92c2429848e41e78af560381a597f933090)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.25575.107 to 10.0.0-beta.25601.102][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.2 to 10.0.2][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.2-servicing.25575.107 to 10.0.2-servicing.25601.102][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/9a7c556a0a...f2d1a92c24\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/efcore/compare/deb7fa06d10551d5ee6234b9c3241752812d7ab2...e917384820e7beb737b279975b5b167324b71cd9\n- https://github.com/dotnet/runtime/compare/4158bc448bdc5850f80307058b9b0b6bad257815...baf4eb1e0b672338897fc20de49daffe5f84569c\n- https://github.com/dotnet/sdk/compare/210c54ebf4a0d3bdb397734b417449596021da5b...e3fdff8d59c9433d256d4d71903239a4ef2d3b23\n- https://github.com/dotnet/source-build-reference-packages/compare/8a350977e236389714dd5d66be46e31ebb1f51ce...f72a9ff20e399ce26ef282b4979750de302e3f42\n- https://github.com/dotnet/sourcelink/compare/a5cc3d4a30b41f1fb0c1a7e12cdede6f4d0c2282...aac1618190641140df043b1197fbbbe30115df69\n- https://github.com/dotnet/windowsdesktop/compare/46ef7f96e8c75f56c4b699553fab1112e4588c92...3db2bb9b7ab2ae49b3ddd1750b1188c744e24f5e\n- https://github.com/dotnet/winforms/compare/39cd7f5d7f267a3632da1ebaeccfb6173e1dd540...f9ca34ff38e11eda610a4b380a41c30a1cd1dade\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:f2d1a92c2429848e41e78af560381a597f933090..https://github.com/dotnet/winforms:darc-release/10.0-fca79058-a87a-479a-a68b-40c3ed4f56db\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14096)","Url":"https://github.com/dotnet/winforms/pull/14096","RelatedDescription":"Open PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14096)"},{"Id":"3665346060","IsPullRequest":true,"CreatedAt":"2025-12-01T23:23:59","Actor":"dotnet-maestro[bot]","Number":"14084","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20251125.7](https://dev.azure.com/dnceng/internal/_build/results?buildId=2847483) ([292370](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/292370))\n- **Date Produced**: November 26, 2025 12:19:37 AM UTC\n- **Commit**: [9a7c556a0ae21ca493352b21bd297e00e8a5f26d](https://github.com/dotnet/dotnet/commit/9a7c556a0ae21ca493352b21bd297e00e8a5f26d)\n- **Commit Diff**: [1483376...9a7c556](https://github.com/dotnet/dotnet/compare/1483376c1a0ffb1e5f197266578dbce1e4098783...9a7c556a0ae21ca493352b21bd297e00e8a5f26d)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.25574.102 to 10.0.0-beta.25575.107][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.2 to 10.0.2][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.2-servicing.25574.102 to 10.0.2-servicing.25575.107][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/1483376c1a...9a7c556a0a\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/efcore/compare/d54ecf2ed5a399ac4711d242b27c38c2595c27bb...deb7fa06d10551d5ee6234b9c3241752812d7ab2\n- https://github.com/dotnet/roslyn/compare/6c4a46a31302167b425d5e0a31ea83c9a9aa1d09...7f327e02b43a2486faa9cfdf0a1eae34c06e2d1a\n- https://github.com/dotnet/runtime/compare/eef1961c35dd10d02f6dc0b4d23d0334ba0ee35d...4158bc448bdc5850f80307058b9b0b6bad257815\n- https://github.com/dotnet/sdk/compare/bda1e4cdd40e62c6f70e360be44afd70fed52c36...210c54ebf4a0d3bdb397734b417449596021da5b\n- https://github.com/dotnet/sourcelink/compare/f854fc15a677a0a11e4541cfecdc9a33624dbca1...a5cc3d4a30b41f1fb0c1a7e12cdede6f4d0c2282\n- https://github.com/dotnet/windowsdesktop/compare/b1a104c98368bbf8feaa5d92cbd691cc8c450c2d...46ef7f96e8c75f56c4b699553fab1112e4588c92\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:9a7c556a0ae21ca493352b21bd297e00e8a5f26d..https://github.com/dotnet/winforms:darc-release/10.0-75020efd-43b0-4720-94d1-57e77a1ed83b\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14084)","Url":"https://github.com/dotnet/winforms/pull/14084","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14084)"},{"Id":"3673395372","IsPullRequest":true,"CreatedAt":"2025-12-01T22:46:32","Actor":"dotnet-maestro[bot]","Number":"14090","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251128.4](https://dev.azure.com/dnceng/internal/_build/results?buildId=2849358) ([292651](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/292651))\n- **Date Produced**: November 28, 2025 5:07:19 PM UTC\n- **Commit**: [3b5d49bb1053c228d431a7ea95a8bec6f9f16ab1](https://github.com/dotnet/dotnet/commit/3b5d49bb1053c228d431a7ea95a8bec6f9f16ab1)\n- **Commit Diff**: [305623c...3b5d49b](https://github.com/dotnet/dotnet/compare/305623c3cd0df455e01b95ed3a8c347e650b315f...3b5d49bb1053c228d431a7ea95a8bec6f9f16ab1)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25576.105 to 11.0.0-beta.25578.104][2]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25576.105 to 10.0.0-rc.3.25578.104][2]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n\n[1]: https://github.com/dotnet/dotnet/compare/305623c3cd...791f8df110\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14090)\n[2]: https://github.com/dotnet/dotnet/compare/305623c3cd...3b5d49bb10\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/3b674da67a2fcf9bb98120e94470eeb177c33e2f...70d851104f739fb906aabcd6a07c0935ce2549c9\n- https://github.com/dotnet/efcore/compare/bbf6760eaf227f8617ea70a24f9eb492f3bbb603...f564ef9aaa805ae393fc3c55c085faf9fd5fb4d8\n- https://github.com/dotnet/msbuild/compare/59a17ea096ff5ac9433dc64cda3098a00cd3deb9...6ae7bab3a992bdecaa5ee36a6bd5967281cec2d0\n- https://github.com/dotnet/wpf/compare/92841b9f489654b1b59d8639623e8f678228aebd...038222ac08b36950e581b4eebad21d901df2d084\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:3b5d49bb1053c228d431a7ea95a8bec6f9f16ab1..https://github.com/dotnet/winforms:darc-main-935df902-3aeb-4f04-8cb6-89df8c808dac\n-->\n[marker]: <> (End:Footer:CodeFlow PR)","Url":"https://github.com/dotnet/winforms/pull/14090","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14090)"},{"Id":"3682905163","IsPullRequest":false,"CreatedAt":"2025-12-01T21:17:44","Actor":"ChristopherDShea","Number":"14095","RawContent":null,"Title":"While EnableVisualStyles is false, MonthCalendar HitTest() does not return a valid HitTestInfo when clicking anywhere on the control.","State":"open","Body":"### .NET version\n\nTested in current versions:  .NET8, .NET9 and .NET10, and the issue exists in all versions.\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nIssue exists in older versions (.NET5) as well.\n\n### Issue description\n\nWhile EnableVisualStyles is set to false, MonthCalendar HitTest() does not return a valid HitTestInfo when clicking any of the valid areas on the control. It always returns a HitArea of Nowhere. This exact scenario works fine in .NET Framework, and it works correctly if EnableVisualStyles is true.\n\n### Steps to reproduce\n\n[IsolatedSample.zip](https://github.com/user-attachments/files/23865144/IsolatedSample.zip)\n\nSteps:\n1. Run the attached sample.\n2. Click anywhere on the MonthCalendar.\n\nResults:\nThe listbox shows displays the Point and HitArea which is always \"Nowhere\"","Url":"https://github.com/dotnet/winforms/issues/14095","RelatedDescription":"Open issue \"While EnableVisualStyles is false, MonthCalendar HitTest() does not return a valid HitTestInfo when clicking anywhere on the control.\" (#14095)"},{"Id":"3679684767","IsPullRequest":false,"CreatedAt":"2025-12-01T07:39:36","Actor":"Amy-Li03","Number":"14094","RawContent":null,"Title":"After reducing the form width, clicking the ToolStrip options triggers a Win32Exception error","State":"open","Body":"### .NET version\n\n.NET SDK 10.0.00-rtm.25523.111\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNo, it still repro on .NET 8.0 and .NET 9.0\n\n\n### Issue description\n\nWhen the form width is reduced to prevent Toolstrip items from displaying, clicking the ToolBar Options throws a **System.ComponentModel.Win32Exception (0x80004005): Failed to set Win32 parent window of the Control** error.\n\n.NET project\n![Image](https://github.com/user-attachments/assets/65356f1e-a8c9-49d2-b8d5-ce590cd57cc7)\n\n.NET framework project\n![Image](https://github.com/user-attachments/assets/0048da86-8850-477a-868e-ebb1f0ecb40e)\n\n**Call Stack**\n```\nSee the end of this message for details on invoking \njust-in-time (JIT) debugging instead of this dialog box.\n\n************** Exception Text **************\nSystem.ComponentModel.Win32Exception (0x80004005): Failed to set Win32 parent window of the Control.\n   at System.Windows.Forms.Control.SetParentHandle(HWND value)\n   at System.Windows.Forms.Control.CreateControl(Boolean ignoreVisible)\n   at System.Windows.Forms.Control.CreateControl()\n   at System.Windows.Forms.Control.WmShowWindow(Message& m)\n   at System.Windows.Forms.Control.WndProc(Message& m)\n   at System.Windows.Forms.ToolStrip.WndProc(Message& m)\n   at System.Windows.Forms.NativeWindow.Callback(HWND hWnd, UInt32 msg, WPARAM wparam, LPARAM lparam)\n```\n\n### Steps to reproduce\n\n1. Create a WinForms .NET project\n2. Add a ToolStrip to form designer\n3. Add toolStripComboBox and toolStripProgressBar to ToolStrip control\n4. Ctrl + F5 to run this project\n5. Narrow down the width of form to make sure no toolstrip Item display on form designer\n6. Click on the ToolBar Options","Url":"https://github.com/dotnet/winforms/issues/14094","RelatedDescription":"Open issue \"After reducing the form width, clicking the ToolStrip options triggers a Win32Exception error\" (#14094)"},{"Id":"3677900013","IsPullRequest":false,"CreatedAt":"2025-11-30T15:16:46","Actor":"Senthilkumar0803","Number":"14093","RawContent":null,"Title":"Multi Select Enum Editor (UITypeEditor) Not Working Properly in .NET Core","State":"open","Body":"### Environment\n\nVisual Studio 2026 - version 18.0.2\n\n### .NET version\n\n.NET 80, .NET90 and .NET10\n\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\n\nNo\n\n### Issue description\n\n#### Case 1: Comparsion of Net Framework and UITypeEditor Usage Without Client/Server Implementation\nIn .NET Framework, the custom EnumEditor (derived from UITypeEditor) works as expected. It displays a dropdown editor with checkboxes and a reset button.\nIn .NET Core, the same editor does not render correctly â€” the checkboxes and button are missing from the dropdown.\n\n#### Case 2: UITypeEditor Usage With Client/Server Approach Fails\nWe attempted to use the EnumEditor on the client side in a .NET Core client/server approach.\nThe editor still fails to render properly and throws an ArgumentException.\nUpon further analysis, we found that the value parameter in the EditValue method does not contain the expected enum value.\nInstead, it shows the: \"Cannot evaluate expression since the function evaluation requires all threads to run.\"\n\n**Additionally, based on this query - https://github.com/dotnet/winforms/issues/13987**\n\nWe reviewed the internal issue link you provided, but unfortunately, it's not accessible to us and returns a 404 error. Regarding the blog post you shared (https://devblogs.microsoft.com/dotnet/custom-controls-for-winforms-out-of-process-designer/), we had already received it as a recommendation earlier and have implemented the client-server approach based on the guidance provided there.\n\nHowever, even after implementing the client-server model, we are still facing issues with enum types not being handled correctly. Could you please provide further guidance or a more specific solution to address this issue?\n\n**.NET Core Demo Link**\n[CustomControlLibrary.NetCore._WithSample.Nuget.zip](https://github.com/user-attachments/files/23840285/CustomControlLibrary.NetCore._WithSample.Nuget.zip)\n\n**.NET Framework Demo Link**\n\n[CustomControlLibrary.NetFramework._WithSample.Nuget.zip](https://github.com/user-attachments/files/23840289/CustomControlLibrary.NetFramework._WithSample.Nuget.zip)\n\n#### Issue Replication Video\n**.NET Framework**\n\nhttps://github.com/user-attachments/assets/6eaff698-e1e1-4c1f-b496-b01f463d0064\n\n**.NET Core**\n\nhttps://github.com/user-attachments/assets/17d7ed0c-68c8-4d27-82a8-124e9695815c\n\n### Steps to reproduce\n\n1. Open the Designer.\n2. Click the CustomControl and go to the property window.\n3. Now, open the dropdown of the \"CustomProperty\" property.\n\n**Note**: An exception occurs when we click the dropdown again or click on the property window after opening the dropdown.\n\n**Observed Behavior** - The UITypeEditor implemented in the client project does not work.\n**Expected Behavior** - The UITypeEditor implemented in the client project should work properly.\n\n### Diagnostics\n\n```text\n\n```","Url":"https://github.com/dotnet/winforms/issues/14093","RelatedDescription":"Open issue \"Multi Select Enum Editor (UITypeEditor) Not Working Properly in .NET Core\" (#14093)"},{"Id":"3676184735","IsPullRequest":true,"CreatedAt":"2025-11-29T01:21:22","Actor":"ricardobossan","Number":"14092","RawContent":null,"Title":"Adds ExpandColapse pattern to SplitButton","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes [#4173](https://github.com/microsoft/winforms-designer/issues/4173)\r\n\r\n\r\n## Proposed changes\r\n\r\n- \r\n- \r\n- \r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- \r\n- \r\n\r\n## Regression? \r\n\r\n- Yes / No\r\n\r\n## Risk\r\n\r\n-\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n<!-- TODO -->\r\n\r\n### After\r\n\r\n<!-- TODO -->\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- \r\n- \r\n- \r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n\r\n<!--\r\n     Microsoft prioritizes making our products accessible. \r\n     WinForms has a key role in allowing developers to create accessible apps. \r\n     \r\n     When submitting a change which impacts UI in any way, including adding new UI or\r\n     modifying existing controls the developer needs to run the Accessibility Insights\r\n     tool (https://accessibilityinsights.io/) and verify that there are no changes or\r\n     regressions. \r\n     \r\n     The developer should run the Fast Pass over the impacted control(s) and provide\r\n     a snapshot of the passing results along with before/after snapshots of the UI.\r\n     More info: (https://accessibilityinsights.io/docs/en/web/getstarted/fastpass)\r\n  -->\r\n\r\n\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- <!-- use `dotnet --info` -->\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14092)","Url":"https://github.com/dotnet/winforms/pull/14092","RelatedDescription":"Open PR \"Adds ExpandColapse pattern to SplitButton\" (#14092)"},{"Id":"3674401344","IsPullRequest":false,"CreatedAt":"2025-11-28T10:27:55","Actor":"FrankBatista09","Number":"14091","RawContent":null,"Title":"An error occurred while validating. HRESULT = '80004005'","State":"open","Body":"I'm implementing CI/CD for a couple applications using GithubActions in GHES with a self-hosted runner and I've been facing this problem \"An error occurred while validating. HRESULT = '80004005'\" for days. The project is in .NET Framework 4.7.2 and I'm using Visual Studio Community 2022\n\nTo give more context, I'm building a .vdproj to generate the msi installer, this is the whole error:\n\nWARNING: Unable to find dependency 'CEFSHARP' (Signature='40C4B6FC221F4138' Version='121.3.70.0') of assembly 'CefSharp.BrowserSubprocess.exe' WARNING: Unable to find dependency 'CEFSHARP' (Signature='40C4B6FC221F4138' Version='121.3.70.0') of assembly 'CefSharp.BrowserSubprocess.Core.dll' ERROR: An error occurred while validating. HRESULT = '80004005'\n\nTo give more context, the vdproj is in a sln together with a ClickOnce project, I'm restoring the dependencies of the solution using nuget restore then I'm building the clickonce with project with msbuild and after that I'm building the vdproj using devenv.com\n\nI have already set the DWORD for the registries even though they have the same purpose.\n\nEnableOutOfProcBuild = 0\n\nDisableOutOfProcBuild = 1\n\nI was having a similar problem with another vdproj in the exact same conditions and I could solve it with setting the DWORD and as I'm creating my own yaml templates I just had to checkout the new repo and add the path of sln, csproj and vdproj to my powershell step but now it's not working does not matter what.\n\nThis was the first error I was getting and I could solve\n\nWARNING: Unable to find dependency 'CEFSHARP' (Signature='40C4B6FC221F4138' Version='94.4.110.0') of assembly 'CefSharp.BrowserSubprocess.exe' WARNING: Unable to find dependency 'CEFSHARP' (Signature='40C4B6FC221F4138' Version='94.4.110.0') of assembly 'CefSharp.BrowserSubprocess.Core.dll' ERROR: An error occurred while validating. HRESULT = '8000000A'\n\nThe only differences are the HRESULT code and the version of the dependencies","Url":"https://github.com/dotnet/winforms/issues/14091","RelatedDescription":"Open issue \"An error occurred while validating. HRESULT = '80004005'\" (#14091)"},{"Id":"3669717333","IsPullRequest":true,"CreatedAt":"2025-11-27T07:53:47","Actor":"Copilot","Number":"14088","RawContent":null,"Title":"Fix Bitmap property serialization error in custom control designer","State":"closed","Body":"Fixes #14080\n\n## Proposed changes\n\n- Add identity conversion support to `ImageConverter` for Image types (Image, Bitmap, Metafile)\n- `CanConvertTo` now returns `true` for Image-derived types\n- `ConvertTo` returns the value as-is when destination is an Image type\n\nThe VS Designer property browser validates serialization by checking `TypeConverter.CanConvertTo(propertyType)`. For Bitmap properties, `ImageConverter.CanConvertTo(typeof(Bitmap))` was returning `false`, causing validation to fail even though actual serialization via byte[] â†’ resources works correctly.\n\n## Customer Impact\n\n- Custom controls with `Bitmap` properties can now set images via Properties window without serialization errors\n- No change to actual serialization behavior - images still serialize to resources via byte[]\n\n## Regression? \n\n- No\n\n## Risk\n\n- Low. Identity conversion is semantically correct for Image types. Existing byte[] serialization path unchanged.\n\n## Test methodology\n\n- Updated `ImageConverterTests.cs` to verify new `CanConvertTo` and `ConvertTo` behavior for Image types\n- Existing tests for non-Image types remain unchanged and pass\n\n> [!WARNING]\n>\n> <details>\n> <summary>Firewall rules blocked me from connecting to one or more addresses (expand for details)</summary>\n>\n> #### I tried to connect to the following addresses, but was blocked by firewall rules:\n>\n> - `0t3vsblobprodcus362.vsblob.vsassets.io`\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet restore` (dns block)\n> - `c50vsblobprodcus330.vsblob.vsassets.io`\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet restore` (dns block)\n> - `rcxvsblobprodcus328.vsblob.vsassets.io`\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet msbuild /m /nologo /clp:Summary /v:minimal /nr:true /warnaserror /p:TreatWarningsAsErrors=true /p:ContinuousIntegrationBuild=false /home/REDACTED/work/winforms/winforms/artifacts/toolset/restore.proj /t:__WriteToolsetLocation /clp:ErrorsOnly;NoSummary /p:__ToolsetLocationOutputFile=/home/REDACTED/work/winforms/winforms/artifacts/toolset/11.0.0-beta.25576.105.txt stViewActionListTests.cs ./src/System.Private.Windows.Corgrep grep ows/Forms/TableLayoutColumnStyleCollectionTests.cs SerializeToResourceExpression\\|R./src/System.Windows.Forms.Primigrep ./src/System.Windows.Forms/Systegrep` (dns block)\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet restore` (dns block)\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet msbuild /m /nologo /clp:Summary /v:minimal /nr:true /warnaserror /p:TreatWarningsAsErrors=true /p:ContinuousIntegrationBuild=false /home/REDACTED/work/winforms/winforms/artifacts/toolset/restore.proj /bl:/home/REDACTED/work/winforms/winforms/artifacts/log/Debug/ToolsetRestore.binlog /t:__WriteToolsetLocation /clp:ErrorsOnly;NoSummary /p:__ToolsetLocationOutputFile=/home/REDACTED/work/winforms/winforms/artifacts/toolset/11.0.0-beta.25576.105.txt ./src/System.Windows.Forms.Primigrep grep awing.Imaging/PngCodecTests.cs` (dns block)\n>\n> If you need me to access, download, or install something from one of these locations, you can either:\n>\n> - Configure [Actions setup steps](https://gh.io/copilot/actions-setup-steps) to set up my environment, which run before the firewall is enabled\n> - Add the appropriate URLs or hosts to the custom allowlist in this repository's [Copilot coding agent settings](https://github.com/dotnet/winforms/settings/copilot/coding_agent) (admins only)\n>\n> </details>\n\n<!-- START COPILOT CODING AGENT SUFFIX -->\n\n\n\n<details>\n\n<summary>Original prompt</summary>\n\n> \n> ----\n> \n> *This section details on the original issue you should resolve*\n> \n> <issue_title>Bitmap Property Serialization Error in Custom Control</issue_title>\n> <issue_description>## Environment\n> Visual Studio professional 2026 - version 18.0.0\n> \n> ## .NET version\n> Facing this issue in .NetCore \n> \n> ## Did this work in a previous version of Visual Studio and/or previous .NET release?\n> No\n> \n> ## Issue Description\n> I have a property of type Bitmap. When I add an image using this property, the following issue occurs: **Property value is not valid (Could not serialize value 'System.Drawing.Bitmap' as 'System.Drawing.Bitmap').**\n> \n> ### Demo Link\n> [CustomControl_Bitmap_Issue.zip](https://github.com/user-attachments/files/23739030/CustomControl_Bitmap_Issue.zip)\n> \n> ### Issue replication video\n> \n> https://github.com/user-attachments/assets/bd038418-f826-48cf-9fa6-f8d8f64e2c50\n> \n> ### Steps to reproduce\n> \n> 1. Open the Designer.\n> 2. Select the CustomButton and go to the Properties window.\n> 3. Click the Icon property and try to add an image.\n> \n> **Expected Behavior:** The image should be added properly when adding it through the Icon property.\n> **Observed Behavior:** The image was not added properly.</issue_description>\n> \n> ## Comments on the Issue (you are @copilot in this section)\n> \n> <comments>\n> </comments>\n> \n\n\n</details>\n\n- Fixes dotnet/winforms#14080\n\n<!-- START COPILOT CODING AGENT TIPS -->\n---\n\nðŸ’¬ We'd love your input! Share your thoughts on Copilot coding agent in our [2 minute survey](https://gh.io/copilot-coding-agent-survey).\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14088)","Url":"https://github.com/dotnet/winforms/pull/14088","RelatedDescription":"Closed or merged PR \"Fix Bitmap property serialization error in custom control designer\" (#14088)"},{"Id":"3670219474","IsPullRequest":false,"CreatedAt":"2025-11-27T07:39:57","Actor":"Zheng-Li01","Number":"14089","RawContent":null,"Title":"[Dark Mode] the text of the disabled items still is visible after focus on it by using mouse when setting the RenderMode as System","State":"open","Body":"### .NET version\n\nlatest .NET 10.0 build\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\nNot reproduce 10.0 Preview4 that all disabled items cannot be focused by using mouse.\n\n### Issue description\n\nThe text of the disabled items still is visible after focus on it by using mouse when setting the RenderMode as System\n**Expected Results:**\n\nhttps://github.com/user-attachments/assets/9122b887-2129-474a-bba6-987ba11a2c6b\n\n**Actual Results:**\n\nhttps://github.com/user-attachments/assets/a78f1881-59dc-48c7-ad01-5960c9d31b39\n\n### Steps to reproduce\n\n1. Create a .NET winforms project with a MenuStrip control\n2. Setting the RenderMode property as System for menuStrip1\n3. Add some subitems for the menustrip1, and set the Enable as False for the subitem\n4. Set app under Dark mode in program.cs file:\n`Application.SetColorMode(SystemColorMode.Dark);`\n5. Run the application\n\n**More info:**\n1. The issue cannot reproduce when setting the RenderMode as ManagerRenderMode/Professional","Url":"https://github.com/dotnet/winforms/issues/14089","RelatedDescription":"Open issue \"[Dark Mode] the text of the disabled items still is visible after focus on it by using mouse when setting the RenderMode as System\" (#14089)"},{"Id":"3669606006","IsPullRequest":true,"CreatedAt":"2025-11-27T02:54:02","Actor":"dotnet-maestro[bot]","Number":"14087","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251126.5](https://dev.azure.com/dnceng/internal/_build/results?buildId=2848176) ([292465](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/292465))\n- **Date Produced**: November 26, 2025 9:19:03 PM UTC\n- **Commit**: [305623c3cd0df455e01b95ed3a8c347e650b315f](https://github.com/dotnet/dotnet/commit/305623c3cd0df455e01b95ed3a8c347e650b315f)\n- **Commit Diff**: [de417a6...305623c](https://github.com/dotnet/dotnet/compare/de417a619f09820da5e8403783f56cdcbafbae9c...305623c3cd0df455e01b95ed3a8c347e650b315f)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25575.110 to 11.0.0-beta.25576.105][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25575.110 to 10.0.0-rc.3.25576.105][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/de417a619f...305623c3cd\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/9a99542f9b72dbcd0e07baec5166909ab756788a...e29f11a331730bd4f51024ba83fa067d2ab80ca9\n- https://github.com/dotnet/aspnetcore/compare/da2e7e169aa20f3c9d52c5f839f1965a1c083a9b...3b674da67a2fcf9bb98120e94470eeb177c33e2f\n- https://github.com/dotnet/efcore/compare/3b4ee038903cb47bf0f54762cc7f7d4551f1efc4...bbf6760eaf227f8617ea70a24f9eb492f3bbb603\n- https://github.com/dotnet/fsharp/compare/92987807b81666221740443a47e26023a03181de...5aa719d00236821810ec93eeafbfa834be60b5a9\n- https://github.com/dotnet/msbuild/compare/92198f54c81842e6fd851c626f48713849b9cb99...59a17ea096ff5ac9433dc64cda3098a00cd3deb9\n- https://github.com/dotnet/sourcelink/compare/25fdaee99efa095bdeeb1c0f7bda13a10ed7c8d5...c84e22bedd248cae51c24bdef5cf4022409fc671\n- https://github.com/dotnet/winforms/compare/e237b3cbd7a7413161529a819b2e67bf3b18f31c...1a8c138be340d80c7e288e044e8a80b7f4adeb1b\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:305623c3cd0df455e01b95ed3a8c347e650b315f..https://github.com/dotnet/winforms:darc-main-60ad8d01-8ad5-4f7d-b3d9-dd6f22daed51\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14087)","Url":"https://github.com/dotnet/winforms/pull/14087","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14087)"},{"Id":"3669500768","IsPullRequest":true,"CreatedAt":"2025-11-27T02:13:39","Actor":"Copilot","Number":"14086","RawContent":null,"Title":"Add IsHandleCreated checks before calling SetWindowPos in DesignerFrame","State":"closed","Body":"Fixes #14081 \r\n\r\n## Proposed changes\r\n\r\n- Add `IsHandleCreated` guard in `ParentOverlay()` before calling `SetParent` and `SetWindowPos`\r\n- Add `IsHandleCreated` check in `WndProc` WM_PARENTNOTIFY handler before calling `SetWindowPos` on overlay controls\r\n\r\n## Customer Impact\r\n\r\n- Prevents Visual Studio crashes when custom control properties invoke native window methods during design time\r\n- Accessing `Control.Handle` without a created handle forces `CreateHandle()`, which can crash the designer\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Low. Follows existing pattern used throughout WinForms (e.g., `Control.BringToFront()`, `Control.SendToBack()`)\r\n\r\n## Test methodology\r\n\r\n- Code review passed\r\n- CodeQL security check passed\r\n- Pattern matches existing guards in Control.cs:4406 and Control.cs:10055\r\n\r\n> [!WARNING]\r\n>\r\n> <details>\r\n> <summary>Firewall rules blocked me from connecting to one or more addresses (expand for details)</summary>\r\n>\r\n> #### I tried to connect to the following addresses, but was blocked by firewall rules:\r\n>\r\n> - `96bvsblobprodcus338.vsblob.vsassets.io`\r\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet msbuild /m /nologo /clp:Summary /v:minimal /nr:true /warnaserror /p:TreatWarningsAsErrors=true /p:ContinuousIntegrationBuild=false /home/REDACTED/work/winforms/winforms/artifacts/toolset/restore.proj /t:__WriteToolsetLocation /clp:ErrorsOnly;NoSummary /p:__ToolsetLocationOutputFile=/home/REDACTED/work/winforms/winforms/artifacts/toolset/11.0.0-beta.25575.110.txt` (dns block)\r\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet dotnet build src/System.Windows.Forms.Design/src/System.Windows.Forms.Design.csproj --no-restore` (dns block)\r\n> - `rcxvsblobprodcus328.vsblob.vsassets.io`\r\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet dotnet build src/System.Windows.Forms.Design/src/System.Windows.Forms.Design.csproj --no-restore` (dns block)\r\n>\r\n> If you need me to access, download, or install something from one of these locations, you can either:\r\n>\r\n> - Configure [Actions setup steps](https://gh.io/copilot/actions-setup-steps) to set up my environment, which run before the firewall is enabled\r\n> - Add the appropriate URLs or hosts to the custom allowlist in this repository's [Copilot coding agent settings](https://github.com/dotnet/winforms/settings/copilot/coding_agent) (admins only)\r\n>\r\n> </details>\r\n\r\n<!-- START COPILOT CODING AGENT SUFFIX -->\r\n\r\n\r\n\r\n<details>\r\n\r\n<summary>Original prompt</summary>\r\n\r\n> \r\n> ----\r\n> \r\n> *This section details on the original issue you should resolve*\r\n> \r\n> <issue_title>Visual Studio Crash When Invoking NativeMethods.SetWindowPos Method</issue_title>\r\n> <issue_description>## Environment\r\n> Visual Studio professional 2026 - version 18.0.0\r\n> \r\n> ## .NET version\r\n> Facing this issue in .NetCore\r\n> \r\n> ## Did this work in a previous version of Visual Studio and/or previous .NET release?\r\n> No\r\n> \r\n> ## Issue Description\r\n> I have a Boolean property named NativeCheck. During the property processing, the SetWindowPos method is invoked. Visual Studio crashes when this method is executed. Below is the method definition:\r\n>      `[DllImport(\"USER32.dll\");` \r\n>     ` internal static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, int uFlags) `\r\n> \r\n> ## Demo Link\r\n> \r\n> [CustomControl_Demo.zip](https://github.com/user-attachments/files/23740457/CustomControl_Demo.zip)\r\n> \r\n> ### Issue replication video\r\n> \r\n> https://github.com/user-attachments/assets/884c2559-dc96-4e7c-b6f8-66788485120b\r\n> \r\n> ### Steps to reproduce\r\n> \r\n> 1. Open the Designer.\r\n> 2. Select the CustomButton and navigate to the Properties window.\r\n> 3. Set the NativeCheck property to True.\r\n> \r\n> **Expected Behavior**: The value should be properly set to the NativeCheck property without any issues.\r\n> **Observed Behavior**: When setting the NativeCheck property to True, Visual Studio crashes.</issue_description>\r\n> \r\n> ## Comments on the Issue (you are @copilot in this section)\r\n> \r\n> <comments>\r\n> </comments>\r\n> \r\n\r\n\r\n</details>\r\n\r\n- Fixes dotnet/winforms#14081\r\n\r\n<!-- START COPILOT CODING AGENT TIPS -->\r\n---\r\n\r\nâœ¨ Let Copilot coding agent [set things up for you](https://github.com/dotnet/winforms/issues/new?title=âœ¨+Set+up+Copilot+instructions&body=Configure%20instructions%20for%20this%20repository%20as%20documented%20in%20%5BBest%20practices%20for%20Copilot%20coding%20agent%20in%20your%20repository%5D%28https://gh.io/copilot-coding-agent-tips%29%2E%0A%0A%3COnboard%20this%20repo%3E&assignees=copilot) â€” coding agent works faster and does higher quality work when set up for your repo.\r\n\r\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14086)","Url":"https://github.com/dotnet/winforms/pull/14086","RelatedDescription":"Closed or merged PR \"Add IsHandleCreated checks before calling SetWindowPos in DesignerFrame\" (#14086)"},{"Id":"3665386001","IsPullRequest":true,"CreatedAt":"2025-11-26T03:02:54","Actor":"dotnet-maestro[bot]","Number":"14085","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251125.10](https://dev.azure.com/dnceng/internal/_build/results?buildId=2847632) ([292376](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/292376))\n- **Date Produced**: November 26, 2025 1:22:02 AM UTC\n- **Commit**: [de417a619f09820da5e8403783f56cdcbafbae9c](https://github.com/dotnet/dotnet/commit/de417a619f09820da5e8403783f56cdcbafbae9c)\n- **Commit Diff**: [d119b40...de417a6](https://github.com/dotnet/dotnet/compare/d119b40e8ff3b88f87ad60b04c807233a159b197...de417a619f09820da5e8403783f56cdcbafbae9c)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25574.108 to 11.0.0-beta.25575.110][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25574.108 to 10.0.0-rc.3.25575.110][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/d119b40e8f...de417a619f\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/a8b9e73f56e84dcb4c7ed0f23f79b308b4f83a01...9a99542f9b72dbcd0e07baec5166909ab756788a\n- https://github.com/dotnet/aspnetcore/compare/0d1029654a05e1685eea0b7689b42ca07b2af201...da2e7e169aa20f3c9d52c5f839f1965a1c083a9b\n- https://github.com/dotnet/cecil/compare/f015d3e84f7d8187a73ab78ff30a868e5e3c3018...82f47fc2ff84b3d94e910147d52f2e6795f6ae21\n- https://github.com/dotnet/command-line-api/compare/c7cc2a976b4afbdfba1021d8551c3e391ede2065...cf5fd8d696450a48d3cc75a7a1792d34b5303f88\n- https://github.com/dotnet/efcore/compare/5544d0fe9b5b4dd6cc44a14f13b364219b7d8b2e...3b4ee038903cb47bf0f54762cc7f7d4551f1efc4\n- https://github.com/dotnet/emsdk/compare/93402626168dc7a690c73dcec059fb5bdd84f5de...f8b85873c9157f00b4951a78977fa87e3ab7c628\n- https://github.com/dotnet/msbuild/compare/b71ea6cf13af59b838346727b37e26858781d018...92198f54c81842e6fd851c626f48713849b9cb99\n- https://github.com/dotnet/templating/compare/f38b39e3f8655d82baf8fe142b89503adecf6eb2...41ef93aacf72633b58372a9841d8940f6d87ae26\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:de417a619f09820da5e8403783f56cdcbafbae9c..https://github.com/dotnet/winforms:darc-main-8e3b74ed-fa67-494a-821f-5c17392a6bed\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14085)","Url":"https://github.com/dotnet/winforms/pull/14085","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14085)"},{"Id":"3665015014","IsPullRequest":false,"CreatedAt":"2025-11-25T23:52:14","Actor":"elachlan","Number":"14083","RawContent":null,"Title":"Preserve callstack when using Control.BeginInvoke with MethodInvoker","State":"open","Body":"### Background and motivation\n\nIn an application we have the following code:\n```vbnet\nPrivate Sub MyControl_LookUpEdit_EditValueChanged(sender As Object, e As EventArgs) Handles MyControl_LookUpEdit.EditValueChanged\n    BeginInvoke(New MethodInvoker(AddressOf AfterMyControlChange))\nEnd Sub\n```\n\nIt is used to work around data binding issues where the binding source datasource isn't updated until after the EditValueChanged event (devexpress).\n\nOccasionally we get exceptions. The call stack root is at the function level. So we don't see what triggered the function call.\n\nIt would be nice if we could preserve the callstack across the boundary allowing us to fully log it to track down issues.\n\n### API Proposal\n\nn/a\n\n\n### API Usage\n\nn/a\n\n\n### Alternative Designs\n\n_No response_\n\n### Risks\n\n_No response_\n\n### Will this feature affect UI controls?\n\nn/a","Url":"https://github.com/dotnet/winforms/issues/14083","RelatedDescription":"Open issue \"Preserve callstack when using Control.BeginInvoke with MethodInvoker\" (#14083)"},{"Id":"3661226004","IsPullRequest":true,"CreatedAt":"2025-11-25T20:16:21","Actor":"dotnet-maestro[bot]","Number":"14076","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20251124.2](https://dev.azure.com/dnceng/internal/_build/results?buildId=2846126) ([292085](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/292085))\n- **Date Produced**: November 24, 2025 2:36:43 PM UTC\n- **Commit**: [1483376c1a0ffb1e5f197266578dbce1e4098783](https://github.com/dotnet/dotnet/commit/1483376c1a0ffb1e5f197266578dbce1e4098783)\n- **Commit Diff**: [18f6e60...1483376](https://github.com/dotnet/dotnet/compare/18f6e60aa4755c2be56b2d45165a135d64d4f710...1483376c1a0ffb1e5f197266578dbce1e4098783)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.25570.103 to 10.0.0-beta.25574.102][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.2 to 10.0.2][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.2-servicing.25570.103 to 10.0.2-servicing.25574.102][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/18f6e60aa4...1483376c1a\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/runtime/compare/b9d8d8fd95f15609f0a95decbab4fbc274ea727f...eef1961c35dd10d02f6dc0b4d23d0334ba0ee35d\n- https://github.com/dotnet/sdk/compare/39099c84c14d32453662391a18ec7717549e0584...bda1e4cdd40e62c6f70e360be44afd70fed52c36\n- https://github.com/dotnet/source-build-reference-packages/compare/49632d61e289d10db866e28221a92963d0193023...8a350977e236389714dd5d66be46e31ebb1f51ce\n- https://github.com/dotnet/windowsdesktop/compare/4530396214f05a463d87242577bfa11671a552d5...b1a104c98368bbf8feaa5d92cbd691cc8c450c2d\n- https://github.com/dotnet/winforms/compare/b048eab77c022ab125fc620c2ec56c7659b680ee...39cd7f5d7f267a3632da1ebaeccfb6173e1dd540\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:1483376c1a0ffb1e5f197266578dbce1e4098783..https://github.com/dotnet/winforms:darc-release/10.0-9939019d-658b-44e3-a5fd-4bf2ddc96bd4\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14076)","Url":"https://github.com/dotnet/winforms/pull/14076","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14076)"},{"Id":"3662154421","IsPullRequest":false,"CreatedAt":"2025-11-25T09:14:32","Actor":"KlausLoeffelmann","Number":"14082","RawContent":null,"Title":"[API Suggestion] WinForms Application Builder API Proposal","State":"open","Body":"## Executive Summary\n\nThis proposal outlines a comprehensive modernization of Windows Forms application development by introducing an **Application Builder Pattern** inspired by ASP.NET Core's proven infrastructure. The goal is to bring dependency injection, modern configuration, logging, and application lifetime management to WinForms applications while maintaining full Designer compatibility.\n\n### Rationale\n\nWindows Forms remains a critical technology for enterprise desktop applications, yet it lacks the modern development infrastructure that has made ASP.NET Core successful. Developers transitioning from .NET Framework to .NET, or building new desktop applications, face several challenges:\n\n1. **No built-in dependency injection** - forcing reliance on anti-patterns like static singletons\n2. **Legacy configuration systems** - XML-based settings files incompatible with cloud deployment\n3. **Inconsistent application frameworks** - VB and C# have different, outdated bootstrapping approaches\n4. **Designer compatibility issues** - making modern patterns difficult to adopt\n5. **Limited Blazor Hybrid support** - no clear path to integrate web technologies\n6. **Missing lifecycle management** - no standardized hooks for startup/shutdown operations\n\nThis proposal addresses these gaps by introducing a familiar, proven pattern that:\n- Aligns WinForms with modern .NET practices used across all other workloads\n- Maintains 100% Designer compatibility through innovative service provider assignment\n- Enables seamless migration from .NET Framework while supporting greenfield development\n- Provides a foundation for cloud-native desktop applications\n- Unifies VB and C# development experiences\n\n### Document Overview\n\nThis proposal is organized into the following sections:\n\n1. **[Modernization Goals](#modernization-goals)** - Detailed rationale for each feature area\n2. **[Core API Surface](#core-api-surface)** - Complete API specifications with proposed namespaces\n3. **[Namespace Strategy](#namespace-strategy)** - Discussion of assembly and namespace organization\n4. **[Configuration Support](#configuration-support)** - JSON-based configuration approach\n5. **[Bootstrapping Examples](#bootstrapping-examples)** - C# and VB.NET samples\n6. **[Implementation Requirements](#implementation-requirements-for-winforms-runtime)** - Runtime integration points\n7. **[Project & Solution Templates](#project-and-solution-templates)** - Modern template ecosystem\n8. **[Migration Path](#migration-path-from-legacy-approaches)** - Guidance for existing applications\n\n---\n\n## Modernization Goals\n\n### 1. Dependency Injection for Migration and Modernization\n\nModern .NET applications rely heavily on dependency injection (DI) for:\n- **Testability**: Components can be easily mocked and unit tested\n- **Maintainability**: Loose coupling between components\n- **Flexibility**: Easy to swap implementations without changing consuming code\n- **Cloud-Native Patterns**: Aligns with microservices and modern architectural patterns\n\nWinForms has lacked first-class DI support, forcing developers to:\n- Use static singletons (anti-pattern)\n- Manually wire dependencies\n- Struggle with Designer compatibility\n\n**Solution**: Introduce `WinFormsApplicationBuilder` that provides DI while maintaining Designer compatibility through `IServiceProviderAssignable`.\n\n---\n\n### 2. Blazor Hybrid Integration\n\nModern WinForms applications need to integrate web technologies:\n- **Rich UI Components**: Leverage Blazor components in desktop apps\n- **Code Reuse**: Share components between web and desktop\n- **Modern Web APIs**: Utilize JavaScript libraries and frameworks\n\n**Solution**: Seamless integration with `BlazorWebView` through service registration and DI.\n\n---\n\n### 3. Designer Compatibility via IServiceProviderAssignable\n\nThe WinForms Designer requires parameterless constructors, which conflicts with constructor injection.\n\n**Solution**: Implement `IServiceProviderAssignable` interface that allows Designer-compatible controls to receive the service provider after construction:\n\n```csharp\npublic interface IServiceProviderAssignable : IServiceProvider\n{\n    /// <summary>\n    ///  Sets the service provider for this component.\n    /// </summary>\n    IServiceProvider SetServiceProvider(object serviceProvider);\n}\n```\n\nThis enables:\n- Designer continues to work with parameterless constructors\n- Runtime injection through property/method call\n- CodeDOM serialization compatibility\n\n---\n\n### 4. Modern Alternative to Legacy Settings Infrastructure\n\nThe current `.settings` file approach has limitations:\n- XML-based, not JSON\n- Limited type support\n- No hierarchical configuration\n- No environment-based overrides\n- Incompatible with modern cloud deployment\n\n**Solution**: `WinFormsUserSettingsService` providing:\n- JSON-based storage\n- Type-safe generic API\n- Automatic serialization/deserialization\n- Integration with `IConfiguration`\n\n---\n\n### 5. Extensible Builder Pattern with C# 14\n\nC# 14 introduces enhanced extension method capabilities that enable:\n- Fluent builder APIs\n- Better type inference\n- More expressive configuration\n- Third-party extensibility\n\n**Solution**: Builder pattern with extension methods for:\n- Custom service registration\n- Third-party library integration\n- Domain-specific configuration\n\n---\n\n### 6. Unified VB and C# Application Framework\n\nCurrently:\n- VB has Application Framework (with `ApplicationEvents.vb`)\n- C# has Application Settings generators\n- Both are inconsistent and limited\n\n**Proposal**: Obsolete both and provide unified:\n- `WinFormsApplicationBuilder` for both languages\n- Modern configuration via `appsettings.json`\n- Consistent lifetime events\n- Cross-language best practices\n\n---\n\n### 7. Unified Logging and Services Experience\n\nDevelopers need consistent logging across:\n- Development (Debug output with timestamps)\n- Production (File-based logs)\n- Integration with Application Insights, Seq, etc.\n\n**Solution**: Leverage `Microsoft.Extensions.Logging` with WinForms-specific providers:\n- `AddTimeStampedDebug()`: Development logging\n- `AddWinFormsFileLogger()`: Production file logging\n- Standard `ILogger<T>` interface\n\n---\n\n### 8. Application Lifetime Service\n\nDesktop applications need lifecycle hooks for:\n- Startup initialization\n- Graceful shutdown\n- Resource cleanup\n- State persistence\n\n**Solution**: `WinFormsApplicationLifetime` providing:\n- `ApplicationStarted` event\n- `ApplicationStopping` event\n- `ApplicationStopped` event\n- Integration with `IHostApplicationLifetime`\n\n---\n\n### 9. Additional Desktop-Specific Benefits from ASP.NET Infrastructure\n\nBy leveraging the existing `IHost` infrastructure, WinForms gains:\n\n#### Configuration Management\n- Hierarchical configuration (appsettings.json, environment variables, command line)\n- Environment-specific settings (Development, Staging, Production)\n- User secrets for sensitive data\n- Hot reload support\n\n#### Health Checks\n- Application health monitoring\n- Dependency health checks\n- Integration with monitoring tools\n\n#### Hosted Services\n- Background task execution\n- Scheduled jobs\n- Long-running operations\n\n#### Options Pattern\n- Strongly-typed configuration\n- Validation at startup\n- Change notifications\n\n#### Middleware Concept (WinForms Adaptation)\n- Pre/post processing of form activation\n- Global exception handling\n- Logging interceptors\n- Authorization checks\n\n---\n\n## Core API Surface\n\n### Namespace: Microsoft.Extensions.WinForms\n\n#### WinFormsApplication Class\n\n```csharp\nnamespace Microsoft.Extensions.WinForms;\n\n/// <summary>\n///  Represents a configured Windows Forms application.\n/// </summary>\npublic sealed class WinFormsApplication : IHost, IDisposable\n{\n    /// <summary>\n    ///  Gets the current running instance of the WinFormsApplication.\n    /// </summary>\n    public static WinFormsApplication? Current { get; }\n    \n    /// <summary>\n    ///  Gets the application's configured service provider.\n    /// </summary>\n    public IServiceProvider Services { get; }\n    \n    /// <summary>\n    ///  Creates a new WinFormsApplicationBuilder with pre-configured defaults.\n    /// </summary>\n    public static WinFormsApplicationBuilder CreateBuilder();\n    \n    /// <summary>\n    ///  Starts the host and runs the Windows Forms application with the configured startup form.\n    /// </summary>\n    public void Run();\n    \n    /// <summary>\n    ///  Starts the host and runs the Windows Forms application with the specified form type.\n    /// </summary>\n    public void Run<TForm>() where TForm : Form;\n    \n    /// <summary>\n    ///  Starts the host asynchronously.\n    /// </summary>\n    public Task StartAsync(CancellationToken cancellationToken = default);\n    \n    /// <summary>\n    ///  Stops the host asynchronously.\n    /// </summary>\n    public Task StopAsync(CancellationToken cancellationToken = default);\n}\n```\n\n---\n\n#### WinFormsApplicationBuilder Class\n\n```csharp\nnamespace Microsoft.Extensions.WinForms;\n\n/// <summary>\n///  A builder for Windows Forms applications.\n/// </summary>\npublic sealed class WinFormsApplicationBuilder : IHostApplicationBuilder\n{\n    /// <summary>\n    ///  Gets the collection of services for the application.\n    /// </summary>\n    public IServiceCollection Services { get; }\n    \n    /// <summary>\n    ///  Gets the application configuration.\n    /// </summary>\n    public ConfigurationManager Configuration { get; }\n    \n    /// <summary>\n    ///  Gets the logging builder for the application.\n    /// </summary>\n    public ILoggingBuilder Logging { get; }\n    \n    /// <summary>\n    ///  Gets the host environment for the application.\n    /// </summary>\n    public IHostEnvironment Environment { get; }\n    \n    /// <summary>\n    ///  Sets the startup form for the application using a form type.\n    /// </summary>\n    public WinFormsApplicationBuilder UseStartupForm<TForm>() where TForm : Form, new();\n    \n    /// <summary>\n    ///  Sets an existing form instance as the startup form.\n    /// </summary>\n    public WinFormsApplicationBuilder UseStartupForm(Form startupForm);\n    \n    /// <summary>\n    ///  Configures the high DPI mode for the application.\n    /// </summary>\n    public WinFormsApplicationBuilder UseHighDpiMode(HighDpiMode highDpiMode);\n    \n    /// <summary>\n    ///  Configures the color mode (Dark/Light/System) for the application.\n    /// </summary>\n    public WinFormsApplicationBuilder UseColorMode(SystemColorMode colorMode);\n    \n    /// <summary>\n    ///  Configures the default font for the application.\n    /// </summary>\n    public WinFormsApplicationBuilder UseDefaultFont(Font defaultFont);\n    \n    /// <summary>\n    ///  Configures whether to enable visual styles.\n    /// </summary>\n    public WinFormsApplicationBuilder UseVisualStyles(bool enable = true);\n    \n    /// <summary>\n    ///  Configures whether to use GDI+ text rendering (v2).\n    /// </summary>\n    public WinFormsApplicationBuilder UseTextRenderingV2(bool enable = true);\n    \n    /// <summary>\n    ///  Configures whether to allow WinForms settings from appsettings.json.\n    /// </summary>\n    public WinFormsApplicationBuilder AllowWinFormsJsonAppSettings(bool allowJson = true);\n    \n    /// <summary>\n    ///  Configures the application to use settings from the project file.\n    /// </summary>\n    public WinFormsApplicationBuilder UseProjectSettings();\n    \n    /// <summary>\n    ///  Adds WinForms-specific debug logging.\n    /// </summary>\n    public WinFormsApplicationBuilder UseWinFormsDebugLogger();\n    \n    /// <summary>\n    ///  Adds WinForms-specific release logging.\n    /// </summary>\n    public WinFormsApplicationBuilder UseWinFormsReleaseLogger();\n    \n    /// <summary>\n    ///  Builds the WinFormsApplication.\n    /// </summary>\n    public WinFormsApplication Build();\n}\n```\n\n---\n\n#### WinFormsApplicationLifetime Class\n\n```csharp\nnamespace Microsoft.Extensions.WinForms;\n\n/// <summary>\n///  Represents the lifetime of a Windows Forms application.\n/// </summary>\npublic sealed class WinFormsApplicationLifetime\n{\n    /// <summary>\n    ///  Occurs when the application has been fully started.\n    /// </summary>\n    public event EventHandler<EventArgs>? ApplicationStarted;\n    \n    /// <summary>\n    ///  Occurs when the application is stopping.\n    /// </summary>\n    public event EventHandler<EventArgs>? ApplicationStopping;\n    \n    /// <summary>\n    ///  Occurs when the application has completely stopped.\n    /// </summary>\n    public event EventHandler<EventArgs>? ApplicationStopped;\n}\n```\n\n---\n\n## Namespace Strategy\n\n### Assembly Organization\n\nThe proposed implementation can be organized in two potential approaches:\n\n#### Option 1: Single Assembly Extension (Recommended for .NET 10+)\n\nAdd to existing `System.Windows.Forms.dll`:\n- Core builder types in `Microsoft.Extensions.WinForms` namespace\n- Service integration in `System.ComponentModel` namespace\n\n**Benefits:**\n- Single assembly reference\n- Tight integration with existing WinForms infrastructure\n- Natural discoverability\n\n#### Option 2: Separate Assembly\n\nCreate new `Microsoft.Extensions.Hosting.WindowsForms.dll`:\n- Contains all builder and hosting infrastructure\n- References `System.Windows.Forms`\n- Similar to `Microsoft.AspNetCore.Components.WebView.WindowsForms`\n\n**Benefits:**\n- Opt-in for applications that need it\n- Easier to ship updates independently\n- Clear separation of concerns\n\n### Proposed Namespace Structure\n\n```csharp\n// Core hosting infrastructure\nnamespace Microsoft.Extensions.WinForms\n{\n    public sealed class WinFormsApplication { }\n    public sealed class WinFormsApplicationBuilder { }\n    public sealed class WinFormsApplicationLifetime { }\n    internal sealed class WinFormsApplicationOptions { }\n}\n\n// Service provider integration for Designer compatibility\nnamespace System.ComponentModel\n{\n    public interface IServiceProviderAssignable : IServiceProvider { }\n}\n\n// Extension methods for service registration\nnamespace Microsoft.Extensions.DependencyInjection\n{\n    public static class WinFormsServiceCollectionExtensions\n    {\n        public static IServiceCollection AddWinFormsUserSettings(this IServiceCollection services);\n        public static IServiceCollection AddWinFormsExceptionHandling(this IServiceCollection services);\n        public static IServiceCollection AddWinFormsDialogs(this IServiceCollection services);\n    }\n}\n\n// Logging extensions\nnamespace Microsoft.Extensions.Logging\n{\n    public static class WinFormsLoggingExtensions\n    {\n        public static ILoggingBuilder AddDebugLogger(this ILoggingBuilder builder);\n        public static ILoggingBuilder AddFileLogger(this ILoggingBuilder builder);\n    }\n}\n\n// Core services and interfaces\nnamespace Microsoft.Extensions.WinForms.Services\n{\n    public interface IUserSettingsService { }\n    public interface IWinFormsExceptionService { }\n    public interface IWinFormsDialogService { }\n}\n```\n\n### Third-Party Extensions\n\nThird-party libraries can extend the builder pattern through standard extension methods:\n\n```csharp\n// Example: Blazor Hybrid support\nnamespace Microsoft.AspNetCore.Components.WebView.WindowsForms\n{\n    public static class BlazorWebViewServiceCollectionExtensions\n    {\n        public static IServiceCollection AddWindowsFormsBlazorWebView(\n            this IServiceCollection services);\n    }\n}\n\n// Example: AI integration\nnamespace Microsoft.Extensions.AI.WinForms\n{\n    public static class AIServiceCollectionExtensions\n    {\n        public static IServiceCollection AddAIChatClient(\n            this IServiceCollection services);\n    }\n}\n```\n\n### Design Principles\n\n1. **Alignment with .NET conventions**: Use `Microsoft.Extensions.*` pattern established by ASP.NET Core\n2. **Minimal surface area**: Keep core types focused, allow extensions via standard patterns\n3. **Clear ownership**: `Microsoft.Extensions.WinForms` clearly indicates hosting infrastructure\n4. **Future-proof**: Namespace structure allows for additional desktop UI framework support\n\n---\n\n### Namespace: System.ComponentModel\n\n#### IServiceProviderAssignable Interface\n\n```csharp\nnamespace System.ComponentModel;\n\n/// <summary>\n///  Represents a component that can receive a service provider after construction.\n///  This enables dependency injection while maintaining Windows Forms Designer compatibility.\n/// </summary>\npublic interface IServiceProviderAssignable : IServiceProvider\n{\n    /// <summary>\n    ///  Sets the service provider for this component.\n    /// </summary>\n    /// <param name=\"serviceProvider\">The service provider to assign.</param>\n    /// <returns>The service provider for chaining.</returns>\n    IServiceProvider SetServiceProvider(object serviceProvider);\n}\n```\n\n---\n\n### Namespace: Microsoft.Extensions.DependencyInjection\n\n#### Service Extension Methods\n\n```csharp\nnamespace Microsoft.Extensions.DependencyInjection;\n\npublic static class WinFormsServiceCollectionExtensions\n{\n    /// <summary>\n    ///  Adds the WinForms user settings service to the service collection.\n    /// </summary>\n    public static IServiceCollection AddWinFormsUserSettings(\n        this IServiceCollection services);\n    \n    /// <summary>\n    ///  Adds the WinForms exception handling service.\n    /// </summary>\n    public static IServiceCollection AddWinFormsExceptionHandling(\n        this IServiceCollection services);\n    \n    /// <summary>\n    ///  Adds the WinForms dialog service for showing dialogs.\n    /// </summary>\n    public static IServiceCollection AddWinFormsDialogs(\n        this IServiceCollection services);\n    \n    /// <summary>\n    ///  Gets a component from the service provider.\n    /// </summary>\n    public static TComponent? GetComponent<TComponent>(\n        this IServiceProvider serviceProvider);\n    \n    /// <summary>\n    ///  Gets a required component from the service provider.\n    /// </summary>\n    public static TComponent GetRequiredComponent<TComponent>(\n        this IServiceProvider serviceProvider);\n}\n```\n\n---\n\n### Namespace: Microsoft.Extensions.WinForms.Services\n\n#### IUserSettingsService Interface\n\n```csharp\nnamespace Microsoft.Extensions.WinForms.Services;\n\n/// <summary>\n///  Provides a modern, JSON-based user settings service.\n/// </summary>\npublic interface IUserSettingsService\n{\n    /// <summary>\n    ///  Gets a setting value with a default fallback.\n    /// </summary>\n    T GetSetting<T>(string key, T defaultValue);\n    \n    /// <summary>\n    ///  Saves a setting value.\n    /// </summary>\n    void SaveSetting<T>(string key, T value);\n    \n    /// <summary>\n    ///  Loads settings from disk.\n    /// </summary>\n    void Load();\n    \n    /// <summary>\n    ///  Saves settings to disk.\n    /// </summary>\n    void Save();\n    \n    /// <summary>\n    ///  Removes a setting.\n    /// </summary>\n    void Remove(string key);\n}\n```\n\n---\n\n#### IWinFormsExceptionService Interface\n\n```csharp\nnamespace Microsoft.Extensions.WinForms.Services;\n\n/// <summary>\n///  Provides centralized exception handling for WinForms applications.\n/// </summary>\npublic interface IWinFormsExceptionService\n{\n    /// <summary>\n    ///  Handles an exception that occurred in the application.\n    /// </summary>\n    void HandleException(Exception exception, bool canContinue = true);\n    \n    /// <summary>\n    ///  Configures global exception handlers.\n    /// </summary>\n    void ConfigureGlobalHandlers();\n}\n```\n\n---\n\n### Namespace: Microsoft.Extensions.Logging\n\n#### Logging Extension Methods\n\n```csharp\nnamespace Microsoft.Extensions.Logging;\n\npublic static class WinFormsLoggingExtensions\n{\n    /// <summary>\n    ///  Adds a timestamped debug logger suitable for Windows Forms development.\n    /// </summary>\n    public static ILoggingBuilder AddDebugLogger(\n        this ILoggingBuilder builder,\n        string? timeStampFormat = null,\n        bool minuteSeparator = true);\n    \n    /// <summary>\n    ///  Adds a file logger for Windows Forms applications.\n    /// </summary>\n    public static ILoggingBuilder AddFileLogger(\n        this ILoggingBuilder builder,\n        string? applicationName = null,\n        string? logDirectory = null);\n}\n```\n\n---\n\n## Configuration Support\n\n### appsettings.json Structure\n\n```json\n{\n  \"WinForms\": {\n    \"HighDpiMode\": \"PerMonitorV2\",\n    \"ColorMode\": \"System\",\n    \"UseTextRenderingV2\": true,\n    \"UseVisualStyles\": true,\n    \"DefaultFont\": {\n      \"Family\": \"Segoe UI\",\n      \"Size\": 9.0\n    }\n  },\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft\": \"Warning\"\n    }\n  },\n  \"UserSettings\": {\n    \"StoragePath\": \"%APPDATA%/MyApp/settings.json\"\n  }\n}\n```\n\n---\n\n## Bootstrapping Examples\n\n### C# Example - Basic Application\n\n```csharp\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.WinForms;\nusing Microsoft.Extensions.Logging;\n\nnamespace MyWinFormsApp;\n\ninternal static class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        // Create the application builder\n        WinFormsApplicationBuilder builder = WinFormsApplication.CreateBuilder();\n\n        // Configure services\n        builder.Services.AddWinFormsUserSettings();\n        builder.Services.AddWinFormsExceptionHandling();\n        builder.Services.AddWinFormsDialogs();\n\n        // Register application forms and components\n        builder.Services.AddScoped<MainForm>();\n        builder.Services.AddScoped<SettingsForm>();\n        \n        // Configure logging\n        builder.Logging.AddDebugLogger();\n        builder.Logging.AddFileLogger();\n\n        // Configure WinForms-specific options\n        builder.UseStartupForm<MainForm>()\n               .UseHighDpiMode(HighDpiMode.PerMonitorV2)\n               .UseColorMode(SystemColorMode.System)\n               .UseTextRenderingV2()\n               .UseVisualStyles()\n               .AllowWinFormsJsonAppSettings();\n\n        // Build and run\n        WinFormsApplication app = builder.Build();\n        app.Run();\n    }\n}\n```\n\n---\n\n### C# Example - Advanced with Blazor Hybrid\n\n```csharp\nusing Microsoft.AspNetCore.Components.WebView.WindowsForms;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.WinForms;\nusing Microsoft.Extensions.Logging;\n\nnamespace ChattyApp;\n\ninternal static class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        WinFormsApplicationBuilder builder = WinFormsApplication.CreateBuilder();\n\n        // Core services\n        builder.Services.AddWinFormsUserSettings();\n        builder.Services.AddWinFormsExceptionHandling();\n\n        // Blazor Hybrid support\n        builder.Services.AddWindowsFormsBlazorWebView();\n\n        // Application components\n        builder.Services.AddScoped<FrmMain>();\n        builder.Services.AddScoped<ChatViewModel>();\n\n        // Logging\n        builder.Logging.AddDebugLogger();\n\n        // WinForms configuration\n        builder.UseStartupForm<FrmMain>()\n               .UseHighDpiMode(HighDpiMode.SystemAware)\n               .UseColorMode(SystemColorMode.System)\n               .UseTextRenderingV2()\n               .UseVisualStyles();\n\n        // Build and run\n        WinFormsApplication app = builder.Build();\n        app.Run();\n    }\n}\n```\n\n---\n\n### C# Example - Form with Dependency Injection\n\n```csharp\nusing System.ComponentModel;\nusing Microsoft.Extensions.Logging;\nusing Microsoft.Extensions.WinForms.Services;\n\nnamespace MyWinFormsApp;\n\n/// <summary>\n///  Main application form with dependency injection support.\n/// </summary>\npublic partial class MainForm : Form, IServiceProviderAssignable\n{\n    private readonly ILogger<MainForm> _logger;\n    private readonly IUserSettingsService _settings;\n    private IServiceProvider? _serviceProvider;\n\n    // Designer-compatible parameterless constructor\n    public MainForm()\n    {\n        InitializeComponent();\n    }\n\n    // Constructor for dependency injection\n    public MainForm(\n        ILogger<MainForm> logger,\n        IUserSettingsService settings) : this()\n    {\n        _logger = logger;\n        _settings = settings;\n        \n        _logger.LogInformation(\"MainForm initialized with DI\");\n    }\n\n    // IServiceProviderAssignable implementation\n    public IServiceProvider SetServiceProvider(object serviceProvider)\n    {\n        _serviceProvider = (IServiceProvider)serviceProvider;\n        return _serviceProvider;\n    }\n\n    public object? GetService(Type serviceType)\n        => _serviceProvider?.GetService(serviceType);\n\n    protected override void OnLoad(EventArgs e)\n    {\n        base.OnLoad(e);\n\n        // Load window position from settings\n        if (_settings.GetSetting(\"WindowMaximized\", false))\n        {\n            WindowState = FormWindowState.Maximized;\n        }\n        else\n        {\n            Location = _settings.GetSetting(\"WindowLocation\", Location);\n            Size = _settings.GetSetting(\"WindowSize\", Size);\n        }\n    }\n\n    protected override void OnFormClosing(FormClosingEventArgs e)\n    {\n        // Save window position\n        _settings.SaveSetting(\"WindowMaximized\", \n            WindowState == FormWindowState.Maximized);\n        \n        if (WindowState == FormWindowState.Normal)\n        {\n            _settings.SaveSetting(\"WindowLocation\", Location);\n            _settings.SaveSetting(\"WindowSize\", Size);\n        }\n        \n        _settings.Save();\n\n        base.OnFormClosing(e);\n    }\n}\n```\n\n---\n\n### VB.NET Example - Basic Application\n\n```vb\nImports Microsoft.Extensions.DependencyInjection\nImports Microsoft.Extensions.WinForms\nImports Microsoft.Extensions.Logging\n\nModule Program\n    ''' <summary>\n    '''  The main entry point for the application.\n    ''' </summary>\n    <STAThread()>\n    Sub Main()\n        ' Create the application builder\n        Dim builder As WinFormsApplicationBuilder = _\n            WinFormsApplication.CreateBuilder()\n\n        ' Configure services\n        builder.Services.AddWinFormsUserSettings()\n        builder.Services.AddWinFormsExceptionHandling()\n        builder.Services.AddWinFormsDialogs()\n\n        ' Register application forms\n        builder.Services.AddScoped(Of MainForm)()\n        builder.Services.AddScoped(Of SettingsForm)()\n\n        ' Configure logging\n        builder.Logging.AddDebugLogger()\n        builder.Logging.AddFileLogger()\n\n        ' Configure WinForms-specific options\n        builder.UseStartupForm(Of MainForm)() _\n               .UseHighDpiMode(HighDpiMode.PerMonitorV2) _\n               .UseColorMode(SystemColorMode.System) _\n               .UseTextRenderingV2() _\n               .UseVisualStyles() _\n               .AllowWinFormsJsonAppSettings()\n\n        ' Build and run\n        Dim app As WinFormsApplication = builder.Build()\n        app.Run()\n    End Sub\nEnd Module\n```\n\n---\n\n### VB.NET Example - Form with Dependency Injection\n\n```vb\nImports System.ComponentModel\nImports Microsoft.Extensions.Logging\nImports Microsoft.Extensions.WinForms.Services\n\n''' <summary>\n'''  Main application form with dependency injection support.\n''' </summary>\nPublic Class MainForm\n    Inherits Form\n    Implements IServiceProviderAssignable\n\n    Private ReadOnly _logger As ILogger(Of MainForm)\n    Private ReadOnly _settings As IUserSettingsService\n    Private _serviceProvider As IServiceProvider\n\n    ' Designer-compatible parameterless constructor\n    Public Sub New()\n        InitializeComponent()\n    End Sub\n\n    ' Constructor for dependency injection\n    Public Sub New(logger As ILogger(Of MainForm), \n                   settings As IUserSettingsService)\n        Me.New()\n        _logger = logger\n        _settings = settings\n        \n        _logger.LogInformation(\"MainForm initialized with DI\")\n    End Sub\n\n    ' IServiceProviderAssignable implementation\n    Public Function SetServiceProvider(serviceProvider As Object) _\n        As IServiceProvider _\n        Implements IServiceProviderAssignable.SetServiceProvider\n        \n        _serviceProvider = DirectCast(serviceProvider, IServiceProvider)\n        Return _serviceProvider\n    End Function\n\n    Public Function GetService(serviceType As Type) As Object _\n        Implements IServiceProvider.GetService\n        \n        Return _serviceProvider?.GetService(serviceType)\n    End Function\n\n    Protected Overrides Sub OnLoad(e As EventArgs)\n        MyBase.OnLoad(e)\n\n        ' Load window position from settings\n        If _settings.GetSetting(\"WindowMaximized\", False) Then\n            WindowState = FormWindowState.Maximized\n        Else\n            Location = _settings.GetSetting(\"WindowLocation\", Location)\n            Size = _settings.GetSetting(\"WindowSize\", Size)\n        End If\n    End Sub\n\n    Protected Overrides Sub OnFormClosing(e As FormClosingEventArgs)\n        ' Save window position\n        _settings.SaveSetting(\"WindowMaximized\", \n            WindowState = FormWindowState.Maximized)\n        \n        If WindowState = FormWindowState.Normal Then\n            _settings.SaveSetting(\"WindowLocation\", Location)\n            _settings.SaveSetting(\"WindowSize\", Size)\n        End If\n        \n        _settings.Save()\n\n        MyBase.OnFormClosing(e)\n    End Sub\nEnd Class\n```\n\n---\n\n## Project and Solution Templates\n\n### Importance of Modern Templates\n\nThe success of the WinFormsApplicationBuilder pattern depends heavily on **discoverability** and **ease of adoption**. Modern templates are essential for:\n\n1. **Lowering the barrier to entry** - Developers can start with best practices immediately\n2. **Showcasing capabilities** - Templates demonstrate the full potential of the new infrastructure\n3. **Accelerating development** - Pre-configured solutions save hours of setup time\n4. **Establishing patterns** - Templates serve as reference implementations\n5. **Supporting migrations** - Multi-process templates help bridge .NET Framework to .NET transitions\n\n### Proposed Template Ecosystem\n\n#### Project Templates\n\n| Template Name | Description | Key Features |\n|--------------|-------------|--------------|\n| **WinForms App (.NET)** | Basic application with DI | Builder pattern, logging, settings service |\n| **WinForms App with Blazor** | Hybrid web/desktop app | BlazorWebView integration, shared Razor components |\n| **WinForms System Tray App** | Background app with tray icon | NotifyIcon setup, context menus, minimize-to-tray |\n| **WinForms Windows Service** | Long-running service | BackgroundService integration, service lifecycle |\n| **WinForms MVVM App** | MVVM architecture | CommunityToolkit.Mvvm, data binding, commands |\n\n#### Solution Templates\n\n| Template Name | Description | Architecture |\n|--------------|-------------|-------------|\n| **WinForms Enterprise App** | Full-stack application | Frontend â†’ ViewModels â†’ Services â†’ Data (EF Core) |\n| **WinForms with Azure Backend** | Cloud-connected app | Desktop client â†’ Azure Functions â†’ Cosmos DB/SQL |\n| **Blazor Hybrid Solution** | Shared UI components | WinForms + Blazor WebAssembly + Shared Razor Class Library |\n| **Migration Bridge Solution** | .NET Framework coexistence | .NET 10 frontend â†” IPC â†” .NET Framework backend |\n| **Multi-Tier WinForms App** | Layered architecture | Presentation â†’ Business Logic â†’ Data Access â†’ Database |\n\n### Template Details\n\n#### 1. WinForms App (.NET) - Basic Template\n\n**Project Structure:**\n```\nMyWinFormsApp/\nâ”œâ”€â”€ Program.cs                 // Application builder setup\nâ”œâ”€â”€ appsettings.json           // Configuration\nâ”œâ”€â”€ MainForm.cs               // Main form with DI\nâ”œâ”€â”€ MainForm.Designer.cs\nâ”œâ”€â”€ Services/\nâ”‚   â””â”€â”€ IMyService.cs         // Example service interface\nâ””â”€â”€ Properties/\n    â””â”€â”€ launchSettings.json   // Development settings\n```\n\n**Program.cs:**\n```csharp\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.WinForms;\nusing Microsoft.Extensions.Logging;\n\nvar builder = WinFormsApplication.CreateBuilder();\n\n// Configure services\nbuilder.Services.AddWinFormsUserSettings();\nbuilder.Services.AddWinFormsExceptionHandling();\nbuilder.Services.AddScoped<MainForm>();\n\n// Configure logging\nbuilder.Logging.AddDebugLogger();\n\n// Configure WinForms\nbuilder.UseStartupForm<MainForm>()\n       .UseHighDpiMode(HighDpiMode.PerMonitorV2)\n       .UseColorMode(SystemColorMode.System);\n\nvar app = builder.Build();\napp.Run();\n```\n\n---\n\n#### 2. WinForms with Blazor Template\n\n**Project Structure:**\n```\nMyBlazorHybridApp/\nâ”œâ”€â”€ Program.cs\nâ”œâ”€â”€ MainForm.cs               // Hosts BlazorWebView\nâ”œâ”€â”€ Components/\nâ”‚   â”œâ”€â”€ App.razor            // Blazor root component\nâ”‚   â”œâ”€â”€ Routes.razor\nâ”‚   â””â”€â”€ Pages/\nâ”‚       â”œâ”€â”€ Index.razor\nâ”‚       â””â”€â”€ Counter.razor\nâ”œâ”€â”€ wwwroot/\nâ”‚   â”œâ”€â”€ css/\nâ”‚   â””â”€â”€ index.html\nâ””â”€â”€ appsettings.json\n```\n\n**Key Configuration:**\n```csharp\n// In Program.cs\nbuilder.Services.AddWindowsFormsBlazorWebView();\nbuilder.Services.AddScoped<ChatViewModel>();\n```\n\n---\n\n#### 3. Migration Bridge Solution Template\n\n**Solution Structure:**\n```\nMyMigrationSolution/\nâ”œâ”€â”€ MyApp.Modern/             // .NET 10 WinForms\nâ”‚   â”œâ”€â”€ Program.cs\nâ”‚   â”œâ”€â”€ MainForm.cs\nâ”‚   â””â”€â”€ Services/\nâ”‚       â””â”€â”€ LegacyBridge.cs  // IPC to legacy code\nâ”œâ”€â”€ MyApp.Legacy/             // .NET Framework 4.8\nâ”‚   â”œâ”€â”€ LegacyService.cs     // Existing business logic\nâ”‚   â””â”€â”€ IPC/\nâ”‚       â””â”€â”€ NamedPipeServer.cs\nâ””â”€â”€ MyApp.Shared/             // .NET Standard 2.0\n    â””â”€â”€ Contracts/\n        â””â”€â”€ ILegacyService.cs\n```\n\n**Migration Strategy:**\n- Modern UI in .NET 10 with full DI and builder pattern\n- Legacy business logic remains in .NET Framework\n- Communication via named pipes or gRPC\n- Gradual migration of business logic to .NET\n\n---\n\n#### 4. WinForms Enterprise App Solution Template\n\n**Solution Structure:**\n```\nMyEnterpriseApp/\nâ”œâ”€â”€ MyApp.Desktop/            // WinForms frontend\nâ”‚   â”œâ”€â”€ Program.cs\nâ”‚   â”œâ”€â”€ Views/\nâ”‚   â””â”€â”€ ViewModels/\nâ”œâ”€â”€ MyApp.Core/               // Business logic\nâ”‚   â”œâ”€â”€ Services/\nâ”‚   â””â”€â”€ Models/\nâ”œâ”€â”€ MyApp.Data/               // Data access\nâ”‚   â”œâ”€â”€ DbContext.cs\nâ”‚   â””â”€â”€ Repositories/\nâ””â”€â”€ MyApp.Tests/              // Unit tests\n    â”œâ”€â”€ ViewModelTests/\n    â””â”€â”€ ServiceTests/\n```\n\n**Dependency Flow:**\n```\nDesktop â†’ Core â†’ Data\n   â†“       â†“\n   â””â”€â”€â”€â”€â”€â†’ Tests\n```\n\n---\n\n#### 5. WinForms with Azure Backend Template\n\n**Solution Structure:**\n```\nMyCloudApp/\nâ”œâ”€â”€ MyApp.Desktop/            // WinForms client\nâ”‚   â”œâ”€â”€ Program.cs\nâ”‚   â”œâ”€â”€ MainForm.cs\nâ”‚   â””â”€â”€ Services/\nâ”‚       â””â”€â”€ AzureApiClient.cs\nâ”œâ”€â”€ MyApp.Functions/          // Azure Functions\nâ”‚   â”œâ”€â”€ CustomerApi.cs\nâ”‚   â””â”€â”€ host.json\nâ”œâ”€â”€ MyApp.Shared/             // DTOs and contracts\nâ”‚   â””â”€â”€ Models/\nâ””â”€â”€ deployment/\n    â”œâ”€â”€ bicep/               // Infrastructure as Code\n    â””â”€â”€ pipelines/           // CI/CD\n```\n\n**Features:**\n- REST API client with HttpClient factory\n- Azure AD authentication\n- Application Insights integration\n- Offline-first data synchronization\n- Deployment scripts for Azure\n\n---\n\n#### 6. System Tray Application Template\n\n**Key Components:**\n```csharp\npublic class TrayApplicationContext : ApplicationContext\n{\n    private readonly NotifyIcon _notifyIcon;\n    private readonly IServiceProvider _services;\n\n    public TrayApplicationContext(IServiceProvider services)\n    {\n        _services = services;\n        _notifyIcon = new NotifyIcon\n        {\n            Icon = Resources.AppIcon,\n            ContextMenuStrip = CreateContextMenu(),\n            Visible = true\n        };\n    }\n    \n    private ContextMenuStrip CreateContextMenu()\n    {\n        var menu = new ContextMenuStrip();\n        menu.Items.Add(\"Open\", null, OnOpen);\n        menu.Items.Add(\"Settings\", null, OnSettings);\n        menu.Items.Add(\"Exit\", null, OnExit);\n        return menu;\n    }\n}\n```\n\n---\n\n### Template Discovery and Documentation\n\n#### Visual Studio Integration\n\nTemplates should appear in:\n1. **New Project Dialog** - Filtered by \"WinForms\" or \"Desktop\"\n2. **Getting Started** - Featured in welcome screen\n3. **Template Search** - Tagged with relevant keywords (WinForms, Desktop, Blazor, Azure, MVVM)\n\n#### Online Documentation\n\nEach template should include:\n- **README.md** - Project overview and quick start\n- **Architecture.md** - Design decisions and structure explanation\n- **Migration-Guide.md** (for bridge templates) - Step-by-step migration process\n- **Deployment.md** - How to build and deploy\n- **Code comments** - Inline explanations of key patterns\n\n#### Template Metadata\n\n```xml\n<Template>\n  <Name>WinForms App (.NET)</Name>\n  <Description>A modern Windows Forms application with dependency injection, logging, and configuration</Description>\n  <ProjectType>CSharp</ProjectType>\n  <ProjectSubType>Windows</ProjectSubType>\n  <SortOrder>1000</SortOrder>\n  <CreateNewFolder>true</CreateNewFolder>\n  <DefaultName>MyWinFormsApp</DefaultName>\n  <ProvideDefaultName>true</ProvideDefaultName>\n  <LocationField>Enabled</LocationField>\n  <EnableLocationBrowseButton>true</EnableLocationBrowseButton>\n  <CreateInPlace>true</CreateInPlace>\n  <Icon>WinFormsIcon.png</Icon>\n  <PreviewImage>WinFormsPreview.png</PreviewImage>\n  <Tags>\n    <Tag>WinForms</Tag>\n    <Tag>Desktop</Tag>\n    <Tag>DependencyInjection</Tag>\n    <Tag>Modern</Tag>\n  </Tags>\n</Template>\n```\n\n---\n\n### Benefits of Comprehensive Template Ecosystem\n\n1. **Reduced Learning Curve** - Developers don't need to configure DI, logging, etc. from scratch\n2. **Best Practices by Default** - Templates encode recommended patterns\n3. **Faster Time to Market** - Pre-wired solutions accelerate development\n4. **Migration Support** - Bridge templates provide clear migration paths\n5. **Ecosystem Growth** - Templates encourage adoption of modern WinForms development\n\n---\n\n## Implementation Requirements for WinForms Runtime\n\nTo fully support this API surface in the .NET runtime, the following components need to be added to `System.Windows.Forms`:\n\n### 1. Core Builder Types (Namespace: Microsoft.Extensions.WinForms)\n\n- `WinFormsApplication` class\n- `WinFormsApplicationBuilder` class\n- `WinFormsApplicationOptions` class\n- `WinFormsApplicationLifetime` class\n\n### 2. Service Provider Integration\n\n- `IServiceProviderAssignable` interface in `System.ComponentModel`\n- Updates to `Form` base class to support optional service provider injection\n- Updates to `Control` base class to support `IServiceProviderAssignable`\n- Designer code generation support for service provider assignment\n\n### 3. Configuration Support\n\n- Integration with `Microsoft.Extensions.Configuration`\n- `appsettings.json` support with `WinForms` section\n- Environment-specific configuration (Development/Production)\n- User secrets support for development\n\n### 4. Logging Integration\n\n- Integration with `Microsoft.Extensions.Logging`\n- Default providers for Debug output and file logging\n- Structured logging support\n\n### 5. Lifetime Management\n\n- Integration with `IHostApplicationLifetime`\n- Application startup/shutdown event hooks\n- Graceful shutdown support\n\n### 6. Settings Service\n\n- Modern replacement for `ApplicationSettings`\n- JSON-based storage\n- Type-safe generic API\n- Automatic serialization\n\n---\n\n## Migration Path from Legacy Approaches\n\n### From VB Application Framework\n\n**Before (VB Application Framework):**\n```vb\n' ApplicationEvents.vb\nNamespace My\n    Partial Friend Class MyApplication\n        Private Sub MyApplication_Startup(sender As Object, \n                                          e As StartupEventArgs) _\n            Handles Me.Startup\n            ' Initialization code\n        End Sub\n    End Class\nEnd Namespace\n```\n\n**After (WinFormsApplicationBuilder):**\n```vb\n' Program.vb\nModule Program\n    <STAThread()>\n    Sub Main()\n        Dim builder = WinFormsApplication.CreateBuilder()\n        \n        ' Configure services and startup\n        builder.Services.AddSingleton(Of IMyService, MyService)()\n        builder.UseStartupForm(Of MainForm)()\n        \n        Dim app = builder.Build()\n        \n        ' Subscribe to lifetime events\n        Dim lifetime = app.Services.GetService(Of WinFormsApplicationLifetime)()\n        AddHandler lifetime.ApplicationStarted, AddressOf OnStartup\n        \n        app.Run()\n    End Sub\n    \n    Private Sub OnStartup(sender As Object, e As EventArgs)\n        ' Initialization code\n    End Sub\nEnd Module\n```\n\n### From C# Application.Run\n\n**Before:**\n```csharp\nstatic class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        Application.EnableVisualStyles();\n        Application.SetHighDpiMode(HighDpiMode.SystemAware);\n        Application.SetCompatibleTextRenderingDefault(false);\n        Application.Run(new MainForm());\n    }\n}\n```\n\n**After:**\n```csharp\nstatic class Program\n{\n    [STAThread]\n    static void Main()\n    {\n        var builder = WinFormsApplication.CreateBuilder();\n        \n        builder.UseStartupForm<MainForm>()\n               .UseHighDpiMode(HighDpiMode.SystemAware)\n               .UseTextRenderingV2()\n               .UseVisualStyles();\n        \n        var app = builder.Build();\n        app.Run();\n    }\n}\n```\n\n### From Settings Files\n\n**Before (.settings file):**\n```xml\n<Settings>\n  <Setting Name=\"WindowLocation\" Type=\"System.Drawing.Point\">\n    <Value>100, 100</Value>\n  </Setting>\n</Settings>\n```\n\n**After (IUserSettingsService):**\n```csharp\n// Save\n_settings.SaveSetting(\"WindowLocation\", this.Location);\n_settings.Save();\n\n// Load\nLocation = _settings.GetSetting(\"WindowLocation\", new Point(100, 100));\n```\n\n---\n\n## Benefits Summary\n\n### For Developers\n- **Modern Patterns**: DI, logging, configuration aligned with ASP.NET Core\n- **Better Testing**: Easy to mock and unit test\n- **Cloud-Ready**: Supports cloud deployment patterns\n- **Blazor Integration**: Seamless hybrid web/desktop apps\n- **Type Safety**: Strongly-typed configuration and settings\n\n### For the Ecosystem\n- **Consistency**: Same patterns across all .NET workloads\n- **Extensibility**: Third-party libraries can provide builder extensions\n- **Maintainability**: Clear separation of concerns\n- **Documentation**: Familiar patterns from web development\n\n### For Migration\n- **Incremental**: Can adopt features gradually\n- **Backward Compatible**: Doesn't break existing code\n- **Designer Compatible**: Works with Visual Studio Designer\n- **VB and C# Unified**: Same API surface for both languages\n\n---\n\n## Conclusion\n\nThe `WinFormsApplicationBuilder` pattern brings Windows Forms development into the modern .NET era by:\n\n1. Providing first-class dependency injection support\n2. Enabling Blazor Hybrid scenarios\n3. Offering modern configuration and logging\n4. Unifying VB and C# application frameworks\n5. Maintaining full Designer compatibility\n6. Paving the way for cloud-native desktop applications\n\nThis proposal leverages existing, proven infrastructure from ASP.NET Core while respecting the unique requirements of desktop application development. The result is a modernized development experience that makes WinForms competitive with contemporary UI frameworks while preserving its strengths: Designer support, performance, and Windows integration.\n","Url":"https://github.com/dotnet/winforms/issues/14082","RelatedDescription":"Open issue \"[API Suggestion] WinForms Application Builder API Proposal\" (#14082)"},{"Id":"3661812351","IsPullRequest":false,"CreatedAt":"2025-11-25T07:23:09","Actor":"Malini-SF4235","Number":"14081","RawContent":null,"Title":"Visual Studio Crash When Invoking NativeMethods.SetWindowPos Method","State":"open","Body":"## Environment\nVisual Studio professional 2026 - version 18.0.0\n\n## .NET version\nFacing this issue in .NetCore\n\n## Did this work in a previous version of Visual Studio and/or previous .NET release?\nNo\n\n## Issue Description\nI have a Boolean property named NativeCheck. During the property processing, the SetWindowPos method is invoked. Visual Studio crashes when this method is executed. Below is the method definition:\n     `[DllImport(\"USER32.dll\");` \n    ` internal static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, int uFlags) `\n\n## Demo Link\n\n[CustomControl_Demo.zip](https://github.com/user-attachments/files/23740457/CustomControl_Demo.zip)\n\n### Issue replication video\n\nhttps://github.com/user-attachments/assets/884c2559-dc96-4e7c-b6f8-66788485120b\n\n### Steps to reproduce\n\n1. Open the Designer.\n2. Select the CustomButton and navigate to the Properties window.\n3. Set the NativeCheck property to True.\n\n**Expected Behavior**: The value should be properly set to the NativeCheck property without any issues.\n**Observed Behavior**: When setting the NativeCheck property to True, Visual Studio crashes.","Url":"https://github.com/dotnet/winforms/issues/14081","RelatedDescription":"Open issue \"Visual Studio Crash When Invoking NativeMethods.SetWindowPos Method\" (#14081)"},{"Id":"3661631220","IsPullRequest":false,"CreatedAt":"2025-11-25T06:06:55","Actor":"Malini-SF4235","Number":"14080","RawContent":null,"Title":"Bitmap Property Serialization Error in Custom Control","State":"open","Body":"## Environment\nVisual Studio professional 2026 - version 18.0.0\n\n## .NET version\nFacing this issue in .NetCore \n\n## Did this work in a previous version of Visual Studio and/or previous .NET release?\nNo\n\n## Issue Description\nI have a property of type Bitmap. When I add an image using this property, the following issue occurs: **Property value is not valid (Could not serialize value 'System.Drawing.Bitmap' as 'System.Drawing.Bitmap').**\n\n### Demo Link\n[CustomControl_Bitmap_Issue.zip](https://github.com/user-attachments/files/23739030/CustomControl_Bitmap_Issue.zip)\n\n### Issue replication video\n\nhttps://github.com/user-attachments/assets/bd038418-f826-48cf-9fa6-f8d8f64e2c50\n\n### Steps to reproduce\n\n1. Open the Designer.\n2. Select the CustomButton and go to the Properties window.\n3. Click the Icon property and try to add an image.\n\n**Expected Behavior:** The image should be added properly when adding it through the Icon property.\n**Observed Behavior:** The image was not added properly.","Url":"https://github.com/dotnet/winforms/issues/14080","RelatedDescription":"Open issue \"Bitmap Property Serialization Error in Custom Control\" (#14080)"},{"Id":"3661419574","IsPullRequest":true,"CreatedAt":"2025-11-25T04:07:49","Actor":"LeafShi1","Number":"14079","RawContent":null,"Title":"Fix incorrect logic in CharIsPrintable for UnicodeCategory exclusions","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #14072\r\n\r\n## Proposed changes\r\n\r\n-  The original implementation of `CharIsPrintable` contains a semantic error in the combination of is not and or. As a result, it returns true for any character that is not `Control`, incorrectly classifying characters from `Format`, `LineSeparator`, `ParagraphSeparator`, and `OtherNotAssigned` as printable.\r\n**Impact**: Zero-width spaces, line separators, paragraph separators, and unassigned code points are treated as printable, even though they render as invisible, garbled symbols, or empty spaces.\r\n\r\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14079)","Url":"https://github.com/dotnet/winforms/pull/14079","RelatedDescription":"Open PR \"Fix incorrect logic in CharIsPrintable for UnicodeCategory exclusions\" (#14079)"},{"Id":"3661250410","IsPullRequest":true,"CreatedAt":"2025-11-25T03:03:49","Actor":"dotnet-maestro[bot]","Number":"14077","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251124.8](https://dev.azure.com/dnceng/internal/_build/results?buildId=2846500) ([292184](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/292184))\n- **Date Produced**: November 24, 2025 10:54:17 PM UTC\n- **Commit**: [d119b40e8ff3b88f87ad60b04c807233a159b197](https://github.com/dotnet/dotnet/commit/d119b40e8ff3b88f87ad60b04c807233a159b197)\n- **Commit Diff**: [cc7f6e8...d119b40](https://github.com/dotnet/dotnet/compare/cc7f6e84d8dae36ad9ea51a5112627b8235982cc...d119b40e8ff3b88f87ad60b04c807233a159b197)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25571.109 to 11.0.0-beta.25574.108][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25571.109 to 10.0.0-rc.3.25574.108][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/cc7f6e84d8...d119b40e8f\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/c1926cf647dd684194c2914f47f61ff534f030ac...a8b9e73f56e84dcb4c7ed0f23f79b308b4f83a01\n- https://github.com/dotnet/aspnetcore/compare/913ff28b8e834b51ded284118accebdaf85697a9...0d1029654a05e1685eea0b7689b42ca07b2af201\n- https://github.com/dotnet/efcore/compare/fe9cccd98fe3b0897ebb9f47943194bc91be5595...5544d0fe9b5b4dd6cc44a14f13b364219b7d8b2e\n- https://github.com/dotnet/msbuild/compare/708535641d9cb8412b9761f7e29a92672a11c7b1...b71ea6cf13af59b838346727b37e26858781d018\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:d119b40e8ff3b88f87ad60b04c807233a159b197..https://github.com/dotnet/winforms:darc-main-84606ea3-31c0-4fa4-84f0-c6a728363574\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14077)","Url":"https://github.com/dotnet/winforms/pull/14077","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14077)"},{"Id":"3661251777","IsPullRequest":true,"CreatedAt":"2025-11-25T02:20:59","Actor":"Copilot","Number":"14078","RawContent":null,"Title":"Fix ToolStripMenuItem character input in design mode","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\n\nFixes #13234\n\n## Proposed changes\n\n- Add `IsInDesignMode` check before calling `SetActiveToolStrip(this)` in `WM_SETFOCUS` handler\n- Prevents modal menu mode from intercepting keyboard input in design surfaces\n\nPR #13034 fixed #12916 by calling `SetActiveToolStrip(this)` on `WM_SETFOCUS`, but this unconditionally enters modal menu mode which redirects keyboard input to the ToolStrip. In design mode (e.g., DemoConsole), this prevents text entry when editing menu items.\n\n```csharp\nif (!IsInDesignMode)\n{\n    ToolStripManager.ModalMenuFilter.SetActiveToolStrip(this);\n}\n```\n\nThis follows the existing pattern at line 4614: `if (!IsDropDown && !IsInDesignMode)`.\n\n## Customer Impact\n\n- Users of custom design surfaces (like DemoConsole) can now enter text when adding ToolStripMenuItems\n- No impact to Visual Studio designer (confirmed not to reproduce there)\n\n## Regression? \n\n- Yes, introduced by #13034\n\n## Risk\n\n- Low: minimal change, follows existing pattern, only affects design mode behavior\n\n## Test methodology\n\n- Code review verified pattern consistency with existing `IsInDesignMode` checks in same method\n- Issue confirmed to not reproduce in VS designer per comment from @ricardobossan\n\n> [!WARNING]\n>\n> <details>\n> <summary>Firewall rules blocked me from connecting to one or more addresses (expand for details)</summary>\n>\n> #### I tried to connect to the following addresses, but was blocked by firewall rules:\n>\n> - `st8vsblobprodcus339.vsblob.vsassets.io`\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet /home/REDACTED/work/winforms/winforms/.dotnet/dotnet msbuild /m /nologo /clp:Summary /v:minimal /nr:true /warnaserror /p:TreatWarningsAsErrors=true /p:ContinuousIntegrationBuild=false /home/REDACTED/work/winforms/winforms/artifacts/toolset/restore.proj /t:__WriteToolsetLocation /clp:ErrorsOnly;NoSummary /p:__ToolsetLocationOutputFile=/home/REDACTED/work/winforms/winforms/artifacts/toolset/11.0.0-beta.25571.109.txt` (dns block)\n>   - Triggering command: `/home/REDACTED/work/winforms/winforms/.dotnet/dotnet dotnet build --no-restore` (dns block)\n>\n> If you need me to access, download, or install something from one of these locations, you can either:\n>\n> - Configure [Actions setup steps](https://gh.io/copilot/actions-setup-steps) to set up my environment, which run before the firewall is enabled\n> - Add the appropriate URLs or hosts to the custom allowlist in this repository's [Copilot coding agent settings](https://github.com/dotnet/winforms/settings/copilot/coding_agent) (admins only)\n>\n> </details>\n\n<!-- START COPILOT CODING AGENT SUFFIX -->\n\n\n\n<details>\n\n<summary>Original prompt</summary>\n\n\n----\n\n*This section details on the original issue you should resolve*\n\n<issue_title>Cannot enter characters when adding ToolStripMenuItem1 and then adding ToolStripMenuItem2 after pressing enter in DemoConsole application</issue_title>\n<issue_description>### .NET version\n\nmain branch of WinForms repo\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nYes, this is a regression issue. Not repro on .NET 9.0 from Release/9.0 branch of WinForms repo.\n\nhttps://github.com/user-attachments/assets/11a56acc-3a27-43d0-adeb-20824cb2bb96\n\n### Issue description\n\n**Actual result:**\nCannot enter characters when adding ToolStripMenuItem1 and then adding ToolStripMenuItem2 after pressing enter in DemoConsole application.\n\nhttps://github.com/user-attachments/assets/1e6fe900-449b-43bd-bfd1-e0c714f73a84\n\n**Expected result:**\nCharacters can be entered when adding ToolStripMenuItem1 and then adding ToolStripMenuItem2 after pressing enter in DemoConsole application.\n\nhttps://github.com/user-attachments/assets/42c4d5a2-b530-4d27-a466-7db5e687c202\n\n\n### Steps to reproduce\n\nTest sample: [DemoConsole](https://github.com/dotnet/winforms/tree/main/src/System.Windows.Forms/tests/IntegrationTests/DesignSurface/DemoConsole) bases on main branch in Winforms repo.\n\nMore info:\n1. This issue rerpo in ContextMenuStrip/MenuStrip/ToolStrip/BindingNavigator control in DemoConsole application.\n</issue_description>\n\n## Comments on the Issue (you are @copilot in this section)\n\n<comments>\n<comment_new><author>@merriemcgaw</author><body>\n@LeafShi1 can your team look into this one?</body></comment_new>\n<comment_new><author>@ricardobossan</author><body>\nThe issue is caused by commit dotnet/winforms#13034:\n`fix dotnet/winforms#12916 Cannot use down to expand ToolStripDropDownButton in toolStrip2 after using right/Left to collapse ToolStripDropDownButton in toolStrip1`.\n\nStill need to find a solution that resolves both this regression and the original problem from dotnet/winforms#12916 without reintroducing either.\n\n<details> <summary>git bisect log</summary>\n\n\n> git bisect start\n>  status: waiting for both good and bad commits\n>  good: [78c7bb89560a456a0f56aa05dc8b5ba222edf83f] System.Data.SqlClient - use version recommended by the SQL team, I couldn't find v5, not sure if it exists, we are not referencing this package right ow, so this is not a problem. Nuget.Packaging - use version that does not pull in vulnerable System.Formats.Asn1 (v8.0,0) Change in the VB test project - this assembly is not references directly, transitive versions can be resolved from the central packaging\n> git bisect good 78c7bb89560a456a0f56aa05dc8b5ba222edf83f\n>  status: waiting for bad commit, 1 good commit known\n>  bad: [9092b067aaec1122e8aa0163951cbe5862431125] [main] Update dependencies from dotnet/runtime (#13363)\n> git bisect bad 9092b067aaec1122e8aa0163951cbe5862431125\n>  bad: [1a430821e2c4696a5bd8f79db746aeb3ffb1f608] Ensure that System.Drawing facade assembly is built before the tests that consume it are. (#13119)\n> git bisect bad 1a430821e2c4696a5bd8f79db746aeb3ffb1f608\n>  bad: [1a430821e2c4696a5bd8f79db746aeb3ffb1f608] Ensure that System.Drawing facade assembly is built before the tests that consume it are. (#13119)\n> git bisect bad 1a430821e2c4696a5bd8f79db746aeb3ffb1f608\n>  good: [707898d6ce7eea814da61e2ec05bde666d27b85b] [main] Update dependencies from dotnet/arcade (#13032)\n> git bisect good 707898d6ce7eea814da61e2ec05bde666d27b85b\n>  bad: [316a77b46ba75f2a68aef1abcf4addb47e75bc79] Remove extra dot at the end of resource string (#13091)\n> git bisect bad 316a77b46ba75f2a68aef1abcf4addb47e75bc79\n>  bad: [5e8147d352c945eea0c9135faf0996d96993f8b9] Resizes `DemoConsole` project's `MainForm` for convenience and to make everything visible in the surface designer (#13050)\n> git bisect bad 5e8147d352c945eea0c9135faf0996d96993f8b9\n>  bad: [6e112b86c1b98a44f4473d45a7a7ec0d90354a7c] fix dotnet/winforms#12916 Cannot use down to expand ToolStripDropDownButton in toolStrip2 after using right/Left to collapse ToolStripDropDownButton in toolStrip1 (#13034)\n> git bisect bad 6e112b86c1b98a44f4473d45a7a7ec0d90354a7c\n>  good: [e9f1c43f83a393d0c7d3e0af70c26f589c5570f9] Enable nullability in DesignerActionMethodItem (#12676)\n> git bisect good e9f1c43f83a393d0c7d3e0af70c26f589c5570f9\n>  good: [e65c611ef4456c8a0d8250a10afcc27466f7cd23] [main] Update dependencies from dotnet/arcade (#13038)\n> git bisect good e65c611ef4456c8a0d8250a10afcc27466f7cd23\n>  good: [2dc1fbe6e65e068347aeb62ea558637ad35e647f] Add code coverage for ControlCodeDomSerializer (#13011)\n> git bisect good 2dc1fbe6e65e068347aeb62ea558637ad35e647f\n>  first bad commit: [6e112b86c1b98a44f4473d45a7a7ec0d90354a7c] fix dotnet/winforms#12916 Cannot use down to expand ToolStripDropDownButton in toolStrip2 after using right/Left to collapse ToolStripDropDownButton in toolStrip1 (#13034)\n\n\n\n</details></body></comment_new>\n<comment_new><author>@ricardobossan</author><...\n\n</details>\n\n- Fixes dotnet/winforms#13400\n\n<!-- START COPILOT CODING AGENT TIPS -->\n---\n\nâœ¨ Let Copilot coding agent [set things up for you](https://github.com/dotnet/winforms/issues/new?title=âœ¨+Set+up+Copilot+instructions&body=Configure%20instructions%20for%20this%20repository%20as%20documented%20in%20%5BBest%20practices%20for%20Copilot%20coding%20agent%20in%20your%20repository%5D%28https://gh.io/copilot-coding-agent-tips%29%2E%0A%0A%3COnboard%20this%20repo%3E&assignees=copilot) â€” coding agent works faster and does higher quality work when set up for your repo.\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14078)","Url":"https://github.com/dotnet/winforms/pull/14078","RelatedDescription":"Open PR \"Fix ToolStripMenuItem character input in design mode\" (#14078)"},{"Id":"3657724145","IsPullRequest":true,"CreatedAt":"2025-11-24T08:38:44","Actor":"SimonZhao888","Number":"14075","RawContent":null,"Title":"Fix issue 14071: ComboBox.ObjectCollection.CopyTo(Array destination, int index) copies Entry object, not inner item","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #14071 \r\n\r\n## Proposed changes\r\n\r\n- Refactored the CopyTo methods to ensure correct item copying and type safety.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- Copying ComboBox items to an array or using a collection wrapper will not throw an InvalidCastException exception.\r\n\r\n## Regression? \r\n\r\n- Yes\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\nhttps://github.com/user-attachments/assets/c03043ca-133c-49a3-90f9-11a0cd5ba1e1\r\n\r\n\r\n### After\r\n\r\nhttps://github.com/user-attachments/assets/b0c911d7-eecc-4838-a54b-9a9959efff25\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- 10.0.100-rc.2.25502.107\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14075)","Url":"https://github.com/dotnet/winforms/pull/14075","RelatedDescription":"Open PR \"Fix issue 14071: ComboBox.ObjectCollection.CopyTo(Array destination, int index) copies Entry object, not inner item\" (#14075)"},{"Id":"3656268450","IsPullRequest":true,"CreatedAt":"2025-11-23T17:33:18","Actor":"KlausLoeffelmann","Number":"14074","RawContent":null,"Title":"Fixing/clarifying XML comments for ScreenCaptureMode and VB's ColorMode.","State":"open","Body":"Fixes a couple of issues in XML comments for the ScreenCaptionMode and clarifies the usage of the ColorMode property in VB's `ApplyApplicationDefaultEventArg`.\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14074)","Url":"https://github.com/dotnet/winforms/pull/14074","RelatedDescription":"Open PR \"Fixing/clarifying XML comments for ScreenCaptureMode and VB's ColorMode.\" (#14074)"},{"Id":"3653667437","IsPullRequest":true,"CreatedAt":"2025-11-22T02:59:21","Actor":"dotnet-maestro[bot]","Number":"14073","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251121.9](https://dev.azure.com/dnceng/internal/_build/results?buildId=2844548) ([291900](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/291900))\n- **Date Produced**: November 21, 2025 10:37:52 PM UTC\n- **Commit**: [cc7f6e84d8dae36ad9ea51a5112627b8235982cc](https://github.com/dotnet/dotnet/commit/cc7f6e84d8dae36ad9ea51a5112627b8235982cc)\n- **Commit Diff**: [e9a2ab6...cc7f6e8](https://github.com/dotnet/dotnet/compare/e9a2ab63ad60de1afff34ddc3f09257093ea034a...cc7f6e84d8dae36ad9ea51a5112627b8235982cc)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25570.101 to 11.0.0-beta.25571.109][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25570.101 to 10.0.0-rc.3.25571.109][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/e9a2ab63ad...cc7f6e84d8\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/d0dd6fd98074a55efc1bfe63297467c706058a56...c1926cf647dd684194c2914f47f61ff534f030ac\n- https://github.com/dotnet/aspnetcore/compare/24ac6d1b50bfd3aabf0e17eee4599bb7bede6796...913ff28b8e834b51ded284118accebdaf85697a9\n- https://github.com/dotnet/efcore/compare/44e26052aca686cd939a3e018cc2046067ebec6a...fe9cccd98fe3b0897ebb9f47943194bc91be5595\n- https://github.com/dotnet/fsharp/compare/4396154347e812cffb31b5b5b95fdc2028bb4c8c...92987807b81666221740443a47e26023a03181de\n- https://github.com/dotnet/msbuild/compare/ad915a4f47346b746998dabaa541a7e3bab1d6cd...708535641d9cb8412b9761f7e29a92672a11c7b1\n- https://github.com/dotnet/winforms/compare/c3534d40dea348b8381be3a18567632946b5ad79...e237b3cbd7a7413161529a819b2e67bf3b18f31c\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:cc7f6e84d8dae36ad9ea51a5112627b8235982cc..https://github.com/dotnet/winforms:darc-main-1e4b06d2-af39-40fa-9cc3-5c05e5828a97\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14073)","Url":"https://github.com/dotnet/winforms/pull/14073","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14073)"},{"Id":"3653128863","IsPullRequest":false,"CreatedAt":"2025-11-21T21:25:25","Actor":"GrabYourPitchforks","Number":"14072","RawContent":null,"Title":"Possible incorrect use of \"NOT ... OR ...\" pattern","State":"open","Body":"Our internal tools are flagging these blocks of code as potentially improper use of the `not ... or ...` pattern matching syntax.\n\nhttps://github.com/dotnet/winforms/blob/2f677f9560b5258212c721c17f1e8803581608d7/src/System.Windows.Forms.Design/src/System/ComponentModel/Design/ByteViewer.cs#L173-L177\n\nSee https://github.com/dotnet/roslyn/issues/75506 for more information on why this pattern is being flagged. If this logic is correct, consider restructuring it to use clarifying `()` parentheses.","Url":"https://github.com/dotnet/winforms/issues/14072","RelatedDescription":"Open issue \"Possible incorrect use of \"NOT ... OR ...\" pattern\" (#14072)"},{"Id":"3649895436","IsPullRequest":true,"CreatedAt":"2025-11-21T20:42:32","Actor":"dotnet-maestro[bot]","Number":"14069","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20251120.3](https://dev.azure.com/dnceng/internal/_build/results?buildId=2843544) ([291651](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/291651))\n- **Date Produced**: November 20, 2025 5:37:12 PM UTC\n- **Commit**: [18f6e60aa4755c2be56b2d45165a135d64d4f710](https://github.com/dotnet/dotnet/commit/18f6e60aa4755c2be56b2d45165a135d64d4f710)\n- **Commit Diff**: [4090eb3...18f6e60](https://github.com/dotnet/dotnet/compare/4090eb301f5e5db13760aa57eeb32b516c42c56b...18f6e60aa4755c2be56b2d45165a135d64d4f710)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.25569.104 to 10.0.0-beta.25570.103][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.1 to 10.0.2][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.1-servicing.25569.104 to 10.0.2-servicing.25570.103][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/4090eb301f...18f6e60aa4\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/efcore/compare/a6217e3438ca1fb430079f2626056c1a11581927...d54ecf2ed5a399ac4711d242b27c38c2595c27bb\n- https://github.com/dotnet/runtime/compare/138d5fe8f32e954a3a834be6360a834688130d4f...b9d8d8fd95f15609f0a95decbab4fbc274ea727f\n- https://github.com/dotnet/sdk/compare/b7adad29114ef57fabf65324e712753767038626...39099c84c14d32453662391a18ec7717549e0584\n- https://github.com/dotnet/sourcelink/compare/307eb51fb9878894d4812276b85ac94293cd7b16...f854fc15a677a0a11e4541cfecdc9a33624dbca1\n- https://github.com/dotnet/windowsdesktop/compare/dddb7a4a4a834496cbd3e58c356fc4ff244e29ad...4530396214f05a463d87242577bfa11671a552d5\n- https://github.com/dotnet/winforms/compare/2b84c6556398afc04d16e1f3e01923c671178e4a...b048eab77c022ab125fc620c2ec56c7659b680ee\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:18f6e60aa4755c2be56b2d45165a135d64d4f710..https://github.com/dotnet/winforms:darc-release/10.0-34e6588e-f219-4317-b2c8-84bcf1119b47\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14069)","Url":"https://github.com/dotnet/winforms/pull/14069","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14069)"},{"Id":"3651078162","IsPullRequest":false,"CreatedAt":"2025-11-21T10:22:25","Actor":"abbweiman","Number":"14071","RawContent":null,"Title":"ComboBox.ObjectCollection.CopyTo(Array destination, int index) copies Entry object, not inner item","State":"open","Body":"### .NET version\n\n.NET 8, 10 etc.\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\n`ComboBox.ObjectCollection.CopyTo(Array destination, int index)` \"leaks\" the Entry objects to destination, instead of copying the actual items.\n\nIt should be `InnerList[i].Item` here:\nhttps://github.com/dotnet/winforms/blob/2f677f9560b5258212c721c17f1e8803581608d7/src/System.Windows.Forms/System/Windows/Forms/Controls/ComboBox/ComboBox.ObjectCollection.cs#L290\n\ncf. `CopyTo(object[] destination, int arrayIndex)`:\nhttps://github.com/dotnet/winforms/blob/2f677f9560b5258212c721c17f1e8803581608d7/src/System.Windows.Forms/System/Windows/Forms/Controls/ComboBox/ComboBox.ObjectCollection.cs#L275\n\nAnd also for example `ListBox.ObjectCollection.CopyTo(Array destination, int index)`:\nhttps://github.com/dotnet/winforms/blob/2f677f9560b5258212c721c17f1e8803581608d7/src/System.Windows.Forms/System/Windows/Forms/Controls/ListBoxes/ListBox.ObjectCollection.cs#L289\n\n### Steps to reproduce\n\nThis code works in .NET 4.8 but throws InvalidCastException in .NET core.\n```\n        class MyItem\n        {\n        }\n        static void Main(string[] args)\n        {\n            var cbo = new ComboBox();\n            cbo.Items.Add(new MyItem());\n            var item1 = (MyItem)cbo.Items[0];\n            var arrayList = new ArrayList(cbo.Items);\n            var item2 = (MyItem)arrayList[0]; // <-- InvalidCastException\n        }\n```","Url":"https://github.com/dotnet/winforms/issues/14071","RelatedDescription":"Open issue \"ComboBox.ObjectCollection.CopyTo(Array destination, int index) copies Entry object, not inner item\" (#14071)"},{"Id":"3649918143","IsPullRequest":true,"CreatedAt":"2025-11-21T02:52:39","Actor":"dotnet-maestro[bot]","Number":"14070","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20251120.1](https://dev.azure.com/dnceng/internal/_build/results?buildId=2843470) ([291616](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/291616))\n- **Date Produced**: November 20, 2025 12:21:56 PM UTC\n- **Commit**: [e9a2ab63ad60de1afff34ddc3f09257093ea034a](https://github.com/dotnet/dotnet/commit/e9a2ab63ad60de1afff34ddc3f09257093ea034a)\n- **Commit Diff**: [ea77dd1...e9a2ab6](https://github.com/dotnet/dotnet/compare/ea77dd1498eeaae360c4309d07ccd68c8936fe48...e9a2ab63ad60de1afff34ddc3f09257093ea034a)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.25569.110 to 11.0.0-beta.25570.101][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.0-rc.3.25569.110 to 10.0.0-rc.3.25570.101][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/ea77dd1498...e9a2ab63ad\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/4644199e9362b60be8f0d3cf632113bfa64ba208...d0dd6fd98074a55efc1bfe63297467c706058a56\n- https://github.com/dotnet/aspnetcore/compare/c07e28bfa41b12fb8f2511948373e86986fd50ca...24ac6d1b50bfd3aabf0e17eee4599bb7bede6796\n- https://github.com/dotnet/efcore/compare/7efce7bca80e997c22d75fdd073e573f318afafd...44e26052aca686cd939a3e018cc2046067ebec6a\n- https://github.com/dotnet/windowsdesktop/compare/4d1f50dff520560be1b73b7fd093109400c45e45...9d90f3f51f618c68d2af7ed75564599b37bf2a65\n\n<!--\n    To diff the source repo and PR branch contents locally, run:\n    darc vmr diff --name-only https://github.com/dotnet/dotnet:e9a2ab63ad60de1afff34ddc3f09257093ea034a..https://github.com/dotnet/winforms:darc-main-f79d2aa8-1051-412c-bde7-4ea17879bda7\n-->\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14070)","Url":"https://github.com/dotnet/winforms/pull/14070","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14070)"},{"Id":"3646501725","IsPullRequest":true,"CreatedAt":"2025-11-20T10:09:49","Actor":"LeafShi1","Number":"14068","RawContent":null,"Title":"Fix 14062: Exclude sizing grip width from DisplayRectangle when SizingGrip is enabled","State":"open","Body":"\r\n<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #14062 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Override `StatusStrip.DisplayRectangle` When `SizingGrip == true`:\r\n  - Compute DPI-scaled grip width via `ScaleHelper.ScaleToDpi(GripWidth, DeviceDpi)`.\r\n  - If `RightToLeft == Yes`, subtract width from the left and shift rect.X to the right by the grip width.\r\n  - If `RightToLeft == No`, subtract width from the right side.\r\n  - Use Math.Max(0, â€¦) to guarantee non-negative width.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- When SizingGrip is enabled, the text of the ToolStripStatusLabel at the end no longer overlaps with or is truncated by the grip, especially when mixed with labels set to Spring = true, resulting in greater stability.\r\n\r\n\r\n## Regression? \r\n\r\n- Yes\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\nThe right label is missing when the first ToolStripStatusLabel has Spring = True\r\n\r\n<img width=\"1411\" height=\"879\" alt=\"image\" src=\"https://github.com/user-attachments/assets/6c8b5b7e-298b-4cf3-8636-c610592648fa\" />\r\n\r\n\r\n### After\r\nThe right-side label is displayed in full.\r\n\r\nhttps://github.com/user-attachments/assets/df379b10-b683-4533-b23d-f6bca6ab850f\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n-  10.0.0-rc.3.25569.110\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14068)","Url":"https://github.com/dotnet/winforms/pull/14068","RelatedDescription":"Open PR \"Fix 14062: Exclude sizing grip width from DisplayRectangle when SizingGrip is enabled\" (#14068)"}],"ResultType":"GitHubIssue"}},"RunOn":"2025-12-02T03:30:31.9902828Z","RunDurationInMilliseconds":650}