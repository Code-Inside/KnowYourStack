{"Data":{"GitHub":{"Issues":[{"Id":"2087383618","IsPullRequest":false,"CreatedAt":"2024-01-18T03:01:23","Actor":"Tanya-Solyanik","Number":"10687","RawContent":null,"Title":"> I'm wrong. GetStandardValues is supposed to return the enum values, I was looking at the keys collection instead of the values collection. \"Standard values\" are always culture-independent. Before the fix, we were looking up by a culture that wasn't initialized. After the fix, we are looking up by culture that is always initialized.","State":"open","Body":"> I was not looking at GetStandardValues only, but the whole code in [KeysConverter](https://github.com/dotnet/winforms/blob/main/src/System.Windows.Forms/src/System/Windows/Forms/Input/KeysConverter.cs). Shouldn't CurrentCulture be replaced by CurrentUICulture in general?\r\n\r\n_Originally posted by @cadilhac in https://github.com/dotnet/winforms/issues/10610#issuecomment-1897509534_\r\n            ","Url":"https://github.com/dotnet/winforms/issues/10687","RelatedDescription":"Open issue \"> I'm wrong. GetStandardValues is supposed to return the enum values, I was looking at the keys collection instead of the values collection. \"Standard values\" are always culture-independent. Before the fix, we were looking up by a culture that wasn't initialized. After the fix, we are looking up by culture that is always initialized.\" (#10687)"},{"Id":"2087350439","IsPullRequest":false,"CreatedAt":"2024-01-18T02:24:33","Actor":"Tanya-Solyanik","Number":"10686","RawContent":null,"Title":"Annotate or get rid of the null-forgiving operators in PropertyGrid.cs and related files.","State":"open","Body":"This is a follow up on https://github.com/dotnet/winforms/pull/10110#discussion_r1360819144. \r\n\r\nInvestigate if https://github.com/dotnet/winforms/blob/f7d6850caa53f62816d977e737d6cb2a537f0d9a/src/System.Windows.Forms/src/System/Windows/Forms/Controls/PropertyGrid/PropertyGrid.cs#L3770 can be refactored to convince nullability analyzers that fields that are allocated in this method are not null. This would allow us to get rid of the null-forgiving operators. If not realistic, then then each null-forgiving operator should be annotated.","Url":"https://github.com/dotnet/winforms/issues/10686","RelatedDescription":"Open issue \"Annotate or get rid of the null-forgiving operators in PropertyGrid.cs and related files.\" (#10686)"},{"Id":"2087335220","IsPullRequest":true,"CreatedAt":"2024-01-18T02:08:01","Actor":"lonitra","Number":"10685","RawContent":null,"Title":"Add ScratchProject with Access to Internals","State":"open","Body":"Adds another test project similar to `ScratchProject` , which has access to our internals for experimenting.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10685)","Url":"https://github.com/dotnet/winforms/pull/10685","RelatedDescription":"Open PR \"Add ScratchProject with Access to Internals\" (#10685)"},{"Id":"2087258948","IsPullRequest":true,"CreatedAt":"2024-01-18T00:44:13","Actor":"paul1956","Number":"10684","RawContent":null,"Title":"Add VB Tests","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes # Missing VB Tests for Microsoft.VisualBasic.Devices\r\n\r\n\r\n## Proposed changes\r\n\r\n- Add tests without any changes to formatting \r\n- \r\n- \r\n\r\n## Customer Impact\r\nImprove test coverage for VisualBasic.Devices before changes are made to improve functionality.\r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- None- no runtime code changes\r\n\r\n\r\n## Test methodology\r\n\r\n- These are just adding tests to test existing code\r\n- Code Coverage should improve, tests themselves should have 100% Coverage\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10684)","Url":"https://github.com/dotnet/winforms/pull/10684","RelatedDescription":"Open PR \"Add VB Tests\" (#10684)"},{"Id":"2084939249","IsPullRequest":true,"CreatedAt":"2024-01-17T19:24:21","Actor":"lonitra","Number":"10674","RawContent":null,"Title":"Fix SafeArray type in HtmlDocument.Write","State":"closed","Body":"Fixes https://github.com/dotnet/winforms/issues/10615 , regression from https://github.com/dotnet/winforms/pull/9972\r\n- Avoid throwing on failure in `IHtmlDocument2.Write` as original code did not throw on failure \r\n- While making changes in the regression PR, I had accidentally commented out some tests covering this scenario ü§¶‚Äç‚ôÄÔ∏è , I re-enabled those tests which covers scenario outlined by issue\r\n- The SafeArray type passed to `IHtmlDocument2.Write` needs to be `VT_VARIANT` so I've added to `SafeArrayScope` to be able to handle this.\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10674)","Url":"https://github.com/dotnet/winforms/pull/10674","RelatedDescription":"Closed or merged PR \"Fix SafeArray type in HtmlDocument.Write\" (#10674)"},{"Id":"2086688417","IsPullRequest":true,"CreatedAt":"2024-01-17T18:22:14","Actor":"lonitra","Number":"10683","RawContent":null,"Title":"Add PrivateAsset tag to System.Drawing.Common","State":"closed","Body":"Help fix build errors in https://github.com/dotnet/wpf/pull/8694\r\nThis is the same error as received in https://github.com/dotnet/wpf/pull/8635. This tag was removed recently, but it actually needs to be present to avoid this error.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10683)","Url":"https://github.com/dotnet/winforms/pull/10683","RelatedDescription":"Closed or merged PR \"Add PrivateAsset tag to System.Drawing.Common\" (#10683)"},{"Id":"2086147918","IsPullRequest":true,"CreatedAt":"2024-01-17T18:15:39","Actor":"dotnet-maestro[bot]","Number":"10681","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20240116.3\r\n- **Date Produced**: January 16, 2024 11:53:17 PM UTC\r\n- **Commit**: d5ee27a55ec6383c29790f3ec666e7c87f7da022\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 9.0.0-beta.24065.5 to 9.0.0-beta.24066.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/0d95a90310...d5ee27a55e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10681)","Url":"https://github.com/dotnet/winforms/pull/10681","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#10681)"},{"Id":"2086148384","IsPullRequest":true,"CreatedAt":"2024-01-17T13:32:46","Actor":"dotnet-maestro[bot]","Number":"10682","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240116.33\r\n- **Date Produced**: January 17, 2024 10:22:11 AM UTC\r\n- **Commit**: dbb335c6ba14b38400b2d8c3a5876698021ec089\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24066.1 to 9.0.0-alpha.1.24066.33][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/613a13fb4a...dbb335c6ba\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10682)","Url":"https://github.com/dotnet/winforms/pull/10682","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10682)"},{"Id":"2086107033","IsPullRequest":false,"CreatedAt":"2024-01-17T12:38:47","Actor":"AngeloCresta","Number":"10680","RawContent":null,"Title":" CheckBoxRenderer.DrawCheckBox has always a white background","State":"open","Body":"### .NET version\r\n\r\nHost:\r\n  Version:      8.0.1\r\n  Architecture: x64\r\n  Commit:       bf5e279d92\r\n\r\n.NET SDKs installed:\r\n  8.0.101 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 7.0.15 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.AspNetCore.App 8.0.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 7.0.15 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.NETCore.App 8.0.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 7.0.15 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n  Microsoft.WindowsDesktop.App 8.0.1 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nYes, in .Net7 (and prior) is working in .Net8 --> no\r\n\r\n### Issue description\r\n\r\nThe backcolor of the checkbox is not applied using CheckBoxRenderer.DrawCheckBox(...)\r\n\r\nIn .Net7:\r\n![image](https://github.com/dotnet/winforms/assets/12256319/082f3894-1521-46b1-9032-a9bb1d877eff)\r\n\r\nIn .Net8:\r\n![image](https://github.com/dotnet/winforms/assets/12256319/d8b87c24-a0c9-443f-a3ed-d7d7a03835d6)\r\n\r\n\r\n### Steps to reproduce\r\n\r\nI've attached a sample project, but the relevant part, after adding a treeview to a form is:\r\n\r\n` \r\nCheckBoxRenderer.DrawCheckBox(g, new Point(0, 1), System.Windows.Forms.VisualStyles.CheckBoxState.UncheckedNormal);\r\n` \r\n[Treeview_Checkbox.zip](https://github.com/dotnet/winforms/files/13963245/Treeview_Checkbox.zip)\r\n\r\nAngelo","Url":"https://github.com/dotnet/winforms/issues/10680","RelatedDescription":"Open issue \" CheckBoxRenderer.DrawCheckBox has always a white background\" (#10680)"},{"Id":"2085703325","IsPullRequest":false,"CreatedAt":"2024-01-17T08:50:38","Actor":"LeafShi1","Number":"10679","RawContent":null,"Title":"Add unit test for Link label","State":"open","Body":"Add unit tests for PR#[10642](https://github.com/dotnet/winforms/pull/10642)\r\n\r\n\r\n\r\nUsing the following code in a .net core project reproduces issue #10515, \r\n- When the `linkLabel.Text` is null or empty, the code `Application.DoEvents();`  will enter an infinite loop before PR#[10642](https://github.com/dotnet/winforms/pull/10642)\r\n\r\n```\r\n LinkLabel linkLabel = new();\r\n // try to comment out  this line 'linkLabel.Text = \"2\";'\r\n // and observe the result after click the button\r\n linkLabel.Text = \"\";\r\n\r\nthis.Controls.Add(linkLabel);\r\nthis.Invalidate();\r\nApplication.DoEvents(); \r\n\r\nMessageBox.Show(\"button1_Click\");\r\n```\r\n\r\nHowever,  `Application.DoEvents();` is invalid when used in Unit test, so additional tests need to be added for PR#https://github.com/dotnet/winforms/pull/10642","Url":"https://github.com/dotnet/winforms/issues/10679","RelatedDescription":"Open issue \"Add unit test for Link label\" (#10679)"},{"Id":"2082945089","IsPullRequest":false,"CreatedAt":"2024-01-17T04:29:53","Actor":"EVA-SS","Number":"10665","RawContent":null,"Title":"Dark mode, the scroll bar theme is incorrect.","State":"closed","Body":"### .NET version\r\n\r\n.net6.0\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nall\r\n\r\n### Issue description\r\n\r\nAfter enabling dark mode, the scroll bar remains in the light theme.\r\n\r\n![DarkTestGIF](https://github.com/dotnet/winforms/assets/13210002/4d5fac95-d3a4-428e-b35c-ea881f6ff7c5)\r\n\r\n\r\n```csharp\r\n        private void button1_Click(object sender, EventArgs e)\r\n        {\r\n            Dark = !Dark;\r\n        }\r\n\r\n        bool dark = false;\r\n        public bool Dark\r\n        {\r\n            get => dark;\r\n            set\r\n            {\r\n                dark = value;\r\n                if (value)\r\n                {\r\n                    BackColor = Color.Black;\r\n                    ForeColor = Color.White;\r\n                }\r\n                else\r\n                {\r\n                    BackColor = Color.White;\r\n                    ForeColor = Color.Black;\r\n                }\r\n                int useImmersiveDarkMode = value ? 1 : 0;\r\n                DwmSetWindowAttribute(Handle, DWMWA_USE_IMMERSIVE_DARK_MODE, ref useImmersiveDarkMode, sizeof(int));\r\n            }\r\n        }\r\n\r\n        #region DarkDwm\r\n\r\n        [DllImport(\"dwmapi.dll\")]\r\n        static extern int DwmSetWindowAttribute(IntPtr hwnd, int attr, ref int attrValue, int attrSize);\r\n\r\n        const int DWMWA_USE_IMMERSIVE_DARK_MODE = 20;\r\n\r\n        #endregion\r\n```\r\n\r\n[DarkTest.zip](https://github.com/dotnet/winforms/files/13944921/DarkTest.zip)\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\nAfter invoking \"Dark=true\", the scroll bar color remains in the light theme.","Url":"https://github.com/dotnet/winforms/issues/10665","RelatedDescription":"Closed issue \"Dark mode, the scroll bar theme is incorrect.\" (#10665)"},{"Id":"2085221235","IsPullRequest":false,"CreatedAt":"2024-01-17T04:07:47","Actor":"vsfeedback","Number":"10676","RawContent":null,"Title":"The webp image format in .NET","State":"closed","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/The-webp-image-format-in-NET/10419132)._\n\n---\nHow can I get the webp image format recognized in .NET development? I cannot create a bitmap with that format yet.\n\n---\n### Original Comments\n\n#### Feedback Bot on 7/19/2023, 11:37 PM: \n\n(private comment, text removed)\n#### maxburns090@gmail.com on 7/23/2023, 10:37 PM: \n\n(private comment, text removed)","Url":"https://github.com/dotnet/winforms/issues/10676","RelatedDescription":"Closed issue \"The webp image format in .NET\" (#10676)"},{"Id":"2085304791","IsPullRequest":true,"CreatedAt":"2024-01-17T03:53:40","Actor":"SimonZhao888","Number":"10678","RawContent":null,"Title":"Remove  System.Design and Drawing from codecov.yml file","State":"closed","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes # https://github.com/dotnet/winforms/pull/10476#discussion_r1446868536\r\n\r\n- Remove  System.Design and Drawing from reporting.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10678)","Url":"https://github.com/dotnet/winforms/pull/10678","RelatedDescription":"Closed or merged PR \"Remove  System.Design and Drawing from codecov.yml file\" (#10678)"},{"Id":"2085266269","IsPullRequest":false,"CreatedAt":"2024-01-17T02:18:39","Actor":"SimonZhao888","Number":"10677","RawContent":null,"Title":"VS is not responding after adding a user control that with events handling to the Form designer","State":"open","Body":"### .NET version\r\n\r\n9.0.100-alpha.1.24066.10\r\n\r\n### Did it work in .NET Framework?\r\n\r\nNot tested/verified\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\n_No response_\r\n\r\n### Issue description\r\n\r\nVS is not responding after adding a user control that with events handling to the Form designer.\r\n![84885709-fee9c300-b0c5-11ea-986c-1c4ae0352f57](https://github.com/dotnet/winforms/assets/133954995/e19ca3bd-f364-40ff-bc57-ec83e49adcec)\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Create a Winforms core project.\r\n2. Add a User Control to the same project.\r\n3. Generate the UserControl1_Load event with following code: MessageBox.Show(\"Not Responding\");\r\n4. Build and reopen the Form designer.\r\n5. Drag the user control to the Form designer.\r\n\r\nOr\r\n\r\n1. Open the attached project. [NotResponding.zip](https://github.com/dotnet/winforms-designer/files/4791793/NotResponding.zip)\r\n2. Build and Drag the user control to the Form designer.","Url":"https://github.com/dotnet/winforms/issues/10677","RelatedDescription":"Open issue \"VS is not responding after adding a user control that with events handling to the Form designer\" (#10677)"},{"Id":"2081342466","IsPullRequest":false,"CreatedAt":"2024-01-17T02:06:12","Actor":"Olina-Zhang","Number":"10659","RawContent":null,"Title":"Failed to get installed printers in System.Drawing.Printing.PrinterSettings.get_InstalledPrinters()","State":"closed","Body":"### .NET version\r\n\r\n9.0.100-alpha.1.24062.11\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nYes\r\n\r\n### Issue description\r\n\r\nFailed to get installed printers in System.Drawing.Printing.PrinterSettings.get_InstalledPrinters(), may be caused by PR: https://github.com/dotnet/winforms/pull/10598\r\n\r\nIn the latest .Net 9.0 SDK build: 9.0.100-alpha.1.24062.11, an exception pops up:\r\n_System.ComponentModel.Win32Exception\r\n  HResult=0x80004005\r\n  Message=**The parameter is incorrect.**\r\n  Source=System.Drawing.Common\r\n  StackTrace:\r\n   at System.Drawing.Printing.PrinterSettings.get_InstalledPrinters()\r\n   at PrinterListForm.Form1.LoadPrinters() in C:\\Users\\xxx\\source\\repos\\PrinterListForm\\PrinterListForm\\Form1.cs:line 14\r\n   at PrinterListForm.Form1..ctor() in C:\\Users\\xxx\\source\\repos\\PrinterListForm\\PrinterListForm\\Form1.cs:line 8\r\n   at PrinterListForm.Program.Main() in C:\\Users\\xxx\\source\\repos\\PrinterListForm\\PrinterListForm\\Program.cs:line 14_\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\nBuild and run following a sample project:\r\n[PrinterListForm.zip](https://github.com/dotnet/winforms/files/13935622/PrinterListForm.zip)\r\n","Url":"https://github.com/dotnet/winforms/issues/10659","RelatedDescription":"Closed issue \"Failed to get installed printers in System.Drawing.Printing.PrinterSettings.get_InstalledPrinters()\" (#10659)"},{"Id":"2083130596","IsPullRequest":false,"CreatedAt":"2024-01-17T02:05:59","Actor":"Junjun-zhao","Number":"10668","RawContent":null,"Title":"[dotnet-sdk-9.0.100-alpha.1.24062.11] System.ComponentModel.Win32Exception with PrintPreviewDialog.ShowDialog()","State":"closed","Body":"### .NET version\r\n```\r\n.NET SDK:\r\n Version:           9.0.100-alpha.1.24062.11\r\n Commit:            5e2e0f9758\r\n Workload version:  9.0.100-manifests.c56d33a3\r\n\r\nRuntime Environment:\r\n OS Name:     Windows\r\n OS Version:  10.0.22000\r\n OS Platform: Windows\r\n RID:         win-x64\r\n Base Path:   C:\\Program Files\\dotnet\\sdk\\9.0.100-alpha.1.24062.11\\\r\n\r\n.NET workloads installed:\r\nThere are no installed workloads to display.\r\n\r\nHost:\r\n  Version:      9.0.0-alpha.1.24061.26\r\n  Architecture: x64\r\n  Commit:       22ba7d607b\r\n\r\n.NET SDKs installed:\r\n  9.0.100-alpha.1.24062.11 [C:\\Program Files\\dotnet\\sdk]\r\n\r\n.NET runtimes installed:\r\n  Microsoft.AspNetCore.App 9.0.0-alpha.1.24061.8 [C:\\Program Files\\dotnet\\shared\\Microsoft.AspNetCore.App]\r\n  Microsoft.NETCore.App 9.0.0-alpha.1.24061.26 [C:\\Program Files\\dotnet\\shared\\Microsoft.NETCore.App]\r\n  Microsoft.WindowsDesktop.App 9.0.0-alpha.1.24061.5 [C:\\Program Files\\dotnet\\shared\\Microsoft.WindowsDesktop.App]\r\n```\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nYes\r\n1). Windows 10 21h2 AMD64 + dotnet-sdk-3.1.430-win-x64: Pass\r\n\r\n2). Windows 10 21h2 AMD64 + dotnet-sdk-6.0.418-win-x64: Pass\r\n\r\n3). Windows 10 21h2 AMD64 + dotnet-sdk-7.0.405-win-x64: Pass\r\n\r\n4). Windows 10 21h2 AMD64 + dotnet-sdk-8.0.101-win-x64-1201: Pass\r\n\r\n5). Windows 10 21h2 AMD64 + dotnet-sdk-9.0.100-alpha.1.24059.5: Pass\r\n\r\n6). Windows 10 21h2 AMD64 + dotnet-sdk-9.0.100-alpha.1.24062.11: **Fail**\r\n\r\n### Issue description\r\n\r\nWhen running a 3rd party application with the latest .NET 9 version, a System.ComponentModel.Win32Exception pops up after clicking the print button.\r\n\r\n**Application Name**: NotatnikMechanika\r\n**OS**Ôºö Windows 10 21H2\r\n**CPU**: X64\r\n**.NET Build Number**: dotnet-sdk-9.0.100-alpha.1.24062.11\r\n**Github link**: https://github.com/VersatileSoft/NotatnikMechanika\r\n**App or App source checking at**: https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1940489\r\n\r\n### Steps to reproduce\r\n\r\n**Minimal Repro steps (Demo attached):**\r\n[WinFormsApp.zip](https://github.com/dotnet/winforms/files/13945971/WinFormsApp.zip)\r\n**The machine has dotnet-sdk-9.0.100-alpha.1.24062.11 installed.**\r\n\r\n1. Create a new winfrom project with netcore3.1.\r\n2. Add a button control and a printPreviewDialog control in the Form1.\r\n3. Add following code in the Form1.cs.\r\n  ```\r\npublic partial class Form1 : Form\r\n     {\r\n        public Form1()\r\n        {\r\n            InitializeComponent();\r\n        }\r\n        private readonly PrintDocument pd = new PrintDocument();\r\n        private void button1_Click(object sender, EventArgs e)\r\n        {\r\n            printPreviewDialog1.Document = pd;\r\n            printPreviewDialog1.ShowDialog();\r\n        }\r\n    }\r\n```\r\n4. Build the app\r\n5. Update the runtime config file to .NET 9 versions:\r\n```\r\n\"frameworks\": [     \r\n      {\r\n        \"name\": \"Microsoft.WindowsDesktop.App\",\r\n        \"version\": \"9.0.0-alpha.1.24061.5\"\r\n      }\r\n    ],\r\n```\r\n6. Launch the app\r\n7. Click button1\r\n8. Click print button\r\n\r\n**Expected Result**: \r\n A File dialog will pop up.\r\n\r\n**Actual Result**: \r\n```\r\nSystem.ComponentModel.Win32Exception\r\n  HResult=0x80004005\r\n  Message=The operation completed successfully.\r\n  Source=System.Drawing.Common\r\n  StackTrace:\r\n   at System.Drawing.Printing.StandardPrintController.OnStartPrint(PrintDocument document, PrintEventArgs e)\r\n   at System.Drawing.Printing.PrintController.Print(PrintDocument document)\r\n   at System.Windows.Forms.ToolStripButton.OnClick(EventArgs e)\r\n   at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)\r\n   at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)\r\n   at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)\r\n   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)\r\n   at System.Windows.Forms.Control.WndProc(Message& m)\r\n   at System.Windows.Forms.ToolStrip.WndProc(Message& m)\r\n   at System.Windows.Forms.NativeWindow.Callback(HWND hWnd, MessageId msg, WPARAM wparam, LPARAM lparam)\r\n```\r\n**Findings:**\r\nWe have found a similar bug and are unsure if it is caused by the same issue.\r\nhttps://github.com/dotnet/winforms/issues/10659\r\n\r\n@dotnet-actwx-bot @dotnet/compat \r\n","Url":"https://github.com/dotnet/winforms/issues/10668","RelatedDescription":"Closed issue \"[dotnet-sdk-9.0.100-alpha.1.24062.11] System.ComponentModel.Win32Exception with PrintPreviewDialog.ShowDialog()\" (#10668)"},{"Id":"2083060389","IsPullRequest":true,"CreatedAt":"2024-01-17T01:48:49","Actor":"JeremyKuhne","Number":"10667","RawContent":null,"Title":"Move COM basics to Core & convert more GDI+ interop","State":"closed","Body":"This change converts the Image and Bitmap classes to CsWin32.\r\n\r\n- Move IStream, ComHelpers, IDispatch, VARIANT and other core COM code to Core\r\n- Change the name of GpStream to ComManagedStream and consolidate both versions\r\n- Create an extension method for Stream to create an IStream scope\r\n- Take in the latest CsWin32 drop to fix a blocking COM generation issue\r\n- Use the new option to not generate friendly overloads in System.Drawing (there is a pending metadata issue that causes some of these to be generated unsafely).\r\n- Update some code to throw ArgumentNull instead of NullRef\r\n- Fix PrinterSettings.InstalledPrinters and add a test\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10667)","Url":"https://github.com/dotnet/winforms/pull/10667","RelatedDescription":"Closed or merged PR \"Move COM basics to Core & convert more GDI+ interop\" (#10667)"},{"Id":"2085164040","IsPullRequest":true,"CreatedAt":"2024-01-17T00:08:48","Actor":"ricardobossan","Number":"10675","RawContent":null,"Title":"Adds tests for AxSystemMonitor","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nRelated #8302 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Instead of consolidating multiple controls into a single pull request, opted for separate PRs for each control for better organization.\r\n- Followed [Lonitra's instructions](https://github.com/dotnet/winforms/issues/8294#issuecomment-1331026574) on related issue #[8294](https://github.com/dotnet/winforms/issues/8294) by adding Ax control references to both the AxHosts project and the WinForms test project. Additionally, added corresponding tests.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- None\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Unit tests\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- 9.0.100-alpha.1.23618.3<!-- use `dotnet --info` -->\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10675)","Url":"https://github.com/dotnet/winforms/pull/10675","RelatedDescription":"Open PR \"Adds tests for AxSystemMonitor\" (#10675)"},{"Id":"2081401532","IsPullRequest":false,"CreatedAt":"2024-01-16T23:56:07","Actor":"Nora-Zhou01","Number":"10661","RawContent":null,"Title":"Running the control fails, displaying \"The type 'IHandle<>' is defined in an assembly that is not referenced\"","State":"closed","Body":"### .NET version\r\n\r\n9.0.100-alpha.1.24062.11\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nYes\r\n\r\n### Issue description\r\n\r\nRunning the control fails, displaying \"The type 'IHandle<>' is defined in an assembly that is not referenced.\"\r\nIn the latest .Net 9.0 SDK build: 9.0.100-alpha.1.24062.11, an exception pops up:\r\n\r\n_The type 'IHandle<>' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Private.Windows.Core, Version=9.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'._\r\n\r\nhttps://github.com/dotnet/winforms/assets/104609169/32139b56-6fa1-4bfa-800d-0b30407e9ca5\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Create a Winforms .Net application\r\n2. Add a NumericUpDown control to form designer\r\n3. Build and run application\r\n\r\n**More info:**\r\n\r\n1. There is a **workaround**: manually add \"**System.Private.Windows.Core.dll**\" to the project. The project can run normally\r\n2. This issue occurs in the following controls: NumericUpDown, TrackBar, Process, DataGridView, PictureBox, SplitContainer","Url":"https://github.com/dotnet/winforms/issues/10661","RelatedDescription":"Closed issue \"Running the control fails, displaying \"The type 'IHandle<>' is defined in an assembly that is not referenced\"\" (#10661)"},{"Id":"2084801695","IsPullRequest":true,"CreatedAt":"2024-01-16T22:15:46","Actor":"JeremyKuhne","Number":"10673","RawContent":null,"Title":"Add System.Private.Windows.Core to ref","State":"closed","Body":"As nothing is actually visible in this assembly we were trying to leave it out of the ref package. C# needs the types to be there when it compiles interface casts. This adds the assembly to the ref and excludes looking for IntelliSense files.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10673)","Url":"https://github.com/dotnet/winforms/pull/10673","RelatedDescription":"Closed or merged PR \"Add System.Private.Windows.Core to ref\" (#10673)"},{"Id":"2084568527","IsPullRequest":true,"CreatedAt":"2024-01-16T20:39:19","Actor":"ViktorHofer","Number":"10672","RawContent":null,"Title":"Make it possible to not import CMake Sdk when excluding project","State":"closed","Body":"More context in https://github.com/dotnet/arcade/issues/14295\r\n\r\nThis allows to not exclude the CMake.Sdk targets when the project should be excluded (i.e. in source-build or a VMR vertical build).\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10672)","Url":"https://github.com/dotnet/winforms/pull/10672","RelatedDescription":"Closed or merged PR \"Make it possible to not import CMake Sdk when excluding project\" (#10672)"},{"Id":"2081537586","IsPullRequest":false,"CreatedAt":"2024-01-16T19:35:05","Actor":"changhao6","Number":"10662","RawContent":null,"Title":"The caret is in the wrong place When typing into a MaskedTextBox using JP IME, ","State":"closed","Body":"### .NET version\n\n.net8\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\n![MaskedTextBox](https://github.com/dotnet/winforms/assets/47862827/b5115e20-9d0f-42f4-929c-270274f916c1)\r\nTyping some words to MaskedTextBox using Japanese IME, the position of the caret will always be in the leftmost part of the textbox if Select All (CTRL+A) first\r\n\r\n> \n\n### Steps to reproduce\n\n1. Drag and drop a MaskedTextBox to the designer form from the toolbox.\r\n2. Set MaskedTextBox Mask property to `(999) 000-0000`\r\n3. Run application.\r\n4. Click the MaskedTextBox and press `Ctrl+A`.\r\n5. Type `123` to the MaskedTextBox by using  MS JP IME and then press `Enter`.\r\n6. The caret position still at the start of MaskedTextBox (it's wrong).","Url":"https://github.com/dotnet/winforms/issues/10662","RelatedDescription":"Closed issue \"The caret is in the wrong place When typing into a MaskedTextBox using JP IME, \" (#10662)"},{"Id":"2081136815","IsPullRequest":true,"CreatedAt":"2024-01-16T17:05:25","Actor":"LeafShi1","Number":"10657","RawContent":null,"Title":"Removing eng/common/build.sh","State":"closed","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #10491 \r\n\r\n\r\n## Proposed changes\r\n\r\n- Remove eng/common/build.sh as the Windows-only SDK cannot be built in Unix machine, we will add this file as needed\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10657)","Url":"https://github.com/dotnet/winforms/pull/10657","RelatedDescription":"Closed or merged PR \"Removing eng/common/build.sh\" (#10657)"},{"Id":"2083923623","IsPullRequest":true,"CreatedAt":"2024-01-16T13:38:34","Actor":"dotnet-maestro[bot]","Number":"10671","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240116.1\r\n- **Date Produced**: January 16, 2024 11:27:57 AM UTC\r\n- **Commit**: 613a13fb4af81f8ed0b0d27dff58fa0c6129e5ba\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24064.3 to 9.0.0-alpha.1.24066.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/6f9d656968...613a13fb4a\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10671)","Url":"https://github.com/dotnet/winforms/pull/10671","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10671)"},{"Id":"2083922995","IsPullRequest":true,"CreatedAt":"2024-01-16T13:38:12","Actor":"dotnet-maestro[bot]","Number":"10670","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20240115.5\r\n- **Date Produced**: January 16, 2024 7:26:33 AM UTC\r\n- **Commit**: 0d95a90310e5e2afbef31f4ca1c4b692698cd686\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 9.0.0-beta.24062.5 to 9.0.0-beta.24065.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/d731f58a50...0d95a90310\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10670)","Url":"https://github.com/dotnet/winforms/pull/10670","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#10670)"},{"Id":"2083377747","IsPullRequest":true,"CreatedAt":"2024-01-16T09:04:51","Actor":"Epica3055","Number":"10669","RawContent":null,"Title":"[release/8.0] [Accessibility]Inspect or AccessibilityInsights tool's rectangle can't focus on the entire FlowLayoutPanel/Panel/SplitContainer/TableLayoutPanel/TabControl/TextBox with scrollBar","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #10540\r\n\r\n\r\n## Proposed changes\r\n\r\n- \r\n-  There is something wrong with the base method `BoundingRectangle`.\r\nSo override this method in the same manner that `ListBox` did\r\nhttps://github.com/dotnet/winforms/blob/9e2fc95fca4e6d18444c819b35bb1338ac6ca63d/src/System.Windows.Forms/src/System/Windows/Forms/Controls/ListBoxes/ListBox.AccessibleObject.cs#L31-L32C10\r\n- \r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n\r\n## Regression? \r\n\r\n- Yes \r\n\r\n## Risk\r\n\r\n- minimal \r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n![image](https://github.com/dotnet/winforms/assets/38325459/5a6b8c79-ce62-418c-a953-718e156e5e4d)\r\n![image](https://github.com/dotnet/winforms/assets/38325459/80b9973c-21a2-4ab5-bdd4-aafe5adf448b)\r\n![image](https://github.com/dotnet/winforms/assets/38325459/2f10ef12-224a-4613-bd46-3345bd379d95)\r\n\r\n\r\n\r\n### After\r\n\r\n\r\n\r\n![image](https://github.com/dotnet/winforms/assets/38325459/3db13ec7-ee3c-44bf-9f4d-0e71d896116b)\r\n![image](https://github.com/dotnet/winforms/assets/38325459/2d0c015a-60ec-4ae7-a0bc-86160f85f191)\r\n![image](https://github.com/dotnet/winforms/assets/38325459/24c15fa2-d2f9-45d1-ac18-442b5380c3d4)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- \r\n- manual \r\n- \r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10669)","Url":"https://github.com/dotnet/winforms/pull/10669","RelatedDescription":"Open PR \"[release/8.0] [Accessibility]Inspect or AccessibilityInsights tool's rectangle can't focus on the entire FlowLayoutPanel/Panel/SplitContainer/TableLayoutPanel/TabControl/TextBox with scrollBar\" (#10669)"},{"Id":"2081606396","IsPullRequest":false,"CreatedAt":"2024-01-16T05:52:46","Actor":"changhao6","Number":"10663","RawContent":null,"Title":"The result of Screen.FromPoint() is wrong.","State":"closed","Body":"### .NET version\n\n.net8\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\n_No response_\n\n### Issue description\n\nI want to konw which screen the cursor in when mousemove in the form by using the code blow:\r\n```C#\r\n        private void Form1_MouseMove(object sender, MouseEventArgs e)\r\n        {\r\n            var screen = Screen.FromPoint(MousePosition);\r\n            this.label1.Text = $\"{screen.DeviceName}\";\r\n        }\r\n```\r\nIt seem can't get which screen the mouse is in exactly.\r\n![screen](https://github.com/dotnet/winforms/assets/47862827/dc5277cf-d0ee-426c-890e-ab95a434f293)\r\nThe background color purple is screen1 and black is screen2.\n\n### Steps to reproduce\n\nMove the form between the two screens and move the mouse.","Url":"https://github.com/dotnet/winforms/issues/10663","RelatedDescription":"Closed issue \"The result of Screen.FromPoint() is wrong.\" (#10663)"},{"Id":"2081994091","IsPullRequest":true,"CreatedAt":"2024-01-15T13:32:52","Actor":"dotnet-maestro[bot]","Number":"10664","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20240114.3\r\n- **Date Produced**: January 15, 2024 1:47:44 AM UTC\r\n- **Commit**: 6f9d6569684cc17015aa6fc5f9d9a5f7580ade97\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.CodeDom**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.ComponentModel.Composition**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.ComponentModel.Composition.Registration**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Data.Odbc**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Data.OleDb**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Diagnostics.EventLog**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.DirectoryServices**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.DirectoryServices.AccountManagement**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.DirectoryServices.Protocols**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.IO.Packaging**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.IO.Ports**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Management**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Reflection.Context**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Resources.Extensions**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Runtime.Caching**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Security.Cryptography.Xml**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Security.Permissions**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.ServiceModel.Syndication**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.ServiceProcess.ServiceController**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Speech**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Text.Encoding.CodePages**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Text.Encodings.Web**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Text.Json**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Threading.AccessControl**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **System.Windows.Extensions**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.9.0**: [from 9.0.0-alpha.1.24063.6 to 9.0.0-alpha.1.24064.3][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/300013b6df...6f9d656968\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10664)","Url":"https://github.com/dotnet/winforms/pull/10664","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#10664)"},{"Id":"2083003184","IsPullRequest":false,"CreatedAt":"2024-01-15T08:27:07","Actor":"vsfeedback","Number":"10666","RawContent":null,"Title":"Another emoji bug with Rich Text Control (bullet points disappear when emojis are added)","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/Another-emoji-bug-with-Rich-Text-Control/10555911)._\n\n---\n[severity:Other]\nSome of the users of my software have reported the following problem with emojis and the Microsoft Rich Text Control - and I can reproduce the problem:\n\nThe problem is that inserting emojis into rich text controls that contain bullet points, frequently causes the bullets to \ndisappear.  It doesn't always happen with all emojis.  It may be that some emojis are worse than others.  Also, it appears to happen more easily with Windows 11 than with Windows 10.  Here is one (of many) ways to reproduce:\n\nUsing Windows 11, type the following text on 4 lines, into a dialog containing a Microsoft Rich Text Control (you will also need to have a way of getting the control to add bullets):\n\nOK\nOne\nTwo\nThree\n\nPosition the cursor right at the start, before the word 'OK'.  Press the Windows (flag) key + '.' (the full stop) on your keyboard.  The emoji popup window opens.  Click or double-click a few times on the 'Heart' emoji, to insert heart emojis.  These go in OK (black-and-white version).  Now select lines 2 to 4 and use your method, whatever it is, of forcing these lines to be bullet-points.  When you do this, the lines  become indented, but the bullets do not display. \n\nActually, this works even if the bullets were already there.  They would just disappear.  Deleting the emoji does not immediately fix the problem.\n\nThe above method doesn't work for me in Windows 10 (i.e. in Windows 10, the bullet points display OK if I do the above).  This only works consistently in Windows 11.  I can get the problem to occur in Windows 10, but less consistently.\n\n\n---\n### Original Comments\n\n#### Nick Walker on 1/10/2024, 02:40 AM: \n\n(private comment, text removed)\n#### Alison Jin [MSFT] on 1/10/2024, 10:01 AM: \n\n(private comment, text removed)\n#### Nick Walker on 1/13/2024, 05:37 AM: \n\n(private comment, text removed)\n#### Feedback Bot on 1/15/2024, 09:38 AM: \n\n(private comment, text removed)\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/winforms/issues/10666","RelatedDescription":"Open issue \"Another emoji bug with Rich Text Control (bullet points disappear when emojis are added)\" (#10666)"},{"Id":"2081356750","IsPullRequest":true,"CreatedAt":"2024-01-15T06:44:57","Actor":"GangWang01","Number":"10660","RawContent":null,"Title":"[DO NOT MERGE] Install scripts update validation PR","State":"open","Body":"### Testing only\r\nSample PR to test install scripts updates\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/10660)","Url":"https://github.com/dotnet/winforms/pull/10660","RelatedDescription":"Open PR \"[DO NOT MERGE] Install scripts update validation PR\" (#10660)"}],"ResultType":"GitHubIssue"}},"RunOn":"2024-01-18T03:30:27.6506254Z","RunDurationInMilliseconds":496}