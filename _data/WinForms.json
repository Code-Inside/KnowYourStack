{"Data":{"GitHub":{"Issues":[{"Id":"1147921906","IsPullRequest":true,"CreatedAt":"2022-02-23T22:51:40","Actor":"SergeySmirnov-Akvelon","Number":"6747","RawContent":null,"Title":"Fixing a JAWS exception in a PropertyGrid","State":"closed","Body":"Fixes #6704\r\n\r\n## Proposed changes\r\n- The issue is reproduced because for `FragmentRoot` we return `PropertyGridView.AccessibilityObject` and not `PropertyGrid.AccessibilityObject`.\r\n- Now `FragmentRoot` returns `PropertyGrid.AccessibilityObject`. This matches the behavior of other accessibility objects in the `PropertyGrid`.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n**Before fix:**\r\n![154419615-f42458cc-c068-4610-94a3-61cfb5235bf8](https://user-images.githubusercontent.com/23376742/155302428-02940f8d-e32a-4116-9d88-efb009150fa1.gif)\r\n\r\n**After fix:**\r\n![Issue-6704](https://user-images.githubusercontent.com/23376742/155302458-89a0b890-d702-404e-ad7c-52feee355cb6.gif)\r\n\r\n## Regression? \r\n\r\n- Yes\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n- CTI team\r\n- Unit-tests\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- JAWS\r\n- NVDA\r\n- Narrator\r\n- Accessibility Insights\r\n- Inspect \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19044.1466]\r\n- .NET Core SDK: 7.0.0-preview.3.22121.13\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6747)","Url":"https://github.com/dotnet/winforms/pull/6747","RelatedDescription":"Closed or merged PR \"Fixing a JAWS exception in a PropertyGrid\" (#6747)"},{"Id":"1148076687","IsPullRequest":true,"CreatedAt":"2022-02-23T22:01:08","Actor":"dotnet-maestro[bot]","Number":"6750","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220222.7\r\n- **Date Produced**: February 23, 2022 5:20:47 AM UTC\r\n- **Commit**: e069de8777bc7c972b898a5c31d80ca9e23bbbef\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22121.13 to 7.0.0-preview.3.22122.7][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/eeff298...e069de8\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6750)","Url":"https://github.com/dotnet/winforms/pull/6750","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6750)"},{"Id":"1148075781","IsPullRequest":true,"CreatedAt":"2022-02-23T22:00:41","Actor":"dotnet-maestro[bot]","Number":"6749","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220222.3\r\n- **Date Produced**: February 22, 2022 7:17:44 PM UTC\r\n- **Commit**: 68a9b6dc9c0f375893fcdab74b7dd2538afb1c4b\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22117.2 to 7.0.0-beta.22122.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/49750c0...68a9b6d\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6749)","Url":"https://github.com/dotnet/winforms/pull/6749","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6749)"},{"Id":"1147484470","IsPullRequest":true,"CreatedAt":"2022-02-23T21:57:19","Actor":"dotnet-bot","Number":"6740","RawContent":null,"Title":"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 1626883","State":"closed","Body":"This is the pull request automatically created by the OneLocBuild task in the build process to check-in localized files generated based upon translation source files (.lcl files) handed-back from the downstream localization pipeline. If there are issues in translations, visit https://aka.ms/ceLocBug and log bugs for fixes. The OneLocBuild wiki is https://aka.ms/onelocbuild and the localization process in general is documented at https://aka.ms/AllAboutLoc.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6740)","Url":"https://github.com/dotnet/winforms/pull/6740","RelatedDescription":"Closed or merged PR \"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 1626883\" (#6740)"},{"Id":"1148621447","IsPullRequest":true,"CreatedAt":"2022-02-23T21:56:59","Actor":"dreddy-work","Number":"6753","RawContent":null,"Title":"Disable loc on release to avoid triggering locs","State":"closed","Body":"disable loc on release branch.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6753)","Url":"https://github.com/dotnet/winforms/pull/6753","RelatedDescription":"Closed or merged PR \"Disable loc on release to avoid triggering locs\" (#6753)"},{"Id":"1148554431","IsPullRequest":true,"CreatedAt":"2022-02-23T20:39:44","Actor":"dreddy-work","Number":"6752","RawContent":null,"Title":"Fixing layout issues of Anchored/Docked controls in the MDI child forms","State":"open","Body":"Fixes #6752\r\n\r\n## Proposed changes\r\n\r\nWhen moving the Form to a new monitor with different DPI settings, Windows changing the Dpi\r\non the handle and sending DPI changed message to the Form are not in sync. Due to this,\r\nmethod User32.GetClientRect are returning the incorrect value.  This method is not\r\naccurate with respect to adornments metrics and their Dpi. Hence this work around.\r\n\r\nThis method is expected to be called whenever there is WINDOWSPOSITION_CHANGED message is triggered.\r\nWe will be calling UpdateBounds(x, y, width, height) explicitly, instead, for MDI child windows\r\nif we had to change the size. for every other control, bounds are changed here.\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Low. Impacts only MDI child forms\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manual. \r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6752)","Url":"https://github.com/dotnet/winforms/pull/6752","RelatedDescription":"Open PR \"Fixing layout issues of Anchored/Docked controls in the MDI child forms\" (#6752)"},{"Id":"1148384562","IsPullRequest":true,"CreatedAt":"2022-02-23T17:37:59","Actor":"kant2002","Number":"6751","RawContent":null,"Title":"Do not retreive shell items via built-in COM","State":"open","Body":"Fixed #6748\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6751)","Url":"https://github.com/dotnet/winforms/pull/6751","RelatedDescription":"Open PR \"Do not retreive shell items via built-in COM\" (#6751)"},{"Id":"1147882788","IsPullRequest":true,"CreatedAt":"2022-02-23T10:00:53","Actor":"kant2002","Number":"6746","RawContent":null,"Title":"Create CCW for IDropSource","State":"open","Body":"Progress towards #5163 and #4649\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6746)","Url":"https://github.com/dotnet/winforms/pull/6746","RelatedDescription":"Open PR \"Create CCW for IDropSource\" (#6746)"},{"Id":"1147853000","IsPullRequest":false,"CreatedAt":"2022-02-23T09:30:10","Actor":"kant2002","Number":"6745","RawContent":null,"Title":"More trimming friendly DragDrop","State":"open","Body":"Currently DragDrop process starts with `DragDropEffects DoDragDrop(object data, DragDropEffects allowedEffects)` which inside perform dispatcherization of the supported interfaces and objects. Sometimes this may means that we rely on Built-in COM support for cast of the interfaces.\r\n\r\nBuilt-in COM support maybe disabled in modern .NET and do not supported in NativeAOT flavor of CoreCLR. I propose provide API which put responsibility of AOT supported casting on the consumer side by introducing typed version of the method.\r\n\r\n```diff\r\npublic class Control\r\n{\r\n+ public DragDropEffects DoDragDrop(System.Runtime.InteropServices.ComTypes.IDataObject data, DragDropEffects allowedEffects)\r\n+ public DragDropEffects DoDragDrop(System.Windows.Forms.IDataObject data, DragDropEffects allowedEffects)\r\n}\r\npublic class ToolStripItem\r\n{\r\n+ public DragDropEffects DoDragDrop(System.Runtime.InteropServices.ComTypes.IDataObject data, DragDropEffects allowedEffects)\r\n+ public DragDropEffects DoDragDrop(System.Windows.Forms.IDataObject data, DragDropEffects allowedEffects)\r\n}\r\n```\r\n\r\nThis would be considered source breaking change.\r\n\r\n/cc @weltkante since you maybe interested in giving feedback on this.","Url":"https://github.com/dotnet/winforms/issues/6745","RelatedDescription":"Open issue \"More trimming friendly DragDrop\" (#6745)"},{"Id":"1147794698","IsPullRequest":false,"CreatedAt":"2022-02-23T08:26:04","Actor":"kant2002","Number":"6744","RawContent":null,"Title":"What's purpose of SAFEARRAYTests","State":"open","Body":"Maybe I miss something obvious, but SafeArrayTests are not testing anything.\r\nI get that maybe SafeArray handling should be in VARIANTTests but they not there too. Do I miss something?\r\n\r\nhttps://github.com/dotnet/winforms/blob/main/src/System.Windows.Forms.Primitives/tests/UnitTests/Interop/Oleaut32/SAFEARRAYTests.cs","Url":"https://github.com/dotnet/winforms/issues/6744","RelatedDescription":"Open issue \"What's purpose of SAFEARRAYTests\" (#6744)"},{"Id":"1147786270","IsPullRequest":true,"CreatedAt":"2022-02-23T08:16:02","Actor":"kant2002","Number":"6743","RawContent":null,"Title":"Use ComWrappers for IErrorInfo","State":"open","Body":"Progress towards #5163 and #4649 \n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6743)","Url":"https://github.com/dotnet/winforms/pull/6743","RelatedDescription":"Open PR \"Use ComWrappers for IErrorInfo\" (#6743)"},{"Id":"1148051492","IsPullRequest":false,"CreatedAt":"2022-02-23T08:04:04","Actor":"Junjun-zhao","Number":"6748","RawContent":null,"Title":" [dotnet-sdk-7.0.100-preview.3.22118.7] Greenshot and NugetPackageExplorerget apps get exception When do saving the file operation","State":"open","Body":"### Description\n\nWhen running Greenshot with .NET 7.0 Preview 3 runtime, it will get exception when do saving the file operation.\n\n### Reproduction Steps\n\n**Repro steps for the affected app:**\r\n\r\n**This is .Net 5.0 app, but we are running it on 7.0, machine only have 7.0 installed, and DOTNET_ROLL_FORWARD_ON_NO_CANDIDATE_FX=2, so it runs on 7.0.**\r\n\r\n1.Copy App from App Path and launch Greenshot.exe. \r\n2.Click “OK” button.\r\n3.Press Print Screen key.\r\n4.Take a screenshot by dragging the cursor down a little and releasing the left button click.\r\n5.Choose Save as (displaying dialog) menu item.\r\n\r\n**Minimal Repro steps:**\r\n**dotnet-sdk-7.0.100-preview.322118.7 sdk should be installed on the machine.** \r\nSample code attached. \r\n[WinFormsApp1 (2).zip](https://github.com/dotnet/runtime/files/8122661/WinFormsApp1.2.zip)\r\n\r\n1) Create .net 5.0 Winform app\r\n2) Add SaveFileDialog and Button Component to form\r\n3) In Button click event, write this :\r\n```\r\n private void button1_Click(object sender, EventArgs e)\r\n        {\r\n             var dialog = new System.Windows.Forms.SaveFileDialog()\r\n            {\r\n               InitialDirectory = @\"C:\\Users\\v-zhiyang\\Documents\"\r\n            };\r\n            try\r\n            {\r\n                var result = dialog.ShowDialog();\r\n            }\r\n            catch (Exception ex)\r\n            {\r\n                MessageBox.Show(ex.Message);\r\n            }\r\n\r\n        }\r\n```\r\n4) Publish the app and change the runtime.json file to use 7.0.0-preview.3.22116.6 for Microsoft.WindowsDesktop.App under publish folder.\r\n```\r\n{\r\n  \"runtimeOptions\": {\r\n    \"tfm\": \"net5.0\",\r\n    \"framework\": {\r\n      \"name\": \"Microsoft.WindowsDesktop.App\",\r\n      \"version\": \"7.0.0-preview.3.22116.6\"\r\n    }\r\n  }\r\n}\r\n```\r\n5) Start the project with F5.\r\n6) Click \"button1\" Button.\n\n### Expected behavior\n\nIt shows save window.\r\n\r\n\r\n\n\n### Actual behavior\n\n**Actual Result for the Affected App:**\r\nIt shows error and crash.\r\n```\r\nApplication: Greenshot.exe\r\nMicrosoft.WindowsDesktop.App version: 7.0.0-preview.3.22116.6\r\nDescription: The process was terminated due to an unhandled exception.\r\nException Info: System.InvalidCastException: \r\nSystem.NotImplementedException: ComWrappers for type System.__ComObject not implemented.\r\n   at Interop.WinFormsComWrappers.ComputeVtables(Object obj, CreateComInterfaceFlags flags, Int32& count)\r\n   at System.Runtime.InteropServices.ComWrappers.<TryGetOrCreateComInterfaceForObjectInternal>g____PInvoke__|7_0(ObjectHandleOnStack comWrappersImpl, Int64 wrapperId, ObjectHandleOnStack instance, CreateComInterfaceFlags flags, IntPtr* retValue)\r\n   at System.Runtime.InteropServices.ComWrappers.TryGetOrCreateComInterfaceForObjectInternal(ObjectHandleOnStack comWrappersImpl, Int64 wrapperId, ObjectHandleOnStack instance, CreateComInterfaceFlags flags, IntPtr& retValue)\r\n   at System.Runtime.InteropServices.ComWrappers.TryGetOrCreateComInterfaceForObjectInternal(ComWrappers impl, Object instance, CreateComInterfaceFlags flags, IntPtr& retValue)\r\n   at System.Runtime.InteropServices.ComWrappers.GetOrCreateComInterfaceForObject(Object instance, CreateComInterfaceFlags flags)\r\n   at Interop.WinFormsComWrappers.GetOrCreateComInterfaceForObject(Object obj)\r\n   at Interop.WinFormsComWrappers.GetComPointer[T](T obj, Guid iid)\r\n   at Interop.WinFormsComWrappers.FileDialogWrapper.Interop.Shell32.IFileDialog.SetDefaultFolder(IShellItem psi)\r\n   at System.Windows.Forms.FileDialog.OnBeforeVistaDialog(IFileDialog dialog)\r\n   at System.Windows.Forms.FileDialog.TryRunDialogVista(IntPtr hWndOwner, Boolean& returnValue)\r\n   at System.Windows.Forms.FileDialog.RunDialog(IntPtr hWndOwner)\r\n   at System.Windows.Forms.CommonDialog.ShowDialog(IWin32Window owner)\r\n   at Greenshot.Addons.Controls.SaveImageFileDialog.ShowDialog() in C:\\.NETCoreUpgradeApps\\AppSources\\greenshot\\src\\Greenshot.Addons\\Controls\\SaveImageFileDialog.cs:line 212\r\n   at Greenshot.Addons.Core.ImageOutput.SaveWithDialog(ISurface surface, ICaptureDetails captureDetails) in C:\\.NETCoreUpgradeApps\\AppSources\\greenshot\\src\\Greenshot.Addons\\Core\\ImageOutput.cs:line 122\r\n   at Greenshot.Destinations.FileWithDialogDestination.ExportCapture(Boolean manuallyInitiated, ISurface surface, ICaptureDetails captureDetails) in C:\\.NETCoreUpgradeApps\\AppSources\\greenshot\\src\\Greenshot\\Destinations\\FileWithDialogDestination.cs:line 59\r\n   at Greenshot.Addons.Core.AbstractDestination.ExportCaptureAsync(Boolean manuallyInitiated, ISurface surface, ICaptureDetails captureDetails) in C:\\.NETCoreUpgradeApps\\AppSources\\greenshot\\src\\Greenshot.Addons\\Core\\AbstractDestination.cs:line 159\r\n   at Greenshot.Addons.Core.AbstractDestination.<>c__DisplayClass42_0.<<ShowPickerMenu>b__6>d.MoveNext() in C:\\.NETCoreUpgradeApps\\AppSources\\greenshot\\src\\Greenshot.Addons\\Core\\AbstractDestination.cs:line 367\r\n--- End of stack trace from previous location ---\r\n   at System.Threading.Tasks.Task.<>c.<ThrowAsync>b__128_0(Object state)\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n\r\n```\r\n\r\n**Actual Result for the Minimal Demo:**\r\n\r\nGet below exception:\r\nSystem.NotImplementedException: ComWrappers for type System.__ComObject not implemented.\n\n### Regression?\n\nYes\r\n\r\n**Verify Scenarios:**\r\n\r\n1). Windows10 RS5 x64+dotnet-sdk-7.0.100-preview.3.22118.7: Fail\r\n2). Windows10 RS5 x64+dotnet-sdk-7.0.100-preview.3.22122.1: Fail\r\n3). Windows10 RS5 x64+dotnet-sdk-7.0.100-preview.2.22114.1: Pass\r\n4). Windows10 RS5 x64+dotnet-sdk-5.0.405-win-x64 (Default SDK): Pass\n\n### Known Workarounds\n\n_No response_\n\n### Configuration\n\n**Application Name**: Greenshot  & NugetPackageExplorer\r\n**OS**: Windows 10 RS5\r\n**CPU**: X64\r\n**.NET Build Number:** dotnet-sdk-7.0.100-preview.3.22118.7\r\n\r\n**Github link for source code**:\r\nhttps://github.com/greenshot/greenshot \r\n\r\n**App and App Source Checking at** : https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1487350\n\n### Other information\n\n**Findings:**\r\n\r\nWhen we create SaveFileDialog object, InitialDirectory will report an exception：\r\n       InitialDirectory = @\"C:\\Users\\v-zhiyang\\Documents\"\r\n\r\n@dotnet-actwx-bot @dotnet/compat","Url":"https://github.com/dotnet/winforms/issues/6748","RelatedDescription":"Open issue \" [dotnet-sdk-7.0.100-preview.3.22118.7] Greenshot and NugetPackageExplorerget apps get exception When do saving the file operation\" (#6748)"},{"Id":"1147674079","IsPullRequest":false,"CreatedAt":"2022-02-23T06:24:33","Actor":"Amy-Li03","Number":"6742","RawContent":null,"Title":"PictureBox Background Transparency over any control","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: \r\n.NET SDK 7.0.100-preview.2.22103\r\n\r\n* Have you experienced this same bug with .NET Framework?: \r\nYes\r\n\r\n**Problem description:**\r\nIt is from a suggestion ticket: https://devdiv.visualstudio.com/DevDiv/_workitems/edit/1469120\r\nI have a PictureBox filled with a .png image (image with Transparent background) and I place this PictureBox over a ListBox and the result is not what I expected. The PictureBox still shows it’s own background or the Forms’s background, it doesn’t allow me to see through the PictureBox, since my image has a transparent background.\r\n![image](https://user-images.githubusercontent.com/62929087/155270205-86013602-7437-401a-bd39-bcac2c961bd6.png)\r\n\r\n**Expected behavior:**\r\nThe PictureBox should allow customer to see through the PictureBox, since the image has a transparent background.\r\n\r\n**Minimal repro:**\r\n1. Create a winforms .net core project with a pictureBox control added.\r\n2. Click the \"Choose Image..\" link in SmartTag of PictureBox to add a transparent image to it.\r\n3. Add a ListBox to the form designer, then put PictureBox over this ListBox.\r\n4. Build and run this project.\r\n\r\nOr\r\n\r\n1. Extract and open following test app: \r\n[TestApp.zip](https://github.com/dotnet/winforms/files/8122281/TestApp.zip)\r\n2. Build and run this project","Url":"https://github.com/dotnet/winforms/issues/6742","RelatedDescription":"Open issue \"PictureBox Background Transparency over any control\" (#6742)"},{"Id":"1147671876","IsPullRequest":true,"CreatedAt":"2022-02-23T06:20:30","Actor":"gpetrou","Number":"6741","RawContent":null,"Title":"Enable nullability in DomainUpDown","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in DomainUpDown.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6741)","Url":"https://github.com/dotnet/winforms/pull/6741","RelatedDescription":"Open PR \"Enable nullability in DomainUpDown\" (#6741)"},{"Id":"1147464087","IsPullRequest":false,"CreatedAt":"2022-02-22T23:17:51","Actor":"runfoapp[bot]","Number":"6739","RawContent":null,"Title":"setwithhandle_getreturnsexpected flaky failure in rolling","State":"open","Body":"<!-- runfo report start -->\r\nRunfo Tracking Issue: [setwithhandle_getreturnsexpected flaky failure in rolling](https://runfo.azurewebsites.net/tracking/issue/295)\r\n|Build|Definition|Kind|Run Name|\r\n|---|---|---|---|\r\n|[1627508](https://dev.azure.com/dnceng/public/_build/results?buildId=1627508)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x86-xunit|\r\n|[1627508](https://dev.azure.com/dnceng/public/_build/results?buildId=1627508)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x86-xunit|\r\n|[1626337](https://dev.azure.com/dnceng/public/_build/results?buildId=1626337)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x64-xunit|\r\n|[1626337](https://dev.azure.com/dnceng/public/_build/results?buildId=1626337)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x64-xunit|\r\n|[1625710](https://dev.azure.com/dnceng/public/_build/results?buildId=1625710)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|[PR 6737](https://github.com/dotnet/winforms/pull/6737)|Windows_x86-xunit|\r\n|[1625710](https://dev.azure.com/dnceng/public/_build/results?buildId=1625710)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|[PR 6737](https://github.com/dotnet/winforms/pull/6737)|Windows_x86-xunit|\r\n|[1624809](https://dev.azure.com/dnceng/public/_build/results?buildId=1624809)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|[PR 6448](https://github.com/dotnet/winforms/pull/6448)|Windows_x86-xunit|\r\n|[1624809](https://dev.azure.com/dnceng/public/_build/results?buildId=1624809)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|[PR 6448](https://github.com/dotnet/winforms/pull/6448)|Windows_x86-xunit|\r\n|[1623455](https://dev.azure.com/dnceng/public/_build/results?buildId=1623455)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_arm64-xunit|\r\n|[1623455](https://dev.azure.com/dnceng/public/_build/results?buildId=1623455)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_arm64-xunit|\r\n|[1623455](https://dev.azure.com/dnceng/public/_build/results?buildId=1623455)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x86-xunit|\r\n|[1623455](https://dev.azure.com/dnceng/public/_build/results?buildId=1623455)|[dotnet-winforms CI](https://dnceng.visualstudio.com/public/_build?definitionId=267)|Rolling|Windows_x86-xunit|\r\n\r\n\r\n\r\nBuild Result Summary\r\n|Day Hit Count|Week Hit Count|Month Hit Count|\r\n|---|---|---|\r\n|1|5|5|\r\n\r\n<!-- runfo report end -->\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/6739","RelatedDescription":"Open issue \"setwithhandle_getreturnsexpected flaky failure in rolling\" (#6739)"},{"Id":"1147419344","IsPullRequest":true,"CreatedAt":"2022-02-22T22:50:33","Actor":"dotnet-maestro[bot]","Number":"6738","RawContent":null,"Title":"[release/7.0-preview2] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:4060a9ae-51b9-48e3-fc71-08d9f4e8def7)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: 4060a9ae-51b9-48e3-fc71-08d9f4e8def7\r\n- **Build**: 20220222.4\r\n- **Date Produced**: February 22, 2022 9:02:23 PM UTC\r\n- **Commit**: 1615de6ccc1290be168c1de290429489c489efde\r\n- **Branch**: refs/heads/release/7.0-preview2\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.2.22114.13 to 7.0.0-preview.2.22122.4][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/14e6411...1615de6\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:4060a9ae-51b9-48e3-fc71-08d9f4e8def7)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6738)","Url":"https://github.com/dotnet/winforms/pull/6738","RelatedDescription":"Closed or merged PR \"[release/7.0-preview2] Update dependencies from dotnet/runtime\" (#6738)"},{"Id":"1145777294","IsPullRequest":true,"CreatedAt":"2022-02-22T18:03:22","Actor":"dotnet-maestro[bot]","Number":"6734","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220221.13\r\n- **Date Produced**: February 22, 2022 5:37:11 AM UTC\r\n- **Commit**: eeff29824557cbc3873c2d331d042a889310bac0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22119.4 to 7.0.0-preview.3.22121.13][2]\r\n\r\n[2]: https://github.com/dotnet/runtime/compare/ddb22ef...eeff298\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6734)\r\n","Url":"https://github.com/dotnet/winforms/pull/6734","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6734)"},{"Id":"1146825228","IsPullRequest":true,"CreatedAt":"2022-02-22T12:03:27","Actor":"SergeySmirnov-Akvelon","Number":"6737","RawContent":null,"Title":"Fixing issue with announcing of PropertyGrid expanded state","State":"open","Body":"Fixes #6656\r\n\r\n## Proposed changes\r\n- I think the problem is being reproduced due to competitive requests to Narrator. Periodically it announces expanded state information and periodically skips.\r\n- A possible fix is to replace the standard method `RaiseAutomationPropertyChangedEvent` with the `RaiseAutomationNotification` method. In this case, we force the expanded state information to be announced, which helps avoid a possible contention problem.\r\n\r\n## Customer Impact\r\n**Before fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/155125271-bb3f3afd-2d5c-4545-b872-eb5e4b8b1422.png)\r\n\r\n**After fix:**\r\n![image](https://user-images.githubusercontent.com/23376742/155126068-5c41933a-c7b0-4421-8a93-bc120b49a4fb.png)\r\n\r\n## Regression? \r\n\r\n- Yes (we have unstable behavior)\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n- CTI team \r\n- Manually\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- Narrator\r\n- JAWS\r\n- NVDA\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19044.1466]\r\n- .NET Core SDK: 7.0.0-preview.3.22119.4\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6737)","Url":"https://github.com/dotnet/winforms/pull/6737","RelatedDescription":"Open PR \"Fixing issue with announcing of PropertyGrid expanded state\" (#6737)"},{"Id":"1146058811","IsPullRequest":true,"CreatedAt":"2022-02-22T00:37:51","Actor":"gpetrou","Number":"6735","RawContent":null,"Title":"Enable nullability in DropDownButton","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in DropDownButton.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6735)","Url":"https://github.com/dotnet/winforms/pull/6735","RelatedDescription":"Closed or merged PR \"Enable nullability in DropDownButton\" (#6735)"},{"Id":"1145609185","IsPullRequest":false,"CreatedAt":"2022-02-22T00:08:41","Actor":"IrinaPykhova","Number":"6733","RawContent":null,"Title":"Native support for UIA patterns","State":"closed","Body":"a lot of people are trying to automate UI testing. So, we often get requests about automation support from our customers. Currently, in WinForms it is very tricky to support and we haven't found any good documentation about that. \r\n\r\nAs a third-party vendor, we'd like WinForms to have some level of native support for UI Automation, similar to WPF implementation: https://docs.microsoft.com/en-us/dotnet/api/system.windows.automation.peers.frameworkelementautomationpeer?view=windowsdesktop-6.0\r\nI think, it might improve automation support for Microsoft controls as well","Url":"https://github.com/dotnet/winforms/issues/6733","RelatedDescription":"Closed issue \"Native support for UIA patterns\" (#6733)"},{"Id":"1145455106","IsPullRequest":false,"CreatedAt":"2022-02-21T08:10:42","Actor":"Olina-Zhang","Number":"6732","RawContent":null,"Title":"[Accessibility] Narrator cannot announce the expand/collapse state for treeView nodes with checkbox enabled or doing expand/collapse action for any treeNode","State":"open","Body":"* .NET Core Version: \r\n7.0.100-preview.2.22116.19\r\n\r\n* Have you experienced this same bug with .NET Framework?: \r\nYes\r\n\r\n**Minimal repro:**\r\n1. Create a Winforms .Net Core application with treeView control added\r\n2. In treeView, add several root treeNodes and child treeNodes\r\n\r\nOr use following attached application:\r\n[WinFormsApp4.zip](https://github.com/dotnet/winforms/files/8107369/WinFormsApp4.zip)\r\n\r\n3. Build and run this application\r\n4. Launch Narrator to test expand/collapse root treeNode\r\n\r\n**Actual result:**\r\nNarrator cannot announce the expand/collapse state for treeview nodes with treeView checkBox enabled, or when doing expanding or collapsing action for treenodes. \r\n![image](https://user-images.githubusercontent.com/26474449/154914880-f3ade506-5f77-4aa2-938d-2ac6417dc224.png)\r\n![TreeView_CheckBox](https://user-images.githubusercontent.com/26474449/154913766-afd3b6f7-cc49-41f1-9e1e-511b52930d85.gif)\r\n\r\n**Expected result:**\r\nNarrator can announce the expand/collapse state when focusing treeview checkbox nodes or doing expanding or collapsing action for them\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/6732","RelatedDescription":"Open issue \"[Accessibility] Narrator cannot announce the expand/collapse state for treeView nodes with checkbox enabled or doing expand/collapse action for any treeNode\" (#6732)"},{"Id":"1145104373","IsPullRequest":true,"CreatedAt":"2022-02-20T23:38:17","Actor":"gpetrou","Number":"6728","RawContent":null,"Title":"Enable nullability in LayoutSettings, FlowLayoutSettings and TableLayoutSettings","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in LayoutSettings, FlowLayoutSettings and TableLayoutSettings.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6728)","Url":"https://github.com/dotnet/winforms/pull/6728","RelatedDescription":"Closed or merged PR \"Enable nullability in LayoutSettings, FlowLayoutSettings and TableLayoutSettings\" (#6728)"},{"Id":"1144971987","IsPullRequest":true,"CreatedAt":"2022-02-20T23:34:37","Actor":"gpetrou","Number":"6726","RawContent":null,"Title":"Enable nullability in CursorConverter","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in CursorConverter.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6726)","Url":"https://github.com/dotnet/winforms/pull/6726","RelatedDescription":"Closed or merged PR \"Enable nullability in CursorConverter\" (#6726)"},{"Id":"1145116184","IsPullRequest":true,"CreatedAt":"2022-02-20T22:58:35","Actor":"vladimir-krestov","Number":"6731","RawContent":null,"Title":"Skipped more flaky tests","State":"closed","Body":"Main issue #6713.\r\nRelased issues:\r\n- #6609 \r\n- #6729 \r\n- #6730 \r\n- #6597 \r\n\r\n## Proposed changes\r\n\r\n- Fix `DateTimePickerTests` test ([comment](https://github.com/dotnet/winforms/issues/6713#issuecomment-1045056854))\r\n- Add `Skip` attributes for new flaky tests\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- No\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6731)","Url":"https://github.com/dotnet/winforms/pull/6731","RelatedDescription":"Closed or merged PR \"Skipped more flaky tests\" (#6731)"},{"Id":"1145112922","IsPullRequest":false,"CreatedAt":"2022-02-20T19:31:26","Actor":"vladimir-krestov","Number":"6730","RawContent":null,"Title":"`Control_SelectNextControl_ToolStrips_CycleForwardExpected` is flaky in CI build","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: 7.0\r\n<!-- e.g. 3.0 Preview1, or daily build number, use `dotnet --info` -->\r\n\r\n* Have you experienced this same bug with .NET Framework?: No\r\n<!-- Yes / No -->\r\n\r\n**Problem description:**\r\n- Test fails sometimes in CI build for successful PRs, that blocking deployment of fixes into sdk:\r\nControl_SelectNextControl_ToolStrips_CycleForwardExpected:\r\nStack trace ([CI build 1620740](https://dev.azure.com/dnceng/public/_build/results?buildId=1620740&view=ms.vss-test-web.build-test-results-tab&runId=45061952&resultId=114518&paneView=debug)):\r\n```\r\nat System.Windows.Forms.Control.ControlCollection.GetChildIndex(Control child, Boolean throwException) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.ControlCollection.cs:line 466\r\n   at System.Windows.Forms.Control.ControlCollection.GetChildIndex(Control child) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.ControlCollection.cs:line 452\r\n   at System.Windows.Forms.Control.ControlCollection.SetChildIndexInternal(Control child, Int32 newIndex) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.ControlCollection.cs:line 481\r\n   at System.Windows.Forms.Control.ControlCollection.SetChildIndex(Control child, Int32 newIndex) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.ControlCollection.cs:line 507\r\n   at System.Windows.Forms.Control.SendToBack() in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs:line 10703\r\n   at System.Windows.Forms.Control.ControlCollection.Add(Control value) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.ControlCollection.cs:line 68\r\n   at System.Windows.Forms.ReadOnlyControlCollection.AddInternal(Control value) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ReadOnlyControlCollection.cs:line 33\r\n   at System.Windows.Forms.ToolStripControlHost.SyncControlParent() in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripControlHost.cs:line 817\r\n   at System.Windows.Forms.ToolStripControlHost.OnParentChanged(ToolStrip oldParent, ToolStrip newParent) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripControlHost.cs:line 705\r\n   at System.Windows.Forms.ToolStripItem.set_ParentInternal(ToolStrip value) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripItem.cs:line 1542\r\n   at System.Windows.Forms.ToolStripSplitStackLayout.LayoutHorizontal() in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripSplitStackLayout.cs:line 367\r\n   at System.Windows.Forms.ToolStripSplitStackLayout.LayoutCore(IArrangedElement container, LayoutEventArgs layoutEventArgs) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripSplitStackLayout.cs:line 237\r\n   at System.Windows.Forms.Layout.LayoutEngine.Layout(Object container, LayoutEventArgs layoutEventArgs) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Layout/LayoutEngine.cs:line 44\r\n   at System.Windows.Forms.Control.OnLayout(LayoutEventArgs levent) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs:line 8273\r\n   at System.Windows.Forms.ScrollableControl.OnLayout(LayoutEventArgs levent) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ScrollableControl.cs:line 628\r\n   at System.Windows.Forms.ToolStrip.OnLayout(LayoutEventArgs e) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStrip.cs:line 3575\r\n   at System.Windows.Forms.Control.PerformLayout(LayoutEventArgs args) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs:line 8990\r\n   at System.Windows.Forms.Control.System.Windows.Forms.Layout.IArrangedElement.PerformLayout(IArrangedElement affectedElement, String affectedProperty) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Control.cs:line 13429\r\n   at System.Windows.Forms.Layout.LayoutTransaction.DoLayout(IArrangedElement elementToLayout, IArrangedElement elementCausingLayout, String property) in /_/src/System.Windows.Forms/src/System/Windows/Forms/Layout/LayoutTransaction.cs:line 98\r\n   at System.Windows.Forms.ToolStrip.DoLayoutIfHandleCreated(ToolStripItemEventArgs e) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStrip.cs:line 2164\r\n   at System.Windows.Forms.ToolStrip.OnItemVisibleChanged(ToolStripItemEventArgs e, Boolean performLayout) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStrip.cs:line 3554\r\n   at System.Windows.Forms.ToolStrip.OnItemRemoved(ToolStripItemEventArgs e) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStrip.cs:line 3529\r\n   at System.Windows.Forms.ToolStripItemCollection.OnAfterRemove(ToolStripItem item) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripItemCollection.cs:line 405\r\n   at System.Windows.Forms.ToolStripItemCollection.Remove(ToolStripItem value) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripItemCollection.cs:line 427\r\n   at System.Windows.Forms.ToolStripItem.Dispose(Boolean disposing) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripItem.cs:line 2099\r\n   at System.Windows.Forms.ToolStripDropDownItem.Dispose(Boolean disposing) in /_/src/System.Windows.Forms/src/System/Windows/Forms/ToolStripDropDownItem.cs:line 373\r\n   at System.ComponentModel.Component.Dispose()\r\n   at System.Windows.Forms.Tests.ControlTests.Control_SelectNextControl_ToolStrips_CycleForwardExpected(RightToLeft rightToLeft) in /_/src/System.Windows.Forms/tests/UnitTests/System/Windows/Forms/ControlTests.cs:line 918\r\n```\r\nError message:\r\n```\r\nSystem.ArgumentException : 'child' is not a child control of this parent.\r\n```\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\n\r\n**PS.**: The first investigation shows, that looks like the reason is an incorrect call of `SyncControlParent` in `ToolStripControlHost` (line 705).\r\n\r\n**Expected behavior:**\r\n- All correct tests pass every time.\r\n\r\n**Minimal repro:**\r\n- Run CI build, it reproduces sometimes\r\n","Url":"https://github.com/dotnet/winforms/issues/6730","RelatedDescription":"Open issue \"`Control_SelectNextControl_ToolStrips_CycleForwardExpected` is flaky in CI build\" (#6730)"},{"Id":"1145110456","IsPullRequest":false,"CreatedAt":"2022-02-20T19:20:04","Actor":"vladimir-krestov","Number":"6729","RawContent":null,"Title":"`Clipboard_SetDataObject_InvokeObjectBoolNotIComDataObject_GetReturnsExpected` is flaky in CI build","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: 7.0\r\n<!-- e.g. 3.0 Preview1, or daily build number, use `dotnet --info` -->\r\n\r\n* Have you experienced this same bug with .NET Framework?: No\r\n<!-- Yes / No -->\r\n\r\n**Problem description:**\r\n- Test fails sometimes in CI build for successful PRs, that blocking deployment of fixes into sdk:\r\n`Clipboard_SetDataObject_InvokeObjectBoolNotIComDataObject_GetReturnsExpected`:\r\nStack trace ([comment](https://github.com/dotnet/winforms/pull/6600#issuecomment-1042437384)):\r\n```\r\nAssert.Equal() Failure\\r\\nExpected: 1\\r\\nActual:   MemoryStream { CanRead = True, CanSeek = True, CanTimeout = False, CanWrite = True, Capacity = 70, ... }\r\n\r\n\r\nStack trace\r\n   at System.Windows.Forms.Tests.ClipboardTests.Clipboard_SetDataObject_InvokeObjectBoolNotIComDataObject_GetReturnsExpected(Object data, Boolean copy) in /_/src/System.Windows.Forms/tests/UnitTests/System/Windows/Forms/ClipboardTests.cs:line 279\r\n```\r\n<!--\r\n    Describe the current behavior, what is wrong or not working as expected.\r\n    Provide as much information as possible, including callstack for crashes/exceptions, screenshots or animations.\r\n  -->\r\n\r\n\r\n**Expected behavior:**\r\n- All correct tests pass every time.\r\n\r\n**Minimal repro:**\r\n- Run CI build, it reproduces sometimes\r\n","Url":"https://github.com/dotnet/winforms/issues/6729","RelatedDescription":"Open issue \"`Clipboard_SetDataObject_InvokeObjectBoolNotIComDataObject_GetReturnsExpected` is flaky in CI build\" (#6729)"},{"Id":"1145015026","IsPullRequest":true,"CreatedAt":"2022-02-20T13:37:51","Actor":"dotnet-maestro[bot]","Number":"6727","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220219.4\r\n- **Date Produced**: February 20, 2022 8:37:03 AM UTC\r\n- **Commit**: ddb22ef2ac96ed31cfd85782d1c38b1523642aaa\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.3.22118.9 to 7.0.0-preview.3.22119.4][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/ca6f420...ddb22ef\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6727)","Url":"https://github.com/dotnet/winforms/pull/6727","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#6727)"},{"Id":"1144970085","IsPullRequest":true,"CreatedAt":"2022-02-20T09:44:25","Actor":"gpetrou","Number":"6725","RawContent":null,"Title":"Enable nullability in FolderBrowserDialog","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in FolderBrowserDialog.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6725)","Url":"https://github.com/dotnet/winforms/pull/6725","RelatedDescription":"Open PR \"Enable nullability in FolderBrowserDialog\" (#6725)"},{"Id":"1144958851","IsPullRequest":false,"CreatedAt":"2022-02-20T08:50:38","Actor":"roland5572","Number":"6724","RawContent":null,"Title":"ToolStripComboBox causes MenuStrip to not display properly","State":"open","Body":"C# Code: .Net 6.0 with Visual studio 2022\r\n\r\n```\r\nusing System;\r\nusing System.Drawing;\r\nusing System.Windows.Forms;\r\n\r\nnamespace ToolStripItemTest\r\n{\r\n    internal static class Program\r\n    {\r\n        /// <summary>\r\n        ///  The main entry point for the application.\r\n        /// </summary>\r\n        [STAThread]\r\n        static void Main()\r\n        {\r\n            ApplicationConfiguration.Initialize();\r\n            Application.Run(CreateForm());\r\n        }\r\n\r\n        private static Form CreateForm()\r\n        {\r\n            var form = new Form()\r\n            {\r\n                Width = 1024,\r\n                Height = 768,\r\n\r\n                StartPosition = FormStartPosition.CenterScreen,\r\n            };\r\n\r\n            var mainMenu = new MenuStrip()\r\n            {\r\n                Dock = DockStyle.Top,\r\n            };\r\n\r\n            var menu1 = new ToolStripMenuItem(\"Menu 1\");\r\n\r\n            var subMenu1 = new ToolStripMenuItem(\"Sub Menu Item 1\");\r\n            var subMenu2 = new ToolStripMenuItem(\"Sub Menu Item 2\");\r\n            var subMenu3 = new ToolStripMenuItem(\"Sub Menu Item 3\");\r\n            var subMenu4 = new ToolStripComboBox(\"Sub Menu Item 4\") { DropDownStyle = ComboBoxStyle.DropDownList };\r\n            var subMenu5 = new ToolStripMenuItem(\"Sub Menu Item 5\");\r\n            var subMenu6 = new ToolStripMenuItem(\"Sub Menu Item 6\");\r\n            var subMenu7 = new ToolStripMenuItem(\"Sub Menu Item 7\");\r\n            var subMenu8 = new ToolStripMenuItem(\"Sub Menu Item 8\");\r\n\r\n\r\n            menu1.DropDownItems.Add(subMenu1);\r\n            menu1.DropDownItems.Add(subMenu2);\r\n            menu1.DropDownItems.Add(subMenu3);\r\n            menu1.DropDownItems.Add(subMenu4);\r\n            menu1.DropDownItems.Add(subMenu5);\r\n            menu1.DropDownItems.Add(subMenu6);\r\n            menu1.DropDownItems.Add(subMenu7);\r\n            menu1.DropDownItems.Add(subMenu8);\r\n\r\n            var subMenu3_Sub1 = new ToolStripMenuItem(\"Sub Menu Item 1\");\r\n            var subMenu3_Sub2 = new ToolStripMenuItem(\"Sub Menu Item 1\");\r\n            var subMenu3_Sub3 = new ToolStripMenuItem(\"Sub Menu Item 1\");\r\n\r\n            subMenu3.DropDownItems.Add(subMenu3_Sub1);\r\n            subMenu3.DropDownItems.Add(subMenu3_Sub2);\r\n            subMenu3.DropDownItems.Add(subMenu3_Sub3);\r\n\r\n            var subMenu6_Sub1 = new ToolStripControlHost(new Control() { Width = 200, Height = 60, BackColor = Color.LightGreen });\r\n            subMenu6.DropDownItems.Add(subMenu6_Sub1);\r\n\r\n            mainMenu.Items.Add(menu1);\r\n\r\n            form.Controls.Add(mainMenu);\r\n\r\n            return form;\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nTest Result:\r\n\r\nVideo 1:\r\n1. Open the menu.\r\n2. Click the combobox menu item.\r\n3. move your mouse to other menu items.\r\n4. Then you will find that the **Menu Hover** effect disappears completely, and when the mouse moves over other items, the menu items will no longer display the blue background and it cannot automatically expand its submenus unless you **click** the left mouse button. **After this**, it still shows various incorrect Hover effects.\r\n\r\nhttps://user-images.githubusercontent.com/88176616/154834883-ed39e8b1-3687-40f7-9145-daa2378b85cb.mp4\r\n\r\nVideo 2:\r\n1. Open the menu.\r\n2. Move the mouse over the menu item with submenu items.\r\n3. Move the mouse to the ComboBox menu item.\r\nYou will find that the previous menu does not close automatically and still retains the blue background.\r\n\r\nhttps://user-images.githubusercontent.com/88176616/154834943-76a70376-a45f-4d5d-b61b-f9b446134a1a.mp4\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/6724","RelatedDescription":"Open issue \"ToolStripComboBox causes MenuStrip to not display properly\" (#6724)"},{"Id":"1144913183","IsPullRequest":true,"CreatedAt":"2022-02-20T03:58:27","Actor":"kant2002","Number":"6723","RawContent":null,"Title":"Explain localization process","State":"open","Body":"Steps for localization process not clearly explained in the documentation\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/6723)","Url":"https://github.com/dotnet/winforms/pull/6723","RelatedDescription":"Open PR \"Explain localization process\" (#6723)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-02-24T03:30:34.8493595Z","RunDurationInMilliseconds":522}