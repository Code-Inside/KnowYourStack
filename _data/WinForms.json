{"Data":{"GitHub":{"Issues":[{"Id":"838326205","IsPullRequest":false,"CreatedAt":"2021-03-23T04:00:43","Actor":"AraHaan","Number":"4712","RawContent":null,"Title":"[DialogResult] Add TryAgain and Continue (result 10, and 11) respectively.","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n<!--\r\n    A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]\r\n  -->\r\nNope, I am filing this because I noticed that the documentations here: https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messagebox\r\nAs such I noticed that DialogResults of 10, and 11 are possible.\r\n\r\n**Describe the solution you'd like and alternatives you've considered**\r\n<!--\r\n    A clear and concise description of what you want to happen. This includes:\r\n    - Description of what API need to be added or changed.\r\n    - Code that shows the surface area of the API.\r\n    - Code that shows real world scenarios, and how they would otherwise be handled.\r\n    - Details showing the usage/consumption of the proposed new API, and alternatives (e.g. not having this API).\r\n    - Any other context or screenshots about the feature request here.\r\n\r\n    :exclamation: Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md for more details\r\n\r\n  -->\r\nCurrently I have no other alternatives in mind other than adding the 2 members to ``DialogResult``.\r\nAlso might need to add ``MB_CANCELTRYCONTINUE`` to the button options too for ``Cancel``, ``Try Again``, and ``Continue`` buttons (I can file a separate issue for this one).\r\nIt also seems to miss on the default buttons to also be able to make button 4 the default if they wanted to as well (I can file a separate issue for this one as well). Nowever I would logically only make it available in .NET 6+ if approved.\r\n\r\n**Will this feature affect UI controls?**\r\n<!--\r\n    Yes / No\r\n\r\n    If yes, describe the following:\r\n\r\n        - Will VS Designer need to support the feature? If yes, describe how you expect it to funсtion.\r\n        - What impact will it have on accessibility?\r\n        - Will this feature need to be localized or be localizable?\r\n  -->\r\nI do not think it will affect them at all, it will instead allow one to handle if one pressed the ``continue`` button on a dialog or ``try again`` to do specific things for those specific results which could be seen as an enhancement.\r\n\r\nAPI Changes:\r\n```diff\r\nnamespace System.Windows.Forms\r\n{\r\n    public enum DialogResult\r\n    {\r\n+        /// <summary>\r\n+        /// The dialog box return value is Try Again (usually sent from a button labeled Try Again).\r\n+        /// </summary>\r\n+        TryAgain = 10,\r\n+\r\n+        /// <summary>\r\n+        /// The dialog box return value is Continue (usually sent from a button labeled Continue).\r\n+        /// </summary>\r\n+        Continue,\r\n    }\r\n}\r\n```","Url":"https://github.com/dotnet/winforms/issues/4712","RelatedDescription":"Open issue \"[DialogResult] Add TryAgain and Continue (result 10, and 11) respectively.\" (#4712)"},{"Id":"837875050","IsPullRequest":false,"CreatedAt":"2021-03-22T16:03:53","Actor":"MohanramAnbukkarasu","Number":"4711","RawContent":null,"Title":"Slow Performance of Linq Where statement","State":"open","Body":"Hi,\r\n\r\nI have an ObservableCollection with 4 lakhs unique items. On a button click event,  I execute a Linq Where query to set value for a bool value in the items of the collection. \r\n`\r\nList<DataClass> DistinctCollection = new List<DataClass>();\r\nList<DataClass> filteredCollection = new List<DataClass>();\r\n\r\nfor(int i=1;i<=400000; i++)\r\n {\r\n     DistinctCollection.Add(new DataClass() { Content = i.ToString() });\r\n }\r\n\r\n filteredCollection = DistinctCollection.Where(x => x.Content.Contains(\"2\")).ToList();\r\n\r\n\r\n\r\n\r\nprivate void button1_Click(object sender, EventArgs e)\r\n{\r\n    // The problem occurs here.\r\n    DistinctCollection.Where(x => filteredCollection.Contains(x)).Select(x => x.IsSelected = true).ToList();\r\n    DistinctCollection.Where(x => !filteredCollection.Contains(x)).Select(x => x.IsSelected = false).ToList();\r\n}\r\n\r\n`\r\n\r\n\r\nPlease use below given sample application to reproduce the problem.\r\n\r\nThe query works properly when the number of items in the collection is less. But the UI freeze when executing the query if the collection contains 4 lakhs and above items. Is there any possible way to improve the performance of this query?\r\n\r\nThanks in advance.\r\n\r\n[Linq.Where_Demo.zip](https://github.com/dotnet/winforms/files/6183604/Linq.Where_Demo.zip)\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/4711","RelatedDescription":"Open issue \"Slow Performance of Linq Where statement\" (#4711)"},{"Id":"837843343","IsPullRequest":true,"CreatedAt":"2021-03-22T15:31:24","Actor":"gpetrou","Number":"4710","RawContent":null,"Title":"Use 'is not null' in some System.Windows.Forms files","State":"open","Body":"## Proposed changes\r\n\r\n- Contributes to https://github.com/dotnet/winforms/issues/3459\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4710)","Url":"https://github.com/dotnet/winforms/pull/4710","RelatedDescription":"Open PR \"Use 'is not null' in some System.Windows.Forms files\" (#4710)"},{"Id":"837378787","IsPullRequest":true,"CreatedAt":"2021-03-22T07:30:23","Actor":"SergeySmirnov-Akvelon","Number":"4709","RawContent":null,"Title":"Fix build issue (ComboBoxUiaTextProvider)","State":"closed","Body":"## Proposed changes\r\n- Fixed build\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4709)","Url":"https://github.com/dotnet/winforms/pull/4709","RelatedDescription":"Closed or merged PR \"Fix build issue (ComboBoxUiaTextProvider)\" (#4709)"},{"Id":"834766965","IsPullRequest":true,"CreatedAt":"2021-03-22T01:37:04","Actor":"SergeySmirnov-Akvelon","Number":"4698","RawContent":null,"Title":"Move sub-classes of \"FlowLayout\" class to their own files","State":"closed","Body":"## Proposed changes\r\n- Moved sub-classes of \"FlowLayout\" class to their own files\r\n- Fixed code sorting\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4698)","Url":"https://github.com/dotnet/winforms/pull/4698","RelatedDescription":"Closed or merged PR \"Move sub-classes of \"FlowLayout\" class to their own files\" (#4698)"},{"Id":"835917166","IsPullRequest":true,"CreatedAt":"2021-03-22T01:36:05","Actor":"dotnet-maestro[bot]","Number":"4704","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20210319.6\r\n- **Date Produced**: 3/19/2021 6:08 PM\r\n- **Commit**: 76954b4ed7b5cd48ace16fefb1209fe56779b247\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Win32.SystemEvents**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.Win32.Registry**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.Targets**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.DirectoryServices**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Drawing.Common**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.IO.FileSystem.AccessControl**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.IO.Packaging**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.IO.Pipes.AccessControl**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Resources.Extensions**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.AccessControl**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Cryptography.Cng**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Diagnostics.EventLog**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.CodeDom**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Cryptography.Xml**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.6.0**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Permissions**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Security.Principal.Windows**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Text.Encodings.Web**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Text.Json**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Threading.AccessControl**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n  - **System.Windows.Extensions**: [from 6.0.0-preview.3.21168.7 to 6.0.0-preview.3.21169.6][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/f58730b...76954b4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4704)\r\n\r\n","Url":"https://github.com/dotnet/winforms/pull/4704","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#4704)"},{"Id":"835892545","IsPullRequest":true,"CreatedAt":"2021-03-21T23:04:02","Actor":"SergeySmirnov-Akvelon","Number":"4703","RawContent":null,"Title":"Move sub-classes of \"KeyboardToolTipStateMachine\", \"ListItemConverter\", \"LayoutUtils\" and \"ListViewSubItem\" classes to their own files","State":"closed","Body":"## Proposed changes\r\n- Moved sub-classes of \"KeyboardToolTipStateMachine\", \"ListItemConverter\", \"LayoutUtils\" and \"ListViewSubItem\" classes to their own files\r\n- Fixed naming issues. Fixed Style issues.\r\n- Fixed code sorting\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4703)","Url":"https://github.com/dotnet/winforms/pull/4703","RelatedDescription":"Closed or merged PR \"Move sub-classes of \"KeyboardToolTipStateMachine\", \"ListItemConverter\", \"LayoutUtils\" and \"ListViewSubItem\" classes to their own files\" (#4703)"},{"Id":"837198929","IsPullRequest":true,"CreatedAt":"2021-03-21T22:25:40","Actor":"weltkante","Number":"4708","RawContent":null,"Title":"Add link span to LinkClickedEventArgs","State":"open","Body":"Resolves #4431\r\n\r\n## Proposed changes\r\n\r\nPass link span to `LinkClickedEventArgs` as they are not otherwise obtainable.\r\n\r\n## Customer Impact\r\n\r\nThe clicked link span is available to user code, which is vital information if you use hidden text adjacent to the link for storing additional information. This was a common strategy for the old RTF textbox control and helps porting old code.\r\n\r\n## Regression? \r\n\r\nno\r\n\r\n## Risk\r\n\r\nnone, this is adding new API\r\n\r\n### Before\r\n\r\nlink span was not available\r\n\r\n### After\r\n\r\nlink span is available and adjacent hidden text can be retrieved easily\r\n\r\n## Test methodology\r\n\r\nadded new unit tests to cover the usage scenarios of retrieving adjacent hidden text\r\n\r\n## Accessibility testing\r\n\r\nnot necessary, this API does not change the UI\r\n\r\n## Test environment(s)\r\n\r\nunit tests\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4708)","Url":"https://github.com/dotnet/winforms/pull/4708","RelatedDescription":"Open PR \"Add link span to LinkClickedEventArgs\" (#4708)"},{"Id":"835966453","IsPullRequest":true,"CreatedAt":"2021-03-21T21:59:47","Actor":"SergeySmirnov-Akvelon","Number":"4705","RawContent":null,"Title":"Move sub-classes of  \"PrintControllerWithStatusDialog\", \"MergePropertyDescriptor\" and \"MultiSelectRootGridEntry\" classes to their own files","State":"closed","Body":"## Proposed changes\r\n- Moved sub-classes of  \"PrintControllerWithStatusDialog\", \"MergePropertyDescriptor\" and \"MultiSelectRootGridEntry\" classes to their own files \r\n- Fixed naming issues. Fixed code sorting\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4705)","Url":"https://github.com/dotnet/winforms/pull/4705","RelatedDescription":"Closed or merged PR \"Move sub-classes of  \"PrintControllerWithStatusDialog\", \"MergePropertyDescriptor\" and \"MultiSelectRootGridEntry\" classes to their own files\" (#4705)"},{"Id":"836016459","IsPullRequest":true,"CreatedAt":"2021-03-21T21:54:56","Actor":"SergeySmirnov-Akvelon","Number":"4706","RawContent":null,"Title":"Move sub-classes of \"PropertyDescriptorGridEntry\" and \"PropertyStore\" classes to their own files","State":"closed","Body":"## Proposed changes\r\n- Moved sub-classes of \"PropertyDescriptorGridEntry\" and \"PropertyStore\" classes to their own files\r\n- Fixed Style issues\r\n- Fixed code sorting\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4706)","Url":"https://github.com/dotnet/winforms/pull/4706","RelatedDescription":"Closed or merged PR \"Move sub-classes of \"PropertyDescriptorGridEntry\" and \"PropertyStore\" classes to their own files\" (#4706)"},{"Id":"835799700","IsPullRequest":true,"CreatedAt":"2021-03-21T21:52:41","Actor":"SergeySmirnov-Akvelon","Number":"4702","RawContent":null,"Title":"Move sub-classes of \"HtmlDocument\", \"HtmlElement\" and \"HtmlWindow\" classes to their own files","State":"closed","Body":"## Proposed changes\r\n- Move sub-classes of \"HtmlDocument\", \"HtmlElement\" and \"HtmlWindow\" classes to their own files\r\n- Fixed name issues. Fixed Style issues\r\n- Fixed code sorting \r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4702)","Url":"https://github.com/dotnet/winforms/pull/4702","RelatedDescription":"Closed or merged PR \"Move sub-classes of \"HtmlDocument\", \"HtmlElement\" and \"HtmlWindow\" classes to their own files\" (#4702)"},{"Id":"836878385","IsPullRequest":true,"CreatedAt":"2021-03-20T18:15:50","Actor":"wreuel","Number":"4707","RawContent":null,"Title":"Fixing issue #4112 Replace deprecated SHILCreateFromPath with SHParse…","State":"open","Body":"…DisplayName\r\n\r\n<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #\r\n\r\nIssue #4112 changed the deprecated as should be\r\n\r\n## Proposed changes\r\n\r\n- Rewrite the code to use the SHParseDisplayName \r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- None\r\n\r\n## Regression? \r\n\r\n-   No\r\n\r\n## Risk\r\n\r\n- No\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n<!-- TODO -->\r\n\r\n### After\r\n\r\n<!-- TODO -->\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- \r\n- \r\n- \r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n\r\n<!--\r\n     Microsoft prioritizes making our products accessible. \r\n     WinForms has a key role in allowing developers to create accessible apps. \r\n     \r\n     When submitting a change which impacts UI in any way, including adding new UI or\r\n     modifying existing controls the developer needs to run the Accessibility Insights\r\n     tool (https://accessibilityinsights.io/) and verify that there are no changes or\r\n     regressions. \r\n     \r\n     The developer should run the Fast Pass over the impacted control(s) and provide\r\n     a snapshot of the passing results along with before/after snapshots of the UI.\r\n     More info: (https://accessibilityinsights.io/docs/en/web/getstarted/fastpass)\r\n  -->\r\n\r\n\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- <!-- use `dotnet --info` -->\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4707)","Url":"https://github.com/dotnet/winforms/pull/4707","RelatedDescription":"Open PR \"Fixing issue #4112 Replace deprecated SHILCreateFromPath with SHParse…\" (#4707)"},{"Id":"834406814","IsPullRequest":true,"CreatedAt":"2021-03-19T01:45:15","Actor":"SergeySmirnov-Akvelon","Number":"4693","RawContent":null,"Title":"DataGridView throws NRE when Narrator is active","State":"closed","Body":"Fixes #4228\r\n\r\n## Proposed changes\r\n- Added skipped checks for null. The issue is reproduced because in some cases the \"DataGridView\" property may be null. Most of the methods and properties check that the \"DataGridView\" property is not null. But in some places (including the \"FragmentRoot\" property) we forgot to add this check and got an exception as a result.\r\n- Added unit tests. \r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n**Before fix:**\r\n![101900113-fc24e200-3bbf-11eb-8b72-10c677bcec1e](https://user-images.githubusercontent.com/23376742/111578094-80d95a80-87c4-11eb-88f6-5fd04cdd35c2.gif)\r\n\r\n**After fix:**\r\n![Issue-4228-AfterFix](https://user-images.githubusercontent.com/23376742/111578116-8cc51c80-87c4-11eb-8e82-d7eefde188c7.gif)\r\n\r\n## Regression? \r\n\r\n- Yes\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n- Unit tests\r\n- CTI team\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- Narrator\r\n\r\n ## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core Version: 6.0.0-preview.2.21154.2\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4693)","Url":"https://github.com/dotnet/winforms/pull/4693","RelatedDescription":"Closed or merged PR \"DataGridView throws NRE when Narrator is active\" (#4693)"},{"Id":"833415774","IsPullRequest":true,"CreatedAt":"2021-03-19T01:43:32","Actor":"RussKie","Number":"4689","RawContent":null,"Title":"Enable selected Roslyn analyzers and auto fix ups","State":"closed","Body":"❗ DO NOT SQUASH!\r\n\r\nDuring reviews we appears to be spending time on benign issues like spacing or correct brace position. Enforce such things via Roslyn Analyzers.\r\n\r\n* Enable SA1513: a closing brace within a C# element, statement, or expression is not followed by a blank line\r\n![image](https://user-images.githubusercontent.com/4403806/111419585-d9b1e000-873d-11eb-8b69-e5da9e964eab.png)\r\n\r\n* Enable SA1500: The opening or closing brace within a C# statement, element, or expression is not placed on its own line (a bit of manual reformatting involved)\r\n\r\n❗  These rule are set to \"error\" to break builds in VS, as \"warning\" isn't triggering VS but will fail cli builds.\r\n\r\n\r\nThe clean up was done by running [`dotnet-fromat` tool](https://github.com/dotnet/format): `dotnet-format --fix-analyzers warn` (the 6 hours of my life I will never get back).\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4689)","Url":"https://github.com/dotnet/winforms/pull/4689","RelatedDescription":"Closed or merged PR \"Enable selected Roslyn analyzers and auto fix ups\" (#4689)"},{"Id":"835372270","IsPullRequest":true,"CreatedAt":"2021-03-19T01:41:18","Actor":"dotnet-maestro[bot]","Number":"4701","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20210318.7\r\n- **Date Produced**: 3/18/2021 8:04 PM\r\n- **Commit**: f58730b33782d34ac6b221d9d2b5ecaf93d9f37a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Win32.SystemEvents**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.Win32.Registry**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.Targets**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.DirectoryServices**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Drawing.Common**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.IO.FileSystem.AccessControl**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.IO.Packaging**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.IO.Pipes.AccessControl**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Resources.Extensions**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.AccessControl**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Cryptography.Cng**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Diagnostics.EventLog**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.CodeDom**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Cryptography.Xml**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.6.0**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Permissions**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Security.Principal.Windows**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Text.Encodings.Web**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Text.Json**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Threading.AccessControl**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n  - **System.Windows.Extensions**: [from 6.0.0-preview.3.21168.1 to 6.0.0-preview.3.21168.7][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/d819ebc...f58730b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4701)","Url":"https://github.com/dotnet/winforms/pull/4701","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#4701)"},{"Id":"831892862","IsPullRequest":true,"CreatedAt":"2021-03-19T00:28:52","Actor":"SergeySmirnov-Akvelon","Number":"4686","RawContent":null,"Title":"Fix inspector crash moving cursor inside the `DataGridView` with `AllowUserToAddRows=false`","State":"closed","Body":"Fixes #4242\r\n\r\n\r\n## Proposed changes\r\n- Fixed issue with getting of the non-existing item\r\n- Added unit tests\r\n\r\n## Customer Impact\r\nBefore fix:\r\n![99368341-fc4dfc80-28f5-11eb-9615-9db023a3e2b1](https://user-images.githubusercontent.com/23376742/111172724-1dc6a880-85b7-11eb-953c-a52e721bf5ac.gif)\r\n\r\nAfter fix:\r\n![Issue-4242](https://user-images.githubusercontent.com/23376742/111172815-320aa580-85b7-11eb-9425-5c8cbb48ca7d.png)\r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n## Test methodology <!-- How did you ensure quality? -->\r\n- CTI team \r\n- Unit tests\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n- Inspector\r\n\r\n## Test environment(s)\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core Version: 5.0.200-preview.20614.14\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4686)","Url":"https://github.com/dotnet/winforms/pull/4686","RelatedDescription":"Closed or merged PR \"Fix inspector crash moving cursor inside the `DataGridView` with `AllowUserToAddRows=false`\" (#4686)"},{"Id":"834737058","IsPullRequest":true,"CreatedAt":"2021-03-19T00:28:05","Actor":"dotnet-maestro[bot]","Number":"4696","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20210317.3\r\n- **Date Produced**: 3/17/2021 7:18 PM\r\n- **Commit**: 0ca849f0b71866b007fedaaa938cee63f8d056a6\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 6.0.0-beta.21166.5 to 6.0.0-beta.21167.3][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.21166.5 to 6.0.0-beta.21167.3][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 6.0.0-beta.21166.5 to 6.0.0-beta.21167.3][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 6.0.0-beta.21166.5 to 6.0.0-beta.21167.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.21166.5 to 6.0.0-beta.21167.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/b80229c...0ca849f\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4696)","Url":"https://github.com/dotnet/winforms/pull/4696","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#4696)"},{"Id":"834834367","IsPullRequest":false,"CreatedAt":"2021-03-18T22:42:16","Actor":"alexluozf","Number":"4699","RawContent":null,"Title":"What's the matter with PropertyGrid in NET5.0 ","State":"closed","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n* .NET Core Version: \r\nwindowsdesktop-runtime-5.0.4-win-x64\r\n\r\n* Have you experienced this same bug with .NET Framework?: \r\nNo\r\n\r\n**Problem description:**\r\n\r\nOnly the focus property value display.\r\n![PropertyGrid Issue](https://user-images.githubusercontent.com/62095636/111636587-989bf780-8833-11eb-9f35-239c1443d879.png)\r\n\r\n\r\n**Expected behavior:**\r\n\r\n\r\n**Minimal repro:**\r\n","Url":"https://github.com/dotnet/winforms/issues/4699","RelatedDescription":"Closed issue \"What's the matter with PropertyGrid in NET5.0 \" (#4699)"},{"Id":"834848524","IsPullRequest":true,"CreatedAt":"2021-03-18T13:57:13","Actor":"SergeySmirnov-Akvelon","Number":"4700","RawContent":null,"Title":"Move sub-classes of \"GridEntry\" class to their own files","State":"open","Body":"## Proposed changes\r\n- Moved sub-classes of \"GridEntry\" class to their own files \r\n- Enabled NRT\r\n- Fixed value names. Fixed code sorting\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4700)","Url":"https://github.com/dotnet/winforms/pull/4700","RelatedDescription":"Open PR \"Move sub-classes of \"GridEntry\" class to their own files\" (#4700)"},{"Id":"834737703","IsPullRequest":true,"CreatedAt":"2021-03-18T12:37:22","Actor":"dotnet-maestro[bot]","Number":"4697","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20210318.1\r\n- **Date Produced**: 3/18/2021 9:02 AM\r\n- **Commit**: d819ebcdbf8e59d2ef8dcbf1e82abddf0757eb0a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NETCore.Targets**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.Win32.Registry**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Resources.Extensions**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.AccessControl**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Cryptography.Cng**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Permissions**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Security.Principal.Windows**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.IO.Pipes.AccessControl**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.IO.Packaging**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.IO.FileSystem.AccessControl**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.CodeDom**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Text.Json**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.DirectoryServices**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Drawing.Common**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Threading.AccessControl**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Text.Encodings.Web**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **System.Windows.Extensions**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.6.0**: [from 6.0.0-preview.3.21167.1 to 6.0.0-preview.3.21168.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/0f64b26...d819ebc\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4697)","Url":"https://github.com/dotnet/winforms/pull/4697","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#4697)"},{"Id":"834629584","IsPullRequest":true,"CreatedAt":"2021-03-18T10:32:05","Actor":"SergeySmirnov-Akvelon","Number":"4695","RawContent":null,"Title":"Move sub-classes of \"DataGridViewTopLeftHeaderCell\", \"FlatButtonAppearance\" and \"FontCacheEntry\" classes to their own files","State":"open","Body":"## Proposed changes\r\n- Moved sub-classes of \"DataGridViewTopLeftHeaderCell\", \"FlatButtonAppearance\" and \"FontCacheEntry\" classes to their own files \r\n- Enabled NRT\r\n- Fixed Style issues and code sorting.\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.0-alpha.1.21073.5\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4695)","Url":"https://github.com/dotnet/winforms/pull/4695","RelatedDescription":"Open PR \"Move sub-classes of \"DataGridViewTopLeftHeaderCell\", \"FlatButtonAppearance\" and \"FontCacheEntry\" classes to their own files\" (#4695)"},{"Id":"834568088","IsPullRequest":true,"CreatedAt":"2021-03-18T09:21:29","Actor":"SergeySmirnov-Akvelon","Number":"4694","RawContent":null,"Title":"Move sub-classes of \"ToolTip\" and \"TabPage\" classes to their own files","State":"open","Body":"## Proposed changes\r\n- Move sub-classes of \"ToolTip\" and \"TabPage\" classes to their own files\r\n- Fixed code sorting\r\n\r\n## Customer Impact\r\n- No \r\n\r\n## Regression? \r\n- No\r\n\r\n## Risk\r\n- Minimal\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n- Microsoft Windows [Version 10.0.19041.388]\r\n- .NET Core SDK 6.0.100-preview.2.21155.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4694)","Url":"https://github.com/dotnet/winforms/pull/4694","RelatedDescription":"Open PR \"Move sub-classes of \"ToolTip\" and \"TabPage\" classes to their own files\" (#4694)"},{"Id":"833711332","IsPullRequest":true,"CreatedAt":"2021-03-17T12:44:34","Actor":"dotnet-maestro[bot]","Number":"4692","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20210317.1\r\n- **Date Produced**: 3/17/2021 10:07 AM\r\n- **Commit**: 0f64b267ac0552f07b06f18103581b880c8c53c6\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NETCore.Targets**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.Win32.Registry**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Resources.Extensions**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.AccessControl**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Cryptography.Cng**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Cryptography.Xml**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Permissions**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Security.Principal.Windows**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Text.Encodings.Web**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Text.Json**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.IO.Pipes.AccessControl**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.IO.Packaging**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.CodeDom**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Threading.AccessControl**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Diagnostics.EventLog**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.DirectoryServices**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Drawing.Common**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.IO.FileSystem.AccessControl**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **System.Windows.Extensions**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.6.0**: [from 6.0.0-preview.3.21166.1 to 6.0.0-preview.3.21167.1][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/ec18977...0f64b26\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4692)","Url":"https://github.com/dotnet/winforms/pull/4692","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#4692)"},{"Id":"833710717","IsPullRequest":true,"CreatedAt":"2021-03-17T12:43:43","Actor":"dotnet-maestro[bot]","Number":"4691","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20210316.5\r\n- **Date Produced**: 3/16/2021 10:01 PM\r\n- **Commit**: b80229ca3c7bae93ff9b4a50807c7efb0518e771\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 6.0.0-beta.21165.1 to 6.0.0-beta.21166.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.21165.1 to 6.0.0-beta.21166.5][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 6.0.0-beta.21165.1 to 6.0.0-beta.21166.5][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 6.0.0-beta.21165.1 to 6.0.0-beta.21166.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.21165.1 to 6.0.0-beta.21166.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/d88b466...b80229c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4691)","Url":"https://github.com/dotnet/winforms/pull/4691","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#4691)"},{"Id":"833566665","IsPullRequest":false,"CreatedAt":"2021-03-17T09:20:52","Actor":"SergeySmirnov-Akvelon","Number":"4690","RawContent":null,"Title":"ListViewSubItems in the ListView have incorrect behavior","State":"open","Body":"<details>\r\n<summary> Common</summary>\r\n\r\n### Case 1:\r\n- [ ] The checkbox does not have its accessibility object in the `ListView`\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111449792-c7757900-8720-11eb-914f-fd02d6b349ab.png)\r\n\r\n**Expected behavior:**\r\nThe checkbox should have its accessibility object in the `ListView`\r\n</details>\r\n\r\n<details>\r\n<summary> Details </summary>\r\n\r\n### Case 1 (regression from #3223):\r\n- [ ] A yellow rectangle is drawn for the entire `ListViewItem` instead of the selected `ListViewSubItem`\r\n\r\n**Actual behavior:**\r\n![Issue-4690-details-case1](https://user-images.githubusercontent.com/23376742/111447695-ba578a80-871e-11eb-9dc4-39aa45238af1.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111448495-85980300-871f-11eb-9346-6d23b052b604.png)\r\n\r\n### Case 2:\r\n- [ ] The image does not have its accessibility object in the `ListView`\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111451977-0f959b00-8723-11eb-8225-6a1551022007.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111452076-2cca6980-8723-11eb-837f-8b548e2bfa51.png)\r\n\r\n### Case 3:\r\n- [ ] ListViewSubItem of an ListViewItem are not displayed in the Inspector tree when the ListViewItem is in a ListViewGroup (may be fixed in #4678)\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111466674-a4ed5b00-8734-11eb-8ff2-d8dd253a49ed.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111466706-acacff80-8734-11eb-9f97-63d990548f91.png)\r\n</details>\r\n\r\n<details>\r\n<summary> LargeIcon</summary>\r\n\r\n### Case 1:\r\n- [ ] `ListViewSubItem` in a `ListView` do not have accessibility objects\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111459193-6d2de580-872b-11eb-8b34-c26e8d6e9363.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111459197-71f29980-872b-11eb-8051-675e8a0f7ff4.png)\r\n</details>\r\n\r\n<details>\r\n<summary> List</summary>\r\n\r\n### Case 1:\r\n- [ ] `ListViewSubItem` in a `ListView` do not have accessibility objects\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111455530-f7277f80-8726-11eb-93e7-58f8567ae2a9.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111455558-00185100-8727-11eb-8ca0-efc2831d156c.png)\r\n</details>\r\n\r\n<details>\r\n<summary> SmallIcon</summary>\r\n\r\n### Case 1:\r\n- [ ] `ListViewSubItem` in a `ListView` do not have accessibility objects\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111458355-62268580-872a-11eb-8fb6-3c3ea56a2de9.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111458398-6c488400-872a-11eb-9211-83c4029e33bc.png)\r\n</details>\r\n\r\n<details>\r\n<summary> Tile </summary>\r\n\r\n### Case 1 (regression from #3223):\r\n - [ ] `ListViewSubItem` of an `ListViewItem` are not displayed in the Inspector tree when the `ListViewItem` is in a `ListViewGroup` (#4678)\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111444647-a4949600-871b-11eb-8381-817028884fa8.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111444728-bb3aed00-871b-11eb-8420-1f630c8f9468.png)\r\n\r\n### Case 2 (regression from #3223):\r\n - [ ] The rectangle is not displayed for a `ListViewSubItem` when the user hovers over it or selects in the Inspector tree (#4679)\r\n\r\n**Actual behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111445629-a4e16100-871c-11eb-80fa-2e0502ad807f.png)\r\n\r\n**Expected behavior:**\r\n![image](https://user-images.githubusercontent.com/23376742/111445672-b1fe5000-871c-11eb-85a7-163805e7ad14.png)\r\n</details>\r\n","Url":"https://github.com/dotnet/winforms/issues/4690","RelatedDescription":"Open issue \"ListViewSubItems in the ListView have incorrect behavior\" (#4690)"},{"Id":"832739539","IsPullRequest":true,"CreatedAt":"2021-03-16T12:59:20","Actor":"dotnet-maestro[bot]","Number":"4688","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20210315.1\r\n- **Date Produced**: 3/15/2021 4:19 PM\r\n- **Commit**: d88b466beb295e15b5e3bcb36b02b7900d4fd0ca\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 6.0.0-beta.21160.7 to 6.0.0-beta.21165.1][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.21160.7 to 6.0.0-beta.21165.1][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 6.0.0-beta.21160.7 to 6.0.0-beta.21165.1][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 6.0.0-beta.21160.7 to 6.0.0-beta.21165.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.21160.7 to 6.0.0-beta.21165.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/7f13798...d88b466\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n- **Updates to .NET SDKs:**\r\n  - Updates sdk.version to 6.0.100-preview.2.21155.3\r\n  - Updates tools.dotnet to 6.0.100-preview.2.21155.3\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4688)","Url":"https://github.com/dotnet/winforms/pull/4688","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#4688)"},{"Id":"832241727","IsPullRequest":false,"CreatedAt":"2021-03-15T22:27:46","Actor":"weltkante","Number":"4687","RawContent":null,"Title":"Clean up interactive dialog test","State":"open","Body":"<!-- Read https://github.com/dotnet/winforms/blob/main/docs/issue-guide.md -->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n/ **Describe the solution you'd like and alternatives you've considered**\r\n\r\nDuring PR #4645 discussion it was noted that interactive testing of various combinations of dialog options would be easier to do by making a property grid available to configure the dialogs instead of having just a small number of predefined test scenarios to chose from.\r\n\r\nThis issue is a follow-up to that PR to clean up existing predefined scenarios and integrate them into the more general property grid based approach.\r\n\r\nAlso consider adding support for predefined scenarios to the property grid approach (maybe through a context menu or as another toolbar button on the property grid).\r\n\r\n**Will this feature affect UI controls?**\r\n\r\nNo, just affects the interactive test project","Url":"https://github.com/dotnet/winforms/issues/4687","RelatedDescription":"Open issue \"Clean up interactive dialog test\" (#4687)"},{"Id":"831084274","IsPullRequest":true,"CreatedAt":"2021-03-15T21:47:55","Actor":"gpetrou","Number":"4684","RawContent":null,"Title":"Enable nullability in PropertyTabChangedEventArgs and PropertyValueCh…","State":"closed","Body":"…angedEventArgs\r\n\r\n## Proposed changes\r\n\r\n- Enable nullability in PropertyTabChangedEventArgs and PropertyValueChangedEventArgs.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4684)","Url":"https://github.com/dotnet/winforms/pull/4684","RelatedDescription":"Closed or merged PR \"Enable nullability in PropertyTabChangedEventArgs and PropertyValueCh…\" (#4684)"},{"Id":"831224739","IsPullRequest":true,"CreatedAt":"2021-03-14T18:26:11","Actor":"weltkante","Number":"4685","RawContent":null,"Title":"Fix inversion of conditional","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nContributes to #4370\r\n\r\n## Proposed changes\r\n\r\nThis regression to Desktop Framework was found while investigating #4370. It is unclear what the effects of this regression are, but [comparing](https://referencesource.microsoft.com/#System.Windows.Forms/winforms/Managed/System/WinForms/Control.cs,15700) with Desktop Framework it seems its a mistake from refactoring\r\n\r\nWhen running a debug build of WinForms during investigation of #4370 I had turned on `CompModSwitches.ActiveX` and the broken code resulted in warnings of the ActiveX host passing wrong flags (which of course is wrong, using MFC or Office as host you can assume they pass the right flags).\r\n\r\n## Customer Impact\r\n\r\n- unknown, probably changing behavior of hosted controls due to wrong flags being passed to host\r\n\r\n## Regression? \r\n\r\n- yes\r\n\r\n## Risk\r\n\r\n- low, restoring code to how it was before. There was another recent regression fix for #4370 so this should be fine to accompany the other fix\r\n\r\n### Before\r\n\r\n- running the sample from #4370 (or generally, hosting a WinForms control in a MFC app or other ActiveX host) outputs warnings when using a WinForms debug build with ActiveX tracing turned on\r\n\r\n### After\r\n\r\n- no warnings in debug build\r\n\r\n## Test methodology\r\n\r\n- source inspection\r\n- running the sample from #4370 with a debug build of WinForms, making sure the previously observed warning is gone\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- MFC application (stock app from wizard) initializing the WinForms control from the sample code\r\n- Outlook 16.0.13801.20240 (32 bit) hosting the WinForms control from the sample code\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4685)","Url":"https://github.com/dotnet/winforms/pull/4685","RelatedDescription":"Open PR \"Fix inversion of conditional\" (#4685)"},{"Id":"831082242","IsPullRequest":true,"CreatedAt":"2021-03-14T06:51:57","Actor":"gpetrou","Number":"4683","RawContent":null,"Title":"Enable nullability in DrawToolTipEventArgs and DrawTreeNodeEventArgs","State":"open","Body":"## Proposed changes\r\n\r\n- Enable nullability in DrawToolTipEventArgs and DrawTreeNodeEventArgs.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/4683)","Url":"https://github.com/dotnet/winforms/pull/4683","RelatedDescription":"Open PR \"Enable nullability in DrawToolTipEventArgs and DrawTreeNodeEventArgs\" (#4683)"}],"ResultType":"GitHubIssue"}},"RunOn":"2021-03-23T05:30:38.5831878Z","RunDurationInMilliseconds":516}