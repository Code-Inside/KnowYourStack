{"Data":{"GitHub":{"Issues":[{"Id":"1268182421","IsPullRequest":true,"CreatedAt":"2022-06-14T01:32:24","Actor":"gpetrou","Number":"7289","RawContent":null,"Title":"Enable nullability in ListViewNativeItemCollection","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in ListViewNativeItemCollection.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7289)","Url":"https://github.com/dotnet/winforms/pull/7289","RelatedDescription":"Closed or merged PR \"Enable nullability in ListViewNativeItemCollection\" (#7289)"},{"Id":"1270126696","IsPullRequest":false,"CreatedAt":"2022-06-14T01:07:02","Actor":"runfoapp[bot]","Number":"7297","RawContent":null,"Title":"Flaky System.Windows.Forms.UITests.ButtonTests.Button_Anchor_ResizeOnWindowSizeWiderAsync","State":"open","Body":"<!-- runfo report start -->\r\nRunfo Tracking Issue: [Flaky System.Windows.Forms.UITests.ButtonTests.Button_Anchor_ResizeOnWindowSizeWiderAsync](https://runfo.azurewebsites.net/tracking/issue/346)\r\n|Build|Definition|Kind|Run Name|\r\n|---|---|---|---|\r\n\r\n\r\n\r\nBuild Result Summary\r\n|Day Hit Count|Week Hit Count|Month Hit Count|\r\n|---|---|---|\r\n|0|0|0|\r\n\r\n<!-- runfo report end -->\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/issues/7297","RelatedDescription":"Open issue \"Flaky System.Windows.Forms.UITests.ButtonTests.Button_Anchor_ResizeOnWindowSizeWiderAsync\" (#7297)"},{"Id":"1268954156","IsPullRequest":true,"CreatedAt":"2022-06-14T01:03:18","Actor":"gpetrou","Number":"7293","RawContent":null,"Title":"Enable nullability in DataGridViewTextBoxEditingControl and IDataGridViewEditingControl","State":"closed","Body":"## Proposed changes\r\n\r\n- Enable nullability in DataGridViewTextBoxEditingControl and IDataGridViewEditingControl.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7293)","Url":"https://github.com/dotnet/winforms/pull/7293","RelatedDescription":"Closed or merged PR \"Enable nullability in DataGridViewTextBoxEditingControl and IDataGridViewEditingControl\" (#7293)"},{"Id":"1267455181","IsPullRequest":true,"CreatedAt":"2022-06-14T00:40:51","Actor":"dotnet-maestro[bot]","Number":"7288","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220612.5\r\n- **Date Produced**: June 13, 2022 8:26:04 AM UTC\r\n- **Commit**: a0b426dc781be2f3e38bb13856d15e2fa595a589\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.CodeDom**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Text.Json**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.6.22308.8 to 7.0.0-preview.6.22312.5][4]\r\n\r\n[4]: https://github.com/dotnet/runtime/compare/3cc587e...a0b426d\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7288)\r\n\r\n\r\n","Url":"https://github.com/dotnet/winforms/pull/7288","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#7288)"},{"Id":"1268475789","IsPullRequest":true,"CreatedAt":"2022-06-14T00:07:23","Actor":"gpetrou","Number":"7292","RawContent":null,"Title":"Use LibraryImport in some Interop UxTheme","State":"closed","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in some Interop UxTheme.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7292)","Url":"https://github.com/dotnet/winforms/pull/7292","RelatedDescription":"Closed or merged PR \"Use LibraryImport in some Interop UxTheme\" (#7292)"},{"Id":"1264146408","IsPullRequest":false,"CreatedAt":"2022-06-13T23:50:16","Actor":"kslynn","Number":"7270","RawContent":null,"Title":"VS2022: The process cannot access the file 'Microsoft.DotNet.DesignTools.Protocol.resources.dll' because it is being used by another process. ","State":"closed","Body":"### Environment\r\n\r\nMicrosoft Visual Studio Professional 2022 (64-bit) - Current\r\nVersion 17.2.3\r\n\r\n\r\n### .NET version\r\n\r\ndotnet5\r\n\r\n### Did this work in a previous version of Visual Studio and/or previous .NET release?\r\n\r\nI don't know, I am new for this company, I got a new pc, and copy the solution from my collages\r\n\r\n### Issue description\r\n\r\n![WinFormDesignerError](https://user-images.githubusercontent.com/12741901/172525228-9af24397-35d5-4d86-8161-eed91a02b198.png)\r\n\r\nthis occors in my old solution, it's converted from dotnet4.6\r\n\r\nit's ok if I open it at the very begining, but after I clicked the debug button to run the program, then switch to the solution, \r\n\r\nerror happened as the file attached while I tried to open the winform in designer\r\n\r\nI restarted the vs2022, the error is still there\r\n\r\nI restarted my computer, the error is still there\r\n\r\nI don't know how to deal with it.\r\n\r\n### Steps to reproduce\r\n\r\n_No response_\r\n\r\n### Diagnostics\r\n\r\n_No response_","Url":"https://github.com/dotnet/winforms/issues/7270","RelatedDescription":"Closed issue \"VS2022: The process cannot access the file 'Microsoft.DotNet.DesignTools.Protocol.resources.dll' because it is being used by another process. \" (#7270)"},{"Id":"1268255053","IsPullRequest":true,"CreatedAt":"2022-06-13T22:34:53","Actor":"dotnet-maestro[bot]","Number":"7291","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220613.1\r\n- **Date Produced**: June 13, 2022 8:26:39 AM UTC\r\n- **Commit**: 569a3f07467a9ebf55b78bbf92ab10b85e597819\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22308.5 to 7.0.0-beta.22313.1][3]\r\n\r\n[3]: https://github.com/dotnet/arcade/compare/d681cd3...569a3f0\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7291)\r\n\r\n","Url":"https://github.com/dotnet/winforms/pull/7291","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7291)"},{"Id":"1269753671","IsPullRequest":true,"CreatedAt":"2022-06-13T17:40:43","Actor":"dmitrii-drobotov","Number":"7296","RawContent":null,"Title":"Fix TreeNode accessible objects memory leak","State":"open","Body":"Fixes #7196\r\n\r\n\r\n## Proposed changes\r\n\r\n- Add call to `UiaDisconnectProvider` for `TreeNodeAccessibleObject`s for cases when:\r\n    - `TreeView` is destroyed (now it only releases `TreeViewAccessibleObject`)\r\n    - All nodes are cleared from `TreeView`\r\n    - A node is removed from `TreeView`\r\n- Add unit tests for above scenarios\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- `TreeNodeAccessibleObject` memory will stop leaking \r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\nAfter executing steps from issue description for `TreeView` with 16 nodes:\r\n\r\n![Screenshot 2022-06-10 161803](https://user-images.githubusercontent.com/102954094/173408896-0f8a12d6-34e3-48aa-9748-d07e6a67256b.png)\r\n\r\n### After\r\n\r\n![Screenshot 2022-06-13 183507](https://user-images.githubusercontent.com/102954094/173408956-cbb1b9c4-56ac-450d-8c26-eb8246f79daf.png)\r\n\r\nIdeally there should be 0 objects, but two empty `TreeNode[]` are still left. I tried to find the cause of it but couldn't quickly do so. It would also be present even without using accessibility tools, therefore out of scope of this task. Considering it has a very small footprint, I don't think we should raise a separate issue for it.\r\n\r\nAfter `TreeView.Nodes.Clear()` — no `TreeNodeAccessibleObject` instances:\r\n\r\n![Screenshot 2022-06-13 184741](https://user-images.githubusercontent.com/102954094/173412001-21b0a52e-1335-4a1d-ad17-f397268df9c2.png)\r\n\r\nAfter  `TreeView.Nodes.RemoveAt()` for several nodes, leaving only 9:\r\n\r\n![Screenshot 2022-06-13 184641](https://user-images.githubusercontent.com/102954094/173411528-06c367cf-9c93-4e7d-a49e-7c525b5d6ee1.png)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Unit testing\r\n- Manual testing with WinDbg to check memory leak, Narrator to check for regressions similar to #6230, Inspect/AI to check that removed nodes are inaccessible there\r\n \r\n\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n* Windows 11 (Version 10.0.22000)\r\n* .NET 7.0.0-preview.5.22272.3\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7296)","Url":"https://github.com/dotnet/winforms/pull/7296","RelatedDescription":"Open PR \"Fix TreeNode accessible objects memory leak\" (#7296)"},{"Id":"1269529069","IsPullRequest":true,"CreatedAt":"2022-06-13T14:26:41","Actor":"vladimir-krestov","Number":"7295","RawContent":null,"Title":"Releasing leak objects of UiaTextRange","State":"open","Body":"Fixes #7248\r\n\r\n## Proposed changes\r\n\r\n- Use HandleDestroyed events to release related objects of UiaTextRange objects. We create new instances of the ranges and send them to UIA (eg. Inspect). When TextBox disposing UIA tool keeps several ranges thereby keep the provider and the TextBox accessible object. Due to we have many unregistered text ranges we don't have access to all of them, so I think it would be better to use events and subscription on them for every text range.\r\n\r\n## Customer Impact\r\n\r\n- No\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- We make some fields as null. UIA can call some method or property after disposing, thereby try to get some value of null-object. So we can catch NRE. To avoid it needs to add necessary null checks.\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n- UIA keeps text ranges and TextBox accessible object\r\n- TextBox accessible object keeps TextBox control (will be fixed next)\r\n![image](https://user-images.githubusercontent.com/49272759/173382118-97f41e7d-ff72-4943-b3fa-bf844ae36a5e.png)\r\n![image](https://user-images.githubusercontent.com/49272759/173382453-78690d1b-6173-4de0-b2b8-88ff5b63b3fa.png)\r\n\r\n\r\n### After\r\n\r\n- TextBox text provider is released\r\n![image](https://user-images.githubusercontent.com/49272759/173383046-ab741603-76d1-47bc-89e1-c862510c4714.png)\r\n\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manual testing\r\n- CTI\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n-  Using Inspect and Narrator:\r\n     - Focus on a TextBox\r\n     - Navigate through characters\r\n     - Select some range\r\n     - Use Inspect TextPattern explorer to get all possible ranges\r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- dotnet 7.0.0-preview.5.22272.3\r\n- Windows 11\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7295)","Url":"https://github.com/dotnet/winforms/pull/7295","RelatedDescription":"Open PR \"Releasing leak objects of UiaTextRange\" (#7295)"},{"Id":"1268993165","IsPullRequest":true,"CreatedAt":"2022-06-13T06:59:57","Actor":"gpetrou","Number":"7294","RawContent":null,"Title":"Replace hashtables with generic dictionaries in ToolTip","State":"open","Body":"## Proposed changes\r\n\r\n- Replace hashtables with generic dictionaries in ToolTip.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7294)","Url":"https://github.com/dotnet/winforms/pull/7294","RelatedDescription":"Open PR \"Replace hashtables with generic dictionaries in ToolTip\" (#7294)"},{"Id":"1268182679","IsPullRequest":true,"CreatedAt":"2022-06-11T06:46:16","Actor":"kant2002","Number":"7290","RawContent":null,"Title":"Produce trim warning as part of the build","State":"open","Body":"For now I only enable trim warnings as part of the build as per https://docs.microsoft.com/en-us/dotnet/core/deploying/trimming/prepare-libraries-for-trimming#enable-the-roslyn-analyzer\r\nThat much simpler setup then proposed by @vitek-karas and I think it\r\nwould suffice us.\r\n\r\nRelated #4649\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7290)","Url":"https://github.com/dotnet/winforms/pull/7290","RelatedDescription":"Open PR \"Produce trim warning as part of the build\" (#7290)"},{"Id":"1265475040","IsPullRequest":true,"CreatedAt":"2022-06-10T18:08:25","Actor":"JeremyKuhne","Number":"7276","RawContent":null,"Title":"Add some clarifying comments to AccessibleObject","State":"closed","Body":"Also tweak the constructors in ControlAccessibleObject to chain them together and roll InitHandle into the constructor.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7276)","Url":"https://github.com/dotnet/winforms/pull/7276","RelatedDescription":"Closed or merged PR \"Add some clarifying comments to AccessibleObject\" (#7276)"},{"Id":"1267271096","IsPullRequest":true,"CreatedAt":"2022-06-10T09:06:03","Actor":"gpetrou","Number":"7287","RawContent":null,"Title":"Use LibraryImport in some Interop Oleaut32","State":"open","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in some Interop Oleaut32.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7287)","Url":"https://github.com/dotnet/winforms/pull/7287","RelatedDescription":"Open PR \"Use LibraryImport in some Interop Oleaut32\" (#7287)"},{"Id":"1267245871","IsPullRequest":true,"CreatedAt":"2022-06-10T08:42:37","Actor":"gpetrou","Number":"7286","RawContent":null,"Title":"Use LibraryImport in Interop Imm32","State":"open","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in Interop Imm32.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7286)","Url":"https://github.com/dotnet/winforms/pull/7286","RelatedDescription":"Open PR \"Use LibraryImport in Interop Imm32\" (#7286)"},{"Id":"1266035875","IsPullRequest":true,"CreatedAt":"2022-06-10T06:12:48","Actor":"dotnet-maestro[bot]","Number":"7280","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220608.5\r\n- **Date Produced**: June 8, 2022 8:58:10 PM UTC\r\n- **Commit**: d681cd3568168a97aa4cf50a61af9ec74d307eb8\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22306.2 to 7.0.0-beta.22308.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/8f311fe...d681cd3\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7280)","Url":"https://github.com/dotnet/winforms/pull/7280","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7280)"},{"Id":"1265577609","IsPullRequest":true,"CreatedAt":"2022-06-10T06:09:11","Actor":"gpetrou","Number":"7278","RawContent":null,"Title":"Use LibraryImport in some Interop Gdi32","State":"closed","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in some Interop Gdi32.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7278)","Url":"https://github.com/dotnet/winforms/pull/7278","RelatedDescription":"Closed or merged PR \"Use LibraryImport in some Interop Gdi32\" (#7278)"},{"Id":"1265588858","IsPullRequest":true,"CreatedAt":"2022-06-10T06:06:51","Actor":"gpetrou","Number":"7279","RawContent":null,"Title":"Use LibraryImport in some Interop Kernel32","State":"closed","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in some Interop Kernel32.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7279)","Url":"https://github.com/dotnet/winforms/pull/7279","RelatedDescription":"Closed or merged PR \"Use LibraryImport in some Interop Kernel32\" (#7279)"},{"Id":"1265080223","IsPullRequest":true,"CreatedAt":"2022-06-09T22:41:27","Actor":"dreddy-work","Number":"7274","RawContent":null,"Title":"Fix typo in 3.1 template.","State":"closed","Body":"Fixing typo in template.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7274)","Url":"https://github.com/dotnet/winforms/pull/7274","RelatedDescription":"Closed or merged PR \"Fix typo in 3.1 template.\" (#7274)"},{"Id":"1266036762","IsPullRequest":true,"CreatedAt":"2022-06-09T21:19:03","Actor":"dotnet-maestro[bot]","Number":"7281","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220608.8\r\n- **Date Produced**: June 9, 2022 12:52:01 AM UTC\r\n- **Commit**: 3cc587e1d037b054e785f1e758edec8490fa62ea\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.6.22307.6 to 7.0.0-preview.6.22308.8][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/655f414...3cc587e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7281)","Url":"https://github.com/dotnet/winforms/pull/7281","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#7281)"},{"Id":"1266494364","IsPullRequest":true,"CreatedAt":"2022-06-09T18:16:36","Actor":"gpetrou","Number":"7285","RawContent":null,"Title":"Use LibraryImport in some Interop Comctl32","State":"open","Body":"## Proposed changes\r\n\r\n- Use LibraryImport in some Interop Comctl32.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7285)","Url":"https://github.com/dotnet/winforms/pull/7285","RelatedDescription":"Open PR \"Use LibraryImport in some Interop Comctl32\" (#7285)"},{"Id":"1266411600","IsPullRequest":true,"CreatedAt":"2022-06-09T16:54:09","Actor":"dmitrii-drobotov","Number":"7284","RawContent":null,"Title":"Fix ListBox items accessible objects memory leak ","State":"open","Body":"Fixes #7197.\r\n\r\n\r\n## Proposed changes\r\n\r\n- Add call to `UiaDisconnectProvider` for `ListBoxItemAccessibleObject`s for cases when:\r\n    - `ListBox` is destroyed (now it only releases provider for `ListBoxAccessibleObject`)\r\n    - All items are cleared from `ListBox`\r\n    - An item is removed from `ListBox`\r\n- Add unit tests for above scenarios\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- `ListBoxItemAccessibleObject`s memory will stop leaking \r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\nAfter executing steps from issue description for ListBox with 18 items:\r\n\r\n![Screenshot 2022-06-09 184103](https://user-images.githubusercontent.com/102954094/172899825-4130454d-ab5b-48e7-a567-451497ba6184.png)\r\n\r\n### After\r\n\r\n![Screenshot 2022-06-09 180310](https://user-images.githubusercontent.com/102954094/172899893-95dfb5a5-16b8-459e-8b1d-317267637d70.png)\r\n\r\nAfter `ListBox.Items.Clear()`:\r\n\r\n![Screenshot 2022-06-09 183627](https://user-images.githubusercontent.com/102954094/172900100-e7cf850a-d04d-4816-b836-b4827d39bc1c.png)\r\n\r\nOne `ListBoxItemAccessibleObject` instance may be held by `ListBox._focusedItem` field, which doesn't create a memory leak, because the AO was disconnected from UIA provider and will be garbage-collected normally once form is closed.\r\n\r\nAfter  `ListBox.Items.RemoveAt(0)` 5 times:\r\n\r\n![Screenshot 2022-06-09 183839](https://user-images.githubusercontent.com/102954094/172900281-17817f20-72eb-4179-8f1f-48fc484c652e.png)\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Unit testing\r\n- Manual testing with WinDbg to check memory leak, Narrator to check for regressions similar to #6230, Inspect/AI to check that removed items are inaccessible there\r\n \r\n\r\n## Test environment(s)\r\n\r\n* Windows 11 (Version 10.0.22000)\r\n* .NET 7.0.0-preview.5.22272.3\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7284)","Url":"https://github.com/dotnet/winforms/pull/7284","RelatedDescription":"Open PR \"Fix ListBox items accessible objects memory leak \" (#7284)"},{"Id":"1266201811","IsPullRequest":false,"CreatedAt":"2022-06-09T14:14:51","Actor":"phillipstoll","Number":"7282","RawContent":null,"Title":"TreeView and ComboBox do not correctly display ","State":"open","Body":"### .NET version\r\n\r\nVersion:   6.0.300\r\n\r\n### Did it work in .NET Framework?\r\n\r\nNo\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nWindows Forms TreeView and ComboBox controls, when used with Verdana Font, do not correctly display certain Latin-8 (ISO-8859-14: Celtic) characters. Certain characters are displayed as squares. E.g., Ḃḃ£ĊċḊ§Ẁ©ẂḋỲ®Ÿ appears as □□£Ċċ□§Ẁ©Ẃ□Ỳ®Ÿ . For the ComboBox the squares appear only in the drop-down. It works correctly with some fonts (Arial) but not with others (Arial Black). It doesn't occur on other common controls such as TextBox, Button, Label, CheckBox, RadioButton, CheckedListBox. Note: fixing it in .NET 5 won't help me because our software is at .NET 4.8\r\n\r\n### Issue description\r\n\r\n\r\n![TreeViewComboBox](https://user-images.githubusercontent.com/75649189/172866419-81f5bfb4-0039-4b18-a7d1-4163e0f6fa1f.jpg)\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\nAdd a Windows Forms App\r\nAdd a TreeView controls to the form\r\nChange the TreeView's  FontFamily to Verdana\r\nEdit the TreeView's Nodes collection, and add a node with the text Ḃḃ£ĊċḊ§Ẁ©ẂḋỲ®Ÿ","Url":"https://github.com/dotnet/winforms/issues/7282","RelatedDescription":"Open issue \"TreeView and ComboBox do not correctly display \" (#7282)"},{"Id":"1265478381","IsPullRequest":true,"CreatedAt":"2022-06-09T13:05:03","Actor":"dotnet-maestro[bot]","Number":"7277","RawContent":null,"Title":"[release/7.0-preview5] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:a7b30b7b-327b-44b1-669d-08da3ece2ec7)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: a7b30b7b-327b-44b1-669d-08da3ece2ec7\r\n- **Build**: 20220608.7\r\n- **Date Produced**: June 9, 2022 12:24:09 AM UTC\r\n- **Commit**: 0b1690811d43db7a5e2b8aa7d4275dd06973c01e\r\n- **Branch**: refs/heads/release/7.0-preview5\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.5.22301.12 to 7.0.0-preview.5.22308.7][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/425fedc...0b16908\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:a7b30b7b-327b-44b1-669d-08da3ece2ec7)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7277)","Url":"https://github.com/dotnet/winforms/pull/7277","RelatedDescription":"Closed or merged PR \"[release/7.0-preview5] Update dependencies from dotnet/runtime\" (#7277)"},{"Id":"1265409399","IsPullRequest":true,"CreatedAt":"2022-06-09T00:29:50","Actor":"dreddy-work","Number":"7275","RawContent":null,"Title":"Bump intellisense.","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7275)","Url":"https://github.com/dotnet/winforms/pull/7275","RelatedDescription":"Closed or merged PR \"Bump intellisense.\" (#7275)"},{"Id":"1264644942","IsPullRequest":true,"CreatedAt":"2022-06-08T12:51:13","Actor":"dotnet-maestro[bot]","Number":"7273","RawContent":null,"Title":"[main] Update dependencies from dotnet/runtime","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n## From https://github.com/dotnet/runtime\r\n- **Subscription**: d9f5b309-084f-43b5-02de-08d8b80548e4\r\n- **Build**: 20220607.6\r\n- **Date Produced**: June 8, 2022 6:26:32 AM UTC\r\n- **Commit**: 655f414c14b96a6293d51dbff69de90507b9e4bc\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Internal.Runtime.WindowsDesktop.Transport**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NET.Sdk.IL**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NETCore.ILDAsm**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.Win32.SystemEvents**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **Microsoft.Windows.Compatibility**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **runtime.win-x64.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **runtime.win-x86.Microsoft.NETCore.ILAsm**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Security.Cryptography.Pkcs**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Text.Encodings.Web**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Text.Json**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Threading.AccessControl**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.6.22306.7 to 7.0.0-preview.6.22307.6][1]\r\n\r\n[1]: https://github.com/dotnet/runtime/compare/eef6c7f...655f414\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:d9f5b309-084f-43b5-02de-08d8b80548e4)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7273)","Url":"https://github.com/dotnet/winforms/pull/7273","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/runtime\" (#7273)"},{"Id":"1264643802","IsPullRequest":true,"CreatedAt":"2022-06-08T12:45:15","Actor":"dotnet-maestro[bot]","Number":"7272","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: b9a1a4bb-2302-4987-3b3d-08d8b8050dda\r\n- **Build**: 20220606.2\r\n- **Date Produced**: June 6, 2022 3:43:08 PM UTC\r\n- **Commit**: 8f311fed1f2acf0ecfdfcecbc7a9fa871ed634cc\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n  - **Microsoft.DotNet.CMake.Sdk**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n  - **Microsoft.DotNet.GenFacades**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n  - **Microsoft.DotNet.RemoteExecutor**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n  - **Microsoft.DotNet.XUnitExtensions**: [from 7.0.0-beta.22306.1 to 7.0.0-beta.22306.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/7f522f2...8f311fe\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:b9a1a4bb-2302-4987-3b3d-08d8b8050dda)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7272)","Url":"https://github.com/dotnet/winforms/pull/7272","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7272)"},{"Id":"1263795658","IsPullRequest":true,"CreatedAt":"2022-06-08T12:43:38","Actor":"phenning","Number":"7268","RawContent":null,"Title":"Fix condition in skipAppModel to use UseWindowsDesktopSDK","State":"closed","Body":"Fixes #7267\r\n\r\n## Proposed changes\r\n- Update skipAppModel condition to consider UseWindowsDesktopSDK which to properly create template targeting netcoreapp3.1 when created from Visual Studio\r\n\r\n\r\n## Customer Impact\r\n\r\n- Without change, customer cannot create a netcoreapp3.1 Winforms app successfully in Visual Studio\r\n\r\n## Regression? \r\n\r\n- No, this appears to have been an issue for quite some time.\r\n\r\n## Risk\r\n\r\n- Low\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n-  Installed template locally with changes, verified both CLI and Visual Studio was successful when targeting 3.1\r\n-  Verified no regressions for other TFMs\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7268)","Url":"https://github.com/dotnet/winforms/pull/7268","RelatedDescription":"Closed or merged PR \"Fix condition in skipAppModel to use UseWindowsDesktopSDK\" (#7268)"},{"Id":"1263787953","IsPullRequest":false,"CreatedAt":"2022-06-08T12:43:38","Actor":"phenning","Number":"7267","RawContent":null,"Title":"Missing Program.vb in Winforms App targeting 3.1 from Visual Studio","State":"closed","Body":"### .NET version\r\n\r\n7.0.100-preview.4.22252.9\r\n\r\n### Did it work in .NET Framework?\r\n\r\nYes\r\n\r\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\r\n\r\nOnly with netcoreapp3.1 SDK I believe.\r\n\r\n### Issue description\r\n\r\nWhen creating a NET Core 3.1 WinForms app in VIsual Studio, an error is encountered:\r\n\r\n1>------ Build started: Project: WinFormsApp5, Configuration: Debug Any CPU ------\r\n1>vbc : error BC30420: 'Sub Main' was not found in 'WinFormsApp5'.\r\n1>Done building project \"WinFormsApp5.vbproj\" -- FAILED.\r\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\r\n\r\nThis is happening because the Program.vb is not being laid down by the template due to an incorrect condition in template.json\r\nWhen the same template is created on the command line via the following, the Program.vb is created, so no error results.\r\n`dotnet new winforms -f netcoreapp3.1 -lang VB`\r\n\r\nThe following configuration is causing the errors:\r\nSince the TFM is netcoreapp3.1, UseWindowsDesktopSdkis set to true;\r\n```\r\n    \"UseWindowsDesktopSdk\": {\r\n      \"type\": \"computed\",\r\n      \"value\": \"(Framework == \\\"netcoreapp3.1\\\")\"\r\n    },\r\n```\r\n\r\nAs a result of this, the ApplicationEvents, and other files are excluded:\r\n```          {\r\n\r\n            \"condition\": \"(UseWindowsDesktopSdk)\",\r\n            \"exclude\": [\r\n              \"Company.WinFormsApplication1.vbproj\",\r\n              \"Company.WinFormsApplicationSkipAppModel1.vbproj\",\r\n              \"My Project/**/*\",\r\n              \"ApplicationEvents.vb\"\r\n            ],\r\n            \"rename\": {\r\n              \"Company.WinFormsApplication3x1.vbproj\": \"Company.WinFormsApplication1.vbproj\"\r\n            }\r\n          },\r\n```\r\n\r\nHowever, the Program.vb is ALSO excluded:\r\n```\r\n          {\r\n            \"condition\": \"(!skipAppModel)\",\r\n            \"exclude\": [\r\n              \"Program.vb\",\r\n              \"Company.WinFormsApplicationSkipAppModel1.vbproj\"\r\n            ],\r\n            \"copyOnly\": [ \"My Project/**/*\" ]\r\n          },\r\n```\r\n\r\nThis happens because skipAppModel is evaluated as false, but the condition above is a negation, so Program.vb is always excluded (hostIsCli == false) in this case, so this will always be false when run from Visual Studio\r\n    \"skipAppModel\": {\r\n      \"type\": \"computed\",\r\n      \"value\": \"(hostIsCli && !UseAppFramework)\"\r\n    }\r\n\r\nFix here would be to update the skipAppModel condition to:\r\n`\"(UseWindowsDesktopSdk || (hostIsCli && !UseAppFramework))\"`\r\n\r\n\r\n### Steps to reproduce\r\n\r\nRepro steps:\r\n\r\n1. Create a VisualBasic Winforms project targeting NET Core 3.1 in Visual Studio\r\n2. Build\r\n3. Observe the Output Window\r\n\r\nBuild started...\r\n1>------ Build started: Project: WinFormsApp5, Configuration: Debug Any CPU ------\r\n1>vbc : error BC30420: 'Sub Main' was not found in 'WinFormsApp5'.\r\n1>Done building project \"WinFormsApp5.vbproj\" -- FAILED.\r\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========","Url":"https://github.com/dotnet/winforms/issues/7267","RelatedDescription":"Closed issue \"Missing Program.vb in Winforms App targeting 3.1 from Visual Studio\" (#7267)"},{"Id":"1264415758","IsPullRequest":false,"CreatedAt":"2022-06-08T08:53:54","Actor":"kant2002","Number":"7271","RawContent":null,"Title":"Icon misaligned in the Menustrip","State":"open","Body":"### .NET version\n\n.NET 7\n\n### Did it work in .NET Framework?\n\nYes\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nI think it is.\n\n### Issue description\n\n![image](https://user-images.githubusercontent.com/4257079/172573113-7b4b7a86-1054-4786-ba7f-ee2c270ac332.png)\r\n\n\n### Steps to reproduce\n\n1. Open WinFormsControlsTest\r\n2. Press Menus\r\n3. Press Project","Url":"https://github.com/dotnet/winforms/issues/7271","RelatedDescription":"Open issue \"Icon misaligned in the Menustrip\" (#7271)"},{"Id":"1264104726","IsPullRequest":true,"CreatedAt":"2022-06-08T02:29:54","Actor":"RussKie","Number":"7269","RawContent":null,"Title":"Ignore tooltip null-owners","State":"open","Body":"Resolves #7262\r\n\r\nIn some circumstances it's plausible to have a race condition, and the control, for which a tooltip is being created, may have disappeared by the time the tooltip is about to be shown. This may lead to the following:\r\n\r\n```\r\nSystem.NullReferenceException: Object reference not set to an instance of an object.\r\n   at System.Windows.Forms.Control.GetSafeHandle(IWin32Window window)\r\n   at Interop.ComCtl32.ToolInfoWrapper`1..ctor(T handle, TTF flags, String text)\r\n   at System.Windows.Forms.ToolTip.TryGetBubbleSize(IKeyboardToolTip tool, Rectangle toolRectangle, Size& bubbleSize)\r\n   at System.Windows.Forms.ToolTip.ShowKeyboardToolTip(String text, IKeyboardToolTip tool, Int32 duration)\r\n   at System.Windows.Forms.KeyboardToolTipStateMachine.ShowToolTip(IKeyboardToolTip tool, ToolTip toolTip)\r\n```\r\n\r\nIgnore such situations.\r\n\r\nI tried to recreate the issue on W11 with the following tweak to [the existing test app](https://github.com/dotnet/winforms/blob/4223d0a6ff606335e064c378a302a05fa382f0e2/src/System.Windows.Forms/tests/IntegrationTests/WinformsControlsTest/DataGridViewInVirtualModeTest.cs) and had the mouse hover cells in the first column, but similar to [the customer's report](https://github.com/dotnet/winforms/issues/7262#issue-1262896269) was unable to do so. \r\n\r\n```cs\r\n        private Timer _timer = new();\r\n        private Random random = new((int)DateTime.Now.Ticks);\r\n\r\n        public DataGridViewInVirtualModeTest()\r\n        {\r\n            InitializeComponent();\r\n            dataGridView1.VirtualMode = false;\r\n            DoubleBuffered = true;\r\n\r\n            _timer.Interval = 100;\r\n            _timer.Tick += (s, e) =>\r\n            {\r\n                _customers.Clear();\r\n\r\n                // Add some sample entries to the data store\r\n                for (int i = 0; i < random.Next(50, 100); i++)\r\n                {\r\n                    _customers.Add(new TestCustomer(\"Ann\" + new string('0', random.Next(0, 50)), 23, true, \"Female\"));\r\n                    _customers.Add(new TestCustomer(\"John\" + new string('0', random.Next(0, 50)), 45, true, \"Male\"));\r\n                    _customers.Add(new TestCustomer(\"Sarah\" + new string('0', random.Next(0, 50)), 67, false, \"Female\"));\r\n                }\r\n\r\n                dataGridView1.DataSource = null;\r\n                dataGridView1.DataSource = _customers;\r\n            };\r\n        }\r\n```\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/winforms/pull/7269)","Url":"https://github.com/dotnet/winforms/pull/7269","RelatedDescription":"Open PR \"Ignore tooltip null-owners\" (#7269)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-06-14T03:30:30.6127125Z","RunDurationInMilliseconds":564}