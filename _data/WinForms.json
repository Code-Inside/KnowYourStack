{"Data":{"GitHub":{"Issues":[{"Id":"3836249366","IsPullRequest":true,"CreatedAt":"2026-01-21T02:59:01","Actor":"dotnet-maestro[bot]","Number":"14228","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20260120.10](https://dev.azure.com/dnceng/internal/_build/results?buildId=2883425) ([298090](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/298090))\n- **Date Produced**: January 20, 2026 9:31:20 PM UTC\n- **Commit**: [a8b46ab052618a946f8b728e7ffa6566ef7c094b](https://github.com/dotnet/dotnet/commit/a8b46ab052618a946f8b728e7ffa6566ef7c094b)\n- **Commit Diff**: [adf42f5...a8b46ab](https://github.com/dotnet/dotnet/compare/adf42f5dcec99a409a6f63355f5b52147bfaf043...a8b46ab052618a946f8b728e7ffa6566ef7c094b)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.26069.103 to 11.0.0-beta.26070.110][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [11.0.0-preview.1.26069.103 to 11.0.0-preview.1.26070.110][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/adf42f5dce...a8b46ab052\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/a4691bde931c20dfe44f556357cb450c83df360c...b92cc5b406acf996b29a653dd4454b87f1d83c5f\n- https://github.com/dotnet/aspnetcore/compare/03d43ac61779148acb14ff0abd32a079a28ba42d...495aa864aefc6ac447b58524fe8fb638828340fc\n- https://github.com/dotnet/efcore/compare/af8a90c70e7609045aabadea6f61afc7892b3cd2...37f5733cb7c7963dad6d76164b7a84d0e189cc0b\n- https://github.com/dotnet/fsharp/compare/5d23fef87847b07b40b1b67c9d826076d7cbaf3d...966a2c065ed78e35dcc68a864839ae8a967b9d95\n- https://github.com/dotnet/msbuild/compare/bd54b25a32bc2480b693bf4416608c5096e85621...1038065e9a9d00843a4f5f1bd2803daf0f402bf5\n- https://github.com/dotnet/razor/compare/01520512ec8e249d3891b44b257a10f98b9c4665...2a02ece9f09e4840edbd63df9f07a95882e062e7\n- https://github.com/dotnet/roslyn/compare/a8d1f35c874c33cd877b4983c0a315b9437e77e3...bee340d2d6efa1d874c8a7b2ac9a8f9d3bd35c8a\n- https://github.com/dotnet/runtime/compare/6afecd4adc64210e5b46767d02a6495af1a08c46...5952bf28fa850316f401b4c329a90d8dfb343a90\n- https://github.com/dotnet/sdk/compare/73e74e8ae5b52b2312cf90778d210274a3f460c4...7b832810b773255dc516c33e66ad0cda40e067b0\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:a8b46ab052618a946f8b728e7ffa6566ef7c094b..https://github.com/dotnet/winforms:darc-main-08cfaa9b-0738-4386-8fd3-72cd6027807c\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14228)","Url":"https://github.com/dotnet/winforms/pull/14228","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14228)"},{"Id":"3836293430","IsPullRequest":false,"CreatedAt":"2026-01-21T02:32:41","Actor":"memoarfaa","Number":"14229","RawContent":null,"Title":"Expose accessible wrappers for system dialog UI (e.g. TaskDialog) — TaskDialogAccessibleObject / DialogAccessibleObject","State":"open","Body":"### Background and motivation\n\nMany modern system dialogs (TaskDialog and newer Open/Save dialogs) present fairly rich UI composed by the OS (main instruction, content text, command links, radio groups, checkboxes, expanders, embedded hyperlinks, etc.). When a WinForms app shows these dialogs, assistive technologies and automation tests sometimes do not receive a complete, stable, or semantically accurate UIA/MSAA representation of dialog content. This makes it harder for app authors and accessibility consumers to:\n\nProvide deterministic screen-reader experiences,\nAutomate dialog interactions reliably (UIA-based tests),\nDiagnose and correct accessibility regressions.\nThis proposal introduces a managed-side accessible wrapper (DialogAccessibleObject) and a TaskDialog-specific specialization (TaskDialogAccessibleObject) to expose dialog semantics and patterns in a consistent, testable way for WinForms-hosted dialogs. The implementation will use only public APIs (UI Automation / MSAA / documented Win32 entry points), be defensive about platform differences, and expose minimal public surface initially.\n\n### API Proposal\n\n```csharp\nnamespace System.Windows.Forms\n {\n+    // New: top-level dialog accessible helper\n+    public static class DialogAccessibleObject\n+    {\n+        // Create an AccessibleObject for an HWND-backed dialog (factory)\n+        public static AccessibleObject CreateForDialog(IntPtr dialogHwnd);\n+\n+        // Optional overload for creating from a UIA AutomationElement (managed wrapper)\n+        public static AccessibleObject CreateForDialog(object automationElement);\n+    }\n+\n+    // New: generic dialog accessible object\n+    public class DialogAccessibleObject : AccessibleObject\n+    {\n+        public DialogAccessibleObject(IntPtr dialogHwnd);\n+        public DialogAccessibleObject(object automationElement);\n+\n+        // Expose the HWND if available (nullable)\n+        public IntPtr DialogHwnd { get; }\n+\n+        // Override to provide dialog-specific fragment navigation, patterns, etc.\n+        public override string Name { get; }\n+        public override AccessibleRole Role { get; }\n+        // ... other overrides / helpers as required\n+    }\n+\n+    // New: TaskDialog specialization\n+    public sealed class TaskDialogAccessibleObject : DialogAccessibleObject\n+    {\n+        public TaskDialogAccessibleObject(TaskDialog owner);\n+        public TaskDialog Owner { get; }\n+    }\n }\n```\n\n\n### API Usage\n\nExample code showing intended consumption and testing.\n\n1- TaskDialog instance exposes an AccessibleObject:\n\n```csharp\nvar dlg = new TaskDialog()\n{\n    MainInstruction = \"Save changes?\",\n    Content = \"Do you want to save changes before closing?\",\n    Buttons = { TaskDialogButtons.OK, TaskDialogButtons.Cancel }\n};\n\n// Synchronous show\ndlg.Show();\n\nAccessibleObject acc = dlg.AccessibleObject;\nConsole.WriteLine(acc.Name); // \"Save changes?\"\n\n// Find OK button child and invoke via accessible API\nAccessibleObject okButton = acc.GetChild(0);\nokButton.DoDefaultAction();\n```\n\n\n2- Factory usage for HWND-based dialog (advanced / automation harness):\n```csharp\nIntPtr dialogHwnd = /* discovered via UIA or hook (see below) */;\nAccessibleObject acc = DialogAccessibleObject.CreateForDialog(dialogHwnd);\n\n// Query properties or patterns:\nvar name = acc.Name;\nvar role = acc.Role;\n```\n\n\n### Alternative Designs\n\n\n-  Do nothing: continue to rely on OS-provided providers only and accept variability across Windows versions (insufficient for consistent app-level behavior).\n- Pure UIA client adapter (no AccessibleObject): use UIA AutomationElement directly from tests/tools. Downside: WinForms would not expose a managed AccessibleObject to code that expects AccessibleObject / legacy MSAA helpers.\n- Expose only an internal hook/extension point so third-party or app-level code can plug providers. This is lighter but shifts responsibility to consumers and fragments the solution.\n- Full native integration with platform internals: rejected because it would rely on undocumented Windows internals and is brittle.\nPreferred approach: provide a WinForms-side AccessibleObject mapping that (a) consumes public UIA/MSAA info where available, (b) provides managed fallbacks when OS info is insufficient, and (c) exposes a small, testable, documented public API.\n\nHow to obtain the dialog HWND / AutomationElement (implementation note)\nModern \"Vista\" dialogs (IFileDialog) do not invoke the legacy HookProc flow; we must discover the dialog HWND or its AutomationElement before attaching a DialogAccessibleObject. Two supported approaches:\n\n1. UIA discovery (recommended)\n\n- Start a short-lived background poller (2–5s) before calling IFileDialog::Show that searches AutomationElement.RootElement for a top-level Window in the current process whose Name == Title (set in OnBeforeVistaDialog) and ControlType == Window. Use AutomationElement.Current.NativeWindowHandle to obtain HWND if needed. This uses public UIA and provides direct managed automation data.\n-  Example (conceptual):\n```csharp\n// Background poller started before dialog.Show(...)\nTask.Run(() =>\n{\n    var timeout = TimeSpan.FromSeconds(5);\n    var sw = Stopwatch.StartNew();\n    Condition cond = new AndCondition(\n        new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Window),\n        new PropertyCondition(AutomationElement.ProcessIdProperty, Process.GetCurrentProcess().Id),\n        new PropertyCondition(AutomationElement.NameProperty, expectedTitle));\n\n    while (sw.Elapsed < timeout)\n    {\n        var root = AutomationElement.RootElement;\n        var wins = root.FindAll(TreeScope.Children, cond);\n        for (int i = 0; i < wins.Count; i++)\n        {\n            var ae = wins[i];\n            int hwnd = ae.Current.NativeWindowHandle;\n            if (hwnd != 0)\n            {\n                // capture and attach wrapper\n                _dialogHwnd = (IntPtr)hwnd;\n                _dialogAutomationElement = ae;\n                return;\n            }\n        }\n        Thread.Sleep(50);\n    }\n});\n```\n2. Thread-local CBT hook (alternative)\nInstall a thread-local CBT hook (WH_CBT / HCBT_CREATEWND) on the creating thread immediately before Show. On HCBT_CREATEWND inspect title/class to capture the dialog HWND and unhook. Deterministic but requires careful P/Invoke hook management and unhooking.\nIntegration guidance: start discovery after OnBeforeVistaDialog and before dialog.Show, store discovered HWND/AutomationElement into FileDialog fields (e.g., _dialogHwnd, _dialogAutomationElement) and attach DialogAccessibleObject in finally cleanup. Prefer UIA discovery as primary; provide CBT hook approach as alternate fallback when deterministic capture is required.\n-  Integration sketch:\n```csharp\n// Keep delegate alive to avoid GC\nprivate static CBTProc s_cbtDelegate;\nprivate static IntPtr s_hookHandle;\nprivate static IntPtr s_dialogHwnd;\n\nprivate static IntPtr CbtProc(int nCode, IntPtr wParam, IntPtr lParam)\n{\n    if (nCode == HCBT_CREATEWND)\n    {\n        IntPtr hwnd = wParam;\n        string title = GetWindowText(hwnd);\n        if (!string.IsNullOrEmpty(title) && title == expectedTitle)\n        {\n            s_dialogHwnd = hwnd;\n            UnhookWindowsHookEx(s_hookHandle);\n            s_hookHandle = IntPtr.Zero;\n        }\n    }\n    return CallNextHookEx(s_hookHandle, nCode, wParam, lParam);\n}\n\n// Before Show:\ns_cbtDelegate = CbtProc;\ns_hookHandle = SetWindowsHookEx(WH_CBT, s_cbtDelegate, IntPtr.Zero, GetCurrentThreadId());\n// After Show (finally): Unhook and use s_dialogHwnd\n```\n### Risks\n\n- Platform variability: dialog composition and automation provider behavior may vary across Windows versions, SKUs, or future OS updates. Mitigation: fallbacks, defensive coding, and keep public surface minimal initially.\n\n- Performance: polling or hooking must be short-lived and non-blocking; UIA queries should be on a background thread.\n-  Complexity / maintainability: exposing additional providers adds responsibilities for lifecycle management (UiaDisconnectProvider, COM release). Tests and clear disposal rules mitigate this.\n\n- Designer impact: exposing new accessible types could affect tools that reflect on types; minimize breaking surface and keep default behavior unchanged.\n\n### Will this feature affect UI controls?\n\nYes — this feature specifically affects dialog accessibility and how controls within system dialogs are exposed to automation.\n\n- Will VS Designer need to support the feature?\n\nNot in the MVP. The change is about runtime accessibility surface for dialogs; Designer updates are not required initially.\n\n- What impact will it have on accessibility?\nPositive: provides deterministic and richer UIA/MSAA surface for dialog elements (better screen-reader output, better automation behavior). Must ensure sensitive content is not overexposed.\n\n- Will this feature need to be localized or be localizable?\nNo new localization strings required for the accessibility wrappers themselves. Accessible text content is from dialog content (already localized by app or OS).\n\nattatched TaskDialog Inspect Object output \n\n[DirectUI_ac.txt](https://github.com/user-attachments/files/24755329/DirectUI_ac.txt)","Url":"https://github.com/dotnet/winforms/issues/14229","RelatedDescription":"Open issue \"Expose accessible wrappers for system dialog UI (e.g. TaskDialog) — TaskDialogAccessibleObject / DialogAccessibleObject\" (#14229)"},{"Id":"3836228933","IsPullRequest":true,"CreatedAt":"2026-01-21T02:06:19","Actor":"dotnet-maestro[bot]","Number":"14227","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"open","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20260120.4](https://dev.azure.com/dnceng/internal/_build/results?buildId=2883117) ([297972](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/297972))\n- **Date Produced**: January 20, 2026 4:19:22 PM UTC\n- **Commit**: [455f1358f39b4d38fa3893c327a45027c4a81843](https://github.com/dotnet/dotnet/commit/455f1358f39b4d38fa3893c327a45027c4a81843)\n- **Commit Diff**: [99f9e99...455f135](https://github.com/dotnet/dotnet/compare/99f9e99f92d73ade5453ba8edba5d72247f3cd11...455f1358f39b4d38fa3893c327a45027c4a81843)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.26065.102 to 10.0.0-beta.26070.104][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.3 to 10.0.3][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.3-servicing.26065.102 to 10.0.3-servicing.26070.104][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/99f9e99f92...455f1358f3\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/ae5295f3a09cb00c82728009e92d90fec86314bc...d4361d83777feb859fcf453b00f966325ea40e9a\n- https://github.com/dotnet/efcore/compare/5e28bfb2dad21a5ca875905aabfeb5b2c5997058...5f83f179ea87d2386e76f24deef4e86a8cbc4c17\n- https://github.com/dotnet/msbuild/compare/8f3a06b74d2d3df313f5bea71ee6390ea3bd462b...b21f3b4fccedcf2f2905b77354765987cf02271d\n- https://github.com/dotnet/sdk/compare/400e46e95aff59f4c43252a86ccc4d85fbeb8515...043eaf5e6e0e4aafc28a5146a3f198fe5f835650\n- https://github.com/dotnet/source-build-reference-packages/compare/1f538e55a45f4672186a68a08639160d5a4d3ce6...ad86fd75a9bf8400b4156c70d984c4d997995472\n- https://github.com/dotnet/templating/compare/8f6252e1567ac5c8faff1ad99310ac66d966687f...d354fe28af14a78be9e9520618d4d210b1e933f3\n- https://github.com/dotnet/windowsdesktop/compare/46806c8c98c339affa04316bac6d5b391091cf94...7a871005d2720e65fab60587dc847b29fea3af07\n- https://github.com/dotnet/winforms/compare/f01695045e31ea77261a1dbde48ca243c432624f...88624f3eab9b58347c738a11715a8b585cad34c5\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:455f1358f39b4d38fa3893c327a45027c4a81843..https://github.com/dotnet/winforms:darc-release/10.0-d0e78459-05c5-4dba-98b3-fb82b5b08339\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14227)","Url":"https://github.com/dotnet/winforms/pull/14227","RelatedDescription":"Open PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14227)"},{"Id":"3836217195","IsPullRequest":true,"CreatedAt":"2026-01-21T02:01:24","Actor":"dotnet-maestro[bot]","Number":"14226","RawContent":null,"Title":"[release/9.0] Update dependencies from dotnet/arcade","State":"open","Body":"This pull request updates the following dependencies\n\n[marker]: <> (Begin:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n## From https://github.com/dotnet/arcade\n- **Subscription**: [92989bf7-cdf9-483d-64c5-08dcbc356d11](https://maestro.dot.net/subscriptions?search=92989bf7-cdf9-483d-64c5-08dcbc356d11)\n- **Build**: [20260120.1](https://dev.azure.com/dnceng/internal/_build/results?buildId=2883081) ([297934](https://maestro.dot.net/channel/5175/github:dotnet:arcade/build/297934))\n- **Date Produced**: January 20, 2026 9:16:49 AM UTC\n- **Commit**: [9b9436a55a49bd58acb8ae95a57ad2185da26805](https://github.com/dotnet/arcade/commit/9b9436a55a49bd58acb8ae95a57ad2185da26805)\n- **Branch**: [release/9.0](https://github.com/dotnet/arcade/tree/release/9.0)\n\n[DependencyUpdate]: <> (Begin)\n\n- **Dependency Updates**:\n  - From [9.0.0-beta.26063.2 to 9.0.0-beta.26070.1][1]\n     - Microsoft.DotNet.Arcade.Sdk\n     - Microsoft.DotNet.CMake.Sdk\n     - Microsoft.DotNet.GenFacades\n     - Microsoft.DotNet.Helix.Sdk\n     - Microsoft.DotNet.RemoteExecutor\n     - Microsoft.DotNet.XUnitExtensions\n\n[1]: https://github.com/dotnet/arcade/compare/c85f9acedd...9b9436a55a\n\n[DependencyUpdate]: <> (End)\n\n- **Updates to .NET SDKs:**\n  - Updates **sdk.version** to 9.0.113\n  - Updates **tools.dotnet** to 9.0.113\n\n[marker]: <> (End:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14226)","Url":"https://github.com/dotnet/winforms/pull/14226","RelatedDescription":"Open PR \"[release/9.0] Update dependencies from dotnet/arcade\" (#14226)"},{"Id":"3828334941","IsPullRequest":true,"CreatedAt":"2026-01-21T00:45:51","Actor":"LeafShi1","Number":"14220","RawContent":null,"Title":".NET 11.0 template precedence and identity properties update","State":"closed","Body":"\r\nTemplate changes for 11.0 template precedence and identity properties. \n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14220)","Url":"https://github.com/dotnet/winforms/pull/14220","RelatedDescription":"Closed or merged PR \".NET 11.0 template precedence and identity properties update\" (#14220)"},{"Id":"3835828669","IsPullRequest":false,"CreatedAt":"2026-01-20T23:04:24","Actor":"Shyam-Gupta","Number":"14225","RawContent":null,"Title":"Remove .NET 6.0 from WinForms template","State":"open","Body":".NET 6.0 is out of support and should be removed from the templates.","Url":"https://github.com/dotnet/winforms/issues/14225","RelatedDescription":"Open issue \"Remove .NET 6.0 from WinForms template\" (#14225)"},{"Id":"3833051674","IsPullRequest":true,"CreatedAt":"2026-01-20T10:21:02","Actor":"LeafShi1","Number":"14224","RawContent":null,"Title":"Issue 14204 fix data grid view excessive cpu+memory usage","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #14204\r\n\r\n\r\n## Root Cause\r\nThe foreach loop over DataGridViewRowCollection uses an enumerator that calls this[index], which unshares (clones) each shared row. For 700k rows, this causes massive memory allocation and CPU usage.\r\n## Proposed changes\r\n\r\n- DataGridView.Methods.cs: \r\n    - Added ReleaseRowUiaProviders() helper method\r\n    - Modified ReleaseUiaProvider() to use HashSet deduplication instead of foreach\r\n- DataGridViewColumnCollection.cs: \r\n    - Modified RemoveAtInternal() to use HashSet deduplication\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n-  Applications with large DataGridView (700k+ rows) freeze for several seconds when closing forms or removing columns\r\n\r\n## Regression? \r\n\r\n- Yes (The regression was introduced in this [commit](https://github.com/dotnet/winforms/commit/6d58d9cc18a75abcf51bb13e81fdfd7923ac8584))\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\nClosing a form with 700k rows causes 5-10+ seconds of UI freeze and high memory spike due to row cloning.\r\n\r\n\r\n### After\r\nForm closes near-instantly with minimal memory overhead.\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manual test\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 11.0.0-alpha.1.26057.107\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14224)","Url":"https://github.com/dotnet/winforms/pull/14224","RelatedDescription":"Open PR \"Issue 14204 fix data grid view excessive cpu+memory usage\" (#14224)"},{"Id":"3831742156","IsPullRequest":true,"CreatedAt":"2026-01-20T02:46:20","Actor":"dotnet-maestro[bot]","Number":"14222","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20260119.3](https://dev.azure.com/dnceng/internal/_build/results?buildId=2882688) ([297900](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/297900))\n- **Date Produced**: January 19, 2026 7:04:17 PM UTC\n- **Commit**: [adf42f5dcec99a409a6f63355f5b52147bfaf043](https://github.com/dotnet/dotnet/commit/adf42f5dcec99a409a6f63355f5b52147bfaf043)\n- **Commit Diff**: [887f3d5...adf42f5](https://github.com/dotnet/dotnet/compare/887f3d5a26e1001ee2777afde10cadcacb8cc735...adf42f5dcec99a409a6f63355f5b52147bfaf043)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.26064.107 to 11.0.0-beta.26069.103][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [11.0.0-alpha.1.26064.107 to 11.0.0-preview.1.26069.103][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n[1]: https://github.com/dotnet/dotnet/compare/887f3d5a26...adf42f5dce\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/30d4d50bbf806a8c45de78ac0fcff1b4c3f78842...03d43ac61779148acb14ff0abd32a079a28ba42d\n- https://github.com/dotnet/efcore/compare/d52eb382d8eda987bc0525233aba616722d2a403...af8a90c70e7609045aabadea6f61afc7892b3cd2\n- https://github.com/dotnet/fsharp/compare/841308307dc2233bc0fa6a364d35a1d4c169f1c5...5d23fef87847b07b40b1b67c9d826076d7cbaf3d\n- https://github.com/nuget/nuget.client/compare/cc8f616db8da1c2feb052c2d7eb5cd73071da290...a99b70cf718ff7842466a7eaeefa99b471cad517\n- https://github.com/dotnet/razor/compare/53776e439d570e344caf5c9482e79abd8cc4cba0...01520512ec8e249d3891b44b257a10f98b9c4665\n- https://github.com/dotnet/roslyn/compare/52e811495adfce82f01a951e8ca92d21c7f015c2...a8d1f35c874c33cd877b4983c0a315b9437e77e3\n- https://github.com/dotnet/runtime/compare/891c183b22d023eea7bc4aa57dbc219d54852036...6afecd4adc64210e5b46767d02a6495af1a08c46\n- https://github.com/dotnet/sdk/compare/ec5f7d915a8597baba3dbf1ef3ece19accb4541b...73e74e8ae5b52b2312cf90778d210274a3f460c4\n- https://github.com/dotnet/sourcelink/compare/857398025138f1337c72f92cfb75896083dcfd22...a4a7b91a68be67b9dfb525ca76f7daa2b5631173\n- https://github.com/dotnet/templating/compare/413680c51cc58fd29655bacf2a080bd0efe0db21...c5d51362f843d69946043cede0b2a3f6f6eda9ba\n- https://github.com/dotnet/winforms/compare/01eefd447bf1de58c82bcd765bf85d1d7fb4e7ac...448e82a4481afb416d908d4011f58e67fe9c3cac\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:adf42f5dcec99a409a6f63355f5b52147bfaf043..https://github.com/dotnet/winforms:darc-main-e84c2957-17dc-4d59-afe5-b1bea31886aa\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14222)","Url":"https://github.com/dotnet/winforms/pull/14222","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14222)"},{"Id":"3831761669","IsPullRequest":false,"CreatedAt":"2026-01-20T02:26:25","Actor":"Zheng-Li01","Number":"14223","RawContent":null,"Title":"[Dark Mode] There not enough space between the borderline and text for Button control when setting the TextAlign as MiddleLeft/MiddleRight","State":"open","Body":"### .NET version\n\n.NET SDK 11.0.0-preview.1.26069.103\n\n### Did it work in .NET Framework?\n\nNot tested/verified\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nThe issue can reproduce .NET SDK 10.0, not reproduce on .NET 9.0\n\n### Issue description\n\nThere not enough space between the borderline and text for Button control when setting the TextAlign as MiddleLeft/MiddleRight in DarkMode\n\n<img width=\"923\" height=\"626\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f6a9bf0e-7ea8-414c-a47a-6aab168cf1fd\" />\n\n**.NET SDK 11.0 Results:**\n\nhttps://github.com/user-attachments/assets/6d19f8ba-cade-43f6-93b7-f392df028924\n\n**.NET SDK 9.0 Results:**\n\nhttps://github.com/user-attachments/assets/cccdc2c8-1ec8-4ebf-9560-531649e1722d\n\n**Classic Mode Results:**\n\nhttps://github.com/user-attachments/assets/77943e0d-f762-44df-9e48-949595f98ddb\n\n### Steps to reproduce\n\n1. Create a .NET winforms project with Button  & PropertyGrid controls\n2. Select the buttton1 as object for the propertyGrid1\n3. Set app under Dark mode in program.cs file\n` Application.SetColorMode(SystemColorMode.Dark);`\n4. Run the application\n5. Set the TextAlign property as MiddleLeft/MiddleRight","Url":"https://github.com/dotnet/winforms/issues/14223","RelatedDescription":"Open issue \"[Dark Mode] There not enough space between the borderline and text for Button control when setting the TextAlign as MiddleLeft/MiddleRight\" (#14223)"},{"Id":"3828348118","IsPullRequest":true,"CreatedAt":"2026-01-19T07:16:17","Actor":"dotnet-bot","Number":"14221","RawContent":null,"Title":"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2883850","State":"open","Body":"This is the pull request automatically created by the OneLocBuild task in the build process to check-in localized files generated based upon translation source files (.lcl files) handed-back from the downstream localization pipeline. If there are issues in translations, visit https://aka.ms/icxLocBug and log bugs for fixes. The OneLocBuild wiki is https://aka.ms/onelocbuild and the localization process in general is documented at https://aka.ms/AllAboutLoc.\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14221)","Url":"https://github.com/dotnet/winforms/pull/14221","RelatedDescription":"Open PR \"Localized file check-in by OneLocBuild Task: Build definition ID 164: Build ID 2883850\" (#14221)"},{"Id":"3828283516","IsPullRequest":true,"CreatedAt":"2026-01-19T06:57:11","Actor":"SimonZhao888","Number":"14219","RawContent":null,"Title":"Fix issue 14210: [Dark Mode] The ListView cannot display the items when setting the Enable as false","State":"open","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #14210 \r\n\r\n## Root Cause\r\nListView is the underlaying Win32 control. When it's in dark mode, the font color is highlighted, but the background color isn't set to dark, causing the items in the ListView to not display correctly. Furthermore, we cannot modify the background color using following code `PInvokeCore.SendMessage(this, PInvoke.LVM_SETBKCOLOR, (WPARAM)0, (LPARAM)BackColor)`.\r\n\r\n## Proposed changes\r\n\r\n- In Dark Mode, when the ListView control is disabled (Enabled = false), the text and background colors are set so that the items can be displayed correctly.\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- The ListView can display the items correctly when it is in DarkMode and setting the Enable as false.\r\n\r\n## Regression? \r\n\r\n- Yes\r\n\r\n## Risk\r\n\r\n- Min\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n## Screenshots <!-- Remove this section if PR does not change UI -->\r\n\r\n### Before\r\n\r\n<img width=\"647\" height=\"643\" alt=\"image\" src=\"https://github.com/user-attachments/assets/7686bb73-dc05-4972-94ac-eaf5c00eae0c\" />\r\n\r\n\r\n### After\r\n\r\n<img width=\"649\" height=\"649\" alt=\"image\" src=\"https://github.com/user-attachments/assets/e15c7c89-885d-4967-a79e-7e1c24f8ca6e\" />\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- Manually\r\n\r\n## Accessibility testing  <!-- Remove this section if PR does not change UI -->\r\n\r\n<!--\r\n     Microsoft prioritizes making our products accessible. \r\n     WinForms has a key role in allowing developers to create accessible apps. \r\n     \r\n     When submitting a change which impacts UI in any way, including adding new UI or\r\n     modifying existing controls the developer needs to run the Accessibility Insights\r\n     tool (https://accessibilityinsights.io/) and verify that there are no changes or\r\n     regressions. \r\n     \r\n     The developer should run the Fast Pass over the impacted control(s) and provide\r\n     a snapshot of the passing results along with before/after snapshots of the UI.\r\n     More info: (https://accessibilityinsights.io/docs/en/web/getstarted/fastpass)\r\n  -->\r\n\r\n\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- .net 11.0.100-alpha.1.25618.104\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\r\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14219)","Url":"https://github.com/dotnet/winforms/pull/14219","RelatedDescription":"Open PR \"Fix issue 14210: [Dark Mode] The ListView cannot display the items when setting the Enable as false\" (#14219)"},{"Id":"3800619921","IsPullRequest":true,"CreatedAt":"2026-01-19T06:42:15","Actor":"dotnet-maestro[bot]","Number":"14199","RawContent":null,"Title":"[main] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n\n\n[marker]: <> (Begin:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [81d064a4-929c-4152-b746-ee3acc24b4ed](https://maestro.dot.net/subscriptions?search=81d064a4-929c-4152-b746-ee3acc24b4ed)\n- **Build**: [20260114.7](https://dev.azure.com/dnceng/internal/_build/results?buildId=2878985) ([297286](https://maestro.dot.net/channel/8298/github:dotnet:dotnet/build/297286))\n- **Date Produced**: January 14, 2026 3:24:15 PM UTC\n- **Commit**: [887f3d5a26e1001ee2777afde10cadcacb8cc735](https://github.com/dotnet/dotnet/commit/887f3d5a26e1001ee2777afde10cadcacb8cc735)\n- **Commit Diff**: [896160e...887f3d5](https://github.com/dotnet/dotnet/compare/896160ec9eb0fdb1c019f698b39fa0923c9a316c...887f3d5a26e1001ee2777afde10cadcacb8cc735)\n- **Branch**: [main](https://github.com/dotnet/dotnet/tree/main)\n\n**Updated Dependencies**\n- From [11.0.0-beta.26057.107 to 11.0.0-beta.26064.107][3]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [11.0.0-alpha.1.26057.107 to 11.0.0-alpha.1.26064.107][3]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.NETCore.Platforms\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n\n[marker]: <> (End:81d064a4-929c-4152-b746-ee3acc24b4ed)\n\n\n\n[1]: https://github.com/dotnet/dotnet/compare/896160ec9e...db3b742425\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14199)\n[2]: https://github.com/dotnet/dotnet/compare/896160ec9e...7b9ad20ba1\n\n[3]: https://github.com/dotnet/dotnet/compare/896160ec9e...887f3d5a26\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/47182042233562b893d2290af4275e924d3ff6bb...30d4d50bbf806a8c45de78ac0fcff1b4c3f78842\n- https://github.com/dotnet/deployment-tools/compare/6ebef72019b85958ae78d0da73ea49a161c7a28a...c3dd1602b13a207262859890e45a73dfc827e886\n- https://github.com/dotnet/efcore/compare/5a68c09c2c67b7f410f0972b193b42d5502367a7...d52eb382d8eda987bc0525233aba616722d2a403\n- https://github.com/dotnet/fsharp/compare/95d597122c8ace890da82c59f2433433325a1b13...841308307dc2233bc0fa6a364d35a1d4c169f1c5\n- https://github.com/dotnet/msbuild/compare/fb775842a00d534aaf25466ff76e0d8fe86d2e7d...bd54b25a32bc2480b693bf4416608c5096e85621\n- https://github.com/dotnet/razor/compare/2d8783f051d7f5d31fc1b2014de263ded199eb3f...53776e439d570e344caf5c9482e79abd8cc4cba0\n- https://github.com/dotnet/roslyn/compare/bf35fe58e593ac0ac74c05bfa6e4719b85772da0...52e811495adfce82f01a951e8ca92d21c7f015c2\n- https://github.com/dotnet/runtime/compare/bce6119e41ecfbcf630c369836770669604c22c6...891c183b22d023eea7bc4aa57dbc219d54852036\n- https://github.com/dotnet/source-build-reference-packages/compare/cdd1ce5b784d2d01917a7eda352f20bf0a3ca690...70e51c1c54cdc4d101d251b20a38185d9f87e58f\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:887f3d5a26e1001ee2777afde10cadcacb8cc735..https://github.com/dotnet/winforms:darc-main-ac5aee8b-3e77-4965-9f30-a355abdebb1d\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)","Url":"https://github.com/dotnet/winforms/pull/14199","RelatedDescription":"Closed or merged PR \"[main] Source code updates from dotnet/dotnet\" (#14199)"},{"Id":"3825998383","IsPullRequest":false,"CreatedAt":"2026-01-17T23:11:43","Actor":"carltonshen-work","Number":"14218","RawContent":null,"Title":"Suspect memory leak related to RichTextBox on .Net 10.0.102","State":"open","Body":"### .NET version\n\n10.0.102\n\n### Did it work in .NET Framework?\n\nNot tested/verified\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nSame code has no issue with .Net 8.0.\n\n### Issue description\n\nI have a simple WinForm application which redirects console input/output and uses a RichTextBox for colored output.\n\nWhen the program is compiled with .Net 10, it will accumulate about 10MB of memory usage every hour. Below is the GC Dump I've captured:\n\n[net10.202601161100.zip](https://github.com/user-attachments/files/24692547/net10.202601161100.zip)\n\nAnd below is the PerfView top items for the Heap Stack view:\n\n| Name                                                                 | Exc % |        Exc | Exc Ct | Inc % |        Inc | Inc Ct |       Fold | Fold Ct |\n|----------------------------------------------------------------------|------:|-----------:|-------:|------:|-----------:|-------:|-----------:|--------:|\n| LIB <<System.Private.CoreLib!List<Runtime.InteropServices.ComWrappers+ManagedObjectWrapperHolder>>>                                   | 97.7  | 33,555,208 |     14 | 97.7  | 33,555,208 |     14 | 33,554,984 |       7 |\n| LIB <<System.Private.CoreLib!Diagnostics.Tracing.NativeRuntimeEventSource>> | 0.6   |    199,730 |  2,457 | 0.6   |    199,730 |  2,457 |    198,886 |   2,443 |\n| LIB <<System.Diagnostics.Process!Diagnostics.Process>>                | 0.3   |    113,488 |     74 | 0.3   |    113,488 |     74 |    109,136 |      14 |\n| LIB <<System.Diagnostics.DiagnosticSource!Diagnostics.Metrics.MetricsEventSource>> | 0.2   |     61,242 |    537 | 0.2   |     61,242 |    537 |     58,846 |     499 |\n| [local vars]                                                         | 0.2   |     60,104 |    139 | 0.3   |     91,345 |    637 |     60,104 |     138 |\n| (more lines ignored) |\n\nHowever, if it is compiled with .Net 8.0, its memory usage is stable over time.\n\n### Steps to reproduce\n\nBelow is the procedure that is being repetitively called to add text to the RTB:\n\n```C#\n    private void AppendLineToConsoleWithColor(string text, Color color)\n    {\n        if (consoleOutput.InvokeRequired)\n        {\n            consoleOutput.Invoke(AppendLineToConsoleWithColor, text, color);\n            return;\n        }\n\n        consoleOutput.SelectionStart = consoleOutput.TextLength;\n        consoleOutput.SelectionLength = 0;\n        consoleOutput.SelectionColor = color;\n\n        consoleOutput.AppendText(text);\n        consoleOutput.AppendText(Environment.NewLine);\n        currentConsoleCharCount += text.Length;\n        currentConsoleCharCount += Environment.NewLine.Length;\n\n        consoleOutput.SelectionColor = consoleOutput.ForeColor;\n\n        if (currentConsoleCharCount > loadedConfig.Settings.MaxConsoleChars)\n        {\n            int removeUpTo = consoleOutput.Text.IndexOf('\\n', loadedConfig.Settings.TrimChunkSize);\n            if (removeUpTo > 0)\n            {\n                Win32WindowAPI.SuspendRedraw(consoleOutput.Handle);\n                try\n                {\n                    consoleOutput.Select(0, removeUpTo + 1);\n                    consoleOutput.ReadOnly = false;\n                    consoleOutput.SelectedText = string.Empty;\n                    consoleOutput.ReadOnly = true;\n                    consoleOutput.ClearUndo();\n                }\n                finally\n                {\n                    Win32WindowAPI.ResumeRedraw(consoleOutput.Handle);\n                }\n                currentConsoleCharCount = consoleOutput.TextLength;\n            }\n        }\n    }\n```\n\nI believe anything that add text to RTB would trigger the same issue. I can already confirm the Win32 API call on the `SuspendRedraw` and `ResumeRedraw` is irrelevant, that remove them does not make any difference.\n\nI have a test app that generates text continuously so the above code is called frequently, which I believe anything to the same effect will work.","Url":"https://github.com/dotnet/winforms/issues/14218","RelatedDescription":"Open issue \"Suspect memory leak related to RichTextBox on .Net 10.0.102\" (#14218)"},{"Id":"3824934837","IsPullRequest":false,"CreatedAt":"2026-01-17T11:24:23","Actor":"WolfgangHG","Number":"14217","RawContent":null,"Title":"Performance regression in VS2026 in AvoidPassingTaskWithoutCancellationTokenAnalyzer","State":"open","Body":"VS2026 builds of our project became drastically slower than VS2022 builds.\n\nWe use .NET 9 target framework, and we have this “global.json” in the solution root:\n\n```\n{\n  \"sdk\": {\n    \"version\": \"9.0.0\",\n    \"rollForward\": \"latestFeature\"\n  }\n}\n```\n\nSome binlogs are privately attached to https://developercommunity.visualstudio.com/t/VS2026-Rebuild-is-much-slower-than-in-/11027380 where I first reported the problem. There you will also find some time measuring.\n\nBuilding without analyzers (`/p:RunAnalyzersDuringBuild=false`) reduced the build time to values similar to VS2022 (still slightly slower).\n\nDuring analysis of this issue, I found the [reportanalyzer switch](https://github.com/dotnet/roslyn/blob/main/docs/analyzers/Report%20Analyzer%20Format.md), and this one brought me to the root cause of the delay I think:\n\nHere are some log snippets (the first line translates to “Total analyzer execution time”):\n\nVS2022:\n```\nGesamtausführungszeit des Analysetools: 10,801 Sekunden.\n  Zeit (s)    %   Analysetool\n  6,212   57   System.Windows.Forms.Analyzers.CSharp, Version=9.0.12.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\n  6,194   57      System.Windows.Forms.CSharp.Analyzers.AvoidPassingTaskWithoutCancellationToken.AvoidPassingTaskWithoutCancellationTokenAnalyzer (WFO2001)\n  0,018   <1      System.Windows.Forms.CSharp.Analyzers.MissingPropertySerializationConfiguration.MissingPropertySerializationConfigurationAnalyzer (WFO1000)\n  2,546   23   Microsoft.CodeAnalysis.CSharp.NetAnalyzers, Version=9.0.12.32904, Culture=neutral, PublicKeyToken=31bf3856ad364e35\n```\n\nVS2026:\n```\nGesamtausführungszeit des Analysetools: 64,305 Sekunden.\n  Zeit (s)    %   Analysetool\n  59,593   92   System.Windows.Forms.Analyzers.CSharp, Version=9.0.12.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\n  59,572   92      System.Windows.Forms.CSharp.Analyzers.AvoidPassingTaskWithoutCancellationToken.AvoidPassingTaskWithoutCancellationTokenAnalyzer (WFO2001)\n  0,021   <1      System.Windows.Forms.CSharp.Analyzers.MissingPropertySerializationConfiguration.MissingPropertySerializationConfigurationAnalyzer (WFO1000)\n  2,385    3   Microsoft.CodeAnalysis.CSharp.NetAnalyzers, Version=9.0.12.32904, Culture=neutral, PublicKeyToken=31bf3856ad364e35\n\n```\n\nSo it seems \"System.Windows.Forms.CSharp.Analyzers.AvoidPassingTaskWithoutCancellationToken.AvoidPassingTaskWithoutCancellationTokenAnalyzer\" causes the delay.\n\nThe file \"C:\\Program Files\\Microsoft Visual Studio\\18\\Enterprise\\MSBuild\\Current\\Bin\\Roslyn\\csc.exe\" of VS2026 has file version 5.0.26.5402, the same file in VS2022 has 4.1400.25.41205\n\nAdding a \".editorconfig\" file with this line optimizes compile time:\n```\ndotnet_diagnostic.WFO2001.severity = none\n```\n","Url":"https://github.com/dotnet/winforms/issues/14217","RelatedDescription":"Open issue \"Performance regression in VS2026 in AvoidPassingTaskWithoutCancellationTokenAnalyzer\" (#14217)"},{"Id":"3821258243","IsPullRequest":true,"CreatedAt":"2026-01-17T09:07:34","Actor":"harborsiem","Number":"14215","RawContent":null,"Title":"ComSafeArrayScope wrong implicit operator for SAFEARRAY**","State":"closed","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #\r\n\r\n\r\n## Proposed changes\r\n\r\n- Implementation of operator for SAFEARRAY** of ComSafeArrayScope like SafeArrayScope\r\n- \r\n- \r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- Don't know if this operator is used\r\n- \r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Low\r\n\r\n<!-- end TELL-MODE -->\r\n\r\n\r\n### Before\r\n\r\nSAFEARRAY** operator has wrong value\r\n\r\n### After\r\n\r\nSAFEARRAY** operator has correct value\r\n\r\n\r\n## Test methodology <!-- How did you ensure quality? -->\r\n\r\n- \r\n- \r\n- \r\n\r\n \r\n\r\n## Test environment(s) <!-- Remove any that don't apply -->\r\n\r\n- <!-- use `dotnet --info` -->\r\n\r\n\r\n<!-- Mention language, UI scaling, or anything else that might be relevant -->\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14215)","Url":"https://github.com/dotnet/winforms/pull/14215","RelatedDescription":"Closed or merged PR \"ComSafeArrayScope wrong implicit operator for SAFEARRAY**\" (#14215)"},{"Id":"3823693032","IsPullRequest":true,"CreatedAt":"2026-01-16T21:19:12","Actor":"ricardobossan","Number":"14216","RawContent":null,"Title":" Fix disabled RichTextBox multiline text rendering in Dark Mode","State":"open","Body":"Fixes #14203\r\n\r\n## Root Cause\r\n\r\n- When a RichTextBox is disabled in Dark Mode, the custom painting code used `ClientRectangle` instead of the proper text formatting rectangle, causing text to render incorrectly at the control's edge rather than within the text area bounds.\r\n- The `EndEllipsis` flag was incompatible with multiline text, causing premature truncation.\r\n\r\n## Proposed changes\r\n\r\n- Use `EM_GETRECT` to get the proper text formatting rectangle that accounts for borders and padding.\r\n- Replace `EndEllipsis` with `TextBoxControl` flag for proper multiline text rendering.\r\n\r\n## Customer Impact\r\n\r\n- Disabled RichTextBox controls now display multiline text correctly in Dark Mode.\r\n\r\n## Regression?\r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Minimal\r\n\r\n## Screenshots\r\n\r\n### Before\r\n\r\n<img width=\"778\" height=\"248\" alt=\"14203-BEFORE\" src=\"https://github.com/user-attachments/assets/fdecdaba-db29-4f1f-bdb3-878309a5cbd5\" />\r\n\r\n### After\r\n\r\n<img width=\"775\" height=\"236\" alt=\"14203-AFTER\" src=\"https://github.com/user-attachments/assets/a66b24f9-a56b-4eba-bddf-dd170bf33163\" />\r\n\r\n## Test methodology\r\n\r\n- Manual\r\n\r\n## Test environment(s)\r\n\r\n- 11.0.100-alpha.1.25618.104\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14216)","Url":"https://github.com/dotnet/winforms/pull/14216","RelatedDescription":"Open PR \" Fix disabled RichTextBox multiline text rendering in Dark Mode\" (#14216)"},{"Id":"3819947040","IsPullRequest":true,"CreatedAt":"2026-01-16T19:32:39","Actor":"dotnet-maestro[bot]","Number":"14214","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20260115.2](https://dev.azure.com/dnceng/internal/_build/results?buildId=2879843) ([297507](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/297507))\n- **Date Produced**: January 15, 2026 3:35:20 PM UTC\n- **Commit**: [99f9e99f92d73ade5453ba8edba5d72247f3cd11](https://github.com/dotnet/dotnet/commit/99f9e99f92d73ade5453ba8edba5d72247f3cd11)\n- **Commit Diff**: [fe158d9...99f9e99](https://github.com/dotnet/dotnet/compare/fe158d9692179d1316d11bf67b264c4509176f7e...99f9e99f92d73ade5453ba8edba5d72247f3cd11)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.26064.114 to 10.0.0-beta.26065.102][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.3 to 10.0.3][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.3-servicing.26064.114 to 10.0.3-servicing.26065.102][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/fe158d9692...99f9e99f92\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/a190abe083fed3953b2174e2dfc7041b986b0b44...ae5295f3a09cb00c82728009e92d90fec86314bc\n- https://github.com/dotnet/efcore/compare/db5ecd5fd05f123b6d25565acd7a32a607894ba2...5e28bfb2dad21a5ca875905aabfeb5b2c5997058\n- https://github.com/dotnet/templating/compare/da9fa0f70871fd54000a921595f5027e8e09fbb9...8f6252e1567ac5c8faff1ad99310ac66d966687f\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:99f9e99f92d73ade5453ba8edba5d72247f3cd11..https://github.com/dotnet/winforms:darc-release/10.0-7fc7ab3b-6a02-431e-9c50-055fb22b725c\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14214)","Url":"https://github.com/dotnet/winforms/pull/14214","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14214)"},{"Id":"3815621281","IsPullRequest":true,"CreatedAt":"2026-01-15T20:34:03","Actor":"dotnet-maestro[bot]","Number":"14213","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20260114.14](https://dev.azure.com/dnceng/internal/_build/results?buildId=2879171) ([297370](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/297370))\n- **Date Produced**: January 14, 2026 10:54:40 PM UTC\n- **Commit**: [fe158d9692179d1316d11bf67b264c4509176f7e](https://github.com/dotnet/dotnet/commit/fe158d9692179d1316d11bf67b264c4509176f7e)\n- **Commit Diff**: [976695d...fe158d9](https://github.com/dotnet/dotnet/compare/976695d40cfde0801c78b8fed85ca80e997da085...fe158d9692179d1316d11bf67b264c4509176f7e)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.26062.108 to 10.0.0-beta.26064.114][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.3 to 10.0.3][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.3-servicing.26062.108 to 10.0.3-servicing.26064.114][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/976695d40c...fe158d9692\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/aspnetcore/compare/8b982fbfa4cb9a3c4ca9adb15ffa4c29c130e1dd...a190abe083fed3953b2174e2dfc7041b986b0b44\n- https://github.com/dotnet/efcore/compare/6320bfe1722ef2ce92e1723760c384c29da17352...db5ecd5fd05f123b6d25565acd7a32a607894ba2\n- https://github.com/dotnet/roslyn/compare/ec501e4c6f2689c9c71e38ce72d892675965c392...123b078829e8fdb3055704d609b7b5a44e1537dd\n- https://github.com/dotnet/runtime/compare/95a8439f484b1c623f7c1f0e3a2b1123e759bff5...dc5fd7a8dce8309e4add8fd4bd5d8718f221b15a\n- https://github.com/dotnet/scenario-tests/compare/f29ac531ec59b79ff12335835ae4a69cde51156a...368b99891ce58728b6795383c862520ec15efb22\n- https://github.com/dotnet/templating/compare/bcb12afa91df5118cdc411e88ea6b7eaf603f1f6...da9fa0f70871fd54000a921595f5027e8e09fbb9\n- https://github.com/dotnet/windowsdesktop/compare/c2987dd864a1ef3b4c4ad4e489c94aad95f401ea...46806c8c98c339affa04316bac6d5b391091cf94\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:fe158d9692179d1316d11bf67b264c4509176f7e..https://github.com/dotnet/winforms:darc-release/10.0-b163eca4-8b65-4f55-addd-23e737a1080d\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14213)","Url":"https://github.com/dotnet/winforms/pull/14213","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14213)"},{"Id":"3811221569","IsPullRequest":true,"CreatedAt":"2026-01-14T19:29:39","Actor":"dotnet-maestro[bot]","Number":"14208","RawContent":null,"Title":"[release/10.0] Source code updates from dotnet/dotnet","State":"closed","Body":"\n> [!NOTE]\n> This is a codeflow update. It may contain both source code changes from\n> [the VMR](https://github.com/dotnet/dotnet)\n> as well as dependency updates. Learn more [here](https://github.com/dotnet/dotnet/tree/main/docs/Codeflow-PRs.md).\n\nThis pull request brings the following source code changes\n\n[marker]: <> (Begin:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n## From https://github.com/dotnet/dotnet\n- **Subscription**: [7442e8e7-a558-4305-8b1f-3fa7e892b4a1](https://maestro.dot.net/subscriptions?search=7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n- **Build**: [20260112.8](https://dev.azure.com/dnceng/internal/_build/results?buildId=2877463) ([297004](https://maestro.dot.net/channel/5173/github:dotnet:dotnet/build/297004))\n- **Date Produced**: January 13, 2026 5:14:26 AM UTC\n- **Commit**: [976695d40cfde0801c78b8fed85ca80e997da085](https://github.com/dotnet/dotnet/commit/976695d40cfde0801c78b8fed85ca80e997da085)\n- **Commit Diff**: [4ef9fba...976695d](https://github.com/dotnet/dotnet/compare/4ef9fba1ed958b047163527960c27baf2883f835...976695d40cfde0801c78b8fed85ca80e997da085)\n- **Branch**: [release/10.0.1xx](https://github.com/dotnet/dotnet/tree/release/10.0.1xx)\n\n**Updated Dependencies**\n- From [10.0.0-beta.26057.111 to 10.0.0-beta.26062.108][1]\n  - Microsoft.DotNet.Arcade.Sdk\n  - Microsoft.DotNet.Build.Tasks.Templating\n  - Microsoft.DotNet.CMake.Sdk\n  - Microsoft.DotNet.GenFacades\n  - Microsoft.DotNet.Helix.Sdk\n  - Microsoft.DotNet.RemoteExecutor\n  - Microsoft.DotNet.XUnitV3Extensions\n- From [10.0.3 to 10.0.3][1]\n  - Microsoft.NET.Sdk.IL\n  - Microsoft.NETCore.App.Ref\n  - Microsoft.NETCore.ILAsm\n  - Microsoft.NETCore.ILDAsm\n  - Microsoft.Win32.SystemEvents\n  - runtime.win-x64.Microsoft.NETCore.ILAsm\n  - runtime.win-x86.Microsoft.NETCore.ILAsm\n  - System.CodeDom\n  - System.Configuration.ConfigurationManager\n  - System.Formats.Nrbf\n  - System.IO.Hashing\n  - System.Reflection.MetadataLoadContext\n  - System.Resources.Extensions\n  - System.Runtime.Serialization.Formatters\n  - System.Text.Encodings.Web\n  - System.Text.Json\n  - System.Windows.Extensions\n- From [10.0.3-servicing.26057.111 to 10.0.3-servicing.26062.108][1]\n  - Microsoft.NETCore.Platforms\n\n[marker]: <> (End:7442e8e7-a558-4305-8b1f-3fa7e892b4a1)\n\n[1]: https://github.com/dotnet/dotnet/compare/4ef9fba1ed...976695d40c\n[marker]: <> (Start:Footer:CodeFlow PR)\n\n## Associated changes in source repos\n- https://github.com/dotnet/arcade/compare/d8dca0b41b903e7182e64543773390b969dab96b...9f518f2be968c4c0102c2e3f8c793c5b7f28b731\n- https://github.com/dotnet/aspnetcore/compare/991f0cb924194b68191438b7d469c86ccba829cf...8b982fbfa4cb9a3c4ca9adb15ffa4c29c130e1dd\n- https://github.com/dotnet/runtime/compare/df5d2d2a52b07ab5578e4ae212f213aca2d8d695...95a8439f484b1c623f7c1f0e3a2b1123e759bff5\n- https://github.com/dotnet/sdk/compare/dde80f2ae0bc68bf846f081e3f25c69f7c93f8ef...400e46e95aff59f4c43252a86ccc4d85fbeb8515\n- https://github.com/dotnet/templating/compare/0cac1aa3a0df20f07742c2179dbda805a50f6049...bcb12afa91df5118cdc411e88ea6b7eaf603f1f6\n- https://github.com/dotnet/windowsdesktop/compare/2e44b04d012eb77fa78472528267bda592c99671...c2987dd864a1ef3b4c4ad4e489c94aad95f401ea\n- https://github.com/dotnet/winforms/compare/6f756681750457dca28bf276dcd2956b12cd3d27...f01695045e31ea77261a1dbde48ca243c432624f\n\n<details>\n<summary>Diff the source with this PR branch</summary>\n\n```bash\ndarc vmr diff --name-only https://github.com/dotnet/dotnet:976695d40cfde0801c78b8fed85ca80e997da085..https://github.com/dotnet/winforms:darc-release/10.0-f4ddf734-07cf-400f-8f44-bfd11f2cc207\n```\n</details>\n\n[marker]: <> (End:Footer:CodeFlow PR)\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14208)","Url":"https://github.com/dotnet/winforms/pull/14208","RelatedDescription":"Closed or merged PR \"[release/10.0] Source code updates from dotnet/dotnet\" (#14208)"},{"Id":"3812476834","IsPullRequest":true,"CreatedAt":"2026-01-14T18:51:36","Actor":"roelgerrits","Number":"14211","RawContent":null,"Title":"Fix winforms designer troubleshoot documentation","State":"closed","Body":"<!-- Please read CONTRIBUTING.md before submitting a pull request -->\r\n\r\nFixes #\r\n\r\n\r\n## Proposed changes\r\n\r\n- Change incorrect exclusion rule from `devevn.exe` to `devenv.exe`\r\n\r\n## Customer Impact\r\n\r\n- None\r\n\r\n## Regression? \r\n\r\n- No\r\n\r\n## Risk\r\n\r\n- Low risk, only documentation fix\r\n\r\n## Test methodology\r\n\r\n- Not applicable\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14211)","Url":"https://github.com/dotnet/winforms/pull/14211","RelatedDescription":"Closed or merged PR \"Fix winforms designer troubleshoot documentation\" (#14211)"},{"Id":"3811218389","IsPullRequest":true,"CreatedAt":"2026-01-14T18:48:27","Actor":"dotnet-maestro[bot]","Number":"14207","RawContent":null,"Title":"[release/9.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\n\n[marker]: <> (Begin:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n## From https://github.com/dotnet/arcade\n- **Subscription**: [92989bf7-cdf9-483d-64c5-08dcbc356d11](https://maestro.dot.net/subscriptions?search=92989bf7-cdf9-483d-64c5-08dcbc356d11)\n- **Build**: [20260113.2](https://dev.azure.com/dnceng/internal/_build/results?buildId=2877988) ([297092](https://maestro.dot.net/channel/5175/github:dotnet:arcade/build/297092))\n- **Date Produced**: January 13, 2026 12:53:13 PM UTC\n- **Commit**: [c85f9aceddaf85296e3efbc463daaa34fef5a375](https://github.com/dotnet/arcade/commit/c85f9aceddaf85296e3efbc463daaa34fef5a375)\n- **Branch**: [release/9.0](https://github.com/dotnet/arcade/tree/release/9.0)\n\n[DependencyUpdate]: <> (Begin)\n\n- **Dependency Updates**:\n  - From [9.0.0-beta.26062.2 to 9.0.0-beta.26063.2][1]\n     - Microsoft.DotNet.Arcade.Sdk\n     - Microsoft.DotNet.CMake.Sdk\n     - Microsoft.DotNet.GenFacades\n     - Microsoft.DotNet.Helix.Sdk\n     - Microsoft.DotNet.RemoteExecutor\n     - Microsoft.DotNet.XUnitExtensions\n\n[1]: https://github.com/dotnet/arcade/compare/7d6bcdd1e8...c85f9acedd\n\n[DependencyUpdate]: <> (End)\n\n\n[marker]: <> (End:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14207)","Url":"https://github.com/dotnet/winforms/pull/14207","RelatedDescription":"Closed or merged PR \"[release/9.0] Update dependencies from dotnet/arcade\" (#14207)"},{"Id":"3812017594","IsPullRequest":false,"CreatedAt":"2026-01-14T07:48:33","Actor":"Zheng-Li01","Number":"14210","RawContent":null,"Title":"[Dark Mode] The ListView cannot display the items when setting the Enable as false","State":"open","Body":"### .NET version\n\n11.0.0-alpha.1.26062.101\n\n### Did it work in .NET Framework?\n\nNot tested/verified\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNo, the issue also can reproduce on .NET 10.0 & .NET 9.0\n\n### Issue description\n\n The ListView cannot display the items when setting the Enable as false in Dark mode\n\n<img width=\"1068\" height=\"536\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/cfcc015a-b4b5-4f99-96b8-91fcbf00ae3a\" />\n\n### Steps to reproduce\n\n1. Create a .NET Winforms project with a ListView control\n2. Add some items for the listView1\n3. Set the **Enable** as **false** for the listView1\n4. Set app under Dark mode in program.cs file\n` Application.SetColorMode(SystemColorMode.Dark);`\n5. Build & run the application","Url":"https://github.com/dotnet/winforms/issues/14210","RelatedDescription":"Open issue \"[Dark Mode] The ListView cannot display the items when setting the Enable as false\" (#14210)"},{"Id":"3811284081","IsPullRequest":true,"CreatedAt":"2026-01-14T02:39:16","Actor":"github-actions[bot]","Number":"14209","RawContent":null,"Title":"[release/10.0] Fix CheckBox/RadioButton Appearance switching in Dark Mode","State":"open","Body":"Backport of #14194 to release/10.0\r\n\r\n## Proposed changes\r\n\r\n- Added `UpdateOwnerDraw()` call in the Appearance setter for both **CheckBox** and **RadioButton**\r\n- Optimized call order to avoid unnecessary operations:\r\n   Handle state change first (may RecreateHandle) and then refresh if handle wasn't recreated\r\n\r\n<!-- We are in TELL-MODE the following section must be completed -->\r\n\r\n## Customer Impact\r\n\r\n- **CheckBox** and **RadioButton** now correctly switch between Normal and Button appearance in Dark Mode\r\n\r\n## Regression? \r\n\r\n- Yes (Regressed from PR https://github.com/dotnet/winforms/pull/13608)\r\n\r\n## Risk\r\n\r\n- Minimal","Url":"https://github.com/dotnet/winforms/pull/14209","RelatedDescription":"Open PR \"[release/10.0] Fix CheckBox/RadioButton Appearance switching in Dark Mode\" (#14209)"},{"Id":"3810357246","IsPullRequest":true,"CreatedAt":"2026-01-13T21:26:59","Actor":"vseanreesermsft","Number":"14206","RawContent":null,"Title":"Merging internal commits for release/8.0","State":"closed","Body":"\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14206)","Url":"https://github.com/dotnet/winforms/pull/14206","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/8.0\" (#14206)"},{"Id":"3810311542","IsPullRequest":true,"CreatedAt":"2026-01-13T21:25:08","Actor":"vseanreesermsft","Number":"14205","RawContent":null,"Title":"Merging internal commits for release/9.0","State":"closed","Body":"\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14205)","Url":"https://github.com/dotnet/winforms/pull/14205","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/9.0\" (#14205)"},{"Id":"3806735243","IsPullRequest":true,"CreatedAt":"2026-01-13T19:51:50","Actor":"dotnet-maestro[bot]","Number":"14202","RawContent":null,"Title":"[release/9.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\n\n[marker]: <> (Begin:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n## From https://github.com/dotnet/arcade\n- **Subscription**: [92989bf7-cdf9-483d-64c5-08dcbc356d11](https://maestro.dot.net/subscriptions?search=92989bf7-cdf9-483d-64c5-08dcbc356d11)\n- **Build**: [20260112.2](https://dev.azure.com/dnceng/internal/_build/results?buildId=2877038) ([296888](https://maestro.dot.net/channel/5175/github:dotnet:arcade/build/296888))\n- **Date Produced**: January 12, 2026 12:24:35 PM UTC\n- **Commit**: [7d6bcdd1e851735273e4eed39e40366d48f335c9](https://github.com/dotnet/arcade/commit/7d6bcdd1e851735273e4eed39e40366d48f335c9)\n- **Branch**: [release/9.0](https://github.com/dotnet/arcade/tree/release/9.0)\n\n[DependencyUpdate]: <> (Begin)\n\n- **Dependency Updates**:\n  - From [9.0.0-beta.25626.6 to 9.0.0-beta.26062.2][1]\n     - Microsoft.DotNet.Arcade.Sdk\n     - Microsoft.DotNet.CMake.Sdk\n     - Microsoft.DotNet.GenFacades\n     - Microsoft.DotNet.Helix.Sdk\n     - Microsoft.DotNet.RemoteExecutor\n     - Microsoft.DotNet.XUnitExtensions\n\n[1]: https://github.com/dotnet/arcade/compare/ab5773ac30...7d6bcdd1e8\n\n[DependencyUpdate]: <> (End)\n\n\n[marker]: <> (End:92989bf7-cdf9-483d-64c5-08dcbc356d11)\n\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/winforms/pull/14202)","Url":"https://github.com/dotnet/winforms/pull/14202","RelatedDescription":"Closed or merged PR \"[release/9.0] Update dependencies from dotnet/arcade\" (#14202)"},{"Id":"3809458211","IsPullRequest":false,"CreatedAt":"2026-01-13T15:47:33","Actor":"dpmm99","Number":"14204","RawContent":null,"Title":"DataGridView: Excessive CPU+memory usage when closing form","State":"open","Body":"The root cause seems to be that [this enumeration](https://github.com/dotnet/winforms/blob/1e206698946b9ccc026c045f73ac5b792db4af92/src/System.Windows.Forms/System/Windows/Forms/Controls/DataGridView/DataGridView.Methods.cs#L25605) clones every row and cell in the DataGridView.\n\nThe result is it takes ~12 minutes and ~8 GB extra memory just to _dispose_ a DataGridView with ~700k rows.\n\nAbbreviated stack trace:\n[DataGridViewRowCollection.this[int].get(int index) Line 137](https://github.com/dotnet/winforms/blob/main/src/System.Windows.Forms/System/Windows/Forms/Controls/DataGridView/DataGridViewRowCollection.cs#L137)\n[DataGridView.ReleaseUiaProvider(HWND handle) Line 25605](https://github.com/dotnet/winforms/blob/1e206698946b9ccc026c045f73ac5b792db4af92/src/System.Windows.Forms/System/Windows/Forms/Controls/DataGridView/DataGridView.Methods.cs#L25605)\nControl.WmDestroy(ref Message m) Line 11463\n\n**Workaround**: setting every DataGridView's DataSource = null in the FormClosing event eliminates the issue. That seems to imply there's another problem with consistency--if ReleaseUiaProvider needs to be called for every single cell during WmDestroy, why wouldn't it be needed when clearing the DataSource?","Url":"https://github.com/dotnet/winforms/issues/14204","RelatedDescription":"Open issue \"DataGridView: Excessive CPU+memory usage when closing form\" (#14204)"},{"Id":"3806787976","IsPullRequest":false,"CreatedAt":"2026-01-13T02:26:47","Actor":"Zheng-Li01","Number":"14203","RawContent":null,"Title":"[Dark Mode] The RichTextBox not display multiline text well when setting the Enable as False","State":"open","Body":"### .NET version\n\n11.0.0-alpha.1.26062.101\n\n### Did it work in .NET Framework?\n\nNot tested/verified\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nThe issue can reproduce on .NET 10.0, and in .NET 9.0, the text is invisible.\n\n### Issue description\n\nThe RichTextBox not display multiline text well when setting the Enable as False in DarkMode\n<img width=\"1903\" height=\"591\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/b54ef004-7ff0-43a6-a96a-8bce7d86b6db\" />\n\nhttps://github.com/user-attachments/assets/f4484105-2d91-44bf-b5de-495df3000240\n\n### Steps to reproduce\n\n1. Create a .NET Winforms project with a RichTextBox control\n2. Add multiline text for the richTextBox1\n3. Set the **Enable** as **false** for the richTextBox1\n4. Set app under Dark mode in program.cs file\n` Application.SetColorMode(SystemColorMode.Dark);`\n5. Build & run the application\n6. Observe multiline text for the richTextBox1","Url":"https://github.com/dotnet/winforms/issues/14203","RelatedDescription":"Open issue \"[Dark Mode] The RichTextBox not display multiline text well when setting the Enable as False\" (#14203)"},{"Id":"3803390926","IsPullRequest":false,"CreatedAt":"2026-01-12T09:07:50","Actor":"awaescher","Number":"14201","RawContent":null,"Title":"Inconsistencies between Show() and ShowAsync()","State":"open","Body":"### .NET version\n\n.NET 10.0.101\n\n### Did it work in .NET Framework?\n\nNot available\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNot available\n\n### Issue description\n\nHighly appreciate the async extensions for WinForms #4631 & #11854. This helps a lot and I have really been looking forward to this.\nHowever, we found out that the new async methods behave differently in three cases:\n\n1. **Showing async MDI children**\nMDI child forms cannot be shown asynchronously. For most business apps this is exactly the point where it should be supported given that all the forms the users are working with are usually MDI children.\n\n2. **`ShowAsync()` without an `IWin32Owner` does not set an owner but behaves like it would**\nIn the demo app, if you leave all checkboxes unset, you'll get a new form that can also get behind the main form.\nIf you check the Async checkbox only, the form will not get a parent and no owner. And still it behaves like it would have an owner.\nWhat I mean by this is while the main form is not blocked and can be used while the created form stays open, the main form cannot cover the created form. The created form will always stay on top, just like it is the case with `Show()` with an owner.\n\n3. **Calling `Show()`/`ShowAsync()` twice**\nWhile it makes no sense to do this, we found out that the behavior differs when calling `Show()` multiple times (no error) vs. calling `ShowAsync()` multiple times, which leads to exceptions.\nWhy is that and can this be changed to behave the same? I think the behavior of `Show()` is better here as it might just be setting `Visible=true`, which can be done multiple times as well.\n\n### Steps to reproduce\n\nI created a tiny repro app where all of this can be tested easily.\n→ https://github.com/awaescher/AsyncFormsRepro\n\nJust clone it and run `dotnet run --project AsyncForms`.\n\n![Screenshot of the repro app](https://raw.githubusercontent.com/awaescher/AsyncFormsRepro/main/Screenshot.png)","Url":"https://github.com/dotnet/winforms/issues/14201","RelatedDescription":"Open issue \"Inconsistencies between Show() and ShowAsync()\" (#14201)"},{"Id":"3801824382","IsPullRequest":false,"CreatedAt":"2026-01-11T18:50:19","Actor":"vimalrajsf5014","Number":"14200","RawContent":null,"Title":".NET Core: Form Size Not Updating Correctly When DPI Scaling Exceeds 200%","State":"open","Body":"### .NET version\n\n.NET 90\n\n### Did it work in .NET Framework?\n\nNo\n\n### Did it work in any of the earlier releases of .NET Core or .NET 5+?\n\nNot applicable — this issue was observed on .NET Framework. I have not verified behavior on earlier .NET Core or .NET 5+ releases.\n\n### Issue description\n\nWhen adding a control of size 500x500 pixels (at 100% scaling = 96 DPI) to a Microsoft Form, the control is anchored and its size is measured at different points in the lifecycle:\n\n* After InitializeComponent\n* After OnHandleCreated\n* At 100% scaling, these measurements are identical.\n* At DPI scaling greater than 200%, the control size differs depending on when it is measured, which causes layout problems.\n\nI have attached a simple sample project and images that demonstrate the issue.\n\n### **Screenshots**\n\n* 100% Scaling:\n\n<img width=\"526\" height=\"564\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/586619b4-7e21-4d0a-9892-319a4f338485\" />\n\n* 125% Scaling:\n<img width=\"652\" height=\"690\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ec2e1e2f-c146-45d6-88f5-a5dc0558e127\" />\n\n\n* 150% Scaling:\n\n<img width=\"784\" height=\"823\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/4644b1b5-88b3-42bd-816c-91434458161b\" />\n\n\n* 175% Scaling:\n\n<img width=\"906\" height=\"963\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/ad8f52a0-7191-4da2-873a-24802e7365bd\" />\n\n* 225% Scaling:\n\n<img width=\"1157\" height=\"969\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d0fd88ff-8298-4c67-808d-7b7e8d3ea6be\" />\n\n* 250% Scaling:\n<img width=\"1279\" height=\"957\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/354bf59e-6a3e-4ebb-a651-1873d94dd64b\" />\n\n* 300% Scaling:\n<img width=\"1533\" height=\"937\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/2df8ba60-c21d-4328-be29-1bebca57816d\" />\n\n* 400%  Scaling\n\n<img width=\"1886\" height=\"910\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/1227d00f-ba9b-4ed5-82b8-212b97f67f37\" />\n\n* 500% Scaling\n<img width=\"1876\" height=\"842\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e4ceb607-7786-46db-b8e3-fc672a065363\" />\n\n\n### **SimpleSample**\n\n[MicrosoftFormSimpleSample.zip](https://github.com/user-attachments/files/24554192/MicrosoftFormSimpleSample.zip)\n\n\n### Actual Behavior\n\n* For DPI scaling greater than 200%, the control’s size measured after InitializeComponent and after OnHandleCreated differs.\n* This mismatch causes layout problems and breaks anchored layouts.\n\n### Expected Behavior\n\n* The control size should remain the same between creation and display, regardless of the DPI scaling level.\n* Anchored layouts should not break due to differences between InitializeComponent and OnHandleCreated measurements.\n\n\n### Steps to reproduce\n\nStep 1 : Run the attached simple sample project.\nStep 2 : Click the MicrosoftForm button.\nStep 3 : Ensure that DPI awareness is set to true in the app.manifest file.\nStep 4 : The sample creates a control sized 500x500 pixels at 100% scaling (96 DPI) and anchors it to the parent form.\nStep 5 : Observe the control size measured:\n* After InitializeComponent\n* After OnHandleCreated\n\nStep 6 : Change the display scaling level to 200% or higher (e.g., 225%).\nStep 7 : Compare the measurements — they should be the same, but at scaling >200% the values differ.\n\n","Url":"https://github.com/dotnet/winforms/issues/14200","RelatedDescription":"Open issue \".NET Core: Form Size Not Updating Correctly When DPI Scaling Exceeds 200%\" (#14200)"}],"ResultType":"GitHubIssue"}},"RunOn":"2026-01-21T03:30:35.0006397Z","RunDurationInMilliseconds":562}