{"Data":{"GitHub":{"Issues":[{"Id":"1052974671","IsPullRequest":true,"CreatedAt":"2021-11-14T16:00:09","Actor":"deeprobin","Number":"5693","RawContent":null,"Title":"FindCommandBinding improvements","State":"open","Body":"Might fix Issue #4869\r\n\r\n## Description\r\n\r\nThe main focus was on the FindCommandBinding method in CommandManager.cs. Here I decided to use a ValueTuple instead of a Tuple as well as to do the check using a switch-is block, as this is most likely easier to optimize through the JIT.\r\n\r\nFurthermore, I made other code improvements in related methods, like reducing code-nesting and using new C# features.\r\n\r\nI don't think these make a big difference to the generated JIT asm, but still hope to have made the code a bit more readable.\r\n\r\n/cc @IAmTheCShark","Url":"https://github.com/dotnet/wpf/pull/5693","RelatedDescription":"Open PR \"FindCommandBinding improvements\" (#5693)"},{"Id":"1052692797","IsPullRequest":true,"CreatedAt":"2021-11-13T14:59:49","Actor":"dotnet-maestro[bot]","Number":"5692","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20211113.1\r\n- **Date Produced**: November 13, 2021 2:15:55 PM UTC\r\n- **Commit**: f023688c2f08967c2e1139c85c0e2d38d245c367\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-alpha.1.21561.9 to 7.0.0-alpha.1.21563.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-alpha.1.21561.9 to 7.0.0-alpha.1.21563.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21562.1][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/7ce653c...f023688\r\n[2]: https://github.com/dotnet/runtime/compare/6f5de0b...35704e4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5692","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#5692)"},{"Id":"1052519919","IsPullRequest":false,"CreatedAt":"2021-11-13T02:15:28","Actor":"Ikonovich","Number":"5691","RawContent":null,"Title":"ComboBox background parameter doesn't work.","State":"open","Body":"* .NET Core Version: 5.0\r\n* Windows version: 10.0.19042 Build 19042\r\n\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n\r\n Setting the background parameter for a combo box doesn't function properly. \r\n\r\nActual behavior: \r\nThe ComboBox maintains the default gray background when the background parameter is set. When the dropdown menu is activated, any non-selected items will take on their Background color, but whichever item is selected will revert to the grey background.\r\n \r\nExpected behavior: \r\nThe combo box should take on either the default background color of the ComboBox or the background color of the selected item.\r\nI would expect that the background color of the selected item would override the default background color.\r\n\r\nMinimal reproduction: \r\n                    <ComboBox Background=\"Yellow\">\r\n                        <ComboBoxItem Background =\"Red\" IsSelected=\"True\">ExampleOne</ComboBoxItem>\r\n                        <ComboBoxItem Background =\"Blue\">ExampleTwo</ComboBoxItem>\r\n                        <ComboBoxItem Background =\"Green\">ExampleThree</ComboBoxItem>\r\n                    </ComboBox>\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/5691","RelatedDescription":"Open issue \"ComboBox background parameter doesn't work.\" (#5691)"},{"Id":"1049733320","IsPullRequest":false,"CreatedAt":"2021-11-12T07:50:57","Actor":"kvalitetskontrollMarkaryd","Number":"5677","RawContent":null,"Title":"Can't debug WPF project after upgrade from .NET5 to .NET6","State":"closed","Body":"* .NET Core Version: 6.0.100\r\n* Windows version: Windows 11 Pro\r\n* IDE: Visual Studio 2022 and Rider\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Have not tried but it's working in .NET5.\r\n\r\n **Problem description:**\r\n Changed from .NET5 to .NET6 by changing TargetFramework in .csproj. I now get the error message in VS2022:\r\n\"Unable to attach to CoreCLR. Operation not supported. Unknown error: 0x80004005.\"\r\nPublish and \"Start without debugging\" works, both in VS and Rider.\r\n\r\nWhat I have tried:\r\n1. I have uppdated all nugets\r\n2. Re-installed Visual Studio 2022\r\n3. Re-installed .Net6\r\n4. Clean and rebuild.\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nVisual Studio error message:\r\n![Visual Studio error message](https://user-images.githubusercontent.com/40342638/141107226-3215f1bb-9b80-4459-a386-204b9a8784d5.png)\r\n\r\nRider error message:\r\nC:\\Users\\user\\AppData\\Local\\JetBrains\\Toolbox\\apps\\Rider\\ch-0\\212.5284.64\\lib\\ReSharperHost\\JetBrains.Debugger.Worker64c.exe --mode=client --frontend-port=53344 --plugins=C:\\Users\\user\\AppData\\Local\\JetBrains\\Toolbox\\apps\\Rider\\ch-0\\212.5284.64\\plugins\\rider-unity\\dotnetDebuggerWorker\r\nOne or more errors have occurred.\r\n\r\n **csproj**\r\n```\r\n<Project Sdk=\"Microsoft.NET.Sdk\">\r\n\r\n  <PropertyGroup>\r\n    <OutputType>WinExe</OutputType>\r\n    <TargetFramework>net6.0-windows</TargetFramework>\r\n    <UseWPF>true</UseWPF>\r\n    <RuntimeIdentifier>win10-x64</RuntimeIdentifier>\r\n    <PublishSingleFile>true</PublishSingleFile>\r\n    <ApplicationIcon>Business_Target.ico</ApplicationIcon>\r\n    <UseWindowsForms>False</UseWindowsForms>\r\n    <ImplicitUsings>disable</ImplicitUsings>\r\n\t<SelfContained>true</SelfContained>\r\n\t<IncludeAllContentForSelfExtract>true</IncludeAllContentForSelfExtract>\r\n  </PropertyGroup>\r\n\r\n  <ItemGroup>\r\n    <ProjectReference Include=\"..\\ProjectOrganizer.Dto\\ProjectOrganizer.Dto.csproj\" />\r\n    <ProjectReference Include=\"..\\ProjectOrganizer.Shared\\ProjectOrganizer.Shared.csproj\">\r\n    </ProjectReference>\r\n  </ItemGroup>\r\n\r\n  <ItemGroup>\r\n    <PackageReference Include=\"AsyncAwaitBestPractices\" Version=\"6.0.2\" />\r\n    <PackageReference Include=\"Autofac\" Version=\"6.3.0\" />\r\n    <PackageReference Include=\"Autofac.Extensions.DependencyInjection\" Version=\"7.2.0\" />\r\n    <PackageReference Include=\"DevExpress.Images\" Version=\"21.2.3\" />\r\n    <PackageReference Include=\"DevExpress.Wpf\" Version=\"21.2.3\" />\r\n    <PackageReference Include=\"DevExpress.Wpf.Themes.Office2019Black\" Version=\"21.2.3\" />\r\n    <PackageReference Include=\"Microsoft.EntityFrameworkCore\" Version=\"6.0.0\" />\r\n    <PackageReference Include=\"Microsoft.Extensions.Http\" Version=\"6.0.0\" />\r\n    <PackageReference Include=\"Microsoft.Extensions.Http.Polly\" Version=\"6.0.0\" />\r\n    <PackageReference Include=\"Mono.Cecil\" Version=\"0.11.4\" />\r\n    <PackageReference Include=\"Polly.Extensions.Http\" Version=\"3.0.0\" />\r\n    <PackageReference Include=\"Prism.Core\" Version=\"8.1.97\" />\r\n  </ItemGroup>\r\n\r\n</Project>\r\n```","Url":"https://github.com/dotnet/wpf/issues/5677","RelatedDescription":"Closed issue \"Can't debug WPF project after upgrade from .NET5 to .NET6\" (#5677)"},{"Id":"1051496827","IsPullRequest":true,"CreatedAt":"2021-11-12T01:54:52","Actor":"dotnet-maestro[bot]","Number":"5690","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20211111.9\r\n- **Date Produced**: November 12, 2021 1:19:16 AM UTC\r\n- **Commit**: 7ce653ce1d831ba80dd02882745b6b3b28053f6c\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-alpha.1.21561.8 to 7.0.0-alpha.1.21561.9][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-alpha.1.21561.8 to 7.0.0-alpha.1.21561.9][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/8cdf7b4...7ce653c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5690","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#5690)"},{"Id":"1051469128","IsPullRequest":true,"CreatedAt":"2021-11-12T00:58:51","Actor":"dotnet-maestro[bot]","Number":"5689","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20211111.8\r\n- **Date Produced**: November 12, 2021 12:17:45 AM UTC\r\n- **Commit**: 8cdf7b4cf71f3688c537002c96497cac6a85a390\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21561.8][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-alpha.1.21561.1 to 7.0.0-alpha.1.21561.8][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/280fc85...8cdf7b4\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5689","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#5689)"},{"Id":"1051351236","IsPullRequest":false,"CreatedAt":"2021-11-11T20:51:39","Actor":"ryanmolden","Number":"5688","RawContent":null,"Title":"WPF does not ignore ignorable DWM errors and instead crashes the process","State":"open","Body":"The gist of the problem is WPF does not ignore STATUS_MESSAGE_LOST in their call to DWM's flush function. This message is ignorable and in fact should be ignored as DWM will recycle itself if it crashes and become available again. WPF not ignoring this forces a SyncFlush failure in VS which forces a UI thread exception to be thrown which crashes the product potentially losing unsaved user data. \r\n\r\nThe DWM folks in an internal email (quoted below) suggested this error (and possibly all others) should be treated as transitory/ignored, as WPF is already doing for SOME other error codes in this same code path.\r\n\r\nThis crash is responsible for approximately 50% of the SyncFlush Watson bucket which is the #1 crash in Dev17.\r\n\r\nFrom an internal email thread with the DWM folks (emphasis on 'all errors should be in this bucket', mine):\r\n\r\n> Yes, STATUS_MESSAGE_LOST is the NTSTATUS that is returned by LPC, whereas the other value is the HRESULT version of the same thing. The only difference is the extra facility bit that’s OR’ed in.\r\n> \r\n> Here, you’ll notice that WPF doesn’t want to do anything different – it just bubbles the error out. Also notice that we’re filtering some known errors already, and doing nothing special when these are encountered. My point is, **all errors should be in this bucket**, and at that point there is no longer a reason to even check the return code of the method. It’s basically a best-effort method: if it works, you want to wait for it to complete, and if it doesn’t work then there’s nothing to wait for.\r\n> \r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/5688","RelatedDescription":"Open issue \"WPF does not ignore ignorable DWM errors and instead crashes the process\" (#5688)"},{"Id":"1051032424","IsPullRequest":true,"CreatedAt":"2021-11-11T14:58:56","Actor":"dotnet-maestro[bot]","Number":"5687","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20211111.1\r\n- **Date Produced**: November 11, 2021 2:14:24 PM UTC\r\n- **Commit**: 280fc8548e3f77aa19e3d2c8cb1aaa8bcaab8aa0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-alpha.1.21560.4 to 7.0.0-alpha.1.21561.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-alpha.1.21560.4 to 7.0.0-alpha.1.21561.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-alpha.1.21558.10 to 7.0.0-alpha.1.21561.1][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/92921bb...280fc85\r\n[2]: https://github.com/dotnet/runtime/compare/dfb8c90...6f5de0b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5687","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#5687)"},{"Id":"1050984347","IsPullRequest":false,"CreatedAt":"2021-11-11T13:32:22","Actor":"dkandrov","Number":"5686","RawContent":null,"Title":"A11y ListBoxItems cause the error \"An element's IsOffScreen property must be false when its clickable point is on screen\"","State":"open","Body":"* .NET Core Version: .NET SDK 5.0.403\r\n* Windows version: Windows 10 - 21H1 build 19043.1348\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n* Is this bug related specifically to tooling in Visual Studio (e.g. XAML Designer, Code editing, etc...)? No\r\n\r\n <!-- Read https://github.com/dotnet/wpf/blob/main/Documentation/issue-guide.md -->\r\n \r\n **Problem description:**\r\n When you use ListBox in your forms and this ListBox contains many items which couldn't be displayed all in one time then you get an a11y error from the Accessibility Insights tool: \"An element's IsOffScreen property must be false when its clickable point is on screen\"\r\n![screenshot](https://user-images.githubusercontent.com/5506989/141305442-21751c56-6721-473d-9d93-4c424850c58f.png)\r\n\r\nIf you scroll elements down and up and start a11y test again:\r\n![screenshot2](https://user-images.githubusercontent.com/5506989/141306661-84112ad9-108b-4784-8554-0c2160dbefee.png)\r\n\r\nIn the Accessibility Insights tool repo, they have a similar issue which was closed because that is the problem of WPF: https://github.com/microsoft/axe-windows/issues/539#issuecomment-797633889\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nThe Accessibility Insights tool shows an error: \"An element's IsOffScreen property must be false when its clickable point is on screen\"\r\n **Expected behavior:**\r\nThe Accessibility Insights tool should not show errors about this.\r\n **Minimal repro:*\r\n[WpfAppListBox.zip](https://github.com/dotnet/wpf/files/7520666/WpfAppListBox.zip)\r\n*\r\n","Url":"https://github.com/dotnet/wpf/issues/5686","RelatedDescription":"Open issue \"A11y ListBoxItems cause the error \"An element's IsOffScreen property must be false when its clickable point is on screen\"\" (#5686)"},{"Id":"1050630918","IsPullRequest":true,"CreatedAt":"2021-11-11T06:45:19","Actor":"gurpreet-wpf","Number":"5685","RawContent":null,"Title":"Update roadmap.md","State":"open","Body":"WPF Roadmap for FY22\r\n\r\nFixes Issue <!-- Issue Number -->\r\n\r\nMain PR <!-- Link to PR if any that fixed this in the main branch. -->\r\n\r\n## Description\r\n\r\n<!-- Give a brief summary of the issue and how the pull request is fixing it. -->\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n","Url":"https://github.com/dotnet/wpf/pull/5685","RelatedDescription":"Open PR \"Update roadmap.md\" (#5685)"},{"Id":"1050578157","IsPullRequest":true,"CreatedAt":"2021-11-11T05:05:27","Actor":"singhashish-wpf","Number":"5684","RawContent":null,"Title":"Replace primitives by cryptography","State":"open","Body":"Fixes Issue <!-- Issue Number -->\r\nBuild error for winforms.\r\n\r\nMain PR <!-- Link to PR if any that fixed this in the main branch. -->\r\nhttps://github.com/dotnet/wpf/pull/5622\r\n## Description\r\nFix build errors, unblock. winforms.\r\n\r\nhttps://github.com/dotnet/runtime/pull/61025\r\n\r\n## Customer Impact\r\nBuild errors.\r\n\r\n## Regression\r\nNo\r\n\r\n## Testing\r\nBuild\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n","Url":"https://github.com/dotnet/wpf/pull/5684","RelatedDescription":"Open PR \"Replace primitives by cryptography\" (#5684)"},{"Id":"1050513745","IsPullRequest":false,"CreatedAt":"2021-11-11T02:43:30","Actor":"loop8ack","Number":"5683","RawContent":null,"Title":"UserControls are not found with the .NET 6 SDK if the AssemblyName is changed with $(MSBuildProjectName).","State":"open","Body":"* .NET Core Version: .net6.0-windows\r\n* .NET Core SDK Version: 6.0.100\r\n* Windows Version: 10.0.19043.1288\r\n* Visual Studio Version: 17.1.0 Preview 1.0\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Not tested\r\n* Is this bug related specifically to tooling in Visual Studio? In the XAML editor and during build\r\n \r\n **Problem description:**\r\n When I change the AssemblyName based on the MSBuildProjectName property, controls in the same project are no longer found.  This error occurs both in the XAML editor and when building. When I change the sdk-Version (in csproj and global.json) to 5.0.400, everything works fine.\r\nF12 (Go to definition) from XAML editor works as expected.\r\n\r\n **Actual behavior:** \r\nBuild will fail with error code \"MC3074\"\r\nDescription: The tag 'UserControl1' does not exist in XML namespace 'clr-namespace:WpfApp1'. Line 10 Position 10.\r\n \r\n **Minimal repro:**\r\n1. Create a new WPF project template \"WPF Application\"\r\n2. Select .NET 6.0 as target framework\r\n3. Create a new UserControl and use it in the MainWindow\r\n4. Run the project\r\n_=> This should build and start as expected_\r\n5. Add the following line to a PropertyGroup in the csproj-file:\r\n`<AssemblyName>test.$(MsBuildProjectName)</AssemblyName>`\r\n6. Run the project\r\n_=> Build will fail with error code \"MC3074\"_\r\n_=> XAML-Editor should show the same error inline_\r\n7. Change the target framework to \"net5.0-windows\".\r\n8. Create global.json next to the sln file with the following content: \r\n`{ \"sdk\": { \"version\": \"5.0.400\" } }`\r\n9. Run the project\r\n_=> This should build and start as expected_\r\n\r\n\r\nThis error only occurs when MSBuild properties are used. I tested it with $(MSBuildProjectName), $(AssemblyName) and $(RootNamespace).\r\nBut if I use $(Nullable) for example, it works as expected.\r\nIf I use a fixed value (e.g. \"test.project\"), it also works as expected.","Url":"https://github.com/dotnet/wpf/issues/5683","RelatedDescription":"Open issue \"UserControls are not found with the .NET 6 SDK if the AssemblyName is changed with $(MSBuildProjectName).\" (#5683)"},{"Id":"1050345694","IsPullRequest":true,"CreatedAt":"2021-11-10T21:51:33","Actor":"dotnet-maestro[bot]","Number":"5682","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20211110.2\r\n- **Date Produced**: November 10, 2021 5:15:38 PM UTC\r\n- **Commit**: ee9b7f19853685805c612103282c8d9486c7db86\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.21558.5 to 6.0.0-beta.21560.2][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.21558.5 to 6.0.0-beta.21560.2][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.21558.5 to 6.0.0-beta.21560.2][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.21558.5 to 6.0.0-beta.21560.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.21558.5 to 6.0.0-beta.21560.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/8ebefe2...ee9b7f1\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n- **Updates to .NET SDKs:**\r\n  - Updates sdk.version to 6.0.100\r\n  - Updates tools.dotnet to 6.0.100\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5682","RelatedDescription":"Open PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#5682)"},{"Id":"1050005132","IsPullRequest":true,"CreatedAt":"2021-11-10T16:19:59","Actor":"dotnet-maestro[bot]","Number":"5680","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20211108.5\r\n- **Date Produced**: November 8, 2021 9:31:54 PM UTC\r\n- **Commit**: 8ebefe290f57089d60100465111e78f223ee91db\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.21519.3 to 6.0.0-beta.21558.5][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.21519.3 to 6.0.0-beta.21558.5][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.21519.3 to 6.0.0-beta.21558.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.21519.3 to 6.0.0-beta.21558.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.21519.3 to 6.0.0-beta.21558.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/85f3aa1...8ebefe2\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5680","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#5680)"},{"Id":"1049929868","IsPullRequest":false,"CreatedAt":"2021-11-10T14:56:38","Actor":"zivkan","Number":"5679","RawContent":null,"Title":"MSBuildProjectExtensionsPath not handled correctly in GenerateTemporaryTargetAssembly","State":"open","Body":"* .NET Core Version: 6.0.100\r\n* Windows version: n/a\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: No\r\n* Is this bug related specifically to tooling in Visual Studio (e.g. XAML Designer, Code editing, etc...)? No\r\n\r\n <!-- Read https://github.com/dotnet/wpf/blob/main/Documentation/issue-guide.md -->\r\n \r\n **Problem description:** A customer reported this issue to NuGet: https://github.com/NuGet/Home/issues/4463#issuecomment-964986638\r\n\r\nI'm reporting it here, but @mkonijnenburg is the affected customer\r\n\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\n \r\n> C:\\Program Files\\dotnet\\sdk\\6.0.100\\Sdks\\Microsoft.NET.Sdk\\targets\\Microsoft.PackageDependencyResolution.targets(267,5): error NETSDK1004: Assets file 'C:\\src\\test\\wpfArtifacts\\obj\\MyApp_3j03kfnj_wpftmp\\project.assets.json' not found. Run a NuGet package restore to generate this file. [C:\\src\\test\\wpfArtifacts\\src\\MyApp\\MyApp_3j03kfnj_wpftmp.csproj]\r\n\r\n **Expected behavior:**\r\n\r\nBuild successfully\r\n \r\n **Minimal repro:**\r\n\r\nCreate `Directory.Build.props`:\r\n\r\n```xml\r\n<Project>\r\n    <PropertyGroup>\r\n        <BaseOutputPath>$(MSBuildThisFileDirectory)bin\\$(MSBuildProjectName)\\</BaseOutputPath>\r\n        <MSBuildProjectExtensionsPath>$(MSBuildThisFileDirectory)obj\\$(MSBuildProjectName)\\</MSBuildProjectExtensionsPath>\r\n        <IntermediateOutputPath>$(MSBuildThisFileDirectory)obj\\$(MSBuildProjectName)\\$(Configuration)\\</IntermediateOutputPath>\r\n    </PropertyGroup>\r\n</Project>\r\n```\r\n\r\nthen `dotnet new wpf -n MyApp ; dotnet new sln ; dotnet sln add MyApp ; dotnet build`\r\n\r\nIf I use `global.json` to pin the .NET SDK to 5.0.x, then this problem does not reproduce.","Url":"https://github.com/dotnet/wpf/issues/5679","RelatedDescription":"Open issue \"MSBuildProjectExtensionsPath not handled correctly in GenerateTemporaryTargetAssembly\" (#5679)"},{"Id":"1049824529","IsPullRequest":true,"CreatedAt":"2021-11-10T13:54:26","Actor":"dotnet-maestro[bot]","Number":"5678","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20211109.3\r\n- **Date Produced**: November 9, 2021 7:25:36 PM UTC\r\n- **Commit**: fecf65bedcee9036b8ba9d8d7feef5413f294914\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.21555.2 to 7.0.0-beta.21559.3][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.21555.2 to 7.0.0-beta.21559.3][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.21555.2 to 7.0.0-beta.21559.3][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.21555.2 to 7.0.0-beta.21559.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.21555.2 to 7.0.0-beta.21559.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/a7c57ab...fecf65b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/5678","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#5678)"},{"Id":"1048882726","IsPullRequest":true,"CreatedAt":"2021-11-09T22:31:16","Actor":"vseanreesermsft","Number":"5670","RawContent":null,"Title":"Merging internal commits for release/5.0","State":"closed","Body":"","Url":"https://github.com/dotnet/wpf/pull/5670","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/5.0\" (#5670)"},{"Id":"1048884530","IsPullRequest":true,"CreatedAt":"2021-11-09T19:41:16","Actor":"vseanreesermsft","Number":"5671","RawContent":null,"Title":"Merging internal commits for release/3.1","State":"closed","Body":"","Url":"https://github.com/dotnet/wpf/pull/5671","RelatedDescription":"Closed or merged PR \"Merging internal commits for release/3.1\" (#5671)"},{"Id":"1048936796","IsPullRequest":false,"CreatedAt":"2021-11-09T18:29:58","Actor":"vsfeedback","Number":"5676","RawContent":null,"Title":"Code Loading and Styling FlowDocument Must Produce an Error In Order to Function","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/Code-Loading-and-Styling-FlowDocument-Mu/1545618)._\n\n---\n[severity:Other]\r\n\nPrivate Sub Window_Loaded(sender As Object, e As RoutedEventArgs) Handles MyBase.Loaded\n\n' Loads the content to display...\n        rtbDisplay.Document = pFldContent\n        rtbDisplay.IsEnabled = True\n\n' Changes the name of the window...\n        txtTitle.Text = pStrHandle\n        ' Prepares to handle \n        Dim strInput As String = GetTheme(pIntWork)\n        Dim strTheme As String()\n        Dim strType As String = \"\"\n        Dim strOutput As String = \"\"\n        ' Attempts to avoid crashing...\n        Try\n            ' Loops through every paragraph in the display...\n            For Each itmBlock As Paragraph In rtbDisplay.Document.Blocks\n                ' Loops through every inline in the active paragraph...\n                For Each itmInline As Inline In itmBlock.Inlines\n                    ' Loops through every object in the active inline's children...\n                    For Each itmObject As Object In LogicalTreeHelper.GetChildren(itmBlock)\n                        ' Attempts to avoid crashing...\n                        Try\n                            ' Responds to User Interface Containers...\n                            If itmObject.GetType = GetType(InlineUIContainer) Then\n                                ' Treats the found children as inline user interface containers...\n                                Dim objTest As InlineUIContainer = itmObject\n                                ' Obtains theme settings...\n                                strTheme = Split(strInput, \",\")\n                                ' Gets the object type of the item in the container...\n                                strType = objTest.Child.GetType.ToString\n                                strType = Right(strType, Len(strType) - InStrRev(strType, \".\"))\n                                ' Responds based on item type...\n                                Select Case strType\n                                    Case \"TextBox\"\n                                        ' Treats the child item type as a text box...\n                                        Dim objText As TextBox = objTest.Child\n                                        ' Works with the text box...\n                                        With objText\n\n. FontFamily = New FontFamily(strTheme(7))\n                                            . FontSize = CDbl(strTheme(8))\n                                            . Foreground = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(9)))\n                                            . Padding = New Thickness(strTheme(10))\n                                            . Background = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(11)))\n                                            . BorderBrush = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(12)))\n                                            . BorderThickness = New Thickness(1)\n                                            . Margin = New Thickness(0)\n\nEnd With\n\nCase \"ComboBox\"\n\n'   THIS NEVER HAPPENS  \n\n' Treats the ui container item type as a combo box...\n                                        Dim objCombo As ComboBox = objTest.Child\n\n' Attempts to locate the template parent for editing (this works, but it only affects part of the design)...\n                                        ' * This section generates an error.  When the error is suppressed, the window does NOT color the combo box *\n                                        Dim tbTemp As TextBox = objCombo.Template.FindName(\"PART_EditableTextBox\", objCombo)\n                                        Dim svTemp As ScrollViewer = tbTemp.Template.FindName(\"PART_ContentHost\", tbTemp)\n\nWith svTemp\n                                            . Background = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(11)))\n                                        End With\n                                        ' * This section generates an error.  When the error is suppressed, the window does NOT color the combo box *\n\nTry\n                                            ' Adds a style resource to the combo box that sets the colors for the popup...\n                                            If objCombo.Resources.Count = 0 Then\n                                                ' Sets the background...\n                                                objCombo.Resources.Add(SystemColors.WindowBrushKey, New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(11))))\n                                                ' Sets the border...\n                                                objCombo.Resources.Add(SystemColors.WindowFrameBrushKey, New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(12))))\n                                                objCombo.Resources.Add(SystemColors.ControlTextBrushKey, New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(11))))\n                                            End If\n                                        Catch ex As Exception\n                                            MsgBox(ex. Message)\n                                        End Try\n\n' Works with the combo box...\n                                        With objCombo\n\n. FontFamily = New FontFamily(strTheme(7))\n                                            . FontSize = CDbl(strTheme(8))\n                                            . Foreground = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(9)))\n                                            . Padding = New Thickness(strTheme(10))\n                                            '. Background = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(11)))\n                                            '. BorderBrush = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(12)))\n                                            . BorderThickness = New Thickness(1)\n                                            . Margin = New Thickness(0)\n\nEnd With\n\nCase \"Button\"\n                                        ' Treats the child item type as a button...\n                                        Dim objButton As Button = objTest.Child\n                                        ' Only works with text buttons...\n                                        If objButton.Name <> \"btnColor\" And objButton.Name <> \"btnImage\" Then\n                                            ' Works with the button...\n                                            With objButton\n\n. FontFamily = New FontFamily(strTheme(13))\n                                                . FontSize = CDbl(strTheme(14))\n                                                . Foreground = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(15)))\n                                                . Padding = New Thickness(strTheme(16))\n                                                . Background = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(17)))\n                                                . BorderBrush = New SolidColorBrush(ColorConverter.ConvertFromString(strTheme(18)))\n                                                . Margin = New Thickness(strTheme(19))\n                                                . BorderThickness = New Thickness(1)\n\nEnd With\n                                        End If\n\nEnd Select\n                            End If\n\nCatch ex As Exception\n                            ' Stores messages...\n                            strOutput &= ex. Message & vbCrLf\n                        End Try\n\nNext\n\nNext\n\nNext\n\nCatch ex As Exception\n            ' Notifies the user...\n            MsgBox(ex. Message, vbExclamation, \"Window Style Error\")\n        End Try\n\nEnd Sub\n\n---\n### Original Comments\n\n#### Feedback Bot on 10/4/2021, 08:55 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5676","RelatedDescription":"Open issue \"Code Loading and Styling FlowDocument Must Produce an Error In Order to Function\" (#5676)"},{"Id":"1048930137","IsPullRequest":false,"CreatedAt":"2021-11-09T18:25:22","Actor":"vsfeedback","Number":"5675","RawContent":null,"Title":"Why ToolTip appears Instantly and does not trigger initial delay in WPF?","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/Why-ToolTip-appears-Instantly-and-does-n/1564898)._\n\n---\n[severity:It's more difficult to complete my work]\r\nI have two buttons in Main.Xaml. I declare ToolTip for each of them. They have a very small gap which is barely visible with open eyes but still they have gap which you you can see by their Margin.\n\n<Button\n        \n         x:Name=\"button1\" Width=\"71\" HorizontalAlignment=\"Left\" Margin=\"165,14,0,0\" Height=\"24\" \n      VerticalAlignment=\"Top\"  UseLayoutRounding=\"True\"  RenderOptions.ClearTypeHint=\"Enabled\"  RenderOptions.BitmapScalingMode=\"NearestNeighbor\"   SnapsToDevicePixels=\"True\"        \n                    >\n             <Button.Content  >\n                 <TextBlock FontSize=\"10\" FontFamily=\"Segoe UI\" UseLayoutRounding=\"True\" TextOptions.TextFormattingMode=\"Display\"  Margin=\"0,-2,0,0\" >\n                     Settings\n                 </TextBlock>\n                 </Button.Content>\n               <Button.ToolTip >\n <ToolTip   UseLayoutRounding=\"True\"  RenderOptions.ClearTypeHint=\"Enabled\"  RenderOptions.BitmapScalingMode=\"NearestNeighbor\"   SnapsToDevicePixels=\"True\" TextOptions.TextFormattingMode=\"Display\"\n                     >\n                     <StackPanel>\n                         <TextBlock  FontFamily=\"Segoe UI\"  FontSize=\"12\"  TextOptions.TextFormattingMode=\"Display\"    > \n                            Settings\n                         </TextBlock>\n                     </StackPanel>\n                   </ToolTip>\n             </Button.ToolTip>\n         </Button>\n    \n    \n            `enter code here`<Button\n       \n         x:Name=\"button2\" Width=\"71\" HorizontalAlignment=\"Left\" Margin=\"237,14,0,0\" Height=\"24\" \n      VerticalAlignment=\"Top\"  UseLayoutRounding=\"True\"  RenderOptions.ClearTypeHint=\"Enabled\"  RenderOptions.BitmapScalingMode=\"NearestNeighbor\"   SnapsToDevicePixels=\"True\"        \n                    >\n             <Button.Content                                               >\n                 <TextBlock FontSize=\"10\" FontFamily=\"Segoe UI\" UseLayoutRounding=\"True\" TextOptions.TextFormattingMode=\"Display\"  Margin=\"0,-2,0,0\" >\n                     Settings\n                 </TextBlock>\n                 </Button.Content>\n               <Button.ToolTip >\n <ToolTip    UseLayoutRounding=\"True\"  RenderOptions.ClearTypeHint=\"Enabled\"  RenderOptions.BitmapScalingMode=\"NearestNeighbor\"   SnapsToDevicePixels=\"True\" TextOptions.TextFormattingMode=\"Display\"\n                     >\n                     <StackPanel>\n                         <TextBlock  FontFamily=\"Segoe UI\"  FontSize=\"12\"  TextOptions.TextFormattingMode=\"Display\"    > \n                            Settings\n                         </TextBlock>\n                     </StackPanel>\n                   </ToolTip>\n             </Button.ToolTip>\n         </Button>\n\nI have created two control template one is for button which is consider as \"RoundCorner\" and declare as StaticResource of buttons in Main.XAMl. And another is for ToolTip.\n\nHere is the Code for RoundCorner Controltemplate(Button) --\n\n<Style x:Key=\"RoundCorner\" TargetType=\"{x:Type Button}\" x:Name=\"RoundCornerButton\"  >\n                 <Setter Property=\"HorizontalContentAlignment\" Value=\"Center\"/>\n                 <Setter Property=\"VerticalContentAlignment\" Value=\"Center\"/>\n                 <Setter Property=\"Padding\" Value=\"1\"/>\n                 <Setter Property=\"Foreground\" Value=\"#bababa\" />\n                <Setter Property=\"Template\">\n                     <Setter.Value>\n                         <ControlTemplate TargetType=\"{x:Type Button}\">\n                             <Grid x:Name=\"grid\" >\n                                 <Border x:Name=\"border\" CornerRadius=\"1\"  BorderThickness=\"0\"  >\n                                     <Border.Background>\n                                         <RadialGradientBrush GradientOrigin=\"0.496,1.052\">\n                                             <RadialGradientBrush.RelativeTransform>\n                                                 <TransformGroup>\n                                                     <ScaleTransform CenterX=\"0.5\" CenterY=\"0.5\" \n                                                         ScaleX=\"1.5\" ScaleY=\"1.5\"/>\n                                                     <TranslateTransform X=\"0.02\" Y=\"0.3\"/>\n                                                 </TransformGroup>\n                                             </RadialGradientBrush.RelativeTransform>\n                                             <GradientStop Offset=\"1\" Color=\"#282828\"/>\n                                             <GradientStop Offset=\"0.3\" Color=\"#282828\"/>\n                                         </RadialGradientBrush>\n                                     </Border.Background>\n                                     <ContentPresenter                                                           \n                                         HorizontalAlignment=\"Center\"\n                                         VerticalAlignment=\"Center\"\n                                           >\n                                     </ContentPresenter>\n                                 </Border>\n    \n                             </Grid>\n    \n                             <ControlTemplate.Triggers>\n    \n                                 <Trigger Property=\"IsMouseOver\" Value=\"True\">\n                                     <Setter Property=\"Background\" TargetName=\"border\" Value=\"#202020\"/>\n                                     <Setter Property=\"Foreground\" Value=\"WhiteSmoke\" />\n                                       \n                                 </Trigger>\n    \n                               <Trigger Property=\"IsPressed\" Value=\"True\">\n                                     <Setter Property=\"Background\" TargetName=\"border\">\n                                         <Setter.Value>\n                                             <RadialGradientBrush GradientOrigin=\"0.496,1.052\">\n                                                 <RadialGradientBrush.RelativeTransform>\n                                                     <TransformGroup>\n                                                         <ScaleTransform CenterX=\"0.5\" CenterY=\"0.5\" ScaleX=\"1.5\" ScaleY=\"1.5\"/>\n                                                         <TranslateTransform X=\"0.02\" Y=\"0.3\"/>\n                                                     </TransformGroup>\n                                                 </RadialGradientBrush.RelativeTransform>\n                                                 <GradientStop Color=\"#161616\" Offset=\"1\"/>\n                                                 <GradientStop Color=\"#161616\" Offset=\"0.3\"/>\n                                             </RadialGradientBrush>\n                                         </Setter.Value>\n                                     </Setter>\n                                 </Trigger>\n    \n                           </ControlTemplate.Triggers>\n    \n                         </ControlTemplate>\n                     </Setter.Value>\n                 </Setter>\n    \n                  </Style>\n\nHere is the Control template code for Tooltip--\n\n<Style x:Key=\"ToolTipDefaults\" x:Name=\"NewTooltip\"\n        TargetType=\"{x:Type ToolTip}\">\n                 <Setter Property=\"OverridesDefaultStyle\"\n           Value=\"True\" />\n                 <Setter Property=\"HasDropShadow\" \n           Value=\"True\" />\n                 <Setter Property=\"ToolTipService.Placement\"\n           Value=\"MousePoint\" />\n                 <Setter Property=\"ToolTipService.VerticalOffset\"\n           Value=\"5\"   />\n                 <Setter Property=\"ToolTipService.HorizontalOffset\"\n           Value=\"-10\" />\n                 <Setter Property=\"Foreground\"\n           Value=\"#606060\"/>\n                 <Setter Property=\"ToolTipService.InitialShowDelay\"\n           Value=\"1000\" />\n                 <Setter Property=\"ToolTipService.BetweenShowDelay\"\n           Value=\"0\" />\n                 <Setter Property=\"ToolTipService.ShowDuration\"\n           Value=\"6000\" />\n    \n                 <Setter Property=\"Template\">\n                     <Setter.Value>\n                         <ControlTemplate TargetType=\"{x:Type ToolTip}\">\n    \n                             <Grid x:Name=\"grid\"  Margin=\"10\"  >\n    \n                                 <Border x:Name=\"Bordermini\"  HorizontalAlignment=\"Right\" \n                 BorderThickness=\"0.5\"  \n                                        \n                 Width=\"{TemplateBinding Width}\"\n                 Height=\"15\">\n                            \n                                     <Border.Background>\n                                         <LinearGradientBrush StartPoint=\"0,0\"\n                                  EndPoint=\"0,1\">\n                                             <LinearGradientBrush.GradientStops>\n                                                 <GradientStopCollection>\n                                                     <GradientStop Color=\"White\"\n                                 Offset=\"0.0\" />\n                                                     <GradientStop Color=\"White\"\n                                 Offset=\"1.0\" />\n                                                 </GradientStopCollection>\n                                             </LinearGradientBrush.GradientStops>\n                                         </LinearGradientBrush>\n    \n                                     </Border.Background>\n    \n                                     <Border.BorderBrush>\n                                         <SolidColorBrush Color=\"Gainsboro\" />\n                                     </Border.BorderBrush>\n    \n                                     <Border.Effect>\n    \n                                         <DropShadowEffect   Opacity=\"0.8\"  BlurRadius=\"5\"  Direction=\"-82\" ShadowDepth=\"3.8\" Color=\"#282828\"      >\n                                     </DropShadowEffect>\n    \n                                     </Border.Effect>\n    \n                           <ContentPresenter Margin=\"1.5,0\"\n                             HorizontalAlignment=\"Left\"\n                             VerticalAlignment=\"Top\" />\n                                 </Border>\n    \n                  <Border x:Name=\"Border\"  HorizontalAlignment=\"Right\"\n                 BorderThickness=\"0.5\"  \n                                        \n                 Width=\"{TemplateBinding Width}\"\n                 Height=\"19\">\n                                     <Border.Background>\n                                         <LinearGradientBrush StartPoint=\"0,0\"\n                                  EndPoint=\"0,1\">\n                                             <LinearGradientBrush.GradientStops>\n                                                 <GradientStopCollection>\n                                                     <GradientStop Color=\"#ffffff\"\n                                 Offset=\"0.0\" />\n                                                     <GradientStop Color=\"#ffffff\"\n                                 Offset=\"1.0\" />\n                                                 </GradientStopCollection>\n                                             </LinearGradientBrush.GradientStops>\n                                         </LinearGradientBrush>\n    \n                                     </Border.Background>\n    \n                                     <Border.BorderBrush>\n                                         <SolidColorBrush Color=\"Gray\" />\n                                     </Border.BorderBrush>\n    \n                                     <ContentPresenter Margin=\"4,0\"\n                             HorizontalAlignment=\"Left\"\n                             VerticalAlignment=\"Top\" />\n                                 </Border>\n    \n                             </Grid>\n    \n                             <ControlTemplate.Triggers>\n                                 <Trigger Property=\"HasDropShadow\" Value=\"True\" >\n    \n                                     <Setter TargetName=\"Border\"\n                     Property=\"CornerRadius\"\n                     Value=\"0\" />\n                                     <Setter TargetName=\"Border\"\n                     Property=\"SnapsToDevicePixels\"\n                     Value=\"true\" />\n                             </Trigger>\n    \n                             </ControlTemplate.Triggers>\n                         </ControlTemplate>\n                      </Setter.Value>\n                 </Setter>\n             </Style>\n\nSo, How I re trigger the initial delay as soon as I quickly move the mouse cursor from one button to another? Is there any need to use the \"Datatrigger\" or \"DataBinding\" to overcome this issue?\n\n---\n### Original Comments\n\n#### Feedback Bot on 10/28/2021, 00:16 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5675","RelatedDescription":"Open issue \"Why ToolTip appears Instantly and does not trigger initial delay in WPF?\" (#5675)"},{"Id":"1048929574","IsPullRequest":false,"CreatedAt":"2021-11-09T18:24:40","Actor":"vsfeedback","Number":"5674","RawContent":null,"Title":"SoldidColorBrush created from BrushConverter(). ConvertFrom method does not work in a ValueConverter ","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/SoldidColorBrush-created-from-BrushConve/1468736)._\n\n---\n[regression] [worked-in:?]\r\n! [SolidColorBrush.png] (https://aka.ms/dc/image?name=Bea2e435819fe4d4fbdb2883700ebcb68637611762643440184_SolidColorBrush.png&tid=ea2e435819fe4d4fbdb2883700ebcb68637611762643440184)\n\nWhen I use ' SolidColorBrush brush = new SolidColorBrush(color: Colors.Gainsboro);' it changes the backgroundcolor.\nIf i use SolidColorBrush brush = (SolidColorBrush)(new BrushConverter(). ConvertFrom(\"#CCFF0000\"));  the backgroundcolor stays always red even if the value becomes true .\nHappend after update to 16.10.3 and is's quite a while ago since i ran this code. As I update as soon as there is an update, i can't remember the last working version !\n\n---\n### Original Comments\n\n#### Feedback Bot on 7/7/2021, 00:15 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Feedback Bot on 10/9/2021, 02:04 AM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5674","RelatedDescription":"Open issue \"SoldidColorBrush created from BrushConverter(). ConvertFrom method does not work in a ValueConverter \" (#5674)"},{"Id":"1048920109","IsPullRequest":false,"CreatedAt":"2021-11-09T18:13:06","Actor":"vsfeedback","Number":"5673","RawContent":null,"Title":"WPF Datagrid TargetDefaultValueConverter fails with System.Windows.Data Error: 6","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity2.visualstudio.com/t/WPF-Datagrid-TargetDefaultValueConverter/1140535)._\n\n---\nI have an Expander control containing aListView as the content of a Datagrid column.  When the Expander is expanded, the listview displays the results but throws this error:\n\n>System.Windows.Data Error: 6 : 'TargetDefaultValueConverter' converter failed to convert value '∞' (type 'Double'); fallback value will be used, if available. BindingExpression:Path=MaxHeight; DataItem='Border' (Name='Content'); target element is 'RowDefinition' (HashCode=17754702); target property is 'Height' (type 'GridLength') ArgumentException:'System.ArgumentException: 'value' parameter cannot be Infinity.\n>   at System.Windows.GridLength.. ctor(Double value, GridUnitType type)\n>   at System.Windows.GridLengthConverter.ConvertFrom(ITypeDescriptorContext typeDescriptorContext, CultureInfo cultureInfo, Object source)\n>   at MS. Internal.Data.DefaultValueConverter.ConvertHelper(Object o, Type destinationType, DependencyObject targetElement, CultureInfo culture, Boolean isForward)\n>   at MS. Internal.Data.TargetDefaultValueConverter.Convert(Object o, Type type, Object parameter, CultureInfo culture)\n>   at System.Windows.Data.BindingExpression.ConvertHelper(IValueConverter converter, Object value, Type targetType, Object parameter, CultureInfo culture)'\n\nUpon further testing, I found it does not matter what gets put in the expander.  The error occurrs yet the display of the result is correct.  What is going on and how can I get rid of the error please?\nHere is the XAML:\n\n<DataGridTemplateColumn HeaderStyle=\"{StaticResource MyDGColumnHeaderStyle}\"\n                                CanUserResize=\"True\" CanUserSort=\"True\" SortMemberPath=\"AttribVisible\" \n                                SortDirection=\"Ascending\" Width=\"20\" >\n                            <DataGridTemplateColumn.Header>\n                                <Grid>\n                                    <ctls:MyBasicButton Style=\"{StaticResource MyImageOnlyButtonStyle}\" \n                                        DataContext=\"{Binding RelativeSource={RelativeSource FindAncestor, \n                                            AncestorType={x:Type UserControl}}, Path=DataContext}\"\n                                        ButtonName=\"reg.btn_AttribHeader\" CanUseAlternateText=\"False\"\n                                        Image=\"{StaticResource TagBlue}\"\n                                        MaxImageSize=\"18\"\n                                        Background=\"Transparent\" BorderThickness=\"0\"\n                                        HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\" \n                                        HorizontalContentAlignment=\"Left\" Margin=\"2,0,2,0\"\n                                        Command=\"{Binding ButtonPressedCommand, Source={StaticResource viewmodelbase}}\" \n\t\t\t                            CommandParameter=\"{Binding Mode=OneWay, RelativeSource={RelativeSource Self}}\"\n                                        Click=\"HeaderButton_Click\">\n                                    </ctls:MyBasicButton>\n                                </Grid>\n                            </DataGridTemplateColumn.Header>\n                            <DataGridTemplateColumn.CellTemplate>\n                                <DataTemplate>\n                                    <Grid>\n                                        <Expander Margin=\"0\" Style=\"{StaticResource MyExpanderStyle}\"\n                                                  Visibility=\"{Binding AttribVisible, Converter={StaticResource BoolToVisibilityConverter}}\">\n                                            <Expander.Header>\n                                                <Grid>\n                                                    <Image Source=\"{StaticResource TagBlue}\"\n                                                            Width=\"14\" Height=\"14\" Margin=\"0,0,0,0\"\n                                                            HorizontalAlignment=\"Left\" VerticalAlignment=\"Center\"/>\n                                                </Grid>\n                                                </Expander.Header>\n                                            <ListView Style=\"{StaticResource MyListViewStyle}\"\n                                                      ignore:ItemsSource=\"{Binding AttribList}\">\n                                                    <ListViewItem>ListView 1</ListViewItem>\n                                                    <ListViewItem>ListView 2</ListViewItem>\n                                                    <ListViewItem>ListView 3</ListViewItem>\n                                            </ListView>\n                                        </Expander>\n                                    </Grid>\n                                </DataTemplate>\n                            </DataGridTemplateColumn.CellTemplate>\n                        </DataGridTemplateColumn>\n\n---\n### Original Comments\n\n#### Feedback Bot on 8/7/2020, 02:00 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Feedback Bot on 11/20/2020, 01:43 AM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5673","RelatedDescription":"Open issue \"WPF Datagrid TargetDefaultValueConverter fails with System.Windows.Data Error: 6\" (#5673)"},{"Id":"1048919700","IsPullRequest":false,"CreatedAt":"2021-11-09T18:12:36","Actor":"vsfeedback","Number":"5672","RawContent":null,"Title":"WPF BitmapCache issue","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity2.visualstudio.com/t/WPF-BitmapCache-issue/1085122)._\n\n---\nThere is an issue in WPF, when BitmapCache is used.\nJust try to reproduce the following steps with the attached solution:\n1. Run the application\n2. Click the \"Minimize and create\" button (the main window will minimize and the child window will be shown with a lot of dashed lines and maximized)\n3. Press Win+L to lock user session\n4. Login to the user account\n5. Hover the \"Push \"button\n6. Open Task manager and pay attention to the CPU and GPU consumption and window freeze\n7. Click the \"Push\" button (the main window will be shown and the problem with the freeze and the consumption will be gone)\n\n---\n### Original Comments\n\n#### Feedback Bot on 6/19/2020, 02:08 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Feedback Bot on 7/23/2020, 06:33 PM: \n\nI have detected that for the last 35 days, this issue didn't have much product team activity and a very small amount of new votes or comments. Based on this, its severity, and affected area, it’s my experience that this issue is very unlikely to be fixed.\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5672","RelatedDescription":"Open issue \"WPF BitmapCache issue\" (#5672)"},{"Id":"1048668523","IsPullRequest":false,"CreatedAt":"2021-11-09T14:24:37","Actor":"sampath-narayanan","Number":"5669","RawContent":null,"Title":"Index of char is wrong while getting from the string using the String.IndexOf()","State":"open","Body":"* .NET Core Version:   NetCore 5.0\r\n* Windows version: windows 10\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: No, only occurs in the NetCore \r\n\r\n **Problem description:**\r\n \r\nIndex of char is wrong while getting from the string using the String.IndexOf(). This issue occurs only when we set the the region and regional format as the Thailand and thai language. \r\n\r\n![image](https://user-images.githubusercontent.com/88649640/140939392-f8bfe436-0f2f-4bdc-b593-854ffb92e776.png)\r\n\r\nMean while issue not occurs while setting region and regional format english language and unitedstates.\r\n\r\n **Actual behavior:** \r\n**Case 1:**\r\n```\r\nstring v = \"{Total items Count}:{10}\";\r\nn1 = v.IndexOf(\"}\");\r\n```\r\n Here, we will get the n1 as 0 which is wrong.\r\n\r\n**Case 2:**\r\n```\r\nstring v = \"{Total items Count}:{10}\";\r\nn2 = v.IndexOf(\"}\", 20);\r\n```\r\nHere, we will get n2 as 20, which is wrong.\r\n\r\n **Expected behavior:**\r\n \r\nFor the case one the expected output is 18\r\n\r\nFor the case two the expected output is 23\r\n\r\n **Minimal repro:**\r\nPlease refer the attached sample\r\n\r\nCase 1:\r\n1. Run the sample\r\n2. Click the \"Click the button get the initial index of  }\"  to get the initial index of \"}\".\r\n\r\nCase 2:\r\n1. Run the sample\r\n2. Click the \"Click the button get the index of } where the start index will be 20\" to get the index of  \"}\" after the index 20.\r\n\r\nPlease set the Region and regional format as thailand and thai before run the sample\r\n\r\n[Sample.zip](https://github.com/dotnet/wpf/files/7505416/Sample.zip)\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/5669","RelatedDescription":"Open issue \"Index of char is wrong while getting from the string using the String.IndexOf()\" (#5669)"},{"Id":"1048552746","IsPullRequest":true,"CreatedAt":"2021-11-09T12:31:02","Actor":"gurpreet-wpf","Number":"5668","RawContent":null,"Title":"Update tooltip.md","State":"open","Body":"https://github.com/dotnet/wpf/issues/5132\r\nUpdating tooltip specs (CTRL and ESP will close any tooltip) as per the latest requirements from Accessibility team.\r\n\r\nFixes Issue <!-- Issue Number -->\r\n\r\nMain PR <!-- Link to PR if any that fixed this in the main branch. -->\r\n\r\n## Description\r\n\r\nhttps://github.com/dotnet/wpf/issues/5132\r\nUpdated tooltip specs accordingly\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n","Url":"https://github.com/dotnet/wpf/pull/5668","RelatedDescription":"Open PR \"Update tooltip.md\" (#5668)"},{"Id":"1048163612","IsPullRequest":false,"CreatedAt":"2021-11-09T04:03:51","Actor":"vsfeedback","Number":"5667","RawContent":null,"Title":"WPF Richtextbox crashed when typing chinese use win10 default typewriting","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity2.visualstudio.com/t/WPF-Richtextbox-crashed-when-typing-chin/1344292)._\n\n---\n[severity:It's more difficult to complete my work]\r\n1:.net 4+\n2:use richtextbox \n   \n```\n\n            \n                \n                    \n                        Symbol: B\n                    \n                    \n                        Atomic Mass: 10.811\n                    \n                \n            \n        \n```\n3:type any words\n! [16137863867541.png] (https://aka.ms/dc/image?name=Ba0c70cb6de85429a8e23cebd0fa73e11637493832317045466_16137863867541.png&tid=a0c70cb6de85429a8e23cebd0fa73e11637493832317045466)\n4:click mouse at richtextbox ,it will send character into origin words\n! [16137864988634.png] (https://aka.ms/dc/image?name=Baa9425d536114c61a45dbf84ebd657b4637493834660095318_16137864988634.png&tid=aa9425d536114c61a45dbf84ebd657b4637493834660095318)\n5:select current line\n! [16137867072318.png] (https://aka.ms/dc/image?name=B383224d3741749018466233841d0ff7a637493835495274861_16137867072318.png&tid=383224d3741749018466233841d0ff7a637493835495274861)\n6:type any character\n \ncrashed\n\n---\n### Original Comments\n\n#### Feedback Bot on 2/19/2021, 10:07 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Feedback Bot on 5/31/2021, 08:23 PM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5667","RelatedDescription":"Open issue \"WPF Richtextbox crashed when typing chinese use win10 default typewriting\" (#5667)"},{"Id":"1048116883","IsPullRequest":false,"CreatedAt":"2021-11-09T02:24:21","Actor":"vsfeedback","Number":"5666","RawContent":null,"Title":"Access Violations in wpfgfx_v0400","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/Access-Violations-in-wpfgfx_v0400/1366724)._\n\n---\n[severity:It's more difficult to complete my work]\r\nOur company develops a large application using C# and WPF. One of our clients is complaining that the application crashes randomly . They are using the application and suddenly it is totally gone. A typical client has 1000's of users using our application daily.\nTo troubleshoot this problem we asked this client to enable crashdumps. We received multiple crashdumps. The thing they all have in common is crashing on what I would call the render thread. (wpfgfx_v0400). They have two distinct error codes: c0000005 (Access violation) and C0000374 (heap corruption). \n\nThe client uses Windows 10 with .net Framework 4.8\n\nI am able to provide the crashdumps if that is neccessary. Some are full crashdumps other are minidumps.\n\nThese stackdumps all seem to be what I would call a 'NullReferenceException'\n\nStackdump #1\nSTACK_TEXT:  \n08edfa58 5fd9c1b0 40d60510 08edfa78 00000000 wpfgfx_v0400! CMilBrushDuce::GetRealizer+0x33\n08edfa7c 5fd9a096 40a7ef08 40d60510 08edfaa4 wpfgfx_v0400! CDrawingContext::GetBrushRealizer+0x95\n08edfae0 5fd9a2b9 40a7ef08 40fc04e8 53279900 wpfgfx_v0400! CDrawingContext::DrawGlyphRun+0x126\n08edfb94 5fd9ae04 40d60210 53279900 5fd9adb0 wpfgfx_v0400! CMilSlaveRenderData::Draw+0x4d1\n08edfbb4 5fd9ad71 40d60210 53279900 5fd9abb0 wpfgfx_v0400! CMilVisual::RenderContent+0x3c\n08edfc7c 5fd991f5 08edfc94 40d60210 00000000 wpfgfx_v0400! CDrawingContext::PreSubgraph+0x780\n08edfca8 5fd9f6f6 1fed2020 40d60228 40d60210 wpfgfx_v0400! CGraphIterator::Walk+0x4e\n08edfcf0 5fd9b628 1fed2020 1ff8e1a0 08edfd18 wpfgfx_v0400! CDrawingContext::DrawVisualTree+0x16b\n08edfd94 5fda0aa9 1fed2020 068844f4 1ff8e1a0 wpfgfx_v0400! CDrawingContext::Render+0x275\n08edfe04 5fda08e4 08edfe2b 06852588 08edfecf wpfgfx_v0400! CSlaveHWndRenderTarget::Render+0x1e9\n08edfe2c 5fd95b78 08edfecf 06852588 00000000 wpfgfx_v0400! CRenderTargetManager::Render+0x40\n08edfe44 5fd93446 08edfecf 06852590 5fd934b0 wpfgfx_v0400! CComposition::Render+0x1f\n08edfeb4 5fd934ff 08edfecf 06852590 5fd934b0 wpfgfx_v0400! CComposition::ProcessComposition+0x16f\n08edfed0 5fd93550 08edfeeb 00000001 0683f168 wpfgfx_v0400! CComposition::Compose+0x3f\n08edfeec 5fd92fd8 06852590 0683f168 5fd92fa0 wpfgfx_v0400! CPartitionThread::RenderPartition+0x25\n08edff04 5fdc9245 3e4db478 5fdc9210 5fdc9210 wpfgfx_v0400! CPartitionThread::Run+0x4e\n08edff2c 76486359 0683f168 76486340 08edff98 wpfgfx_v0400! CPartitionThread::ThreadMain+0x2f\n08edff3c 778b8944 0683f168 46f84318 00000000 kernel32! BaseThreadInitThunk+0x19\n08edff98 778b8914 ffffffff 778da0b5 00000000 ntdll!__RtlUserThreadStart+0x2f\n08edffa8 00000000 5fdc9210 0683f168 00000000 ntdll!_RtlUserThreadStart+0x1b\n\nStackdump #2\nSTACK_TEXT:  \n071bf1f8 6079c1b0 20abb7e0 071bf218 00000000 wpfgfx_v0400! CMilBrushDuce::GetRealizer+0x33\n071bf21c 6079c8bf 433de8a8 20abb7e0 071bf244 wpfgfx_v0400! CDrawingContext::GetBrushRealizer+0x95\n071bf248 6079f0f8 00000001 071bf404 071bf298 wpfgfx_v0400! CDrawingContext::FillOrStrokeShape+0x3b\n071bf2cc 3f800000 071bf4a8 6079f57f 071bf404 wpfgfx_v0400! CDrawingContext::DrawShape+0x153\nWARNING: Frame IP not in any known module. Following frames may be wrong.\n071bf2dc 433de8a8 00000000 3f627471 00000000 0x3f800000\n071bf404 608c6404 3f800000 3fc00000 3f800000 0x433de8a8\n071bf408 3f800000 3fc00000 3f800000 3f9ca75e wpfgfx_v0400! CRectangleFigure::`vftable'\n\nStackdump #3\nSTACK_TEXT:  \n0af7f2a8 5949c1b0 22f68b78 0af7f2c8 00000000 wpfgfx_v0400! CMilBrushDuce::GetRealizer+0x33\n0af7f2cc 5949a096 9b947f98 22f68b78 0af7f2f4 wpfgfx_v0400! CDrawingContext::GetBrushRealizer+0x95\n0af7f330 5949a2b9 9b947f98 9b9eb5b8 4f3b9fc8 wpfgfx_v0400! CDrawingContext::DrawGlyphRun+0x126\n0af7f3e4 5949ae04 22f68878 4f3b9fc8 5949adb0 wpfgfx_v0400! CMilSlaveRenderData::Draw+0x4d1\n0af7f404 5949ad71 22f68878 4f3b9fc8 5949abb0 wpfgfx_v0400! CMilVisual::RenderContent+0x3c\n0af7f4cc 594991f5 0af7f4e4 22f68878 00000000 wpfgfx_v0400! CDrawingContext::PreSubgraph+0x780\n0af7f4f8 5949f6f6 0121b170 22f68890 22f68878 wpfgfx_v0400! CGraphIterator::Walk+0x4e\n0af7f540 5949b628 0121b170 1a34b0b8 0af7f568 wpfgfx_v0400! CDrawingContext::DrawVisualTree+0x16b\n0af7f5e4 594a0aa9 0121b170 0f27befc 1a34b0b8 wpfgfx_v0400! CDrawingContext::Render+0x275\n0af7f654 594a08e4 0af7f67b 0121d4a0 0af7f71b wpfgfx_v0400! CSlaveHWndRenderTarget::Render+0x1e9\n0af7f67c 59495b78 0af7f71b 0121d4a0 00000000 wpfgfx_v0400! CRenderTargetManager::Render+0x40\n0af7f694 59493446 0af7f71b 0121d4a8 594934b0 wpfgfx_v0400! CComposition::Render+0x1f\n0af7f700 594934ff 0af7f71b 0121d4a8 594934b0 wpfgfx_v0400! CComposition::ProcessComposition+0x16f\n0af7f71c 59493550 0af7f737 00000001 01178ea0 wpfgfx_v0400! CComposition::Compose+0x3f\n0af7f738 59492fd8 0121d4a8 01178ea0 59492fa0 wpfgfx_v0400! CPartitionThread::RenderPartition+0x25\n0af7f750 594c9245 3d989a6b 594c9210 594c9210 wpfgfx_v0400! CPartitionThread::Run+0x4e\n0af7f778 749a6359 01178ea0 749a6340 0af7f7e4 wpfgfx_v0400! CPartitionThread::ThreadMain+0x2f\n0af7f788 771f8944 01178ea0 a59a3ebb 00000000 kernel32! BaseThreadInitThunk+0x19\n0af7f7e4 771f8914 ffffffff 7721a0ce 00000000 ntdll!__RtlUserThreadStart+0x2f\n0af7f7f4 00000000 594c9210 01178ea0 00000000 ntdll!_RtlUserThreadStart+0x1b\n\nIs this a known issue? Is there something I can recommend my client so they won't have this error anymore?\n\nThanks for your help\n\n---\n### Original Comments\n\n#### Feedback Bot on 3/11/2021, 10:55 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Vikas Patel on 4/19/2021, 08:59 PM: \n\n<p>A large number of our clients are having same issue. Were you able to get a resolution from Microsoft on this?</p>\n\n#### Folko Hettinga on 4/21/2021, 00:04 AM: \n\n<p>Hi Vikas. We also have multiple clients facing this issue, unfortunately no help from Microsoft…</p>\n\n#### Feedback Bot on 7/5/2021, 11:35 PM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5666","RelatedDescription":"Open issue \"Access Violations in wpfgfx_v0400\" (#5666)"},{"Id":"1048116610","IsPullRequest":false,"CreatedAt":"2021-11-09T02:23:42","Actor":"vsfeedback","Number":"5665","RawContent":null,"Title":"VS 2019 - WPF Core Windows App - NO System Reference","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity2.visualstudio.com/t/VS-2019---WPF-Core-Windows-App---NO-Syst/926959)._\n\n---\nSince using VS 2019, I have not been able to use the [mscorlib] reference in the XAML files in order to reference the .Net [System] library. I was able to in VS 2019, but not VS 2019. \n\nWhen possible I try to use static resources to manage values of primitive types, like Double, String, etc. Are these available to XAML in other ways? Where is the [mscorlib] reference?\n\n---\n### Original Comments\n\n#### Feedback Bot on 2/23/2020, 05:52 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### tom.shiveley.sogeti on 2/27/2020, 07:14 AM: \n\nEDIT:  In the first paragraph, last sentence I meant to say &quot;I was able to in VS 2017 but not VS 2019.&quot; I&#39;m sure you&#39;re already aware, but thought I&#39;d clarify.\n#### Feedback Bot on 4/3/2020, 01:45 AM: \n\nI have detected that for the last 35 days, this issue didn't have much product team activity and a very small amount of new votes or comments. Based on this, its severity, and affected area, it’s my experience that this issue is very unlikely to be fixed.\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5665","RelatedDescription":"Open issue \"VS 2019 - WPF Core Windows App - NO System Reference\" (#5665)"},{"Id":"1048116333","IsPullRequest":false,"CreatedAt":"2021-11-09T02:23:03","Actor":"vsfeedback","Number":"5664","RawContent":null,"Title":"In a WPF FlowDocument that's not associated with a control, TextPointer.InsertTextInRun sometimes fails to insert text at the \"current\" position","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/In-a-WPF-FlowDocument-thats-not-associa/1410585)._\n\n---\n[severity:It's more difficult to complete my work]\r\nI have a FlowDocument that is in this form:\nAN\n\nI have a pointer that's pointing to a position immediately after the \"N.\"\n\nI attempt to insert \"T\" at that position, right after the \"N.\" \n\nDue to the character insertion, the pointer is now one unit farther away from the start of the document than it was. So, the pointer is now immediately after the letter \"T\" that I just inserted, right?\n\nNo! The \"T\" was inserted before the \"N\" somehow, and the pointer is now immediately after the \"N\"!\n\nIn other words, the following source code throws an exception, after the FlowDocument and pointer are set up as described above:\n\n```\nvoid WTF(TextPointer pointer)\n    {\n        // new RichTextBox((FlowDocument)pointer. Paragraph.Parent);\n        int offsetBeforeInsertion = pointer. DocumentStart.GetOffsetToPosition(pointer); // 6\n        pointer. InsertTextInRun(\"T\");\n        int offsetAfterInsertion = pointer. DocumentStart.GetOffsetToPosition(pointer); // 7\n        if (offsetAfterInsertion == offsetBeforeInsertion + 1 && pointer. GetPositionAtOffset(-1). GetTextInRun(LogicalDirection.Forward) == \"N\")\n            throw new Exception(\"WPF, WTF!\");\n    }\n```\n\nIf I uncomment the line that makes this FlowDocument become the Document for a RichTextBox, then the exception goes away, even though the RichTextBox isn't displayed and doesn't do anything!\n\n---\n### Original Comments\n\n#### Feedback Bot on 4/29/2021, 00:58 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Jeff Hatch on 4/29/2021, 10:21 AM: \n\n<p>Oops, the form of the FlowDocument didn’t come through because I didn’t format it as code. It’s this:</p>\n<pre><code>AN\n</code></pre>\n<p>The pointer is pointing to after the N, within its Run. (It got to this state programmatically, not via XAML initialization.)</p>\n\n#### Feedback Bot on 8/2/2021, 00:27 AM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5664","RelatedDescription":"Open issue \"In a WPF FlowDocument that's not associated with a control, TextPointer.InsertTextInRun sometimes fails to insert text at the \"current\" position\" (#5664)"},{"Id":"1048116180","IsPullRequest":false,"CreatedAt":"2021-11-09T02:22:43","Actor":"vsfeedback","Number":"5663","RawContent":null,"Title":"\"BitmapImage.EndInit\" causes an exception if \"Rotation\" and \"DecodePixelWidth\" is used with small images","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/BitmapImageEndInit-causes-an-exceptio/1352982)._\n\n---\n[severity:It's more difficult to complete my work]\r\nThe following code causes the System.InvalidOperationException in the method \"EndEdit\" if the image file (here \"img0010.jpg\") is a small image:\n[ShowErrorProject.zip] (https://aka.ms/dc/file?name=Bbb90a1f813ad42419d5b96f01402593f637502647807249998_ShowErrorProject.zip&tid=bb90a1f813ad42419d5b96f01402593f637502647807249998)\n\n```\nBitmapImage NewBitmap = new BitmapImage();\nNewBitmap.BeginInit();\nNewBitmap.CacheOption = BitmapCacheOption.OnLoad;\nNewBitmap.StreamSource = File.OpenRead(@\".. \\.. \\img0010.jpg\");\nNewBitmap.Rotation = Rotation.Rotate90;\nNewBitmap.DecodePixelWidth = 200;\nNewBitmap.EndInit();\nImageControl.Source = NewBitmap;\n```\n\nI have attached the image file in the sample project.\n\n---\n### Original Comments\n\n#### Feedback Bot on 3/1/2021, 11:06 PM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n\n#### Feedback Bot on 5/31/2021, 08:23 PM: \n\nI detected that this issue hasn’t received a lot of activity, votes, or comments in the past 90 days. Based on this, the issues severity and affected area, it’s my experience that this issue is unlikely to get fixed. To improve the situation, consider following best practices for quality problem reports, and giving us more details on how this issue is impacting you.\n\n\n---\n### Original Solutions\n(no solutions)","Url":"https://github.com/dotnet/wpf/issues/5663","RelatedDescription":"Open issue \"\"BitmapImage.EndInit\" causes an exception if \"Rotation\" and \"DecodePixelWidth\" is used with small images\" (#5663)"}],"ResultType":"GitHubIssue"}},"RunOn":"2021-11-15T05:30:38.0232783Z","RunDurationInMilliseconds":493}