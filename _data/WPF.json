{"Data":{"GitHub":{"Issues":[{"Id":"1208757934","IsPullRequest":true,"CreatedAt":"2022-04-19T20:27:45","Actor":"dotnet-maestro[bot]","Number":"6461","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220419.3\r\n- **Date Produced**: April 19, 2022 6:43:48 PM UTC\r\n- **Commit**: 464f03d217a6c2287981010b399c1d4940b48edc\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22219.1 to 7.0.0-preview.4.22219.3][2]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22219.1 to 7.0.0-preview.4.22219.3][2]\r\n\r\n[2]: https://github.com/dotnet/winforms/compare/d3ec181...464f03d\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6461)\r\n","Url":"https://github.com/dotnet/wpf/pull/6461","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6461)"},{"Id":"1208447722","IsPullRequest":true,"CreatedAt":"2022-04-19T14:56:06","Actor":"dotnet-maestro[bot]","Number":"6460","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220419.1\r\n- **Date Produced**: April 19, 2022 1:54:02 PM UTC\r\n- **Commit**: d3ec181a2b16eaef69a1447370850d11ffcb513d\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22218.3 to 7.0.0-preview.4.22219.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22218.3 to 7.0.0-preview.4.22219.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22217.5 to 7.0.0-preview.4.22218.7][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/ee389e3...d3ec181\r\n[2]: https://github.com/dotnet/runtime/compare/74e1d4d...778b522\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6460)","Url":"https://github.com/dotnet/wpf/pull/6460","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6460)"},{"Id":"1208291885","IsPullRequest":true,"CreatedAt":"2022-04-19T12:57:53","Actor":"dotnet-maestro[bot]","Number":"6459","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220418.3\r\n- **Date Produced**: April 18, 2022 10:59:35 PM UTC\r\n- **Commit**: 8425453874961a7d7d2379e3f39c104f9ad0a0bd\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22215.2 to 7.0.0-beta.22218.3][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22215.2 to 7.0.0-beta.22218.3][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22215.2 to 7.0.0-beta.22218.3][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22215.2 to 7.0.0-beta.22218.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22215.2 to 7.0.0-beta.22218.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/4000024...8425453\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6459)","Url":"https://github.com/dotnet/wpf/pull/6459","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6459)"},{"Id":"1208234227","IsPullRequest":false,"CreatedAt":"2022-04-19T11:40:10","Actor":"NickeManarin","Number":"6458","RawContent":null,"Title":"WPF ARM64 app crashes on startup, unless assemblies are somewhat forcibly loaded","State":"open","Body":"Hi, I have been getting `BadImageException`'s when loading my WPF app exported as arm64.\r\n\r\nThese are the publishing settings, but not that it also happens with single file (on/off) and framework-dependant as well.\r\n\r\n![image](https://user-images.githubusercontent.com/14798947/159193282-8e0cd18a-b23d-47a1-904a-c29c2f5a2f41.png)\r\n\r\n![image](https://user-images.githubusercontent.com/14798947/159193290-7945d8b2-b86f-4125-a933-fa3ce3739925.png)\r\n\r\n------------\r\n\r\n```\r\nAn attempt was made to load a program with an incorrect format. (0x8007000B)\r\nSystem.BadImageFormatException\r\n at MS.Win32.PresentationCore.UnsafeNativeMethods.MilCoreApi.RenderOptions_ForceSoftwareRenderingModeForProcess(Boolean fForce)\r\n at System.Windows.Media.RenderOptions.set_ProcessRenderMode(RenderMode value)\r\n at Myapp.App.App_Startup(Object sender, StartupEventArgs e) in App.xaml.cs:line 156\r\n at System.Windows.Application.OnStartup(StartupEventArgs e)\r\n at System.Windows.Application.<.ctor>b__1_0(Object unused)\r\n at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n```\r\n\r\nThe line that triggers the issue looks like this:\r\n\r\n```\r\nRenderOptions.ProcessRenderMode = UserSettings.All.DisableHardwareAcceleration ? RenderMode.SoftwareOnly : RenderMode.Default;\r\n```\r\n\r\nRemoving that line just makes the app crash in the next line (a `FindResource()` call).\r\n\r\n---------------\r\n\r\nAs previously discussed in https://github.com/dotnet/wpf/discussions/6286, at first, I thought it could be related to some of my projects (or dependencies, such as SharpDX) being exported as x86 and failing to load.\r\n\r\nSo, I decided to export as self-contained + not as single file, to be able to scan all assemblies.\r\nI simply added a method to execute a for loop before the app passed though the line that triggered the crash, calling `AssemblyName.GetAssemblyName(name)` for all assemblies in the same folder.\r\n\r\nBy doing that, the app worked normally.\r\nWhy does that work?\r\n\r\nI can't do that normally in my app, as I export as a single file.\r\n\r\n```\r\nAccessibility.dll - AnyCPU\r\nclretwrc.dll - Not a valid assembly\r\nclrjit.dll - Not a valid assembly\r\ncoreclr.dll - Not a valid assembly\r\nD3DCompiler_47.dll - Not a valid assembly\r\ndbgshim.dll - Not a valid assembly\r\nDirectWriteForwarder.dll - None\r\nhostfxr.dll - Not a valid assembly\r\nhostpolicy.dll - Not a valid assembly\r\nKGySoft.CoreLibraries.dll - AnyCPU\r\nKGySoft.Drawing.dll - AnyCPU\r\nMicrosoft.Bcl.AsyncInterfaces.dll - AnyCPU\r\nMicrosoft.CSharp.dll - AnyCPU\r\nMicrosoft.DiaSymReader.Native.arm64.dll - Not a valid assembly\r\nMicrosoft.Extensions.ObjectPool.dll - AnyCPU\r\nMicrosoft.VisualBasic.Core.dll - AnyCPU\r\nMicrosoft.VisualBasic.dll - AnyCPU\r\nMicrosoft.VisualBasic.Forms.dll - AnyCPU\r\nMicrosoft.VisualBasic.Forms.resources.dll - AnyCPU\r\nMicrosoft.Win32.Primitives.dll - AnyCPU\r\nMicrosoft.Win32.Registry.AccessControl.dll - AnyCPU\r\nMicrosoft.Win32.Registry.dll - AnyCPU\r\nMicrosoft.Win32.SystemEvents.dll - AnyCPU\r\nmscordaccore.dll - Not a valid assembly\r\nmscordaccore_arm64_arm64_6.0.422.16404.dll - Not a valid assembly\r\nmscordbi.dll - Not a valid assembly\r\nmscorlib.dll - AnyCPU\r\nmscorrc.dll - Not a valid assembly\r\nnetstandard.dll - AnyCPU\r\nPenImc_cor3.dll - Not a valid assembly\r\nPresentationCore.dll - AnyCPU\r\nPresentationCore.resources.dll - AnyCPU\r\nPresentationFramework-SystemCore.dll - AnyCPU\r\nPresentationFramework-SystemData.dll - AnyCPU\r\nPresentationFramework-SystemDrawing.dll - AnyCPU\r\nPresentationFramework-SystemXml.dll - AnyCPU\r\nPresentationFramework-SystemXmlLinq.dll - AnyCPU\r\nPresentationFramework.Aero.dll - AnyCPU\r\nPresentationFramework.Aero2.dll - AnyCPU\r\nPresentationFramework.AeroLite.dll - AnyCPU\r\nPresentationFramework.Classic.dll - AnyCPU\r\nPresentationFramework.dll - AnyCPU\r\nPresentationFramework.Luna.dll - AnyCPU\r\nPresentationFramework.resources.dll - AnyCPU\r\nPresentationFramework.Royale.dll - AnyCPU\r\nPresentationNative_cor3.dll - Not a valid assembly\r\nPresentationUI.dll - AnyCPU\r\nPresentationUI.resources.dll - AnyCPU\r\nReachFramework.dll - AnyCPU\r\nReachFramework.resources.dll - AnyCPU\r\nMyApp.dll - AnyCPU\r\nMyApp.Domain.dll - AnyCPU\r\nMyApp.Native.dll - AnyCPU\r\nMyApp.Util.dll - AnyCPU\r\nMyApp.ViewModel.dll - AnyCPU\r\nSharpDX.Direct3D11.dll - AnyCPU\r\nSharpDX.dll - AnyCPU\r\nSharpDX.DXGI.dll - AnyCPU\r\nsni.dll - Not a valid assembly\r\nSystem.AppContext.dll - AnyCPU\r\nSystem.Buffers.dll - AnyCPU\r\nSystem.CodeDom.dll - AnyCPU\r\nSystem.Collections.Concurrent.dll - AnyCPU\r\nSystem.Collections.dll - AnyCPU\r\nSystem.Collections.Immutable.dll - AnyCPU\r\nSystem.Collections.NonGeneric.dll - AnyCPU\r\nSystem.Collections.Specialized.dll - AnyCPU\r\nSystem.ComponentModel.Annotations.dll - AnyCPU\r\nSystem.ComponentModel.Composition.dll - AnyCPU\r\nSystem.ComponentModel.Composition.Registration.dll - AnyCPU\r\nSystem.ComponentModel.DataAnnotations.dll - AnyCPU\r\nSystem.ComponentModel.dll - AnyCPU\r\nSystem.ComponentModel.EventBasedAsync.dll - AnyCPU\r\nSystem.ComponentModel.Primitives.dll - AnyCPU\r\nSystem.ComponentModel.TypeConverter.dll - AnyCPU\r\nSystem.Configuration.ConfigurationManager.dll - AnyCPU\r\nSystem.Configuration.dll - AnyCPU\r\nSystem.Console.dll - AnyCPU\r\nSystem.Core.dll - AnyCPU\r\nSystem.Data.Common.dll - AnyCPU\r\nSystem.Data.DataSetExtensions.dll - AnyCPU\r\nSystem.Data.dll - AnyCPU\r\nSystem.Data.Odbc.dll - AnyCPU\r\nSystem.Data.OleDb.dll - AnyCPU\r\nSystem.Data.SqlClient.dll - AnyCPU\r\nSystem.Design.dll - AnyCPU\r\nSystem.Diagnostics.Contracts.dll - AnyCPU\r\nSystem.Diagnostics.Debug.dll - AnyCPU\r\nSystem.Diagnostics.DiagnosticSource.dll - AnyCPU\r\nSystem.Diagnostics.EventLog.dll - AnyCPU\r\nSystem.Diagnostics.EventLog.Messages.dll - AnyCPU\r\nSystem.Diagnostics.FileVersionInfo.dll - AnyCPU\r\nSystem.Diagnostics.PerformanceCounter.dll - AnyCPU\r\nSystem.Diagnostics.Process.dll - AnyCPU\r\nSystem.Diagnostics.StackTrace.dll - AnyCPU\r\nSystem.Diagnostics.TextWriterTraceListener.dll - AnyCPU\r\nSystem.Diagnostics.Tools.dll - AnyCPU\r\nSystem.Diagnostics.TraceSource.dll - AnyCPU\r\nSystem.Diagnostics.Tracing.dll - AnyCPU\r\nSystem.DirectoryServices.AccountManagement.dll - AnyCPU\r\nSystem.DirectoryServices.dll - AnyCPU\r\nSystem.DirectoryServices.Protocols.dll - AnyCPU\r\nSystem.dll - AnyCPU\r\nSystem.Drawing.Common.dll - AnyCPU\r\nSystem.Drawing.Design.dll - AnyCPU\r\nSystem.Drawing.dll - AnyCPU\r\nSystem.Drawing.Primitives.dll - AnyCPU\r\nSystem.Dynamic.Runtime.dll - AnyCPU\r\nSystem.Formats.Asn1.dll - AnyCPU\r\nSystem.Globalization.Calendars.dll - AnyCPU\r\nSystem.Globalization.dll - AnyCPU\r\nSystem.Globalization.Extensions.dll - AnyCPU\r\nSystem.IO.Compression.Brotli.dll - AnyCPU\r\nSystem.IO.Compression.dll - AnyCPU\r\nSystem.IO.Compression.FileSystem.dll - AnyCPU\r\nSystem.IO.Compression.Native.dll - Not a valid assembly\r\nSystem.IO.Compression.ZipFile.dll - AnyCPU\r\nSystem.IO.dll - AnyCPU\r\nSystem.IO.FileSystem.AccessControl.dll - AnyCPU\r\nSystem.IO.FileSystem.dll - AnyCPU\r\nSystem.IO.FileSystem.DriveInfo.dll - AnyCPU\r\nSystem.IO.FileSystem.Primitives.dll - AnyCPU\r\nSystem.IO.FileSystem.Watcher.dll - AnyCPU\r\nSystem.IO.IsolatedStorage.dll - AnyCPU\r\nSystem.IO.MemoryMappedFiles.dll - AnyCPU\r\nSystem.IO.Packaging.dll - AnyCPU\r\nSystem.IO.Pipes.AccessControl.dll - AnyCPU\r\nSystem.IO.Pipes.dll - AnyCPU\r\nSystem.IO.Ports.dll - AnyCPU\r\nSystem.IO.UnmanagedMemoryStream.dll - AnyCPU\r\nSystem.Linq.dll - AnyCPU\r\nSystem.Linq.Expressions.dll - AnyCPU\r\nSystem.Linq.Parallel.dll - AnyCPU\r\nSystem.Linq.Queryable.dll - AnyCPU\r\nSystem.Management.dll - AnyCPU\r\nSystem.Memory.dll - AnyCPU\r\nSystem.Net.dll - AnyCPU\r\nSystem.Net.Http.dll - AnyCPU\r\nSystem.Net.Http.Json.dll - AnyCPU\r\nSystem.Net.HttpListener.dll - AnyCPU\r\nSystem.Net.Mail.dll - AnyCPU\r\nSystem.Net.NameResolution.dll - AnyCPU\r\nSystem.Net.NetworkInformation.dll - AnyCPU\r\nSystem.Net.Ping.dll - AnyCPU\r\nSystem.Net.Primitives.dll - AnyCPU\r\nSystem.Net.Quic.dll - AnyCPU\r\nSystem.Net.Requests.dll - AnyCPU\r\nSystem.Net.Security.dll - AnyCPU\r\nSystem.Net.ServicePoint.dll - AnyCPU\r\nSystem.Net.Sockets.dll - AnyCPU\r\nSystem.Net.WebClient.dll - AnyCPU\r\nSystem.Net.WebHeaderCollection.dll - AnyCPU\r\nSystem.Net.WebProxy.dll - AnyCPU\r\nSystem.Net.WebSockets.Client.dll - AnyCPU\r\nSystem.Net.WebSockets.dll - AnyCPU\r\nSystem.Numerics.dll - AnyCPU\r\nSystem.Numerics.Vectors.dll - AnyCPU\r\nSystem.ObjectModel.dll - AnyCPU\r\nSystem.Printing.dll - None\r\nSystem.Private.CoreLib.dll - AnyCPU\r\nSystem.Private.DataContractSerialization.dll - AnyCPU\r\nSystem.Private.ServiceModel.dll - AnyCPU\r\nSystem.Private.ServiceModel.resources.dll - AnyCPU\r\nSystem.Private.Uri.dll - AnyCPU\r\nSystem.Private.Xml.dll - AnyCPU\r\nSystem.Private.Xml.Linq.dll - AnyCPU\r\nSystem.Reflection.Context.dll - AnyCPU\r\nSystem.Reflection.DispatchProxy.dll - AnyCPU\r\nSystem.Reflection.dll - AnyCPU\r\nSystem.Reflection.Emit.dll - AnyCPU\r\nSystem.Reflection.Emit.ILGeneration.dll - AnyCPU\r\nSystem.Reflection.Emit.Lightweight.dll - AnyCPU\r\nSystem.Reflection.Extensions.dll - AnyCPU\r\nSystem.Reflection.Metadata.dll - AnyCPU\r\nSystem.Reflection.Primitives.dll - AnyCPU\r\nSystem.Reflection.TypeExtensions.dll - AnyCPU\r\nSystem.Resources.Extensions.dll - AnyCPU\r\nSystem.Resources.Reader.dll - AnyCPU\r\nSystem.Resources.ResourceManager.dll - AnyCPU\r\nSystem.Resources.Writer.dll - AnyCPU\r\nSystem.Runtime.Caching.dll - AnyCPU\r\nSystem.Runtime.CompilerServices.Unsafe.dll - AnyCPU\r\nSystem.Runtime.CompilerServices.VisualC.dll - AnyCPU\r\nSystem.Runtime.dll - AnyCPU\r\nSystem.Runtime.Extensions.dll - AnyCPU\r\nSystem.Runtime.Handles.dll - AnyCPU\r\nSystem.Runtime.InteropServices.dll - AnyCPU\r\nSystem.Runtime.InteropServices.RuntimeInformation.dll - AnyCPU\r\nSystem.Runtime.Intrinsics.dll - AnyCPU\r\nSystem.Runtime.Loader.dll - AnyCPU\r\nSystem.Runtime.Numerics.dll - AnyCPU\r\nSystem.Runtime.Serialization.dll - AnyCPU\r\nSystem.Runtime.Serialization.Formatters.dll - AnyCPU\r\nSystem.Runtime.Serialization.Json.dll - AnyCPU\r\nSystem.Runtime.Serialization.Primitives.dll - AnyCPU\r\nSystem.Runtime.Serialization.Xml.dll - AnyCPU\r\nSystem.Security.AccessControl.dll - AnyCPU\r\nSystem.Security.Claims.dll - AnyCPU\r\nSystem.Security.Cryptography.Algorithms.dll - AnyCPU\r\nSystem.Security.Cryptography.Cng.dll - AnyCPU\r\nSystem.Security.Cryptography.Csp.dll - AnyCPU\r\nSystem.Security.Cryptography.Encoding.dll - AnyCPU\r\nSystem.Security.Cryptography.OpenSsl.dll - AnyCPU\r\nSystem.Security.Cryptography.Pkcs.dll - AnyCPU\r\nSystem.Security.Cryptography.Primitives.dll - AnyCPU\r\nSystem.Security.Cryptography.ProtectedData.dll - AnyCPU\r\nSystem.Security.Cryptography.X509Certificates.dll - AnyCPU\r\nSystem.Security.Cryptography.Xml.dll - AnyCPU\r\nSystem.Security.dll - AnyCPU\r\nSystem.Security.Permissions.dll - AnyCPU\r\nSystem.Security.Principal.dll - AnyCPU\r\nSystem.Security.Principal.Windows.dll - AnyCPU\r\nSystem.Security.SecureString.dll - AnyCPU\r\nSystem.ServiceModel.dll - AnyCPU\r\nSystem.ServiceModel.Duplex.dll - AnyCPU\r\nSystem.ServiceModel.Http.dll - AnyCPU\r\nSystem.ServiceModel.NetTcp.dll - AnyCPU\r\nSystem.ServiceModel.Primitives.dll - AnyCPU\r\nSystem.ServiceModel.Security.dll - AnyCPU\r\nSystem.ServiceModel.Syndication.dll - AnyCPU\r\nSystem.ServiceModel.Web.dll - AnyCPU\r\nSystem.ServiceProcess.dll - AnyCPU\r\nSystem.ServiceProcess.ServiceController.dll - AnyCPU\r\nSystem.Speech.dll - AnyCPU\r\nSystem.Text.Encoding.CodePages.dll - AnyCPU\r\nSystem.Text.Encoding.dll - AnyCPU\r\nSystem.Text.Encoding.Extensions.dll - AnyCPU\r\nSystem.Text.Encodings.Web.dll - AnyCPU\r\nSystem.Text.Json.dll - AnyCPU\r\nSystem.Text.RegularExpressions.dll - AnyCPU\r\nSystem.Threading.AccessControl.dll - AnyCPU\r\nSystem.Threading.Channels.dll - AnyCPU\r\nSystem.Threading.dll - AnyCPU\r\nSystem.Threading.Overlapped.dll - AnyCPU\r\nSystem.Threading.Tasks.Dataflow.dll - AnyCPU\r\nSystem.Threading.Tasks.dll - AnyCPU\r\nSystem.Threading.Tasks.Extensions.dll - AnyCPU\r\nSystem.Threading.Tasks.Parallel.dll - AnyCPU\r\nSystem.Threading.Thread.dll - AnyCPU\r\nSystem.Threading.ThreadPool.dll - AnyCPU\r\nSystem.Threading.Timer.dll - AnyCPU\r\nSystem.Transactions.dll - AnyCPU\r\nSystem.Transactions.Local.dll - AnyCPU\r\nSystem.ValueTuple.dll - AnyCPU\r\nSystem.Web.dll - AnyCPU\r\nSystem.Web.HttpUtility.dll - AnyCPU\r\nSystem.Web.Services.Description.dll - AnyCPU\r\nSystem.Web.Services.Description.resources.dll - AnyCPU\r\nSystem.Windows.Controls.Ribbon.dll - AnyCPU\r\nSystem.Windows.Controls.Ribbon.resources.dll - AnyCPU\r\nSystem.Windows.dll - AnyCPU\r\nSystem.Windows.Extensions.dll - AnyCPU\r\nSystem.Windows.Forms.Design.dll - AnyCPU\r\nSystem.Windows.Forms.Design.Editors.dll - AnyCPU\r\nSystem.Windows.Forms.Design.resources.dll - AnyCPU\r\nSystem.Windows.Forms.dll - AnyCPU\r\nSystem.Windows.Forms.Primitives.dll - AnyCPU\r\nSystem.Windows.Forms.Primitives.resources.dll - AnyCPU\r\nSystem.Windows.Forms.resources.dll - AnyCPU\r\nSystem.Windows.Input.Manipulations.dll - AnyCPU\r\nSystem.Windows.Input.Manipulations.resources.dll - AnyCPU\r\nSystem.Windows.Presentation.dll - AnyCPU\r\nSystem.Xaml.dll - AnyCPU\r\nSystem.Xaml.resources.dll - AnyCPU\r\nSystem.Xml.dll - AnyCPU\r\nSystem.Xml.Linq.dll - AnyCPU\r\nSystem.Xml.ReaderWriter.dll - AnyCPU\r\nSystem.Xml.Serialization.dll - AnyCPU\r\nSystem.Xml.XDocument.dll - AnyCPU\r\nSystem.Xml.XmlDocument.dll - AnyCPU\r\nSystem.Xml.XmlSerializer.dll - AnyCPU\r\nSystem.Xml.XPath.dll - AnyCPU\r\nSystem.Xml.XPath.XDocument.dll - AnyCPU\r\nUIAutomationClient.dll - AnyCPU\r\nUIAutomationClient.resources.dll - AnyCPU\r\nUIAutomationClientSideProviders.dll - AnyCPU\r\nUIAutomationClientSideProviders.resources.dll - AnyCPU\r\nUIAutomationProvider.dll - AnyCPU\r\nUIAutomationProvider.resources.dll - AnyCPU\r\nUIAutomationTypes.dll - AnyCPU\r\nUIAutomationTypes.resources.dll - AnyCPU\r\nvcruntime140_cor3.dll - Not a valid assembly\r\nWindowsBase.dll - AnyCPU\r\nWindowsBase.resources.dll - AnyCPU\r\nWindowsFormsIntegration.dll - AnyCPU\r\nWindowsFormsIntegration.resources.dll - AnyCPU\r\nwpfgfx_cor3.dll - Not a valid assembly\r\n```\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/6458","RelatedDescription":"Open issue \"WPF ARM64 app crashes on startup, unless assemblies are somewhat forcibly loaded\" (#6458)"},{"Id":"1208149790","IsPullRequest":true,"CreatedAt":"2022-04-19T10:54:18","Actor":"dotnet-maestro[bot]","Number":"6457","RawContent":null,"Title":"[main] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:f8781171-8d89-4d6b-f62b-08d8e93a0c51)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: f8781171-8d89-4d6b-f62b-08d8e93a0c51\r\n- **Build**: 20220419.1\r\n- **Date Produced**: April 19, 2022 10:07:27 AM UTC\r\n- **Commit**: c7613b7eaa5fad9ca0c969c60324ec4f36849510\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 7.0.0-preview.4.22173.2 to 7.0.0-preview.5.22219.1][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC6a3e171&targetVersion=GCc7613b7&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:f8781171-8d89-4d6b-f62b-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6457)","Url":"https://github.com/dotnet/wpf/pull/6457","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6457)"},{"Id":"1207704660","IsPullRequest":true,"CreatedAt":"2022-04-19T09:37:01","Actor":"singhashish-wpf","Number":"6456","RawContent":null,"Title":"Update branding to 5","State":"closed","Body":"Update branding to preview 5\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6456)","Url":"https://github.com/dotnet/wpf/pull/6456","RelatedDescription":"Closed or merged PR \"Update branding to 5\" (#6456)"},{"Id":"1207611112","IsPullRequest":true,"CreatedAt":"2022-04-19T01:57:20","Actor":"dotnet-maestro[bot]","Number":"6455","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220418.3\r\n- **Date Produced**: April 19, 2022 1:08:59 AM UTC\r\n- **Commit**: ee389e31138f5b8f92701e3b9f6e211e37c49469\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22218.2 to 7.0.0-preview.4.22218.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22218.2 to 7.0.0-preview.4.22218.3][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/04082b9...ee389e3\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6455)","Url":"https://github.com/dotnet/wpf/pull/6455","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6455)"},{"Id":"1207513278","IsPullRequest":true,"CreatedAt":"2022-04-18T22:56:08","Actor":"dotnet-maestro[bot]","Number":"6454","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220418.2\r\n- **Date Produced**: April 18, 2022 9:58:37 PM UTC\r\n- **Commit**: 04082b99477b1636bb5992b6c2aac6fc916c712a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22217.2 to 7.0.0-preview.4.22218.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22217.2 to 7.0.0-preview.4.22218.2][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22216.4 to 7.0.0-preview.4.22217.5][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/93c7049...04082b9\r\n[2]: https://github.com/dotnet/runtime/compare/a39ddca...74e1d4d\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6454)","Url":"https://github.com/dotnet/wpf/pull/6454","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6454)"},{"Id":"1207285513","IsPullRequest":false,"CreatedAt":"2022-04-18T17:53:21","Actor":"zydjohnHotmail","Number":"6453","RawContent":null,"Title":"Create a video from WPF animation.","State":"open","Body":"Hello:\r\nI am using WPF for C# target .NET 6.0; I have Visual Studio 2022 (Version 17.1.4) and also VS 2022 Preview (Preview Version 17.2.0 Preview 3.0) on Windows 10 (Version 21H2).\r\nI can write some C# code to generate animation, like the following code:\r\n\r\nusing System;\r\nusing System.Windows;\r\nusing System.Windows.Controls;\r\nusing System.Windows.Media;\r\nusing System.Windows.Shapes;\r\nusing System.Windows.Media.Animation;\r\n\r\nnamespace WpfApplication1\r\n{\r\n    public partial class MainWindow : Window\r\n    {\r\n        private Storyboard myStoryboard;\r\n\r\n        public MainWindow()\r\n        {\r\n            InitializeComponent();\r\n\r\n            StackPanel myPanel = new StackPanel();\r\n            myPanel.Margin = new Thickness(10);\r\n\r\n            Rectangle myRectangle = new Rectangle();\r\n            myRectangle.Name = \"myRectangle\";\r\n            this.RegisterName(myRectangle.Name, myRectangle);\r\n            myRectangle.Width = 100;\r\n            myRectangle.Height = 100;\r\n            myRectangle.Fill = Brushes.Blue;\r\n\r\n            DoubleAnimation myDoubleAnimation = new DoubleAnimation();\r\n            myDoubleAnimation.From = 1.0;\r\n            myDoubleAnimation.To = 0.0;\r\n            myDoubleAnimation.Duration = new Duration(TimeSpan.FromSeconds(5));\r\n            myDoubleAnimation.AutoReverse = true;\r\n            myDoubleAnimation.RepeatBehavior = RepeatBehavior.Forever;\r\n\r\n            myStoryboard = new Storyboard();\r\n            myStoryboard.Children.Add(myDoubleAnimation);\r\n            Storyboard.SetTargetName(myDoubleAnimation, myRectangle.Name);\r\n            Storyboard.SetTargetProperty(myDoubleAnimation, new PropertyPath(Rectangle.OpacityProperty));\r\n\r\n            // Use the Loaded event to start the Storyboard.\r\n            myRectangle.Loaded += new RoutedEventHandler(myRectangleLoaded);\r\n            myPanel.Children.Add(myRectangle);\r\n            this.Content = myPanel;\r\n        }\r\n\r\n        private void myRectangleLoaded(object sender, RoutedEventArgs e)\r\n        {\r\n            myStoryboard.Begin(this);\r\n        }\r\n    }\r\n}\r\n\r\nI want to know if there is any built-in or other “decent” way to create a MP4 format video to save the animation.  So, I can play it with Windows Media Player or any other MP4 player, like VLC player.  I know this way will work: using a 3rd party screen recording software to record the screen area where the animation took place.  However, this seems not a “decent” way.\r\nI want to be able to control the frame rate like: either 25 or 30 FPS or other custom FPS, and I want to be able to control the resolution of the image/video for 720P or 1080P.  For rotating animation, I want to save each 10 degree rotation as one frame, so for 360 degree rotation, the FPS will be 36.\r\nUsing a 3rd party screen recording software is not so “decent”.\r\nI hope there is some built-in feature in WPF, but since there is documents for WPF in .NET 6.0 yet, I can only read WPF for .NET Framework 4.x; or if there is such feature in .NET MAUI in preview version can do this.\r\nThen, please share some code or provide some URL where I can find useful information for this topic.  I believe this should be a built-in feature in WPF, otherwise, how you can save your visual effect using a publicly accessible format? Do you want all the people to install WPF with Visual Studio to view your WPF program in source code format?\r\nThanks,","Url":"https://github.com/dotnet/wpf/issues/6453","RelatedDescription":"Open issue \"Create a video from WPF animation.\" (#6453)"},{"Id":"1207200379","IsPullRequest":false,"CreatedAt":"2022-04-18T16:12:53","Actor":"zgabi","Number":"6452","RawContent":null,"Title":"WeakEventManager lock issue","State":"open","Body":".NET 6.0.202\r\nWindows Server 2022 21H2 20348.643\r\nDoes the bug reproduce also in WPF for .NET Framework 4.8?: yes\r\n\r\n **Problem description:**\r\nCollection was modified exception in `WeakEventTable `cleanup.\r\nIt seems that the problem occures only when `EnableWeakEventMemoryImprovements` is true. \r\n\r\n_dataTable is changed in the PurgeInternal code in this loop:\r\nhttps://github.com/dotnet/wpf/blob/89d172db0b7a192de720c6cfba5e28a1e7d46123/src/Microsoft.DotNet.Wpf/src/WindowsBase/MS/Internal/WeakEventTable.cs#L336-L348\r\n\r\nSomewhere here:\r\nhttps://github.com/dotnet/wpf/blob/bdfe29afcaa879c55aa3ed6541698cdc42be4dd8/src/Microsoft.DotNet.Wpf/src/WindowsBase/System/Windows/WeakEventManager.cs#L406-L445\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nI receive the following exception sometimes which terminates the whole process (of course I could catch it in the `Dispatcher.UnhandledException` event handler):\r\n\r\nSystem.InvalidOperationException: Collection was modified; enumeration operation may not execute.\r\n   at System.Collections.Hashtable.HashtableEnumerator.MoveNext()\r\n   at MS.Internal.WeakEventTable.Purge(Boolean purgeAll)\r\n   at MS.Internal.CleanupHelper.DoCleanup(Boolean forceCleanup)\r\n   at MS.Internal.CleanupHelper.OnCleanupTick(Object sender, EventArgs e)\r\n   at System.Windows.Threading.DispatcherTimer.FireTick()\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n \r\n **Expected behavior:**\r\nNo unhandled exception\r\n \r\n **Minimal repro:**\r\nOpen the attached project, execute it and press the button several times.\r\n[WeakEventManagerTest.zip](https://github.com/dotnet/wpf/files/8506598/WeakEventManagerTest.zip)\r\n","Url":"https://github.com/dotnet/wpf/issues/6452","RelatedDescription":"Open issue \"WeakEventManager lock issue\" (#6452)"},{"Id":"1206700801","IsPullRequest":true,"CreatedAt":"2022-04-18T06:29:49","Actor":"dotnet-maestro[bot]","Number":"6451","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220417.2\r\n- **Date Produced**: April 18, 2022 5:41:39 AM UTC\r\n- **Commit**: 93c70498ef90a33ff64c66ad00ba067a12ce82fc\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22217.1 to 7.0.0-preview.4.22217.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22217.1 to 7.0.0-preview.4.22217.2][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/11bdca7...93c7049\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6451)","Url":"https://github.com/dotnet/wpf/pull/6451","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6451)"},{"Id":"1206380558","IsPullRequest":true,"CreatedAt":"2022-04-17T14:16:49","Actor":"dotnet-maestro[bot]","Number":"6450","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220417.1\r\n- **Date Produced**: April 17, 2022 1:28:29 PM UTC\r\n- **Commit**: 11bdca7201ffb7697cf1c1d66e1428a2dfcc2e1e\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22216.2 to 7.0.0-preview.4.22217.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22216.2 to 7.0.0-preview.4.22217.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22215.7 to 7.0.0-preview.4.22216.4][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/945d389...11bdca7\r\n[2]: https://github.com/dotnet/runtime/compare/2d4f2d0...a39ddca\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6450)","Url":"https://github.com/dotnet/wpf/pull/6450","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6450)"},{"Id":"1206362057","IsPullRequest":true,"CreatedAt":"2022-04-17T12:46:12","Actor":"dotnet-maestro[bot]","Number":"6449","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220415.2\r\n- **Date Produced**: April 16, 2022 2:47:34 AM UTC\r\n- **Commit**: 4000024394df3049886c50e54ad0a2b903221ef0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22215.1 to 7.0.0-beta.22215.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22215.1 to 7.0.0-beta.22215.2][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22215.1 to 7.0.0-beta.22215.2][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22215.1 to 7.0.0-beta.22215.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22215.1 to 7.0.0-beta.22215.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/c49ad02...4000024\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6449)","Url":"https://github.com/dotnet/wpf/pull/6449","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6449)"},{"Id":"1206293401","IsPullRequest":true,"CreatedAt":"2022-04-17T06:49:25","Actor":"dotnet-maestro[bot]","Number":"6448","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220416.2\r\n- **Date Produced**: April 17, 2022 5:51:07 AM UTC\r\n- **Commit**: 945d389d80122054e2e24766ede9df8bba573e03\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22215.6 to 7.0.0-preview.4.22216.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22215.6 to 7.0.0-preview.4.22216.2][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22214.7 to 7.0.0-preview.4.22215.7][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/7ef343e...945d389\r\n[2]: https://github.com/dotnet/runtime/compare/895715e...2d4f2d0\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6448)","Url":"https://github.com/dotnet/wpf/pull/6448","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6448)"},{"Id":"1206101741","IsPullRequest":true,"CreatedAt":"2022-04-16T12:54:48","Actor":"dotnet-maestro[bot]","Number":"6447","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220415.1\r\n- **Date Produced**: April 15, 2022 6:42:09 PM UTC\r\n- **Commit**: c49ad022e8d39db4bf47197aa4eebfe6428b51a7\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22214.3 to 7.0.0-beta.22215.1][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22214.3 to 7.0.0-beta.22215.1][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22214.3 to 7.0.0-beta.22215.1][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22214.3 to 7.0.0-beta.22215.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22214.3 to 7.0.0-beta.22215.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/5ef2983...c49ad02\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6447)","Url":"https://github.com/dotnet/wpf/pull/6447","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6447)"},{"Id":"1206037592","IsPullRequest":false,"CreatedAt":"2022-04-16T07:07:12","Actor":"zgabi","Number":"6446","RawContent":null,"Title":"Stack object allocation in UIElementHelper.InvalidateAutomationAncestors should be removed","State":"open","Body":"I noticed in our application, that more than 20% of the object allocations are in the UIElementHelper.InvalidateAutomationAncestors and in InvalidateAutomationAncestorsCoreHelper, which is adding to this Stack.\r\n\r\nThis Stack object should be cached somehow.\r\n\r\n![image](https://user-images.githubusercontent.com/3104253/163646509-72956e17-9287-4fe9-b391-16e202bd17c8.png)\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/6446","RelatedDescription":"Open issue \"Stack object allocation in UIElementHelper.InvalidateAutomationAncestors should be removed\" (#6446)"},{"Id":"1205985742","IsPullRequest":true,"CreatedAt":"2022-04-16T02:57:21","Actor":"dotnet-maestro[bot]","Number":"6445","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220415.6\r\n- **Date Produced**: April 16, 2022 1:41:57 AM UTC\r\n- **Commit**: 7ef343e350b4c798efae38ea66863b96b4a92016\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22215.5 to 7.0.0-preview.4.22215.6][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22215.5 to 7.0.0-preview.4.22215.6][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/d2f9c33...7ef343e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6445)","Url":"https://github.com/dotnet/wpf/pull/6445","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6445)"},{"Id":"1205978992","IsPullRequest":true,"CreatedAt":"2022-04-16T02:16:39","Actor":"dotnet-maestro[bot]","Number":"6444","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220415.5\r\n- **Date Produced**: April 16, 2022 1:05:22 AM UTC\r\n- **Commit**: d2f9c33ab20d5d00e14e42e138add50f9d9976d3\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22215.3 to 7.0.0-preview.4.22215.5][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22215.3 to 7.0.0-preview.4.22215.5][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/0410846...d2f9c33\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6444)","Url":"https://github.com/dotnet/wpf/pull/6444","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6444)"},{"Id":"1205906385","IsPullRequest":true,"CreatedAt":"2022-04-15T21:43:33","Actor":"zgabi","Number":"6443","RawContent":null,"Title":"Use Dictionary instead of Hashtable in WeakEventTable","State":"open","Body":"## Description\r\n\r\nIt's currently using a Hashtable with struct keys (except the _managerTable, but better to change all of them), which means every operation on the Hashtable boxes the struct. Switching to a Dictionary removes those costs.\r\nThe Hashtable indexer returns null when key not exists, so in this case TryGetValue should be used on the Dictionary object.\r\n\r\n## Customer Impact\r\n\r\nLess unnecessary boxing means less pauses due to GC.\r\n\r\n## Regression\r\n\r\nNo\r\n\r\n## Testing\r\n\r\nJust CI\r\n\r\n## Risk\r\n\r\nSimilar as in #4731\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6443)","Url":"https://github.com/dotnet/wpf/pull/6443","RelatedDescription":"Open PR \"Use Dictionary instead of Hashtable in WeakEventTable\" (#6443)"},{"Id":"1205861607","IsPullRequest":true,"CreatedAt":"2022-04-15T20:39:16","Actor":"dotnet-maestro[bot]","Number":"6442","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220413.4\r\n- **Date Produced**: April 15, 2022 7:49:34 PM UTC\r\n- **Commit**: 3510f88911e3fea61a4eeb481d7a1fbae9795c7b\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22212.1 to 6.0.0-rtm.22213.4][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GCc8d46e6&targetVersion=GC3510f88&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6442)","Url":"https://github.com/dotnet/wpf/pull/6442","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6442)"},{"Id":"1205829586","IsPullRequest":true,"CreatedAt":"2022-04-15T19:53:54","Actor":"dotnet-maestro[bot]","Number":"6441","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220415.3\r\n- **Date Produced**: April 15, 2022 7:09:16 PM UTC\r\n- **Commit**: 041084645716b529ff1e1225fca1b451d56f77bf\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22215.2 to 7.0.0-preview.4.22215.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22215.2 to 7.0.0-preview.4.22215.3][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22211.8 to 7.0.0-preview.4.22214.7][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/ff8cb04...0410846\r\n[2]: https://github.com/dotnet/runtime/compare/5707668...895715e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6441)","Url":"https://github.com/dotnet/wpf/pull/6441","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6441)"},{"Id":"1205598180","IsPullRequest":true,"CreatedAt":"2022-04-15T14:20:56","Actor":"dotnet-maestro[bot]","Number":"6439","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220415.2\r\n- **Date Produced**: April 15, 2022 1:29:51 PM UTC\r\n- **Commit**: ff8cb04baa2d784a4613b98085d7c03ea63a7452\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22215.1 to 7.0.0-preview.4.22215.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22215.1 to 7.0.0-preview.4.22215.2][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/2bb30de...ff8cb04\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6439)","Url":"https://github.com/dotnet/wpf/pull/6439","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6439)"},{"Id":"1205599460","IsPullRequest":false,"CreatedAt":"2022-04-15T13:57:43","Actor":"paulrozhkin","Number":"6440","RawContent":null,"Title":"TabStripPlacement binding exception in TabItem","State":"open","Body":"* .NET Core Version: 6.0.100\r\n* Windows version: Windows 10 Version 20H2 (OS Build 19042.1645)\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n \r\n **Problem description:**\r\nBinding failure occurs when removing last item (last tab) from TabControl. This is independent of whether MVVM or code behind is being used.\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\nWhen deleting the last tab I get an error:\r\n```\r\nBinding Path: TabStripPlacement;\r\nTarget: TabItem; \r\nDescription: Cannot find source: RelativeSource FindAncestor, AncestorType='System.Windows.Controls.TabControl', AncestorLevel='1'\r\n```\r\n **Expected behavior:**\r\nBinding exception does not occur \r\n\r\n **Minimal repro:**\r\nDelete tabs with buttons \"Remove last\" or \"Remove all\"\r\nMainWindow.xaml:\r\n```\r\n<Window x:Class=\"TabControlBug.MainWindow\"\r\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\r\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\r\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\r\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\r\n        mc:Ignorable=\"d\"\r\n        Title=\"MainWindow\" Height=\"450\" Width=\"800\">\r\n    <Grid Margin=\"0,0,10,10\">\r\n        <Grid>\r\n            <Grid.RowDefinitions>\r\n                <RowDefinition />\r\n                <RowDefinition Height=\"Auto\" />\r\n            </Grid.RowDefinitions>\r\n\r\n            <TabControl x:Name=\"TabControl\" Margin=\"10,10,0,0\">\r\n\r\n                <TabControl.ContentTemplate>\r\n                    <DataTemplate>\r\n                        <Grid>\r\n                            <TextBox Text=\"{Binding Text}\" FontSize=\"16\" AcceptsReturn=\"True\"\r\n                                     HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\" />\r\n                        </Grid>\r\n                    </DataTemplate>\r\n                </TabControl.ContentTemplate>\r\n\r\n                <TabControl.ItemTemplate>\r\n                    <DataTemplate>\r\n                        <TextBlock Text=\"{Binding Header}\" />\r\n                    </DataTemplate>\r\n                </TabControl.ItemTemplate>\r\n            </TabControl>\r\n\r\n            <StackPanel Grid.Row=\"1\" Orientation=\"Horizontal\">\r\n                <Button Content=\"Add\"\r\n                        Margin=\"20 0 0 0\"\r\n                        Height=\"22\" Click=\"Add_OnClick\" />\r\n                <Button Content=\"Remove last\"\r\n                        Margin=\"20 0 0 0\"\r\n                        Height=\"22\" Click=\"RemoveLast_OnClick\"/>\r\n                <Button Content=\"Remove all\"\r\n                        Margin=\"20 0 0 0\"\r\n                        Height=\"22\" Click=\"RemoveAll_OnClick\" />\r\n            </StackPanel>\r\n\r\n        </Grid>\r\n    </Grid>\r\n</Window>\r\n``` \r\nMainWindow.xaml.cs:\r\n```\r\nusing System;\r\nusing System.Windows;\r\n\r\nnamespace TabControlBug\r\n{\r\n    public partial class MainWindow\r\n    {\r\n        public MainWindow()\r\n        {\r\n            InitializeComponent();\r\n            AddItem();\r\n            AddItem();\r\n            AddItem();\r\n        }\r\n\r\n        private void Add_OnClick(object sender, RoutedEventArgs e)\r\n        {\r\n            AddItem();\r\n        }\r\n\r\n        private void RemoveLast_OnClick(object sender, RoutedEventArgs e)\r\n        {\r\n            if (TabControl.Items.Count > 0)\r\n            {\r\n                TabControl.Items.RemoveAt(TabControl.Items.Count - 1);\r\n            }\r\n        }\r\n\r\n        private void RemoveAll_OnClick(object sender, RoutedEventArgs e)\r\n        {\r\n            TabControl.Items.Clear();\r\n        }\r\n\r\n        private void AddItem()\r\n        {\r\n            var newItem = new TabItemViewModel\r\n            {\r\n                Header = Guid.NewGuid().ToString().Substring(0, 3),\r\n                Text = Guid.NewGuid().ToString()\r\n            };\r\n\r\n            TabControl.Items.Add(newItem);\r\n        }\r\n    }\r\n}\r\n```\r\nTabItemViewModel.cs:\r\n```\r\nusing System.ComponentModel;\r\nusing System.Runtime.CompilerServices;\r\nusing TabControlBug.Annotations;\r\n\r\nnamespace TabControlBug\r\n{\r\n    public class TabItemViewModel : INotifyPropertyChanged\r\n    {\r\n        private string _text;\r\n        private string _header;\r\n\r\n        public string Header\r\n        {\r\n            get => _header;\r\n            set\r\n            {\r\n                _header = value;\r\n                OnPropertyChanged(nameof(Header));\r\n            }\r\n        }\r\n\r\n        public string Text\r\n        {\r\n            get => _text;\r\n            set\r\n            {\r\n                _text = value;\r\n                OnPropertyChanged(nameof(Text));\r\n            }\r\n        }\r\n\r\n        public event PropertyChangedEventHandler? PropertyChanged;\r\n\r\n        [NotifyPropertyChangedInvocator]\r\n        protected virtual void OnPropertyChanged([CallerMemberName] string? propertyName = null)\r\n        {\r\n            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\r\n        }\r\n    }\r\n}\r\n```","Url":"https://github.com/dotnet/wpf/issues/6440","RelatedDescription":"Open issue \"TabStripPlacement binding exception in TabItem\" (#6440)"},{"Id":"1205542791","IsPullRequest":true,"CreatedAt":"2022-04-15T12:52:20","Actor":"dotnet-maestro[bot]","Number":"6438","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220414.3\r\n- **Date Produced**: April 14, 2022 4:28:23 PM UTC\r\n- **Commit**: 5ef2983363df5e0d85181b2948e2a5b0c16aa41a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22213.2 to 7.0.0-beta.22214.3][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22213.2 to 7.0.0-beta.22214.3][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22213.2 to 7.0.0-beta.22214.3][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22213.2 to 7.0.0-beta.22214.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22213.2 to 7.0.0-beta.22214.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/4ec0b54...5ef2983\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6438)","Url":"https://github.com/dotnet/wpf/pull/6438","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6438)"},{"Id":"1205373685","IsPullRequest":true,"CreatedAt":"2022-04-15T08:37:04","Actor":"dotnet-maestro[bot]","Number":"6437","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220415.1\r\n- **Date Produced**: April 15, 2022 7:48:40 AM UTC\r\n- **Commit**: 2bb30de28bd22ac58c9200141df2b4c86701ea5e\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22214.5 to 7.0.0-preview.4.22215.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22214.5 to 7.0.0-preview.4.22215.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/3113659...2bb30de\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6437)","Url":"https://github.com/dotnet/wpf/pull/6437","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6437)"},{"Id":"1205250308","IsPullRequest":true,"CreatedAt":"2022-04-15T04:49:15","Actor":"dotnet-maestro[bot]","Number":"6436","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220414.5\r\n- **Date Produced**: April 15, 2022 4:05:54 AM UTC\r\n- **Commit**: 3113659b01ea492d0a746c5addc3a6819607c6a0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22214.1 to 7.0.0-preview.4.22214.5][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22214.1 to 7.0.0-preview.4.22214.5][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/94dc5b3...3113659\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6436)","Url":"https://github.com/dotnet/wpf/pull/6436","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6436)"},{"Id":"1204922029","IsPullRequest":false,"CreatedAt":"2022-04-14T19:55:23","Actor":"raffaeler","Number":"6434","RawContent":null,"Title":"Enable WPF to play well with Dependency Injection","State":"open","Body":"I created my own framework to use Dependency Injection in WPF. This is done using the ASP.NET infrastructure.\r\nI can inject pages, viewmodels and many other types, but the WPF infrastructure does not allow to inject, for example, converters or markup extensions.\r\n\r\nMarkup extensions provide an IServiceProvider which we can't access elsewhere.\r\n\r\nThis issue is about a two-phase request:\r\n- Step 1 (short-term): Ability to provide to WPF a user-provided IServiceProvider, so that I can retrieve my objects within a markup extension.\r\n- Step 2 (long-term): Embrace the ASP.NET DI infrastructure so that we can access configurations within converters, controls, behaviors, etc. \r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/6434","RelatedDescription":"Open issue \"Enable WPF to play well with Dependency Injection\" (#6434)"},{"Id":"1204820297","IsPullRequest":false,"CreatedAt":"2022-04-14T17:57:29","Actor":"mol","Number":"6433","RawContent":null,"Title":"NullReferenceException in PopupSecurityHelper started appearing yesterday (with .NET Core 3.1.24 update?) for hundreds of users so far","State":"open","Body":"* .NET Core Version: **3.1.24.**\r\n* Windows version: ~~**10 and 11 so far.**~~ **10.0.22598 (Windows 11 Insider Preview)**.\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: **Unable to reproduce so far. Just seeing hundreds of bug reports coming in from our users.**\r\n* Is this bug related specifically to tooling in Visual Studio (e.g. XAML Designer, Code editing, etc...)? **No.**\r\n\r\n <!-- Read https://github.com/dotnet/wpf/blob/main/Documentation/issue-guide.md -->\r\n \r\n **Problem description:**\r\nYesterday, April 13, coinciding with a number of Windows updates rolling out (in particular I think .NET Core 3.1.24 is the culprit) we started seeing crashes of our application, [Mailbird](www.getmailbird.com), coming in from first a few users, but today hundreds.\r\n\r\nStack traces are entirely in .NET code and we've released no update to Mailbird in several weeks. Looking at the change log for .NET Core 3.1.24 I see two PR's that make changes that \"fit\" the stack traces: https://github.com/dotnet/wpf/pull/6020 and https://github.com/dotnet/wpf/pull/6017.\r\n\r\n\r\n **Actual behavior:**\r\nSince it's the Dispatcher, the application crashes. A few of the stack traces we're seeing (all end the same place):\r\n```\r\nSystem.NullReferenceException: Object reference not set to an instance of an object.\r\n  Module \"System.Windows.Controls.Primitives.Popup+PopupSecurityHelper\", in get_Handle\r\n  Module \"System.Windows.Controls.Primitives.Popup+PopupSecurityHelper\", in RegisterForTooltipDismissNotification\r\n  Module \"System.Windows.Controls.PopupControlService\", in CloseToolTip\r\n  Module \"System.Windows.Controls.PopupControlService\", in OnMouseMove\r\n  Module \"System.Windows.Controls.PopupControlService\", in OnPostProcessInput\r\n  Module \"System.Windows.Input.InputManager\", in RaiseProcessInputEventHandlers\r\n  Module \"System.Windows.Input.InputManager\", in ProcessStagingArea\r\n  Module \"System.Windows.Input.InputManager\", in ProcessInput\r\n  Module \"System.Windows.Input.InputProviderSite\", in ReportInput\r\n  Module \"System.Windows.Interop.HwndMouseInputProvider\", in ReportInput\r\n  Module \"System.Windows.Interop.HwndMouseInputProvider\", in FilterMessage\r\n  Module \"System.Windows.Interop.HwndSource\", in InputFilterMessage\r\n  Module \"MS.Win32.HwndWrapper\", in WndProc\r\n  Module \"MS.Win32.HwndSubclass\", in DispatcherCallbackOperation\r\n  Module \"System.Windows.Threading.ExceptionWrapper\", in InternalRealCall\r\n  Module \"System.Windows.Threading.ExceptionWrapper\", in TryCatchWhen\r\n```\r\n```\r\nSystem.NullReferenceException: Object reference not set to an instance of an object.\r\n  Module \"System.Windows.Controls.Primitives.Popup+PopupSecurityHelper\", in get_Handle\r\n  Module \"System.Windows.Controls.Primitives.Popup+PopupSecurityHelper\", in RegisterForTooltipDismissNotification\r\n  Module \"System.Windows.Controls.PopupControlService\", in CloseToolTip\r\n  Module \"System.Windows.Controls.PopupControlService\", in OnMouseMove\r\n  Module \"System.Windows.Controls.PopupControlService\", in OnPostProcessInput\r\n  Module \"System.Windows.Input.InputManager\", in RaiseProcessInputEventHandlers\r\n  Module \"System.Windows.Input.InputManager\", in ProcessStagingArea\r\n  Module \"System.Windows.Input.InputManager\", in ProcessInput\r\n  Module \"System.Windows.Input.MouseDevice\", in Synchronize\r\n  Module \"System.Windows.Input.InputManager\", in HitTestInvalidatedAsyncCallback\r\n  Module \"System.Windows.Threading.ExceptionWrapper\", in InternalRealCall\r\n  Module \"System.Windows.Threading.ExceptionWrapper\", in TryCatchWhen\r\n```\r\n```\r\nSystem.NullReferenceException: La référence d'objet n'est pas définie à une instance d'un objet.\r\nà System.Windows.Controls.Primitives.Popup.PopupSecurityHelper.get_Handle()\r\nà System.Windows.Controls.Primitives.Popup.PopupSecurityHelper.RegisterForTooltipDismissNotification(UInt32 flag)\r\nà System.Windows.Controls.PopupControlService.CloseToolTip(ToolTip tooltip)\r\nà System.Windows.Controls.PopupControlService.OnPostProcessInput(Object sender, ProcessInputEventArgs e)\r\nà System.Windows.Input.InputManager.RaiseProcessInputEventHandlers(ProcessInputEventHandler postProcessInput, ProcessInputEventArgs processInputEventArgs)\r\nà System.Windows.Input.InputManager.ProcessStagingArea()\r\nà System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)\r\nà System.Windows.Input.MouseDevice.Synchronize()\r\nà System.Windows.Input.MouseDevice.ChangeMouseCapture(IInputElement mouseCapture, IMouseInputProvider providerCapture, CaptureMode captureMode, Int32 timestamp)\r\nà System.Windows.Input.MouseDevice.Capture(IInputElement element, CaptureMode captureMode)\r\nà System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonDown(MouseButtonEventArgs e)\r\nà System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)\r\nà System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)\r\nà System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\nà System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)\r\nà System.Windows.UIElement.OnMouseDownThunk(Object sender, MouseButtonEventArgs e)\r\nà System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)\r\nà System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)\r\nà System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\nà System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\r\nà System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)\r\nà System.Windows.Input.InputManager.ProcessStagingArea()\r\nà System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)\r\nà System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)\r\nà System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)\r\nà System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nà System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nà MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\r\nà MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\r\nà System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\nà System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n```\r\n \r\n **Expected behavior:**\r\nNo `System.NullReferenceException` should be thrown.\r\n \r\n **Minimal repro:**\r\nAs of yet we've been unable to reproduce. It seems random in terms of when and where it happens, but looking at the stack traces it seems to happen when tooltips are closed.","Url":"https://github.com/dotnet/wpf/issues/6433","RelatedDescription":"Open issue \"NullReferenceException in PopupSecurityHelper started appearing yesterday (with .NET Core 3.1.24 update?) for hundreds of users so far\" (#6433)"},{"Id":"1204571337","IsPullRequest":true,"CreatedAt":"2022-04-14T14:29:40","Actor":"dotnet-maestro[bot]","Number":"6432","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220414.1\r\n- **Date Produced**: April 14, 2022 1:38:13 PM UTC\r\n- **Commit**: 94dc5b303a3b441767007aa0f2bcd9d048bf1c17\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22213.1 to 7.0.0-preview.4.22214.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22213.1 to 7.0.0-preview.4.22214.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/8dfd08d...94dc5b3\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6432)","Url":"https://github.com/dotnet/wpf/pull/6432","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6432)"},{"Id":"1204472521","IsPullRequest":true,"CreatedAt":"2022-04-14T12:58:56","Actor":"dotnet-maestro[bot]","Number":"6430","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220413.2\r\n- **Date Produced**: April 13, 2022 4:15:41 PM UTC\r\n- **Commit**: 4ec0b54a25d4e2129e8b34f60b4489e325421cb7\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22212.2 to 7.0.0-beta.22213.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22212.2 to 7.0.0-beta.22213.2][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22212.2 to 7.0.0-beta.22213.2][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22212.2 to 7.0.0-beta.22213.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22212.2 to 7.0.0-beta.22213.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/2e24ed0...4ec0b54\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6430)","Url":"https://github.com/dotnet/wpf/pull/6430","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6430)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-04-20T03:30:28.5900368Z","RunDurationInMilliseconds":448}