{"Data":{"GitHub":{"Issues":[{"Id":"1597819857","IsPullRequest":true,"CreatedAt":"2023-02-24T03:01:19","Actor":"dotnet-maestro[bot]","Number":"7569","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230223.3\r\n- **Date Produced**: February 23, 2023 10:52:20 PM UTC\r\n- **Commit**: 98795364c9caaf4f0fe7275027d3eb5a34363270\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23122.1 to 8.0.0-preview.2.23123.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23122.1 to 8.0.0-preview.2.23123.3][1]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23120.6 to 8.0.0-preview.2.23123.1][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/bba30b5...9879536\r\n[2]: https://github.com/dotnet/runtime/compare/75eac96...af18fd0\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7569)","Url":"https://github.com/dotnet/wpf/pull/7569","RelatedDescription":"Open PR \"[main] Update dependencies from dotnet/winforms\" (#7569)"},{"Id":"1596398644","IsPullRequest":true,"CreatedAt":"2023-02-23T08:06:53","Actor":"pchaurasia14","Number":"7568","RawContent":null,"Title":"Disposing page stream eagerly","State":"open","Body":"Fixes #7567 \r\n\r\n## Description\r\nStream is not explicitly disposed when retrieving page contents. This causes stream to stay open even when the usage is over. The next iteration of the same code path then throws the error since it sees that the underlying stream is already open.\r\n\r\n## Customer Impact\r\nUnable to search when using docviewer control\r\n\r\n## Regression\r\nDon't know.\r\n\r\n## Testing\r\n\r\nUnder testing. \r\n\r\n## Risk\r\nLow. Since the scope of the stream is anyways local.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7568)","Url":"https://github.com/dotnet/wpf/pull/7568","RelatedDescription":"Open PR \"Disposing page stream eagerly\" (#7568)"},{"Id":"1596386466","IsPullRequest":false,"CreatedAt":"2023-02-23T07:55:54","Actor":"pchaurasia14","Number":"7567","RawContent":null,"Title":"IOException using WPF DocumentViewer to search contents","State":"open","Body":"### Description\n\nWhen using DocumentViewer control, repeated search for any text throws an IOException.\r\n\r\n```\r\nMessage - \r\n    System.IO.IOException: 'Entries cannot be opened multiple times in Update mode\r\nStack Trace -\r\n    at System.IO.Compression.ZipArchiveEntry.OpenInUpdateMode()\r\n   at System.IO.Compression.ZipArchiveEntry.Open()\r\n   at System.IO.Packaging.ZipStreamManager.Open(ZipArchiveEntry zipArchiveEntry, FileMode streamFileMode, FileAccess streamFileAccess)\r\n   at System.IO.Packaging.ZipPackagePart.GetStreamCore(FileMode streamFileMode, FileAccess streamFileAccess)\r\n   at System.IO.Packaging.PackagePart.GetStream(FileMode mode, FileAccess access)\r\n   at MS.Internal.IO.Packaging.PackagePartExtensions.GetSeekableStream(PackagePart packPart, FileMode mode, FileAccess access)\r\n   at System.IO.Packaging.PackWebResponse.CachedResponse.GetResponseStream()\r\n   at System.IO.Packaging.PackWebResponse.GetResponseStream()\r\n   at MS.Internal.WpfWebRequestHelper.CreateRequestAndGetResponseStream(Uri uri)\r\n   at System.Windows.Documents.PageContent.GetPageStream()\r\n   at System.Windows.Documents.FixedFindEngine._GetPageString(FixedDocument doc, Int32 translatedPageNo, Boolean replaceAlefWithAlefHamza)\r\n   at System.Windows.Documents.FixedFindEngine.Find(ITextPointer start, ITextPointer end, String findPattern, CultureInfo cultureInfo, Boolean matchCase, Boolean matchWholeWord, Boolean matchLast, Boolean matchDiacritics, Boolean matchKashida, Boolean matchAlefHamza)\r\n   at System.Windows.Documents.TextFindEngine.Find(ITextPointer findContainerStartPosition, ITextPointer findContainerEndPosition, String findPattern, FindFlags flags, CultureInfo cultureInfo)\r\n   at MS.Internal.Documents.DocumentViewerHelper.Find(FindToolBar findToolBar, TextEditor textEditor, ITextView textView, ITextView masterPageTextView)\r\n   at System.Windows.Controls.Primitives.DocumentViewerBase.Find(FindToolBar findToolBar)\r\n   at System.Windows.Controls.DocumentViewer.OnFindInvoked(Object sender, EventArgs e)\r\n   at MS.Internal.Documents.FindToolBar.OnFindTextBoxPreviewKeyDown(Object sender, KeyEventArgs e)\r\n   at System.Windows.Input.KeyEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)\r\n   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)\r\n   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)\r\n   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)\r\n   at System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)\r\n   at System.Windows.Input.InputManager.ProcessStagingArea()\r\n   at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)\r\n   at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)\r\n   at System.Windows.Interop.HwndKeyboardInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawKeyboardActions actions, Int32 scanCode, Boolean isExtendedKey, Boolean isSystemKey, Int32 virtualKey)\r\n   at System.Windows.Interop.HwndKeyboardInputProvider.ProcessKeyAction(MSG& msg, Boolean& handled)\r\n   at System.Windows.Interop.HwndSource.CriticalTranslateAccelerator(MSG& msg, ModifierKeys modifiers)\r\n   at System.Windows.Interop.HwndSource.OnPreprocessMessage(Object param)\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n   at System.Windows.Threading.Dispatcher.LegacyInvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)\r\n   at System.Windows.Interop.HwndSource.OnPreprocessMessageThunk(MSG& msg, Boolean& handled)\r\n   at System.Windows.Interop.HwndSource.WeakEventPreprocessMessage.OnPreprocessMessage(MSG& msg, Boolean& handled)\r\n   at System.Windows.Interop.ThreadMessageEventHandler.Invoke(MSG& msg, Boolean& handled)\r\n   at System.Windows.Interop.ComponentDispatcherThread.RaiseThreadMessage(MSG& msg)\r\n   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\r\n   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\r\n   at System.Windows.Threading.Dispatcher.Run()\r\n   at System.Windows.Application.RunDispatcher(Object ignore)\r\n   at System.Windows.Application.RunInternal(Window window)\r\n   at System.Windows.Application.Run()\r\n   at DocumentViewerException.App.Main()\r\n```\n\n### Reproduction Steps\n\n1. Use a machine with Visual Studio 2022\r\n2. Unzip the attached sample DocumentViewerExceptionRepro.zip\r\n3. Build and run the application\r\n4. At the bottom of the main window there is a search control\r\n5. search for any string and press the same search button multiple times\n\n### Expected behavior\n\nShould not throw exception\n\n### Actual behavior\n\nThrows exception\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Impact\n\n_No response_\n\n### Configuration\n\n.NET Core 6,  7\n\n### Other information\n\n[DocumentViewerException.zip](https://github.com/dotnet/wpf/files/10811340/DocumentViewerException.zip)\r\n","Url":"https://github.com/dotnet/wpf/issues/7567","RelatedDescription":"Open issue \"IOException using WPF DocumentViewer to search contents\" (#7567)"},{"Id":"1596135456","IsPullRequest":true,"CreatedAt":"2023-02-23T03:36:54","Actor":"dotnet-maestro[bot]","Number":"7566","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230222.1\r\n- **Date Produced**: February 22, 2023 6:06:02 PM UTC\r\n- **Commit**: bba30b55a0ba2a5268709b8c616dc5e2cd2dc6a8\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23121.7 to 8.0.0-preview.2.23122.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23121.7 to 8.0.0-preview.2.23122.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/46195b1...bba30b5\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7566)","Url":"https://github.com/dotnet/wpf/pull/7566","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7566)"},{"Id":"1594956986","IsPullRequest":false,"CreatedAt":"2023-02-22T11:41:48","Actor":"pchaurasia14","Number":"7563","RawContent":null,"Title":"Support for nullability annotations","State":"open","Body":"Based on [community feedback](https://github.com/dotnet/wpf/discussions/7555#discussioncomment-5053915), here is the first draft on support nullability annotations.\r\n\r\nList of assemblies - \r\n\r\n- [ ] System.Xaml\r\n- [ ] WindowsBase\r\n- [ ] PresentationCore\r\n- [ ] PresentationFramework\r\n- [ ] UIAutomation\r\n- [ ] UIAutomationClient\r\n- [ ] UIAutomationClientSideProviders\r\n- [ ] UIAutomationProvider\r\n- [ ] UIAutomationTypes\r\n- [ ] ReachFramework\r\n- [ ] PresentationUI\r\n- [ ] System.Windows.Controls.Ribbon\r\n- [ ] WindowsFormsIntegration\r\n- [ ] System.Windows.Input.Manipulations\r\n\r\nWe will provide a clearer breakdown as well as grouping of the work in next 2-3 weeks. \r\n\r\nThanks @dotMorten for the [suggestion](https://github.com/dotnet/wpf/discussions/7555#discussioncomment-5072812) ","Url":"https://github.com/dotnet/wpf/issues/7563","RelatedDescription":"Open issue \"Support for nullability annotations\" (#7563)"},{"Id":"1594894578","IsPullRequest":false,"CreatedAt":"2023-02-22T10:58:47","Actor":"Kation","Number":"7562","RawContent":null,"Title":"DictionaryKeyPropertyAttribute not working","State":"open","Body":"### Description\r\n\r\nClass define with `DictionaryKeyPropertyAttribute` still show `All objects added to an IDictionary must have a Key attribute or some other type of key associated with them.` error while building project.\r\n\r\n### Reproduction Steps\r\n\r\nDefine a class with `DictionaryKeyPropertyAttribute`.\r\n```\r\n[DictionaryKeyProperty(\"TargetType\")]\r\npublic class MyStyle\r\n{\r\n    public MyStyle()\r\n    {\r\n\r\n    }\r\n\r\n    public Type TargetType { get; set; }\r\n}\r\n```\r\nUse it in a xaml file.\r\n```\r\n<Window x:Class=\"WpfApp1.MainWindow\"\r\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\r\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\r\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\r\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\r\n        xmlns:local=\"clr-namespace:WpfApp1\"\r\n        xmlns:my=\"clr-namespace:WpfLibrary1;assembly=WpfLibrary1\"\r\n        mc:Ignorable=\"d\"\r\n        Title=\"MainWindow\" Height=\"450\" Width=\"800\">\r\n    <Window.Resources>\r\n        <ResourceDictionary>\r\n            <my:MyStyle TargetType=\"{x:Type Butt\r\n[WpfApp1.zip](https://github.com/dotnet/wpf/files/10802917/WpfApp1.zip)\r\non}\"/>\r\n        </ResourceDictionary>\r\n    </Window.Resources>\r\n    <Grid>\r\n    </Grid>\r\n</Window>\r\n```\r\n\r\n### Expected behavior\r\n\r\nBuild successful\r\n\r\n### Actual behavior\r\n\r\nBuild failed\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Impact\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n_No response_\r\n\r\n### Other information\r\n\r\n[WpfApp1.zip](https://github.com/dotnet/wpf/files/10802921/WpfApp1.zip)\r\n","Url":"https://github.com/dotnet/wpf/issues/7562","RelatedDescription":"Open issue \"DictionaryKeyPropertyAttribute not working\" (#7562)"},{"Id":"1594729894","IsPullRequest":false,"CreatedAt":"2023-02-22T09:10:43","Actor":"lindexi","Number":"7561","RawContent":null,"Title":"WPF known issues: the window be activated after dpi changed","State":"open","Body":"### Description\r\n\r\nThe inactive window in WPF will be activated after the dpi changed. And I am not sure if this behavior is a bug.\r\n\r\nWhy?\r\n\r\nThe HwndTarget will call the SetWindowPos in `OnDpiChanged`, see\r\n\r\nhttps://github.com/dotnet/wpf/blob/c37ab558d3aebf3bfe0038c86e8a4be78d09e03c/src/Microsoft.DotNet.Wpf/src/PresentationCore/System/Windows/InterOp/HwndTarget.cs#L1753-L1770\r\n\r\nBut seems like it forgot to set the SWP_NOACTIVATE parameter. As the https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowpos documents says: SWP_NOACTIVATE means does not activate the window. If this flag is not set, the window is activated and moved to the top of either the topmost or non-topmost group (depending on the setting of the hWndInsertAfter parameter).\r\n\r\n### Reproduction Steps\r\n\r\n1. Create an empty wpf project and run the application.\r\n2. Deactive the main window\r\n3. Change the system dpi\r\n\r\n### Expected behavior\r\n\r\nThe main window will not be activated after dpi changed.\r\n\r\n### Actual behavior\r\n\r\nThe main window will be activated after dpi changed.\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Impact\r\n\r\nIt seems that everyone is used to this behavior\r\n\r\n### Configuration\r\n\r\n_No response_\r\n\r\n### Other information\r\n\r\n_No response_","Url":"https://github.com/dotnet/wpf/issues/7561","RelatedDescription":"Open issue \"WPF known issues: the window be activated after dpi changed\" (#7561)"},{"Id":"1594670230","IsPullRequest":true,"CreatedAt":"2023-02-22T08:27:19","Actor":"Kuldeep-MS","Number":"7560","RawContent":null,"Title":"Fixing the AssemblyName in temporary project file for GenerateTemporaryTargetAssembly task","State":"open","Body":"Fixes \r\n#5711\r\n#5576\r\n#5697\r\n\r\nMain PR https://github.com/dotnet/wpf/pull/7557\r\n\r\n## Description\r\n\r\nWhen running the `GenerateTemporaryTargetAssmebly` task, a temporary project file gets created from the user defined project and in the process of creation, two instances of `AssemblyName` gets inserted in the file. \r\n\r\nFirst instance will have evaluated value for assembly name (i.e. all the macros will be resolved) whereas second instance will still have the unresolved macros in the `AssemblyName`.\r\n\r\nIf `MSBuildProjectName` is being used computation of `AssemblyName`, it will cause MSBuild to pick current project name for naming the assembly and because temporary project file is being used we will have temporary project file name as assembly name and eventually no local references will be found in MarkupCompilation2.\r\n\r\nRemoving the second instance of `AssemblyName` from aforementioned project file resolves the issue as `MSBuild` will have only evaluated `AssemblyName`. \r\n\r\n## Customer Impact\r\n\r\nProjects are not building if `$(MSBuildProjectName)` is being used in `AssemblyName`\r\n\r\n## Regression\r\n\r\nYes\r\n\r\n## Testing\r\n\r\nIn Progress\r\n\r\n## Risk\r\n\r\nIn evaluation\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7560)","Url":"https://github.com/dotnet/wpf/pull/7560","RelatedDescription":"Open PR \"Fixing the AssemblyName in temporary project file for GenerateTemporaryTargetAssembly task\" (#7560)"},{"Id":"1594378734","IsPullRequest":true,"CreatedAt":"2023-02-22T03:31:53","Actor":"dotnet-maestro[bot]","Number":"7559","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230221.7\r\n- **Date Produced**: February 22, 2023 2:07:37 AM UTC\r\n- **Commit**: 46195b1c4ad995a32046cbeeeb8d650550685c28\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23119.3 to 8.0.0-preview.2.23121.7][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23119.3 to 8.0.0-preview.2.23121.7][1]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23118.4 to 8.0.0-preview.2.23120.6][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/e054841...46195b1\r\n[2]: https://github.com/dotnet/runtime/compare/edce5ea...75eac96\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7559)","Url":"https://github.com/dotnet/wpf/pull/7559","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7559)"},{"Id":"1593467634","IsPullRequest":true,"CreatedAt":"2023-02-21T13:55:50","Actor":"dotnet-maestro[bot]","Number":"7558","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20230220.1\r\n- **Date Produced**: February 20, 2023 5:36:56 PM UTC\r\n- **Commit**: c4a85adbff520f62bfade7a6132f471506c3d35a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 8.0.0-beta.23118.1 to 8.0.0-beta.23120.1][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23118.1 to 8.0.0-beta.23120.1][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 8.0.0-beta.23118.1 to 8.0.0-beta.23120.1][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 8.0.0-beta.23118.1 to 8.0.0-beta.23120.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23118.1 to 8.0.0-beta.23120.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/38d3196...c4a85ad\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7558)","Url":"https://github.com/dotnet/wpf/pull/7558","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7558)"},{"Id":"1593414774","IsPullRequest":true,"CreatedAt":"2023-02-21T12:42:53","Actor":"Kuldeep-MS","Number":"7557","RawContent":null,"Title":"Fixing the AssemblyName in temporary project file for GenerateTemporaryTargetAssembly task","State":"open","Body":"Fixes \r\n#5711\r\n#5576\r\n#5697\r\n\r\n## Description\r\n\r\nWhen running the `GenerateTemporaryTargetAssmebly` task, a temporary project file gets created from the user defined project and in the process of creation, two instances of `AssemblyName` gets inserted in the file. \r\n\r\nFirst instance will have evaluated value for assembly name (i.e. all the macros will be resolved) whereas second instance will still have the unresolved macros in the `AssemblyName`.\r\n\r\nIf `MSBuildProjectName` is being used computation of `AssemblyName`, it will cause MSBuild to pick current project name for naming the assembly and because temporary project file is being used we will have temporary project file name as assembly name and eventually no local references will be found in MarkupCompilation2.\r\n\r\nRemoving the second instance of `AssemblyName` from aforementioned project file resolves the issue as `MSBuild` will have only evaluated `AssemblyName`. \r\n\r\n## Customer Impact\r\n\r\nProjects are not building if `$(MSBuildProjectName)` is being used in `AssemblyName`\r\n\r\n## Regression\r\n\r\nYes\r\n\r\n## Testing\r\n\r\nIn Progress\r\n\r\n## Risk\r\n\r\nIn evaluation\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7557)","Url":"https://github.com/dotnet/wpf/pull/7557","RelatedDescription":"Open PR \"Fixing the AssemblyName in temporary project file for GenerateTemporaryTargetAssembly task\" (#7557)"},{"Id":"1592764984","IsPullRequest":true,"CreatedAt":"2023-02-21T04:37:40","Actor":"ThomasGoulet73","Number":"7556","RawContent":null,"Title":"Use project ChecksumAlgorithm in code-behind.","State":"open","Body":"Fixes dotnet/wpf#7348\r\n\r\n## Description\r\nUse the project ChecksumAlgorithm to generate `#pragma checksum` in code-behind using the correct algorithm.\r\n\r\n## Customer Impact\r\nProjects setting ChecksumAlgorithm will now generate `#pragma checksum` using the correct algorithm.\r\n\r\n## Regression\r\nNo.\r\n\r\n## Testing\r\nI used the repro project in dotnet/wpf#7348 to check the generated code.\r\n\r\n## Risk\r\nLow.\r\n\r\n\r\n/cc @swenkeratmicrosoft @tmat\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7556)","Url":"https://github.com/dotnet/wpf/pull/7556","RelatedDescription":"Open PR \"Use project ChecksumAlgorithm in code-behind.\" (#7556)"},{"Id":"1591889135","IsPullRequest":true,"CreatedAt":"2023-02-20T14:14:58","Actor":"pchaurasia14","Number":"7554","RawContent":null,"Title":"WPF roadmap 2023","State":"closed","Body":"Roadmap update.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7554)","Url":"https://github.com/dotnet/wpf/pull/7554","RelatedDescription":"Closed or merged PR \"WPF roadmap 2023\" (#7554)"},{"Id":"1590343074","IsPullRequest":true,"CreatedAt":"2023-02-20T06:25:44","Actor":"dotnet-maestro[bot]","Number":"7550","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20230218.1\r\n- **Date Produced**: February 18, 2023 5:58:34 PM UTC\r\n- **Commit**: 38d3196e1596eb525367ec8d65fcc1f30a58261c\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 8.0.0-beta.23115.1 to 8.0.0-beta.23118.1][2]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23115.1 to 8.0.0-beta.23118.1][2]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 8.0.0-beta.23115.1 to 8.0.0-beta.23118.1][2]\r\n  - **Microsoft.DotNet.GenAPI**: [from 8.0.0-beta.23115.1 to 8.0.0-beta.23118.1][2]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23115.1 to 8.0.0-beta.23118.1][2]\r\n\r\n[2]: https://github.com/dotnet/arcade/compare/83284ab...38d3196\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7550)\r\n","Url":"https://github.com/dotnet/wpf/pull/7550","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7550)"},{"Id":"1590540545","IsPullRequest":true,"CreatedAt":"2023-02-20T06:24:00","Actor":"dotnet-maestro[bot]","Number":"7551","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230219.3\r\n- **Date Produced**: February 19, 2023 5:33:55 PM UTC\r\n- **Commit**: e054841c9c2f3bc4ca4d4ae71835f16e434371ce\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23117.6 to 8.0.0-preview.2.23119.3][5]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23117.6 to 8.0.0-preview.2.23119.3][5]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23116.1 to 8.0.0-preview.2.23118.4][6]\r\n\r\n[5]: https://github.com/dotnet/winforms/compare/5b971a5...e054841\r\n[6]: https://github.com/dotnet/runtime/compare/f2f734a...edce5ea\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7551)\r\n\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/7551","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7551)"},{"Id":"1591159149","IsPullRequest":true,"CreatedAt":"2023-02-20T05:51:38","Actor":"singhashish-wpf","Number":"7553","RawContent":null,"Title":"Fix build errors due to specific build","State":"closed","Body":"Fix build errors due to specific build\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7553)","Url":"https://github.com/dotnet/wpf/pull/7553","RelatedDescription":"Closed or merged PR \"Fix build errors due to specific build\" (#7553)"},{"Id":"1591034856","IsPullRequest":true,"CreatedAt":"2023-02-20T02:57:02","Actor":"lindexi","Number":"7552","RawContent":null,"Title":"Fix NullReferenceException in DynamicRenderer","State":"open","Body":"Fixes #7537\r\n\r\n\r\n## Description\r\n\r\nThe `_applicationDispatcher` may be null with the thread-safe issues, see https://github.com/dotnet/wpf/issues/7537\r\n\r\nI use the argument instead of field to solve thread-safe issues.\r\n\r\n## Customer Impact\r\n\r\nFix #7537\r\n\r\n## Regression\r\n\r\nNone.\r\n\r\n## Testing\r\n\r\nCI and the [Demo](https://github.com/dotnet/wpf/files/10762876/PC-Test-develop-2.zip)\r\n\r\nBut I did not do enough testing.\r\n\r\n## Risk\r\n\r\nLow\r\n\r\n\r\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7552)","Url":"https://github.com/dotnet/wpf/pull/7552","RelatedDescription":"Open PR \"Fix NullReferenceException in DynamicRenderer\" (#7552)"},{"Id":"1590179481","IsPullRequest":true,"CreatedAt":"2023-02-18T04:37:54","Actor":"dotnet-maestro[bot]","Number":"7549","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230217.6\r\n- **Date Produced**: February 17, 2023 8:20:36 PM UTC\r\n- **Commit**: 5b971a53cbb1afe38cf990416bea69a5bcbb5d2a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23116.3 to 8.0.0-preview.2.23117.6][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23116.3 to 8.0.0-preview.2.23117.6][1]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23115.10 to 8.0.0-preview.2.23116.1][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/73281a8...5b971a5\r\n[2]: https://github.com/dotnet/runtime/compare/4f19d17...f2f734a\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7549)","Url":"https://github.com/dotnet/wpf/pull/7549","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7549)"},{"Id":"1588806935","IsPullRequest":true,"CreatedAt":"2023-02-17T06:10:20","Actor":"singhashish-wpf","Number":"7548","RawContent":null,"Title":"Feature","State":"closed","Body":"Fixes # <!-- Issue Number -->\r\n\r\nMain PR <!-- Link to PR if any that fixed this in the main branch. -->\r\n\r\n## Description\r\n\r\n<!-- Give a brief summary of the issue and how the pull request is fixing it. -->\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7548)","Url":"https://github.com/dotnet/wpf/pull/7548","RelatedDescription":"Closed or merged PR \"Feature\" (#7548)"},{"Id":"1588805023","IsPullRequest":true,"CreatedAt":"2023-02-17T06:07:43","Actor":"singhashish-wpf","Number":"7547","RawContent":null,"Title":"as","State":"closed","Body":"Fixes # <!-- Issue Number -->\r\n\r\nMain PR <!-- Link to PR if any that fixed this in the main branch. -->\r\n\r\n## Description\r\n\r\n<!-- Give a brief summary of the issue and how the pull request is fixing it. -->\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7547)","Url":"https://github.com/dotnet/wpf/pull/7547","RelatedDescription":"Closed or merged PR \"as\" (#7547)"},{"Id":"1588679207","IsPullRequest":true,"CreatedAt":"2023-02-17T03:37:02","Actor":"dotnet-maestro[bot]","Number":"7546","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230216.3\r\n- **Date Produced**: February 16, 2023 7:14:19 PM UTC\r\n- **Commit**: 73281a8a16ae9f79ca5e0fef39503336fe420341\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23115.5 to 8.0.0-preview.2.23116.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23115.5 to 8.0.0-preview.2.23116.3][1]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23114.16 to 8.0.0-preview.2.23115.10][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/c90f513...73281a8\r\n[2]: https://github.com/dotnet/runtime/compare/53bb518...4f19d17\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7546)","Url":"https://github.com/dotnet/wpf/pull/7546","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7546)"},{"Id":"1587795355","IsPullRequest":true,"CreatedAt":"2023-02-16T14:38:30","Actor":"miloush","Number":"7545","RawContent":null,"Title":"GlyphSerializer rounding fix","State":"open","Body":"Fixes #7499\r\n\r\nRelated: #6295\r\n\r\n## Description\r\n\r\n<!-- Give a brief summary of the issue and how the pull request is fixing it. -->\r\n\r\nPrevious rounding strategy\r\n1. did not calculate the error according to XPS specification\r\n2. updated error with shaping value when font value is used by the client\r\n\r\nThe PR fixes 1. by keeping track of total advance width (desired and rounded) and 2. by using the font advance width when no value is output to XPS.\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\n\r\nCustomers not taking this fix will see either gaps or overlapped characters when producing XPS with text. See #7499 for an example.\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\n\r\nYes. Introduced by #6295 trying to fix #6525. This PR addresses both issues.\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\n\r\nTested manually using repro projects for #6525 and #7499.\r\n\r\n![image](https://user-images.githubusercontent.com/10546952/219394733-1ea807a1-b03c-4133-8103-0f4a1ae35062.png)\r\n\r\n## Risk\r\n\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n\r\nSame risks as with #6295. This PR changes relative positioning of glyphs in a GlyphRun to match the bounding box, so it should not cause reflow of documents.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7545)","Url":"https://github.com/dotnet/wpf/pull/7545","RelatedDescription":"Open PR \"GlyphSerializer rounding fix\" (#7545)"},{"Id":"1587662997","IsPullRequest":true,"CreatedAt":"2023-02-16T13:56:37","Actor":"dotnet-maestro[bot]","Number":"7544","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20230215.1\r\n- **Date Produced**: February 15, 2023 4:22:46 PM UTC\r\n- **Commit**: 83284ab08840fe5f429ecd9fa935e81527023553\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 8.0.0-beta.23113.1 to 8.0.0-beta.23115.1][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 8.0.0-beta.23113.1 to 8.0.0-beta.23115.1][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 8.0.0-beta.23113.1 to 8.0.0-beta.23115.1][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 8.0.0-beta.23113.1 to 8.0.0-beta.23115.1][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 8.0.0-beta.23113.1 to 8.0.0-beta.23115.1][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/7b0fb0a...83284ab\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7544)","Url":"https://github.com/dotnet/wpf/pull/7544","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#7544)"},{"Id":"1587390822","IsPullRequest":true,"CreatedAt":"2023-02-16T10:07:11","Actor":"singhashish-wpf","Number":"7543","RawContent":null,"Title":"Add dotnet updated install script","State":"closed","Body":"Add dotnet updated install script for automation testing\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7543)","Url":"https://github.com/dotnet/wpf/pull/7543","RelatedDescription":"Closed or merged PR \"Add dotnet updated install script\" (#7543)"},{"Id":"1587276770","IsPullRequest":false,"CreatedAt":"2023-02-16T08:50:08","Actor":"tripleacoder","Number":"7542","RawContent":null,"Title":" System.Windows.ContextLayoutManager.UpdateLayout() throws KeyNotFoundException","State":"open","Body":"### Description\r\n\r\nI get this exception quite often in my .NET 4.8 WPF app. The error is sent from clients automatically and I do not know how to reproduce it, or from what part of the code it originates.\r\n\r\nI found a similar issue saying it had been fixed in 4.8:\r\n[https://github.com/dotnet/wpf/issues/2152]\r\n\r\n```\r\nSystem.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.\r\n   at MS.Internal.WeakDictionary`2.get_Item(TKey key)\r\n   at System.Windows.Automation.Peers.ItemPeersStorage`1.get_Item(Object item)\r\n   at System.Windows.Automation.Peers.ItemsControlAutomationPeer.GetChildrenCore()\r\n   at System.Windows.Automation.Peers.ListViewAutomationPeer.GetChildrenCore()\r\n   at System.Windows.Automation.Peers.AutomationPeer.EnsureChildren()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateChildrenInternal(Int32 invalidateLimit)\r\n   at System.Windows.Automation.Peers.ItemsControlAutomationPeer.UpdateChildren()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.Automation.Peers.AutomationPeer.UpdateSubtree()\r\n   at System.Windows.ContextLayoutManager.fireAutomationEvents()\r\n   at System.Windows.ContextLayoutManager.UpdateLayout()\r\n   at System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)\r\n   at System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()\r\n   at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks()\r\n   at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)\r\n   at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)\r\n```\r\n\r\n\r\n### Reproduction Steps\r\n\r\nDon't know.\r\n\r\n### Expected behavior\r\n\r\nNo exception\r\n\r\n### Actual behavior\r\n\r\nProgram crashes?\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Impact\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n.NET 4.8\r\nWindows 10\r\nx64\r\n\r\n### Other information\r\n\r\n_No response_","Url":"https://github.com/dotnet/wpf/issues/7542","RelatedDescription":"Open issue \" System.Windows.ContextLayoutManager.UpdateLayout() throws KeyNotFoundException\" (#7542)"},{"Id":"1587135519","IsPullRequest":true,"CreatedAt":"2023-02-16T08:25:15","Actor":"singhashish-wpf","Number":"7541","RawContent":null,"Title":"WPF Test Automation","State":"closed","Body":"Run feature tests on demand\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7541)","Url":"https://github.com/dotnet/wpf/pull/7541","RelatedDescription":"Closed or merged PR \"WPF Test Automation\" (#7541)"},{"Id":"1586919803","IsPullRequest":true,"CreatedAt":"2023-02-16T03:31:56","Actor":"dotnet-maestro[bot]","Number":"7540","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20230215.5\r\n- **Date Produced**: February 15, 2023 7:47:26 PM UTC\r\n- **Commit**: c90f5134458cfdfd67cdae0a3fcaf1a3b7f14cf0\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 8.0.0-preview.2.23114.8 to 8.0.0-preview.2.23115.5][1]\r\n  - **Microsoft.Private.Winforms**: [from 8.0.0-preview.2.23114.8 to 8.0.0-preview.2.23115.5][1]\r\n  - **System.CodeDom**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Diagnostics.EventLog**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.DirectoryServices**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Drawing.Common**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Security.Cryptography.Xml**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Security.Permissions**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Windows.Extensions**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.IO.Packaging**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **System.Resources.Extensions**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.8.0**: [from 8.0.0-preview.2.23113.11 to 8.0.0-preview.2.23114.16][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/5f78764...c90f513\r\n[2]: https://github.com/dotnet/runtime/compare/24193b7...53bb518\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7540)","Url":"https://github.com/dotnet/wpf/pull/7540","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#7540)"},{"Id":"1586294127","IsPullRequest":true,"CreatedAt":"2023-02-15T18:17:43","Actor":"dotnet-maestro[bot]","Number":"7539","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20230214.5\r\n- **Date Produced**: February 15, 2023 4:28:13 AM UTC\r\n- **Commit**: 0c93c1cb1ef9c9d5c1a59f4ab98c2f7e37f12197\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.23060.6 to 6.0.0-beta.23114.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.23060.6 to 6.0.0-beta.23114.5][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.23060.6 to 6.0.0-beta.23114.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.23060.6 to 6.0.0-beta.23114.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.23060.6 to 6.0.0-beta.23114.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/74b7648...0c93c1c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n- **Updates to .NET SDKs:**\r\n  - Updates sdk.version to 6.0.114\r\n  - Updates tools.dotnet to 6.0.114\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7539)","Url":"https://github.com/dotnet/wpf/pull/7539","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#7539)"},{"Id":"1586025884","IsPullRequest":true,"CreatedAt":"2023-02-15T15:29:50","Actor":"dotnet-maestro[bot]","Number":"7538","RawContent":null,"Title":"[release/7.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:e96ced2d-df2c-460a-8163-08da7ef6284d)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: e96ced2d-df2c-460a-8163-08da7ef6284d\r\n- **Build**: 20230214.3\r\n- **Date Produced**: February 14, 2023 11:41:01 PM UTC\r\n- **Commit**: 4625a29565a94d3b8c5c680c8f1f1d53b2f216f5\r\n- **Branch**: refs/heads/release/7.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.23060.4 to 7.0.0-beta.23114.3][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.23060.4 to 7.0.0-beta.23114.3][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.23060.4 to 7.0.0-beta.23114.3][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.23060.4 to 7.0.0-beta.23114.3][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.23060.4 to 7.0.0-beta.23114.3][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/ac5977e...4625a29\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n- **Updates to .NET SDKs:**\r\n  - Updates sdk.version to 7.0.103\r\n  - Updates tools.dotnet to 7.0.103\r\n\r\n[marker]: <> (End:e96ced2d-df2c-460a-8163-08da7ef6284d)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/7538)","Url":"https://github.com/dotnet/wpf/pull/7538","RelatedDescription":"Closed or merged PR \"[release/7.0] Update dependencies from dotnet/arcade\" (#7538)"},{"Id":"1585792782","IsPullRequest":false,"CreatedAt":"2023-02-15T12:42:00","Actor":"jaelys","Number":"7537","RawContent":null,"Title":"InkCanvas.DynamicRenderer set different custom DynamicRenderer multiple times, throw an exception","State":"open","Body":"### Description\r\nWhen using the touch screen, errors will occur, but not when using the mouse\r\n\r\nOn the touch screen, the two buttons switch and click multiple times to set a custom Dynamic Renderer for InkCanvas.DynamicRenderer. The crash always occurs after DrawPen OnRemoved\r\n\r\nButton(DrawPen)Button(DrawArrow)\r\n\r\n`var dr = name switch\r\n                {                    \r\n                    \"GeneralPen\" => new DrawPen(this),                   \r\n                    \"ArrowPen\" => new DrawArrow(this),                                \r\n                    _ => new DrawPen(this),\r\n                };   \r\n           \r\n DynamicRenderer = dr;\r\n`\r\n\r\nIf set different custom DynamicRenderer multiple times, throw an exception\r\n\r\n`App_DispatcherUnhandledException--Object reference not set to an instance of an object.\r\n at System.Windows.Input.StylusPlugIns.DynamicRenderer.TransitionComplete(StrokeInfo si)\r\n   at System.Windows.Input.StylusPlugIns.DynamicRenderer.<>c__DisplayClass19_0.<NotifyAppOfDRThreadRenderComplete>b__0(Object unused)\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)`\r\n\r\n[PC-Test-develop-2.zip](https://github.com/dotnet/wpf/files/10762876/PC-Test-develop-2.zip)\r\n\r\n### Reproduction Steps\r\n\r\nDitto description\r\n\r\n### Expected behavior\r\n\r\nNo exception will be thrown\r\n\r\n### Actual behavior\r\n\r\nThrow thread exception\r\n\r\n### Regression?\r\n\r\n_No response_\r\n\r\n### Known Workarounds\r\n\r\n_No response_\r\n\r\n### Impact\r\n\r\n_No response_\r\n\r\n### Configuration\r\n\r\n.NET Core Version: .NET 7.0.103 SDK\r\nWindows version: Version 22H2 (OS Build 19045.2546)\r\n\r\n### Other information\r\n\r\n_No response_","Url":"https://github.com/dotnet/wpf/issues/7537","RelatedDescription":"Open issue \"InkCanvas.DynamicRenderer set different custom DynamicRenderer multiple times, throw an exception\" (#7537)"}],"ResultType":"GitHubIssue"}},"RunOn":"2023-02-24T03:30:33.3685724Z","RunDurationInMilliseconds":591}