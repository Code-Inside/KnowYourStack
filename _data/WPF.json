{"Data":{"GitHub":{"Issues":[{"Id":"2617025245","IsPullRequest":false,"CreatedAt":"2024-10-28T01:03:33","Actor":"ShannonZ","Number":"10005","RawContent":null,"Title":"Memory leak on some graphic cards","State":"open","Body":"### Description\n\n [Here](https://github.com/ShannonZ/playground) is a minimal reproducible demo. \nThere is a **rapid memory increment after clicking the minimize button**. I've tested this problem with different graphic cards (integrated and discrete ). Until now, the following cards could reproduce the memory leak issue:\n\n- NVIDIA GeForce GTX 1650\n- NVIDIA GeForce GTX 3050\n- NVidia Geforce GT 710\n- ATI 6750\n- Intel UHD 630 Graphics (integrated with i7-9700)\n\nI've also tested the problem on different OSes (win10 LTSC2018-2022, win10 home, win 11 home) and .NET versions (framework 4.5 4.6 4.7 4.8, dotnet6 8).  Unfortunately, all these software conditions have the same problem.\n\nFor Intel UHD 630, driver versions from old 27.x to the latest 30.x were tested, no help.\n\n[3GB version dump file](https://drive.google.com/file/d/1QV4osqoLkoK2fmPcCp7qvhaWji63bejX/view?usp=sharing)\n\n\n\n\n### Reproduction Steps\n\n[This video](https://drive.google.com/file/d/1M__dGl626e1GMHajEe12PMH9UUJxCmIf/view?usp=sharing) is a step-by-step example demonstrating how to reproduce this issue.\n\n### Expected behavior\n\nThere should be no memory leaks when running on different graphics cards.\n\n### Actual behavior\n\nMemory leaks occur when running on some graphics cards.\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n1. Comment the `WindowChrome` part out in Style could solve the leak problem. But I don't know why; (No minimization button, should press win+D to minimize the window)\n![image](https://github.com/user-attachments/assets/14e0be46-aef9-4357-a817-699675dbc73d);\n2. Using software-rendering;\n3. Restore the window to the normal state, those memory would be \"released\". [Video](https://drive.google.com/file/d/1Rf1hP5xpFwYSGM7sCO4tXTM53WqmPjrJ/view?usp=sharing);\n4. No obvious memory leak on NVIDIA Geforce RTX 4060 Laptop GPU, win 11\n\n### Impact\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/wpf/issues/10005","RelatedDescription":"Open issue \"Memory leak on some graphic cards\" (#10005)"},{"Id":"2616176517","IsPullRequest":true,"CreatedAt":"2024-10-26T22:12:01","Actor":"h3xds1nz","Number":"10004","RawContent":null,"Title":"Remove locks on Style/TriggerBase counters, use atomic increments instead","State":"open","Body":"## Description\r\n\r\nSimilarly as in #9741, we will use simple `Interlocked.Increment` to retrieve the next globally unique index, instead of using a full-blown `Monitor`-type lock for such simple operation. This will contribute to startup performance mostly.\r\n\r\nI've also removed `IsEqual` private static method in `Style` as it was just staring there at me, unused.\r\n\r\n## Customer Impact\r\n\r\nIncreased (mostly startup) performance.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nLow, this is very easy to grasp.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/10004)","Url":"https://github.com/dotnet/wpf/pull/10004","RelatedDescription":"Open PR \"Remove locks on Style/TriggerBase counters, use atomic increments instead\" (#10004)"},{"Id":"2616156825","IsPullRequest":true,"CreatedAt":"2024-10-26T21:32:48","Actor":"h3xds1nz","Number":"10003","RawContent":null,"Title":"Update PropertyValues in TriggerBase/FrameworkElementFactory via reference","State":"open","Body":"## Description\r\n\r\nAdds ability to retrieve elements via `ref` from `FrugalStructList<T>` and the underlying storage formats, allowing for future optimizations. I intentionally did not modify the indexer as this can be done easily later on, so there's a new method for it now, which will allow for incremental optimizations in future on another types, where it makes sense and is safe to do so.\r\n\r\nThis allows us to update items via reference, which is particularly useful in case of `PropertyValues` used in `TriggerBase` and `FrameworkElementFactory` since it is a struct that needs to be copied everytime on update back and forth.\r\n\r\nIt is particularly efficient optimization here since the struct is full of managed pointers and ain't blittable, which takes considerable time to track back and forth for a simple update on one property.\r\n\r\nI've also updated the getter/setter on `FrugalStructList<T>` for a minor speed boost, since it is used in almost every WPF collection, every branch counts. Nothing extra new, this is used in `List<T>` by default for several releases.\r\n\r\n### Original getter/setter prolog:\r\n\r\n```assembly\r\nmov rcx, [rcx+8]\r\ntest rcx, rcx      \r\nje short L0021 \r\ncmp edx, [rcx+8]     \r\njge short L0021\r\ntest edx, edx\r\njl short L0021\r\n```\r\n\r\n### New getter/setter prolog:\r\n\r\n```assembly\r\nmov rcx, [rcx+8]\r\ntest rcx, rcx    \r\nje short L001d \r\ncmp edx, [rcx+8] \r\njae short L001d\r\n```\r\n\r\n### Updating PropertyValues before/after\r\n\r\n| Method          |  Mean [ns] | Error [ns] | StdDev [ns] | Code Size [B] | Allocated [B] |\r\n|---------------- |----------:|-----------:|------------:|--------------:|--------------:|\r\n| Original | 459.11 ns |   2.278 ns |    2.131 ns |       1,072 B |             - |\r\n| PR__EDIT|  58.45 ns |   0.464 ns |    0.434 ns |         469 B |             - |\r\n\r\n<details><summary>Minimal benchmark code</summary>\r\n\r\n```csharp\r\n[Benchmark]\r\npublic static FrugalStructList<PropertyValue> PropertyValues = new();\r\npublic static FrugalStructList<PropertyValue> PropertyValues2 = new();\r\n\r\npublic static IEnumerable<TriggerCondition[]> KeysToTest\r\n{\r\n    get\r\n    {\r\n        yield return new TriggerCondition[] { new TriggerCondition() {  SourceChildIndex = 4}, new TriggerCondition() { SourceChildIndex = 1 }, new TriggerCondition() { SourceChildIndex = 3 } };\r\n    }\r\n}\r\n\r\n[GlobalSetup]\r\npublic static void Setup()\r\n{\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n  PropertyValues2.Add(new PropertyValue() { ChildName = \"abcd\", Conditions = new TriggerCondition[5], Property = TextBox.TextProperty, ValueInternal = 45, ValueType = PropertyValueType.Trigger });\r\n}\r\n\r\n[ArgumentsSource(nameof(KeysToTest))]\r\npublic void Original(TriggerCondition[] triggerCondition)\r\n{\r\n    // Set Condition for all data triggers\r\n    for (int i = 0; i < PropertyValues.Count; i++)\r\n    {\r\n        PropertyValue propertyValue = PropertyValues[i];\r\n\r\n        propertyValue.Conditions = triggerCondition;\r\n        switch (propertyValue.ValueType)\r\n        {\r\n            case PropertyValueType.Trigger:\r\n                propertyValue.ValueType = PropertyValueType.DataTrigger;\r\n                break;\r\n            case PropertyValueType.DataTrigger:\r\n                propertyValue.ValueType = PropertyValueType.Trigger;\r\n                break;\r\n            case PropertyValueType.PropertyTriggerResource:\r\n                propertyValue.ValueType = PropertyValueType.DataTriggerResource;\r\n                break;\r\n            default:\r\n                throw new InvalidOperationException(\"fail\");\r\n        }\r\n\r\n        // Put back modified struct\r\n        PropertyValues[i] = propertyValue;\r\n    }\r\n}\r\n\r\n[Benchmark]\r\n[ArgumentsSource(nameof(KeysToTest))]\r\npublic void PR__EDIT(TriggerCondition[] triggerCondition)\r\n{\r\n    // Set Condition for all data triggers\r\n    for (int i = 0; i < PropertyValues2.Count; i++)\r\n    {\r\n        ref PropertyValue propertyValue = ref PropertyValues2.GetEntryAtRef(i);\r\n\r\n        propertyValue.Conditions = triggerCondition;\r\n        switch (propertyValue.ValueType)\r\n        {\r\n            case PropertyValueType.Trigger:\r\n                propertyValue.ValueType = PropertyValueType.DataTrigger;\r\n                break;\r\n            case PropertyValueType.DataTrigger:\r\n                propertyValue.ValueType = PropertyValueType.Trigger;\r\n                break;\r\n            case PropertyValueType.PropertyTriggerResource:\r\n                propertyValue.ValueType = PropertyValueType.DataTriggerResource;\r\n                break;\r\n            default:\r\n                throw new InvalidOperationException(\"fail\");\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n</details>\r\n\r\n## Customer Impact\r\n\r\nIncreased startup performance mostly, but also when dynamically creating triggers at runtime and obviously everything related to ContentPresenter, Validation, ItemsControl templates etc. I could observe about several milliseconds improvement with a simple app with a few controls with ScrollViewer (ListBox) etc.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build, sample apps testing with styles/triggers to check they're applied property.\r\n\r\n## Risk\r\n\r\nLow-to-medium, reviewers shall check that the `ref` is not forwarded/used anywhere while the `FrugalStructList<T>` could be modified (this really means when Grow or for example Remove happens), R/W operations via indexer do not matter as they do not modify the backing store in size/copy it.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/10003)","Url":"https://github.com/dotnet/wpf/pull/10003","RelatedDescription":"Open PR \"Update PropertyValues in TriggerBase/FrameworkElementFactory via reference\" (#10003)"},{"Id":"2615840193","IsPullRequest":true,"CreatedAt":"2024-10-26T12:36:33","Actor":"h3xds1nz","Number":"10002","RawContent":null,"Title":"Optimize lookups in FontEmbeddingManager, use HashSet over Dictionary","State":"open","Body":"## Description\r\n\r\nOptimizes methods in `FontEmbeddingManager`, using `HashSet<ushort>` over `Dictionary<ushort, bool>` since the `bool` is useless and as the comment says, it was always the plan anyways.\r\n\r\n- `GetUsedGlyphs` throws `KeyNotFoundException` over `ArgumentException` but that bug was already present.\r\n    - I'll log an issue for this later.\r\n\r\n### 3 Different faces, 9 Glyph Runs\r\n\r\n| Method          | Mean [ns]  | Error [ns] | StdDev [ns] | Gen0   | Code Size [B] | Allocated [B] |\r\n|---------------- |-----------:|-----------:|------------:|-------:|--------------:|--------------:|\r\n| Original | 1,344.4 ns |   13.79 ns |    12.23 ns | 0.1507 |       1,066 B |        2544 B |\r\n| PR_EDIT |   850.7 ns |   11.54 ns |    10.23 ns | 0.1297 |       1,577 B |        2184 B |\r\n\r\n<details>\r\n<summary>Benchmark data source</summary>\r\n\r\n```csharp\r\nyield return new List<GlyphRun>() { giveme(\"Consolas\", \"hello\"), giveme(\"Arial\", \"hannah\"), giveme(\"Consolas\", \"test\"),\r\n                                    giveme(\"Arial\", \"hello\"), giveme(\"Consolas\", \"hannah\"), giveme(\"Arial\", \"test\"),\r\n                                    giveme(\"Times New Roman\", \"hello\"), giveme(\"Times New Roman\", \"hannah\"), giveme(\"Times New Roman\", \"test\") };\r\n\r\n```\r\n\r\n</details>\r\n\r\n### 1 font, 9 Glyph Runs (XpsFontSubsetter scenario)\r\n\r\n| Method          | Mean [ns]  | Error [ns] | StdDev [ns] | Gen0   | Code Size [B] | Allocated [B] |\r\n|---------------- |-----------:|-----------:|------------:|-------:|--------------:|--------------:|\r\n| Original | 1,401.2 ns |    5.46 ns |     5.11 ns | 0.1087 |       1,063 B |        1832 B |\r\n| PR_EDIT |   878.1 ns |    3.87 ns |     3.43 ns | 0.1020 |       1,394 B |        1712 B |\r\n\r\n<details>\r\n<summary>Benchmark data source</summary>\r\n\r\n```csharp\r\nyield return new List<GlyphRun>() { giveme(\"Consolas\", \"hello\"), giveme(\"Consolas\", \"hannah\"), giveme(\"Consolas\", \"test\"),\r\n                                    giveme(\"Consolas\", \"hello\"), giveme(\"Consolas\", \"hannah\"), giveme(\"Consolas\", \"test\"),\r\n                                    giveme(\"Consolas\", \"hello\"), giveme(\"Consolas\", \"hannah\"), giveme(\"Consolas\", \"Okay, lets change this a bit!\") };\r\n\r\n```\r\n\r\n</details>\r\n\r\n## Customer Impact\r\n\r\nImproved performance, slightly decreased allocations. This is used by the `XpsFontSubsetter`, so it could gain a bit of perf.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nLow, just a simple swap.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/10002)","Url":"https://github.com/dotnet/wpf/pull/10002","RelatedDescription":"Open PR \"Optimize lookups in FontEmbeddingManager, use HashSet over Dictionary\" (#10002)"},{"Id":"2615454569","IsPullRequest":true,"CreatedAt":"2024-10-26T02:00:35","Actor":"dotnet-maestro[bot]","Number":"10001","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.Reflection.MetadataLoadContext**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Serialization.Formatters**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.Registry.AccessControl**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.SystemEvents**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.CodeDom**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.Odbc**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.OleDb**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.PerformanceCounter**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.AccountManagement**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.Protocols**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Formats.Nrbf**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Ports**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Management**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.Context**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Caching**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Pkcs**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.ProtectedData**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceModel.Syndication**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceProcess.ServiceController**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Speech**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Text.Encoding.CodePages**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Threading.AccessControl**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition.Registration**: from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20241026.1\r\n- **Date Produced**: October 26, 2024 1:17:05 PM UTC\r\n- **Commit**: 7376e50c5a762131398992def2e76f4586fe5025\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 10.0.0-alpha.1.24524.3 to 10.0.0-alpha.1.24526.1][3]\r\n  - **Microsoft.Private.Winforms**: [from 10.0.0-alpha.1.24524.3 to 10.0.0-alpha.1.24526.1][3]\r\n  - **System.Drawing.Common**: [from 10.0.0-alpha.1.24524.3 to 10.0.0-alpha.1.24526.1][3]\r\n  - **System.Reflection.MetadataLoadContext**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Windows.Extensions**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **Microsoft.NETCore.Platforms**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Resources.Extensions**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Runtime.Serialization.Formatters**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **Microsoft.NETCore.App.Ref**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **Microsoft.Win32.SystemEvents**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.CodeDom**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.ComponentModel.Composition**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Configuration.ConfigurationManager**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Data.Odbc**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Data.OleDb**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Diagnostics.EventLog**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.DirectoryServices.AccountManagement**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.DirectoryServices.Protocols**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.DirectoryServices**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Formats.Nrbf**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.IO.Packaging**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.IO.Ports**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Management**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Reflection.Context**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Runtime.Caching**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Security.Cryptography.Pkcs**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Security.Cryptography.Xml**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Security.Permissions**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.ServiceModel.Syndication**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.ServiceProcess.ServiceController**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Speech**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Text.Encoding.CodePages**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.Threading.AccessControl**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n  - **System.ComponentModel.Composition.Registration**: [from 10.0.0-alpha.1.24523.5 to 10.0.0-alpha.1.24526.1][4]\r\n\r\n[3]: https://github.com/dotnet/winforms/compare/132e6e7e5d...7376e50c5a\r\n[4]: https://github.com/dotnet/runtime/compare/edaa25e694...3648d836eb\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/10001)\r\n\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/10001","RelatedDescription":"Open PR \"[main] Update dependencies from dotnet/winforms\" (#10001)"},{"Id":"2614730358","IsPullRequest":true,"CreatedAt":"2024-10-25T17:33:54","Actor":"h3xds1nz","Number":"10000","RawContent":null,"Title":"Replace Hashtable/ArrayList in AccessKeyManager and remove locks","State":"open","Body":"#10000, would you look at that?\r\n\r\n## Description\r\n\r\nThis basically turned into overhaul of `AccessKeyManager` because unless I've missed a class on threading and read the code incorrectly, there's just a lot of unnecessary overhead within the entire class that deserves to be removed.\r\n\r\n- I've removed the locking when accessing `_keyToElements` since it is an instance member and all instances are inherently one per thread (`AccessKeyManager` has a <ins>private</ins> `ctor` that is only called via <ins>private</ins> `Current` property where the instance is stored in `[ThreadStatic] s_accessKeyManager` variable. So there should be no way how a different thread can ever gain access to an instance of the dictionary with current code.\r\n- This means that all methods can inherently be `static` as they either do not modify state or request the one-per-thread instance from `Current` and can gain access to the only instance member via the property.\r\n- `AccessKeyInformation` is now a `readonly struct` as there's no reason for it to be mutable.\r\n- Instead of using untyped `ArrayList`, we will swap to `List<WeakReference<IInputElement>>`.\r\n- Instead of using untyped `Hashtable`, we will swap to `Dictionary<string, List<WeakReference<IInputElement>>>`.\r\n- Instead of using untyped `WeakReference`, we will use the generic `WeakReference<IInputElement>`.\r\n- `CriticalGetActiveSource` was removed as it duplicates `GetActiveSource`.\r\n- Some members in `AccessKeyEventArgs` / `AccessKeyPressedEventArgs` were made `readonly`.\r\n\r\n## Customer Impact\r\n\r\nIncreased performance, faster startup, decreased allocations.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build, testing with access keys.\r\n\r\n## Risk\r\n\r\nLow-to-medium, while the changes are mostly replacements, there are different uses of indexers (`Hashtable` vs `Dictionary`) and work with generic `WeakReference` is different, so reviewers shall pay attention I did do anything that shall change behaviour in that regard though from my testing it seemed fine.\r\n\r\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/10000)","Url":"https://github.com/dotnet/wpf/pull/10000","RelatedDescription":"Open PR \"Replace Hashtable/ArrayList in AccessKeyManager and remove locks\" (#10000)"},{"Id":"2614529627","IsPullRequest":false,"CreatedAt":"2024-10-25T16:08:34","Actor":"MichaelSimons","Number":"9998","RawContent":null,"Title":"autogenerated files by Microsoft Visual C++ that may can be deleted","State":"open","Body":"Transferred WPF specific files from https://github.com/dotnet/aspnetcore/issues/58632 originally logged by @dviererbe\n\n### Describe the Bug\n\nI was running lintian (static analysis tool for deb packages) in pedantic mode and it made suggestion to remove auto generated files from the source. I just wanted to share these remarks here, in case they may be useful. These files seem not to be important for Linux source built.\n\n```\nP: dotnet9 source: source-contains-autogenerated-visual-c++-file [src/wpf/src/Microsoft.DotNet.Wpf/src/PenImc/dll/resource.h]\n```\n\n### Steps to Reproduce\n\nFiles in the corresponding repositories:\n- [`src/wpf/src/Microsoft.DotNet.Wpf/src/PenImc/dll/resource.h`](https://github.com/dotnet/wpf/blob/main/src/Microsoft.DotNet.Wpf/src/PenImc/dll/resource.h)\n\n\n### Other Information\n\n```\n$ lintian-explain-tags source-contains-autogenerated-visual-c++-file\nP: source-contains-autogenerated-visual-c++-file\nN: \nN:   The following file is autogenerated by Microsoft Visual C++.\nN:   \nN:   They are usually provided for the convenience of users. These files usually just take up space\nN:   in the tarball and are of no use in Debian.\nN:   \nN:   Check if upstream also provides source-only tarballs that you can use as the upstream\nN:   distribution instead. If not, you may want to ask upstream to provide source-only tarballs.\nN: \nN:   Visibility: pedantic\nN:   Show-Always: no\nN:   Check: cruft\n```","Url":"https://github.com/dotnet/wpf/issues/9998","RelatedDescription":"Open issue \"autogenerated files by Microsoft Visual C++ that may can be deleted\" (#9998)"},{"Id":"2613946437","IsPullRequest":true,"CreatedAt":"2024-10-25T12:16:47","Actor":"dotnet-maestro[bot]","Number":"9997","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20241025.3\r\n- **Date Produced**: October 25, 2024 9:09:03 PM UTC\r\n- **Commit**: ee7a468d815a3401b842e23ee336dd9d679d973d\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 10.0.0-beta.24523.2 to 10.0.0-beta.24525.3][2]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 10.0.0-beta.24523.2 to 10.0.0-beta.24525.3][2]\r\n  - **Microsoft.DotNet.GenAPI**: [from 10.0.0-beta.24523.2 to 10.0.0-beta.24525.3][2]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 10.0.0-beta.24523.2 to 10.0.0-beta.24525.3][2]\r\n\r\n[2]: https://github.com/dotnet/arcade/compare/89040b649a...ee7a468d81\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9997)\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/9997","RelatedDescription":"Open PR \"[main] Update dependencies from dotnet/arcade\" (#9997)"},{"Id":"2613596641","IsPullRequest":false,"CreatedAt":"2024-10-25T09:36:49","Actor":"h3xds1nz","Number":"9996","RawContent":null,"Title":"[API Proposal]: Implement IEquatable interface on DpiScale","State":"open","Body":"### Background and motivation\n\nCurrently, the `DpiScale` struct does not implement `IEquatable`, while we have an internal implemented wrapper class `DpiScale2` that does implement it and wraps this struct. This is for example used as a dictionary key in `StylusLogic`, which could then be simplified to use the regular struct and avoid for example temporary heap allocs on lookup.\n\nThere were already some boxing issues solved in #6309 but the equality is done with an internal `Equals` currently, however as Stephen Toub mentions, the hope is for `DpiScale` to implement `IEquatable` in the future and I couldn't agree more.\n\nWhile at it, I'd mark the struct as `readonly` since it is designed to be immutable anyways.\n\nThe hope is to have then 1 unifying type that we can use to represent `DpiScale` in different scenarios and not having to depend on internal types that are just wrappers around the struct to use it in other places.\n\n### API Proposal\n\n```diff\nnamespace System.Windows;\n\n- public partial struct DpiScale\n+ public readonly partial struct DpiScale : IEquatable<DpiScale>\n{\n+   public bool Equals(DpiScale other)\n+   public override bool Equals(object obj)\n+   public override int GetHashCode()\n+   public static bool operator ==(DpiScale left, DpiScale right)\n+   public static bool operator !=(DpiScale left, DpiScale right)\n}\n```\n\n\n### API Usage\n\nBesides other places:\n\nhttps://github.com/dotnet/wpf/blob/6c96913d693c56922e697b23b3053aa604d3bd2c/src/Microsoft.DotNet.Wpf/src/PresentationCore/System/Windows/Input/Stylus/Common/StylusLogic.cs#L183\n\n### Possible additions\n\nWe could also add a public utility factory method that's currently also on `DpiScale2`, that is `FromPixelsPerInch`, I believe it has its uses:\nhttps://github.com/dotnet/wpf/blob/6c96913d693c56922e697b23b3053aa604d3bd2c/src/Microsoft.DotNet.Wpf/src/PresentationCore/MS/internal/DpiScale2.cs#L202\n\n### Risks\n\nAdding `readonly` is not a breaking change, adding `IEquatable` can obviously produce a new behavior in terms of equality comparisons but I believe it is the right thing to do moving forward.","Url":"https://github.com/dotnet/wpf/issues/9996","RelatedDescription":"Open issue \"[API Proposal]: Implement IEquatable interface on DpiScale\" (#9996)"},{"Id":"2613346969","IsPullRequest":false,"CreatedAt":"2024-10-25T07:42:41","Actor":"Yslelf","Number":"9995","RawContent":null,"Title":"Add 3D Transform to 2D UI","State":"open","Body":"Can we add 3D to the Transform of WPF on 2D UI? For example, RoateTransform3D can be used for 2D, such as Avalonia UWP. Otherwise, ordinary RoateTransform can only rotate angle, which is equivalent to rotating the z-axis, but not the x and y axes, and can only be used in Viewport3D","Url":"https://github.com/dotnet/wpf/issues/9995","RelatedDescription":"Open issue \"Add 3D Transform to 2D UI\" (#9995)"},{"Id":"2608390512","IsPullRequest":true,"CreatedAt":"2024-10-25T05:21:34","Actor":"dotnet-maestro[bot]","Number":"9986","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20241023.2\r\n- **Date Produced**: October 23, 2024 3:10:05 PM UTC\r\n- **Commit**: 89040b649a6aa8fa9b6bd6ddaad5a637cf091b07\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 10.0.0-beta.24522.1 to 10.0.0-beta.24523.2][2]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 10.0.0-beta.24522.1 to 10.0.0-beta.24523.2][2]\r\n  - **Microsoft.DotNet.GenAPI**: [from 10.0.0-beta.24522.1 to 10.0.0-beta.24523.2][2]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 10.0.0-beta.24522.1 to 10.0.0-beta.24523.2][2]\r\n\r\n[2]: https://github.com/dotnet/arcade/compare/1ccd352f12...89040b649a\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9986)\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/9986","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#9986)"},{"Id":"2608344275","IsPullRequest":true,"CreatedAt":"2024-10-25T05:21:07","Actor":"dotnet-maestro[bot]","Number":"9985","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20241024.3\r\n- **Date Produced**: October 24, 2024 11:05:27 PM UTC\r\n- **Commit**: 132e6e7e5d98bccce3b77dbb3737c3069cb00ec5\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 10.0.0-alpha.1.24523.7 to 10.0.0-alpha.1.24524.3][4]\r\n  - **Microsoft.Private.Winforms**: [from 10.0.0-alpha.1.24523.7 to 10.0.0-alpha.1.24524.3][4]\r\n  - **System.Drawing.Common**: [from 10.0.0-alpha.1.24523.7 to 10.0.0-alpha.1.24524.3][4]\r\n  - **System.Reflection.MetadataLoadContext**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Windows.Extensions**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **Microsoft.NETCore.Platforms**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Resources.Extensions**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Runtime.Serialization.Formatters**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **Microsoft.NETCore.App.Ref**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **Microsoft.Win32.SystemEvents**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.CodeDom**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.ComponentModel.Composition**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Configuration.ConfigurationManager**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Data.Odbc**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Data.OleDb**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Diagnostics.EventLog**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.DirectoryServices.AccountManagement**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.DirectoryServices.Protocols**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.DirectoryServices**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Formats.Nrbf**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.IO.Packaging**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.IO.Ports**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Management**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Reflection.Context**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Runtime.Caching**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Security.Cryptography.Pkcs**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Security.Cryptography.Xml**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Security.Permissions**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.ServiceModel.Syndication**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.ServiceProcess.ServiceController**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Speech**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Text.Encoding.CodePages**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.Threading.AccessControl**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n  - **System.ComponentModel.Composition.Registration**: [from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5][5]\r\n\r\n[4]: https://github.com/dotnet/winforms/compare/fefcb94844...132e6e7e5d\r\n[5]: https://github.com/dotnet/runtime/compare/9ecef8c2d7...edaa25e694\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9985)\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.Reflection.MetadataLoadContext**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Serialization.Formatters**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.Registry.AccessControl**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.SystemEvents**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.CodeDom**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.Odbc**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.OleDb**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.PerformanceCounter**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.AccountManagement**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.Protocols**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Formats.Nrbf**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Ports**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Management**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.Context**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Caching**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Pkcs**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.ProtectedData**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceModel.Syndication**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceProcess.ServiceController**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Speech**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Text.Encoding.CodePages**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.Threading.AccessControl**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition.Registration**: from 10.0.0-alpha.1.24523.1 to 10.0.0-alpha.1.24523.5 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/9985","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#9985)"},{"Id":"2612760663","IsPullRequest":false,"CreatedAt":"2024-10-24T23:55:46","Actor":"ThomasGoulet73","Number":"9994","RawContent":null,"Title":"Discussion: Clarify contributor guidelines","State":"open","Body":"There was some discussion in dotnet/wpf#9981 about what kind of changes should be included in a pull-request (The main point discussed in dotnet/wpf#9981 was about unrelated changes for refactoring/formatting).\n\nI took the liberty of opening this issue to discuss it with the community and the WPF team. Obviously, I think we are free to discuss it but the WPF team will have the final say about this.\n\nThe end goal of this issue is to document it properly and for the guidelines to be clear to set the right expectation for a PR.","Url":"https://github.com/dotnet/wpf/issues/9994","RelatedDescription":"Open issue \"Discussion: Clarify contributor guidelines\" (#9994)"},{"Id":"2612609778","IsPullRequest":true,"CreatedAt":"2024-10-24T21:43:07","Actor":"h3xds1nz","Number":"9993","RawContent":null,"Title":"Use Spans and ReadOnlyCollection.Empty in TextBlock/Line, reduce allocs","State":"open","Body":"## Description\r\n\r\nBringing some optimizations to `TextBlock` control and related components (`Line`; `ComplexLine`).\r\n\r\n- Empty `Initialize` method in TextBlock's `ctor` has been removed.\r\n- Unused private methods `GetLineIndexFromDcp` and `ClearComplexContent` have been removed (`EnsureComplexContent` handles the detach if its needed)\r\n- Instead of using `new ReadOnlyCollection<T>(new List<T>(0))` numerous times, we swap to the non-allocating, generic singleton variant of `ReadOnlyCollection<T>.Empty`, removing all possible overhead.\r\n- Replaced `ArrayList` for `InlineObjects` in `ComplexContent` with `List<InlineObject>`.\r\n- Unused calculated variable removed in `ComplexLine` - `double adjustedXOffset` (method doesn't modify state either)\r\n- Unused calculated variable removed in `AlignContent` - `Vector contentOffset` (method doesn't modify state either)\r\n- `GetRangeBounds` in `Line` instead of using a `List<Rect>` now uses pre-allocated `Rect[]` that's wrapped in `ReadOnlySpan<Rect>` to its callers on return.\r\n- Instead of creating `List<TextSegment>(1)` and using `Insert` (that's a great combination), we use `TextSegment[]`.\r\n- I've adjusted the weird loop `GetTightBoundingGeometryFromTextPositions` with more thoughtful impl.\r\n\r\n\r\n### new `ReadOnlyCollection<T>(new List<T>(0))` vs `Empty`\r\n| Method          | Mean [ns] | Error [ns] | StdDev [ns] | Gen0   | Code Size [B] | Allocated [B] |\r\n|---------------- |----------:|-----------:|------------:|-------:|--------------:|--------------:|\r\n| Original | 6.0508 ns |  0.1542 ns |   0.2577 ns | 0.0033 |          78 B |          56 B |\r\n| PR_EDIT | 0.6467 ns |  0.0061 ns |   0.0051 ns |      - |          14 B |             - |\r\n\r\n`GetRangeBounds` call old vs. new and the loop itself; without combining geometries\r\n\r\n### GetTightBoundingGeometryFromTextPositions inner loop (1 rect)\r\n\r\n| Method          | Mean [ns] | Error [ns] | StdDev [ns] | Gen0   | Code Size [B] | Allocated [B] |\r\n|---------------- |------------:|-----------:|------------:|-------:|--------------:|--------------:|\r\n| Original_string |   131.0 ns |    1.93 ns |     1.71 ns | 0.0210 |       1,682 B |         352 B |\r\n| APR_EDIT_int    |  112.3 ns |    1.14 ns |     1.07 ns | 0.0134 |         975 B |         224 B |\r\n\r\n## Customer Impact\r\n\r\nIncreased performance, decreased allocations.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build, sample apps run.\r\n\r\n## Risk\r\n\r\nShould be low, the changes are pretty much mechanical.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9993)","Url":"https://github.com/dotnet/wpf/pull/9993","RelatedDescription":"Open PR \"Use Spans and ReadOnlyCollection.Empty in TextBlock/Line, reduce allocs\" (#9993)"},{"Id":"2612249161","IsPullRequest":false,"CreatedAt":"2024-10-24T18:01:16","Actor":"ronak-k-p","Number":"9992","RawContent":null,"Title":"How to include/copy Framework dependencies to build.","State":"open","Body":"Referring to issue logged here : https://github.com/dotnet/wpf/issues/7751\n\nI want to include/copy Accessibility.dll to my build folder.  I tried several option from MSBuild properties resulting few of the path value being hardcoded. Runtime its referring from \n#### C:/Program Files/dotnet/packs/Microsoft.WindowsDesktop.App.Ref/**8.0.8**/ref/net8.0/Accessibility.dll\n\nHow can change csproj settings so it will copy this dll to build.\n\nI already tried\n#### $(NetCoreRoot)/packs/Microsoft.WindowsDesktop.App.Ref/**8.0.8**/ref/net8.0/Accessibility.dll (8.0.8 & net8.0 is hardcoded)","Url":"https://github.com/dotnet/wpf/issues/9992","RelatedDescription":"Open issue \"How to include/copy Framework dependencies to build.\" (#9992)"},{"Id":"2610601715","IsPullRequest":false,"CreatedAt":"2024-10-24T06:28:02","Actor":"abbweiman","Number":"9991","RawContent":null,"Title":"updateuid target does not exist in multitarget project","State":"open","Body":"### Description\n\nThe `updateuid` target is no longer found in a SDK-style WPF project with multi targeting enabled.\n\n### Reproduction Steps\n\n1. Create a WPF project. Change `TargetFramework` to `TargetFrameworks`:\n```\n<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <OutputType>WinExe</OutputType>\n    <TargetFrameworks>net6.0-windows</TargetFrameworks>\n    <UseWPF>true</UseWPF>\n  </PropertyGroup>\n</Project>\n```\n\n**Note**: It doesn't matter if it's actual multi targeting or what's inside the TargetFrameworks. It's enough to add the 's'!\n\n2. `msbuild /t:updateuid MyWpfProject.csproj`\n\n### Expected behavior\n\nNo error and uids are updated in xaml files.\n\n### Actual behavior\n\n`error MSB4057: The target \"updateuid\" does not exist in the project.`\n\n### Regression?\n\nYes! This has worked for years until recently.\n\n### Known Workarounds\n\nNone.\n\n### Impact\n\nThis is stopping us from updating translations in a big project.\n\n### Configuration\n\nVisual Studio 17.11.5\nMSBuild 17.11.9\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/wpf/issues/9991","RelatedDescription":"Open issue \"updateuid target does not exist in multitarget project\" (#9991)"},{"Id":"2609851496","IsPullRequest":true,"CreatedAt":"2024-10-23T21:08:41","Actor":"h3xds1nz","Number":"9990","RawContent":null,"Title":"Remove GenericsInstances class from WindowsBase as it no longer needed","State":"open","Body":"## Description\r\n\r\nRemoves `GenericsInstances` class that was solely used for `ngen` purposes in `NetFX` to trigger generation for those generic types that were otherwise only defined on interfaces in `WindowsBase` (see comment).\r\n\r\nI have done a test with CrossGen2 (R2R) and this wasn't being jitted. So imho it is safe to say it has outlived its purpose.\r\nUsing the output of `DOTNET_JitDisasmSummary=1`; while without publishing as R2R all those things were.\r\n\r\n## Customer Impact\r\n\r\nDecreased assemblies size, cleaner codebase for developers.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build, app run (more in description).\r\n\r\n## Risk\r\n\r\nDon't think there's any.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9990)","Url":"https://github.com/dotnet/wpf/pull/9990","RelatedDescription":"Open PR \"Remove GenericsInstances class from WindowsBase as it no longer needed\" (#9990)"},{"Id":"2608712674","IsPullRequest":false,"CreatedAt":"2024-10-23T13:54:20","Actor":"robert-abeo","Number":"9989","RawContent":null,"Title":"Fluent2 ContextMenu Won't Vertically Scroll","State":"open","Body":"### Description\n\nThe Fluent2 `ContextMenu` doesn't support scrolling which is a mistake in the control template:\n\nhttps://github.com/dotnet/wpf/blob/e16222f888d89a3c06efd8fb252f67ed30f39050/src/Microsoft.DotNet.Wpf/src/Themes/PresentationFramework.Fluent/Styles/ContextMenu.xaml#L41-L45\n\nCompare this to the `MenuItem` which is correct:\n\nhttps://github.com/dotnet/wpf/blob/e16222f888d89a3c06efd8fb252f67ed30f39050/src/Microsoft.DotNet.Wpf/src/Themes/PresentationFramework.Fluent/Styles/MenuItem.xaml#L107-L109\n\nThe fix is simply:\n\n```xaml\n                        <!-- Modified to support scrolling -->\n                        <ScrollViewer\n                            CanContentScroll=\"True\"\n                            HorizontalScrollBarVisibility=\"Disabled\"\n                            VerticalScrollBarVisibility=\"Auto\">\n                            <StackPanel\n                                Orientation=\"Vertical\"\n                                ClipToBounds=\"True\"\n                                IsItemsHost=\"True\"\n                                KeyboardNavigation.DirectionalNavigation=\"Cycle\" />\n                        </ScrollViewer>\n```\n\n### Reproduction Steps\n\nSee above\n\n### Expected behavior\n\nVertical scrolling is supported\n\n### Actual behavior\n\nNo vertical scrolling\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Impact\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/wpf/issues/9989","RelatedDescription":"Open issue \"Fluent2 ContextMenu Won't Vertically Scroll\" (#9989)"},{"Id":"2608643415","IsPullRequest":false,"CreatedAt":"2024-10-23T13:34:35","Actor":"robert-abeo","Number":"9987","RawContent":null,"Title":"Fluent2 Menu/MenuItem Resource Keys Misnamed","State":"open","Body":"### Description\n\nEvery Fluent2 control template I've looked at has some very serious issues with resource keys. They don't follow upstream Fluent at all. The original author of this theme just did what they thought best but came up with a far inferior design. I have major concerns launching the Fluent2 theme like this. I think it needs to be re-written following upstream resources...\n\nA good example of this is the Menu/MenuItem resource keys:\n\nhttps://github.com/dotnet/wpf/blob/e16222f888d89a3c06efd8fb252f67ed30f39050/src/Microsoft.DotNet.Wpf/src/Themes/PresentationFramework.Fluent/Themes/Fluent.Dark.xaml#L513-L518\n\nWhat is `MenuBarItemBackgroundMousePointer`. I think this should be `MenuBarItemBackgroundPointerOver` matching everywhere else. But there are so many resources missing here based on upstream. It forces re-templating most of the time. It is also incompatible with existing Fluent themes that define these resources.\n\nhttps://github.com/microsoft/microsoft-ui-xaml/blob/d74a0332cf0d5e58f12eddce1070fa7a79b4c2db/src/controls/dev/MenuBar/MenuBar_themeresources.xaml#L5-L15\n\nIf you notice the `MenuBarItemBackgroundMousePointer` is also flat wrong as it should be pointing to the secondary instead of tertiary brush...\n\n### Reproduction Steps\n\nSee above\n\n### Expected behavior\n\nSee above\n\n### Actual behavior\n\nSee above\n\n### Regression?\n\n_No response_\n\n### Known Workarounds\n\n_No response_\n\n### Impact\n\n_No response_\n\n### Configuration\n\n_No response_\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/wpf/issues/9987","RelatedDescription":"Open issue \"Fluent2 Menu/MenuItem Resource Keys Misnamed\" (#9987)"},{"Id":"2604026285","IsPullRequest":true,"CreatedAt":"2024-10-23T05:21:22","Actor":"dotnet-maestro[bot]","Number":"9979","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20241022.2\r\n- **Date Produced**: October 22, 2024 11:32:07 PM UTC\r\n- **Commit**: 1d963e9d2168a60d37159b967b1899e2540a98f1\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 10.0.0-alpha.1.24521.4 to 10.0.0-alpha.1.24522.2][3]\r\n  - **Microsoft.Private.Winforms**: [from 10.0.0-alpha.1.24521.4 to 10.0.0-alpha.1.24522.2][3]\r\n  - **System.Drawing.Common**: [from 10.0.0-alpha.1.24521.4 to 10.0.0-alpha.1.24522.2][3]\r\n  - **System.Reflection.MetadataLoadContext**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Windows.Extensions**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **Microsoft.NETCore.Platforms**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Resources.Extensions**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Runtime.Serialization.Formatters**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **Microsoft.NETCore.App.Ref**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **Microsoft.Win32.SystemEvents**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.CodeDom**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.ComponentModel.Composition**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Configuration.ConfigurationManager**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Data.Odbc**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Data.OleDb**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Diagnostics.EventLog**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.DirectoryServices.AccountManagement**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.DirectoryServices.Protocols**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.DirectoryServices**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Formats.Nrbf**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.IO.Packaging**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.IO.Ports**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Management**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Reflection.Context**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Runtime.Caching**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Security.Cryptography.Pkcs**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Security.Cryptography.Xml**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Security.Permissions**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.ServiceModel.Syndication**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.ServiceProcess.ServiceController**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Speech**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Text.Encoding.CodePages**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.Threading.AccessControl**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n  - **System.ComponentModel.Composition.Registration**: [from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2][4]\r\n\r\n[3]: https://github.com/dotnet/winforms/compare/65c6bebbb3...1d963e9d21\r\n[4]: https://github.com/dotnet/runtime/compare/dfc2b85a00...1e5bae2e56\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9979)\r\n\r\n\r\n\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.Reflection.MetadataLoadContext**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Serialization.Formatters**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.Registry.AccessControl**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.SystemEvents**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.CodeDom**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.Odbc**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.OleDb**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.PerformanceCounter**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.AccountManagement**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.Protocols**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Formats.Nrbf**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Ports**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Management**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.Context**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Caching**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Pkcs**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.ProtectedData**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceModel.Syndication**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceProcess.ServiceController**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Speech**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Text.Encoding.CodePages**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.Threading.AccessControl**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition.Registration**: from 10.0.0-alpha.1.24519.3 to 10.0.0-alpha.1.24521.2 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/9979","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#9979)"},{"Id":"2606667250","IsPullRequest":false,"CreatedAt":"2024-10-22T22:37:32","Actor":"xDreamms","Number":"9984","RawContent":null,"Title":"Listbox Image Binding Is Slow and Freezes UI","State":"open","Body":"### Description\n\n\n```\n public static async Task<BitmapImage> GetImage(string url,ImageType imageType)\n {\n     var bitmapImage = new BitmapImage(new Uri(url,UriKind.Absolute));\n     return bitmapImage;\n}\n```\n\n ```\n<ListBox  ScrollViewer.CanContentScroll=\"True\" MaxHeight=\"500\" \n   VirtualizingPanel.IsVirtualizing=\"true\" \n   VirtualizingPanel.VirtualizationMode=\"Recycling\" ItemsSource=\"{Binding PopularMovies, Mode=OneWay, IsAsync=True}\"  Grid.Row=\"3\" Grid.Column=\"1\" Grid.ColumnSpan=\"2\" SelectionChanged=\"MoviesDisplay_OnSelectionChanged\" ScrollViewer.ScrollChanged=\"MoviesDisplay_OnScrollChanged\"  ScrollViewer.HorizontalScrollBarVisibility=\"Visible\" ScrollViewer.VerticalScrollBarVisibility=\"Disabled\" Background=\"Transparent\" x:Name=\"MoviesDisplay\">\n\n     <b:Interaction.Behaviors>\n         <local:IgnoreMouseWheelBehavior />\n     </b:Interaction.Behaviors>\n     <ItemsControl.Resources>\n         <Style x:Key=\"ScaleStyle\" TargetType=\"Image\">\n             <Style.Triggers>\n                 <Trigger Property=\"IsMouseOver\" Value=\"True\">\n                     <Setter Property=\"Grid.ZIndex\" Value=\"1\"/>\n                     <Setter Property=\"RenderTransform\">\n                         <Setter.Value>\n                             <ScaleTransform ScaleX=\"1.1\" ScaleY=\"1.1\"/>\n                         </Setter.Value>\n                     </Setter>\n                 </Trigger>\n             </Style.Triggers>\n         </Style>\n     </ItemsControl.Resources>\n     <ListBox.ItemContainerStyle>\n         <Style TargetType=\"ListBoxItem\">\n             <Setter Property=\"IsSelected\" Value=\"{Binding Content.IsSelected, Mode=TwoWay, RelativeSource={RelativeSource Self}}\"/>\n             <Setter Property=\"Template\">\n                 <Setter.Value>\n                     <ControlTemplate TargetType=\"ListBoxItem\">\n                         <ContentPresenter/>\n                     </ControlTemplate>\n                 </Setter.Value>\n             </Setter>\n         </Style>\n     </ListBox.ItemContainerStyle>\n     <ListBox.ItemTemplate>\n         <DataTemplate>\n             <Grid Cursor=\"Hand\" Margin=\"0 0 20 0\" >\n                 <Grid.ColumnDefinitions>\n                     <ColumnDefinition Width=\"*\"></ColumnDefinition>\n                 </Grid.ColumnDefinitions>\n                 <Grid.RowDefinitions>\n                     <RowDefinition Height=\"*\"></RowDefinition>\n                     <RowDefinition Height=\"0.052*\"></RowDefinition>\n                     <RowDefinition Height=\"0.05*\"></RowDefinition>\n                 </Grid.RowDefinitions>\n\n                 <Viewbox HorizontalAlignment=\"Left\" Grid.Row=\"0\" Grid.Column=\"0\">\n                     <Image RenderTransformOrigin=\"0.5,0.5\" Style=\"{StaticResource ScaleStyle}\"  Source=\"{Binding Bitmap, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}\"></Image>\n                 </Viewbox>\n\n                 <Viewbox MaxWidth=\"200\" HorizontalAlignment=\"Left\" Grid.Row=\"1\">\n                     <TextBlock   TextWrapping=\"Wrap\" Text=\"{Binding Name, UpdateSourceTrigger=PropertyChanged}\" Foreground=\"White\"></TextBlock>\n                 </Viewbox>\n\n                 <Grid Grid.Row=\"2\" Grid.Column=\"0\">\n                     <Grid.ColumnDefinitions>\n                         <ColumnDefinition Width=\"0.3*\"></ColumnDefinition>\n                         <ColumnDefinition Width=\"*\"></ColumnDefinition>\n                     </Grid.ColumnDefinitions>\n\n                     <Viewbox HorizontalAlignment=\"Left\">\n                         <materialDesign:RatingBar\n x:Name=\"ReadOnlyRatingBar\"\n IsReadOnly=\"True\"\n Value=\"{Binding Rating, UpdateSourceTrigger=PropertyChanged}\"></materialDesign:RatingBar>\n                     </Viewbox>\n\n                     <Viewbox Margin=\"10 0 0 0\" Grid.Column=\"1\" HorizontalAlignment=\"Left\">\n                         <TextBlock Text=\"{Binding RatingNumber, UpdateSourceTrigger=PropertyChanged}\" Foreground=\"#767676\"></TextBlock>\n                     </Viewbox>\n                 </Grid>\n             </Grid>\n         </DataTemplate>\n     </ListBox.ItemTemplate>\n     <ListBox.ItemsPanel>\n         <ItemsPanelTemplate>\n             <VirtualizingStackPanel VirtualizingStackPanel.IsVirtualizing=\"True\"  VirtualizingStackPanel.VirtualizationMode=\"Recycling\" IsItemsHost=\"True\" Orientation=\"Horizontal\"  />\n         </ItemsPanelTemplate>\n     </ListBox.ItemsPanel>\n </ListBox>\n```\n\n```\npublic static async Task GetPopularMoviesAsync(string language, int page)\n{\n    PopularMovies.Clear();\n    var popularMovies = await client.GetMoviePopularListAsync(language, page);\n    foreach (var movie in popularMovies.Results)\n    {\n        Movie mov = new Movie()\n        {\n            Bitmap = await GetImage(client.GetImageUrl(\"w500\", movie.PosterPath).AbsoluteUri,ImageType.Poster),\n            Id = movie.Id,\n            Name = movie.Title,\n            Rating = movie.VoteAverage,\n            RatingNumber = movie.VoteAverage.ToString(),\n            ShowType = ShowType.Movie,\n        };\n        if (PopularMovies.Any(x => x.Id == movie.Id))\n        {\n\n        }\n        else\n        {\n            PopularMovies.Add(mov);\n        }\n    }\n}\n```\nIt is slow and freezes UI. Btw I am using https://github.com/jellyfin/TMDbLib. And I read and applied this article: But still slow\nhttps://github.com/RickStrahl/BlogPosts/blob/master/2024-01/Working%20around%20the%20WPF%20Image%20Control%20Blues/WorkingAroundWPFImageControlBlues.md\nBtw my 2018 project .net 4.7.2 with same codes runs very fast. What did you change in ImageControl?\n\n### Expected behavior\n\nIt should work without freezes and fast\n\n### Actual behavior\n\nSlow and Freezes UI\n\n","Url":"https://github.com/dotnet/wpf/issues/9984","RelatedDescription":"Open issue \"Listbox Image Binding Is Slow and Freezes UI\" (#9984)"},{"Id":"2606507050","IsPullRequest":true,"CreatedAt":"2024-10-22T21:04:43","Actor":"h3xds1nz","Number":"9983","RawContent":null,"Title":"Fix DataGrid hang during scroll to cell when UseLayoutRounding is enabled","State":"open","Body":"Fixes #9944 \r\n\r\n## Description\r\n\r\nFixes an infinite loop (an application hang) when scrolling to a `Cell` right after layout refresh. This only happens when `UseLayoutRounding` is enabled and you hit the jackpot (e.g. with the repro in the issue, x1.25 on the pixels).\r\n\r\nAs I've described originally in the issue, with some small adjustments:\r\n\r\nBecause of layout rounding, `GetParentCellsPanelHorizontalOffset` can return negative (e.g. `-0.4`), which happens here. Doing simple `Math.Max(0d, result)` on the result fixes the hang and prevents breaking the binding for the button in row header that's used in all styles for `DataGrid.SelectAllCommand`. The layout computation logic does not sit well with negative numbers.\r\n\r\nhttps://github.com/dotnet/wpf/blob/58c3b2ee8e11749c69a836aa8e87b9a0cd7071c8/src/Microsoft.DotNet.Wpf/src/PresentationFramework/System/Windows/Controls/DataGrid.cs#L8522\r\n\r\nIn my humble opinion, this is the right thing to do to constrain it at zero, it fixes the immediate problem but also the other options will pass zero or greater; `RowHeaderWidth` is also constrained with `FrameworkElement`'s `Width`.\r\n\r\nBy the way, the repro to do two layout passes can be simplified to (with `DataGrid` being read only):\r\n\r\n```csharp\r\nmyDataGrid.MouseUp += (sender, e) =>\r\n{\r\n    myDataGrid.Items.Refresh();\r\n    DataGridColumn currentColumn = myDataGrid.CurrentColumn ?? myDataGrid.Columns[1];\r\n    myDataGrid.CurrentCell = new DataGridCellInfo(myDataGrid.SelectedItem, currentColumn);\r\n};\r\n```\r\n\r\n## Customer Impact\r\n\r\nCustomers will enjoy `DataGrid` without the application randomly hanging.\r\n\r\n## Regression\r\n\r\nUnlikely.\r\n\r\n## Testing\r\n\r\nAll the other layout calculations that depend on this I've checked seem to be outputting the same before and after fix (the final output, not the infinite loop one), visually I couldn't see any difference either. I've tested it on several different DPIs and everything seems to be in order.\r\n\r\n## Risk\r\n\r\nLow-to-medium; while it makes sense that it shouldn't be negative due to the binding (and it never will be unless you `UseLayoutRounding` with magical dimensions), we shall not take that as a holy grail. Though the functions called `GetParentCellsPanelHorizontalOffset` are only called by this method where I've done the fix, it made sense to me to make it here where it's being decided and not somewhere in the actual calculation.\r\n\r\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9983)","Url":"https://github.com/dotnet/wpf/pull/9983","RelatedDescription":"Open PR \"Fix DataGrid hang during scroll to cell when UseLayoutRounding is enabled\" (#9983)"},{"Id":"2606262087","IsPullRequest":true,"CreatedAt":"2024-10-22T19:10:34","Actor":"h3xds1nz","Number":"9982","RawContent":null,"Title":"Remove ShowMessageBoxHelper from SecurityHelper (CAS remnants)","State":"open","Body":"## Description\r\n\r\nContinues the work on removing CAS remnants, this time again method proxies and \"helpers\" from `SecurityHelper`, which makes it almost finished effort with the rest of the PRs currently submitted.\r\n\r\nThis just removes `MessageBox` proxies used by `DocumentsViewer` control.\r\n\r\n## Customer Impact\r\n\r\nDecreased size of assemblies, cleaner codebase for developers.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nLow.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9982)","Url":"https://github.com/dotnet/wpf/pull/9982","RelatedDescription":"Open PR \"Remove ShowMessageBoxHelper from SecurityHelper (CAS remnants)\" (#9982)"},{"Id":"2605721464","IsPullRequest":true,"CreatedAt":"2024-10-22T14:59:55","Actor":"h3xds1nz","Number":"9981","RawContent":null,"Title":"Optimize working with EllipseGeometry/RectangleGeometry, reduce allocs","State":"open","Body":"## Description\r\n\r\nRemoves some unnecessary `gen0` allocations when working with `EllipseGeometry`/`RectangleGeometry` (such as adding them to a `PathGeometry` or combining geometries which serializes them (`Point` array alloc) and when rendering `TickBar`. Also introduces `internal` constructors for `PathFigure`/`PathGeometry` that can be used with inline arrays.\r\n\r\nAlso changes some `private static` fields to constants, decreasing static allocations.\r\n\r\nThe savings are not that massive right now, but it will allow for further optimizations (and there's a lot of space for it).\r\n\r\n### Define geometry, add to group, get bounds\r\n\r\n| Method       | Mean [ns]  | Error [ns] | StdDev [ns] | Gen0   | Code Size [B] | Allocated [B] |\r\n|---------------- |-----------:|-----------:|------------:|-------:|--------------:|--------------:|\r\n| Original | 9,371.1 ns |   67.37 ns |    56.25 ns | 0.4578 |       9,483 B |        7848 B |\r\n| PR_EDIT | 8,986.0 ns |   55.25 ns |    48.98 ns |  0.4120    |   9,120 B  |        7120 B |\r\n\r\n<details>\r\n<summary>Benchmark code</summary>\r\n\r\n```csharp\r\npublic Rect Original()\r\n{\r\n  PathGeometry abcd =  new PathGeometry();\r\n  RectangleGeometry rectangle =   new RectangleGeometry(s_myRect, 10, 10);\r\n  EllipseGeometry ellipse = new EllipseGeometry(s_myPoint, 10, 10);\r\n\r\n  // uses GetPathFigureCollection\r\n  abcd.AddGeometry(rectangle);\r\n  abcd.AddGeometry(ellipse);\r\n\r\n  // Retrieve bounds, another alloc\r\n  Rect myBounds = rectangle.Bounds;\r\n  Rect myEllipse = ellipse.Bounds;\r\n\r\n  myBounds.Union(myEllipse);\r\n\r\n  return myBounds;\r\n}\r\n```\r\n\r\n</details>\r\n\r\n\r\n## Customer Impact\r\n\r\nImproved performance, decreased allocations.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build, sample apps, usage of types.\r\n\r\n## Risk\r\n\r\nShould be low, all the changes were done with using stack-allocated memory\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9981)","Url":"https://github.com/dotnet/wpf/pull/9981","RelatedDescription":"Open PR \"Optimize working with EllipseGeometry/RectangleGeometry, reduce allocs\" (#9981)"},{"Id":"2604639971","IsPullRequest":false,"CreatedAt":"2024-10-22T08:12:57","Actor":"bent-rasmussen","Number":"9980","RawContent":null,"Title":"Fluent Theme: `MenuItem` does not align `Header`","State":"open","Body":"### Description\n\nA usability aspect of menus is that they are easy to visually scan. If some menu items do not have icons, then their headers are not aligned with headers that do have icons. This degrades usability somewhat. The default \"theme\" does not exhibit this issue.\n\nI am not sure if this is simply the way Fluent is supposed to be, so this is just a guess.\n\n| Default | Fluent |\n| -------- | ------- |\n| ![Image](https://github.com/user-attachments/assets/28bd11e5-6294-4eb4-9d2f-c87c3d5b3fd1) | ![Image](https://github.com/user-attachments/assets/a64ce313-f265-40af-b981-195dac9faa2b) |\n\n\n### Reproduction Steps\n\n- Create a .NET 9 desktop app with the new Fluent theme\n- Add a `Menu` like so:\n\n```xaml\n<Window\n    x:Class=\"MenuIconAlignment.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:local=\"clr-namespace:MenuIconAlignment\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    Title=\"MainWindow\"\n    Width=\"400\"\n    Height=\"250\"\n    ThemeMode=\"Light\"\n    WindowStartupLocation=\"CenterScreen\"\n    mc:Ignorable=\"d\">\n    <Grid>\n\n        <Menu\n            Margin=\"50,-100,0,0\"\n            HorizontalAlignment=\"Center\"\n            VerticalAlignment=\"Center\"\n            VerticalContentAlignment=\"Center\">\n            <MenuItem Header=\"File\" IsSubmenuOpen=\"True\">\n\n                <MenuItem Header=\"Open\">\n                    <MenuItem.Icon>\n                        <TextBlock FontFamily=\"Segoe Fluent Icons\" Text=\"&#xE1A5;\" />\n                    </MenuItem.Icon>\n                </MenuItem>\n                <MenuItem Header=\"Exit\" />\n\n            </MenuItem>\n        </Menu>\n\n    </Grid>\n</Window>\n```\n\n\n### Expected behavior\n\nHeaders **are** vertically aligned.\n\n ![Image](https://github.com/user-attachments/assets/28bd11e5-6294-4eb4-9d2f-c87c3d5b3fd1)\n\n### Actual behavior\n\nHeaders **are not** vertically aligned.\n\n![Image](https://github.com/user-attachments/assets/a64ce313-f265-40af-b981-195dac9faa2b)\n\n### Regression?\n\nWell, without fluent, headers are aligned, with fluent they are not but of course fluent is a new theme.\n\n### Known Workarounds\n\n_No response_\n\n### Impact\n\nDegraded usability; slows down visual scanning.\n\n### Configuration\n\n| Property | Value |\n| ----------|-------|\n| SDK | .NET 9 RC2 |\n| OS Name | Microsoft Windows 11 Pro |\n| Version | 10.0.22631 Build 22631 |\n| System SKU | Surface_Pro_8_1983 |\n\n### Other information\n\n_No response_","Url":"https://github.com/dotnet/wpf/issues/9980","RelatedDescription":"Open issue \"Fluent Theme: `MenuItem` does not align `Header`\" (#9980)"},{"Id":"2603342958","IsPullRequest":true,"CreatedAt":"2024-10-21T18:28:25","Actor":"h3xds1nz","Number":"9978","RawContent":null,"Title":"Remove SafeSecurityHelperAvalon, move functionality to PresentationSource","State":"open","Body":"## Description\r\n\r\nOne `SecurityHelper` file down, two to go.\r\n\r\nThis one was a partial class from `SafeSecurityHelper`, containing a simple wrapper for `PresentationSource.FromVisual` with a `bool` check. It was compiled unconditionally both into `PresentationFramework` and `PresentationCore`, though the functionality is not needed in both assemblies.\r\n\r\nAlso removed some obsolete CAS remarks in `PresentationSource` and used pattern matching in some places to simplify code.\r\n\r\n## Customer Impact\r\n\r\nDecreased size of assemblies, cleaner code base for developers.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nLow.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9978)","Url":"https://github.com/dotnet/wpf/pull/9978","RelatedDescription":"Open PR \"Remove SafeSecurityHelperAvalon, move functionality to PresentationSource\" (#9978)"},{"Id":"2603199517","IsPullRequest":true,"CreatedAt":"2024-10-21T17:17:53","Actor":"h3xds1nz","Number":"9977","RawContent":null,"Title":"Remove Marshal Exception/HRESULT proxies from SecurityHelper, simplify code","State":"open","Body":"## Description\r\n\r\nContinues the work on removing CAS remnants, this time again method proxies and \"helpers\" from `SecurityHelper`.\r\n\r\nIn this PR we remove `GetHRForException` from `StreamAsIStream` along with obsolete warning suppresions and also `GetExceptionForHR` plus `ThrowExceptionForHR` proxies.\r\n\r\n- `_lastException ` was just storing the latest exception in a private field that was never read.\r\n- Technically we could just return `COR_E_OBJECTDISPOSED` in some cases instead of setting up a frame, conditionally throwing `ObjectDisposedException`, catching it just to retrieve the `HResult` and then returning it but I think it is out of scope for this PR.\r\n\r\n## Customer Impact\r\n\r\nDecreased size of assemblies, cleaner codebase for developers.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nLow.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9977)","Url":"https://github.com/dotnet/wpf/pull/9977","RelatedDescription":"Open PR \"Remove Marshal Exception/HRESULT proxies from SecurityHelper, simplify code\" (#9977)"},{"Id":"2597339545","IsPullRequest":true,"CreatedAt":"2024-10-21T08:53:31","Actor":"dotnet-maestro[bot]","Number":"9976","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20241020.1\r\n- **Date Produced**: October 20, 2024 1:08:50 PM UTC\r\n- **Commit**: 89e6bb9bd71cf6eee690a1586eaabd58f6014460\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 10.0.0-alpha.1.24518.5 to 10.0.0-alpha.1.24520.1][4]\r\n  - **Microsoft.Private.Winforms**: [from 10.0.0-alpha.1.24518.5 to 10.0.0-alpha.1.24520.1][4]\r\n  - **System.Drawing.Common**: [from 10.0.0-alpha.1.24518.5 to 10.0.0-alpha.1.24520.1][4]\r\n  - **System.Reflection.MetadataLoadContext**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Windows.Extensions**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **Microsoft.NETCore.Platforms**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Resources.Extensions**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Runtime.Serialization.Formatters**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **Microsoft.NETCore.App.Ref**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **Microsoft.Win32.Registry.AccessControl**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **Microsoft.Win32.SystemEvents**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.CodeDom**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.ComponentModel.Composition**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Configuration.ConfigurationManager**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Data.Odbc**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Data.OleDb**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Diagnostics.EventLog**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Diagnostics.PerformanceCounter**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.DirectoryServices.AccountManagement**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.DirectoryServices.Protocols**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.DirectoryServices**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Formats.Nrbf**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.IO.Packaging**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.IO.Ports**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Management**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Reflection.Context**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Runtime.Caching**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Security.Cryptography.Pkcs**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Security.Cryptography.ProtectedData**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Security.Cryptography.Xml**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Security.Permissions**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.ServiceModel.Syndication**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.ServiceProcess.ServiceController**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Speech**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Text.Encoding.CodePages**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.Threading.AccessControl**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n  - **System.ComponentModel.Composition.Registration**: [from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3][5]\r\n\r\n[4]: https://github.com/dotnet/winforms/compare/64e70d27f4...89e6bb9bd7\r\n[5]: https://github.com/dotnet/runtime/compare/2830cf5d4b...dfc2b85a00\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\r\n\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9976)\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.Reflection.MetadataLoadContext**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Serialization.Formatters**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.10.0**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.Registry.AccessControl**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.Win32.SystemEvents**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.CodeDom**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.Odbc**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Data.OleDb**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.PerformanceCounter**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.AccountManagement**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices.Protocols**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Formats.Nrbf**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Ports**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Management**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.Context**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Runtime.Caching**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Pkcs**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.ProtectedData**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceModel.Syndication**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.ServiceProcess.ServiceController**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Speech**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Text.Encoding.CodePages**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Threading.AccessControl**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.ComponentModel.Composition.Registration**: from 10.0.0-alpha.1.24517.1 to 10.0.0-alpha.1.24519.3 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/9976","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#9976)"},{"Id":"2597208679","IsPullRequest":true,"CreatedAt":"2024-10-18T10:58:23","Actor":"h3xds1nz","Number":"9975","RawContent":null,"Title":"Remove WLDP/UseLegacyDangerousClipboardDeserializationMode leftovers","State":"open","Body":"## Description\r\n\r\nCleans up rest of the dead code after #1286, as this code is uncalled since the switch doesn't exist.\r\n\r\n## Customer Impact\r\n\r\nSmaller size of assemblies, cleaner code base for developers.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nLocal build.\r\n\r\n## Risk\r\n\r\nNext to none, just dead code removal.\r\n\n ###### Microsoft Reviewers: [Open in CodeFlow](https://microsoft.github.io/open-pr/?codeflow=https://github.com/dotnet/wpf/pull/9975)","Url":"https://github.com/dotnet/wpf/pull/9975","RelatedDescription":"Open PR \"Remove WLDP/UseLegacyDangerousClipboardDeserializationMode leftovers\" (#9975)"},{"Id":"2596431114","IsPullRequest":false,"CreatedAt":"2024-10-18T05:11:30","Actor":"vsfeedback","Number":"9974","RawContent":null,"Title":"Cannot create app packages for projects containing source generators","State":"open","Body":"_This issue has been moved from [a ticket on Developer Community](https://developercommunity.visualstudio.com/t/Cannot-create-app-packages-for-projects-/10770385)._\n\n---\nAttempting to create app packages for a WPF project containing a source generator throws an error, as if the source generator is not running.\n\nI have tried rolling back the .NET SDK to no avail.\n\nDownload repro project:  \n(attached or via link [https://github.com/user-attachments/files/15571552/CsWin32WaprojDeployRepro.zip](https://github.com/user-attachments/files/15571552/CsWin32WaprojDeployRepro.zip))\n\n1.  Select the packaging project\n    \n2.  Project > Publish > Create app packages\n    \n3.  Complete the wizard (Sideloading > Skip signing > x86 + x64 + arm64 > Installer URI [https://example.org](https://example.org) > Create)\n    \n4.  Observe error in Error List / Output window (screenshot attached):\n    \n    ```  \n    The name ‘Windows’ does not exist in the current context […]  \n    X:\\CsWin32DeployRepro\\WpfApp\\MainWindow.xaml.cs      \n    ```\n\n---\n### Original Comments\n\n#### Feedback Bot on 10/17/2024, 08:29 AM: \n\n<p>We have directed your feedback to the appropriate engineering team for further evaluation. The team will review the feedback and notify you about the next steps.</p>\n","Url":"https://github.com/dotnet/wpf/issues/9974","RelatedDescription":"Open issue \"Cannot create app packages for projects containing source generators\" (#9974)"}],"ResultType":"GitHubIssue"}},"RunOn":"2024-10-28T03:30:27.4884177Z","RunDurationInMilliseconds":413}