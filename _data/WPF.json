{"Data":{"GitHub":{"Issues":[{"Id":"1193951706","IsPullRequest":true,"CreatedAt":"2022-04-06T03:13:17","Actor":"dotnet-maestro[bot]","Number":"6368","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220405.9\r\n- **Date Produced**: April 6, 2022 2:49:16 AM UTC\r\n- **Commit**: 12fb1d1bf394066a31a76f68a6eca02a6fc56b91\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22205.6 to 6.0.0-rtm.22205.9][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC12fb1d1&targetVersion=GC12fb1d1&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6368)","Url":"https://github.com/dotnet/wpf/pull/6368","RelatedDescription":"Open PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6368)"},{"Id":"1193654612","IsPullRequest":true,"CreatedAt":"2022-04-06T02:14:30","Actor":"vseanreesermsft","Number":"6360","RawContent":null,"Title":"Update branding to 3.1.25","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6360)","Url":"https://github.com/dotnet/wpf/pull/6360","RelatedDescription":"Closed or merged PR \"Update branding to 3.1.25\" (#6360)"},{"Id":"1193654699","IsPullRequest":true,"CreatedAt":"2022-04-06T02:13:53","Actor":"vseanreesermsft","Number":"6361","RawContent":null,"Title":"Update branding to 5.0.17","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6361)","Url":"https://github.com/dotnet/wpf/pull/6361","RelatedDescription":"Closed or merged PR \"Update branding to 5.0.17\" (#6361)"},{"Id":"1193772279","IsPullRequest":true,"CreatedAt":"2022-04-05T22:46:28","Actor":"dotnet-maestro[bot]","Number":"6367","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220405.6\r\n- **Date Produced**: April 5, 2022 9:42:55 PM UTC\r\n- **Commit**: 12fb1d1bf394066a31a76f68a6eca02a6fc56b91\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22161.2 to 6.0.0-rtm.22205.6][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GCc8d46e6&targetVersion=GC12fb1d1&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6367)","Url":"https://github.com/dotnet/wpf/pull/6367","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6367)"},{"Id":"1193737210","IsPullRequest":true,"CreatedAt":"2022-04-05T22:23:55","Actor":"dotnet-maestro[bot]","Number":"6366","RawContent":null,"Title":"[release/5.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:879723a8-02ca-470e-70c0-08d83eef1915)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 879723a8-02ca-470e-70c0-08d83eef1915\r\n- **Build**: 20220405.5\r\n- **Date Produced**: April 5, 2022 9:12:05 PM UTC\r\n- **Commit**: 70a0cf8c57aa58a11ce005659ba13a2b235c8cfe\r\n- **Branch**: refs/heads/release/5.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 5.0.12-servicing.22103.6 to 5.0.12-servicing.22205.5][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC4e0c495&targetVersion=GC70a0cf8&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:879723a8-02ca-470e-70c0-08d83eef1915)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6366)","Url":"https://github.com/dotnet/wpf/pull/6366","RelatedDescription":"Closed or merged PR \"[release/5.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6366)"},{"Id":"1193680804","IsPullRequest":true,"CreatedAt":"2022-04-05T21:19:15","Actor":"dotnet-maestro[bot]","Number":"6364","RawContent":null,"Title":"[release/5.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:1b2e9dc5-44be-480a-8167-08d86afc0648)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 1b2e9dc5-44be-480a-8167-08d86afc0648\r\n- **Build**: 20220309.5\r\n- **Date Produced**: March 9, 2022 9:39:48 PM UTC\r\n- **Commit**: ee744068a4fcccc5b8b56e0025f9c95aa19ff318\r\n- **Branch**: refs/heads/release/5.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/e5953f2...ee74406\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:1b2e9dc5-44be-480a-8167-08d86afc0648)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6364)","Url":"https://github.com/dotnet/wpf/pull/6364","RelatedDescription":"Closed or merged PR \"[release/5.0] Update dependencies from dotnet/arcade\" (#6364)"},{"Id":"1193674541","IsPullRequest":true,"CreatedAt":"2022-04-05T20:51:41","Actor":"dotnet-maestro[bot]","Number":"6363","RawContent":null,"Title":"[release/3.1] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:f6560d32-4c6b-4ed3-5c71-08d72a4d3f20)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: f6560d32-4c6b-4ed3-5c71-08d72a4d3f20\r\n- **Build**: 20220309.6\r\n- **Date Produced**: March 9, 2022 9:51:37 PM UTC\r\n- **Commit**: aebcd10d76469b2e84cffd39d043574bc5357d22\r\n- **Branch**: refs/heads/release/3.x\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 2.0.0-beta.22077.9 to 2.0.0-beta.22159.6][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/31e3d88...aebcd10\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:f6560d32-4c6b-4ed3-5c71-08d72a4d3f20)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6363)","Url":"https://github.com/dotnet/wpf/pull/6363","RelatedDescription":"Closed or merged PR \"[release/3.1] Update dependencies from dotnet/arcade\" (#6363)"},{"Id":"1193681844","IsPullRequest":true,"CreatedAt":"2022-04-05T20:24:54","Actor":"dotnet-maestro[bot]","Number":"6365","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"open","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20220328.5\r\n- **Date Produced**: March 28, 2022 7:04:19 PM UTC\r\n- **Commit**: f8c0d51185208227e582f76ac3c5003db237b689\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/879df78...f8c0d51\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6365)","Url":"https://github.com/dotnet/wpf/pull/6365","RelatedDescription":"Open PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#6365)"},{"Id":"1193636054","IsPullRequest":true,"CreatedAt":"2022-04-05T20:00:43","Actor":"vseanreesermsft","Number":"6358","RawContent":null,"Title":"Update branding to 3.1.25","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6358)","Url":"https://github.com/dotnet/wpf/pull/6358","RelatedDescription":"Closed or merged PR \"Update branding to 3.1.25\" (#6358)"},{"Id":"1193636245","IsPullRequest":true,"CreatedAt":"2022-04-05T20:00:34","Actor":"vseanreesermsft","Number":"6359","RawContent":null,"Title":"Update branding to 5.0.17","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6359)","Url":"https://github.com/dotnet/wpf/pull/6359","RelatedDescription":"Closed or merged PR \"Update branding to 5.0.17\" (#6359)"},{"Id":"1193654768","IsPullRequest":true,"CreatedAt":"2022-04-05T19:53:57","Actor":"vseanreesermsft","Number":"6362","RawContent":null,"Title":"Update branding to 6.0.5","State":"open","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6362)","Url":"https://github.com/dotnet/wpf/pull/6362","RelatedDescription":"Open PR \"Update branding to 6.0.5\" (#6362)"},{"Id":"1192668444","IsPullRequest":true,"CreatedAt":"2022-04-05T08:18:06","Actor":"singhashish-wpf","Number":"6357","RawContent":null,"Title":"Add rules to Fabricbot","State":"closed","Body":"Add more rules to fabric bot for issue/pr/label management.","Url":"https://github.com/dotnet/wpf/pull/6357","RelatedDescription":"Closed or merged PR \"Add rules to Fabricbot\" (#6357)"},{"Id":"1192507328","IsPullRequest":true,"CreatedAt":"2022-04-05T02:21:36","Actor":"dotnet-maestro[bot]","Number":"6356","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220404.1\r\n- **Date Produced**: April 5, 2022 1:29:40 AM UTC\r\n- **Commit**: 1616cf133035beadf3c97573c8abecbdb6750967\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22203.4 to 7.0.0-preview.4.22204.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22203.4 to 7.0.0-preview.4.22204.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/6cc092c...1616cf1\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6356","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6356)"},{"Id":"1192497141","IsPullRequest":false,"CreatedAt":"2022-04-05T01:33:45","Actor":"NWoodsman","Number":"6355","RawContent":null,"Title":"Setting System.Windows.Media.Pen.DashStyle exhibits unreliable behavior","State":"open","Body":"* .NET Core Version: 6.0\r\n* Windows version: Windows 10 build 19043.1586\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n* Is this bug related specifically to tooling in Visual Studio (e.g. XAML Designer, Code editing, etc...)? No\r\n* Security issues and bugs should be reported privately, learn more via our [responsible disclosure guidelines](https://github.com/dotnet/wpf/blob/main/README.md#reporting-security-issues-and-security-bugs).\r\n\r\n <!-- Read https://github.com/dotnet/wpf/blob/main/Documentation/issue-guide.md -->\r\n \r\n **Problem description:**\r\n\r\nSetting `System.Windows.Media.Pen.DashStyle` to a value changes the UI once and not again. \r\n\r\nThe code sample includes the following code:\r\n\r\n```\r\n            switch (Counter)\r\n            {\r\n                case 0:\r\n                    LineElement.Pen.DashStyle = new DashStyle(new double[] { 4, 6 }, 0);\r\n                    Counter++;\r\n                    break;\r\n                case 1:\r\n                    LineElement.Pen.DashStyle = DashStyles.Solid;\r\n                    Counter++;\r\n                    break;\r\n                case 2:\r\n                    LineElement.Pen.DashStyle = new DashStyle(new double[] { 4, 6 }, 0);\r\n                    Counter++;\r\n                    break;\r\n                case 3:\r\n                    LineElement.Pen.DashStyle = DashStyles.Solid;\r\n                    Counter++;\r\n                    break;\r\n\r\n                default:\r\n                    throw new ArgumentOutOfRangeException();\r\n            }\r\n\r\n```\r\nIn the above code extracted from my gist, the GUI changes at case 0 correctly and draws a dashed line. Then it fails to update at every other case.\r\n\r\nThe code copied into a .Net 4.8 WPF app exhibits the same behavior.\r\n\r\n \r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\n \r\nThe GUI changes exactly once when the `Pen.DashStyle` dependency property updates. Then it stops updating. \r\n\r\n **Expected behavior:**\r\n\r\nI expected that setting `Pen.DashStyle` more than once to new values would behave like a dependency property (since it is). \r\n \r\n **Minimal repro:**\r\n\r\nCreate new WPF .Net6 app, call it `WpfApp1`.\r\nReplace all of the code in MainWindow.xaml and MainWindow.xaml.cs with the code in the following gist files:\r\n[https://gist.github.com/NWoodsman/eccbc3c3164bc0691c6841d2836e6684](url)\r\nRun the app and click the button repeatedly.\r\n","Url":"https://github.com/dotnet/wpf/issues/6355","RelatedDescription":"Open issue \"Setting System.Windows.Media.Pen.DashStyle exhibits unreliable behavior\" (#6355)"},{"Id":"1191862185","IsPullRequest":true,"CreatedAt":"2022-04-04T14:15:54","Actor":"miloush","Number":"6354","RawContent":null,"Title":"DynamicResource support for app resource changes","State":"open","Body":"Fixes #6302\r\n\r\n## Description\r\n\r\nChanges in application resources are not picked up by `DynamicResource` extension if the target object is not in the visual tree (i.e. has no mentor). It already has code to access App/System resources in the absence of mentor which suggests this was meant to be a supported scenario.\r\n\r\nThis PR introduces internal `ResourcesChanged` instance event on the `Application` object and subscribes the `ResourceReferenceExpression` to the changes when the target element does not have a mentor.\r\n\r\n## Customer Impact\r\n\r\n`DynamicResource` extension on `DependencyObject`s such as `DataGridColumn`s or other user types will not track the changes to the application resources. However, the extension reads them correct the first time, making this issue difficult to diagnose.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nBuilt an updated _PresentationFramework.dll_ and tested with the repro project in #6302 on 6.0.2 x86 app.\r\n\r\n## Risk\r\n\r\nNo changes to public API. No changes to behavior when the resource does not come from App/System resources, or when the target object has a mentor. At runtime, each instance of `ResourceReferenceExpression` will create a strong reference to the Application instance, but only in the affected case.","Url":"https://github.com/dotnet/wpf/pull/6354","RelatedDescription":"Open PR \"DynamicResource support for app resource changes\" (#6354)"},{"Id":"1191718820","IsPullRequest":true,"CreatedAt":"2022-04-04T12:33:51","Actor":"miloush","Number":"6353","RawContent":null,"Title":"Adds System.Windows.DataObject.GetData overload taking an index","State":"open","Body":"Fixes #6352\r\n\r\n## Description\r\n\r\nApplications are unable to access multiple aspects/views of `IDataObject` (for example, when multiple files are pasted or dropped not from a file system).\r\n\r\nThe functionality already exists internally. This PR makes it accessible via a public API by adding an overload that accepts a value for `FORMATETC.lindex`.\r\n\r\nUnfortunately the functionality is only made available on `System.Windows.DataObject` since `IDataObject` is public and introducing a new member would break existing implementations.\r\n\r\nAn equivalent `SetData` update should be considered.\r\n\r\n## Customer Impact\r\n\r\nCustomers are unable to get data from drop operations or clipboard when `FileContents` format contains multiple files without rewriting the whole `IDataObject` stack.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nBuilt an updated _PresentationCore.dll_ and tested in 6.0.2 x86 app by dragging and dropping multiple attachments from Outlook onto a WPF window.\r\n\r\n## Risk\r\n\r\nAdding one new public overload of an existing method. If `DataObject` ever supports any other sources other than `OleConverter` and `DataStore`, the new `GetData` overload would need to be updated. Existing behavior not affected. ","Url":"https://github.com/dotnet/wpf/pull/6353","RelatedDescription":"Open PR \"Adds System.Windows.DataObject.GetData overload taking an index\" (#6353)"},{"Id":"1191644427","IsPullRequest":false,"CreatedAt":"2022-04-04T11:27:52","Actor":"miloush","Number":"6352","RawContent":null,"Title":"Support retrieving multiple file contents on drop","State":"open","Body":"**Scenario:**\r\n\r\nUser grabs multiple attachments in Outlook and drags & drops them into a WPF application. The application should be able to read the contents of all the files.\r\n\r\n**Current state:**\r\n\r\nThe existing `DataObject.GetData(\"FileContents\")` API only returns the first file. Other files need to be accessed by specifying the appropriate `FORMATETC.lindex` member, which is accessible through `DataObject.OleConverter.GetData` but not using the public API.\r\n\r\n**Proposed solution:**\r\n\r\nAdd `public GetData(string format, bool autoConvert, int index)` overload to `System.Windows.DataObject` that would pass the index to the underlying `DataObject.OleConverter.GetData` or `DataObject.DataStore.GetData` method. Ideally, this would be added on the `IDataObject` interface but that would be a breaking change since it's public.\r\n\r\nNote: This would enable developers to retrieve file content of all the dropped files. The developer would still need to obtain the file names and count by other means if needed, but reading the associated `FileGroupDescriptor` structure that is accessible through the existing API is much more straightforward then re-implementing the whole `IDataObject` API. ","Url":"https://github.com/dotnet/wpf/issues/6352","RelatedDescription":"Open issue \"Support retrieving multiple file contents on drop\" (#6352)"},{"Id":"1191550522","IsPullRequest":true,"CreatedAt":"2022-04-04T10:07:29","Actor":"miloush","Number":"6351","RawContent":null,"Title":"PickFolders option for OpenFileDialog","State":"open","Body":"For discussion. Fixes #438. Further discussion in #4039.\r\n\r\n## Description\r\n\r\nAllows developers to ask the user to select a folder, a feature known as `FolderBrowserDialog` in WinForms.\r\n\r\nThis PR is the least invasive way of introducing the feature. It closely reflects the underlying API design, i.e. the ability to specify `FOS_PICKFOLDERS` on the `IOpenFileDialog`. This is a backwards compatible solution - no public API has been moved or removed and no existing behavior has changed.\r\n\r\n### Tracking the flags\r\n\r\nThere is, however, an unfortunate implementation detail - the original authors of the code decided to use a single variable to store legacy OFN_ options, Vista FOS_ options and their own custom options. These options diverged and conflict with each other:\r\n\r\n| Value | OFN_ | FOS_ | OPTION_ |\r\n|---|---|---|---|\r\n| 0x0000_0001 | READONLY * | | |\r\n| 0x0000_0002 | OVERWRITEPROMPT | OVERWRITEPROMPT * | |\r\n| 0x0000_0004 | **HIDEREADONLY** * | **STRICTFILETYPES** | |\r\n| 0x0000_0008 | NOCHANGEDIR * | NOCHANGEDIR * | |\r\n| 0x0000_0010 | SHOWHELP | | |\r\n| 0x0000_0020 | **ENABLEHOOK** | **PICKFOLDERS** * | |\r\n| 0x0000_0040 | **ENABLETEMPLATE** | **FORCEFILESYSTEM** | |\r\n| 0x0000_0080 | **ENABLETEMPLATEHANDLE** | **ALLNONSTORAGEITEMS** | |\r\n| 0x0000_0100 | NOVALIDATE * | NOVALIDATE * | |\r\n| 0x0000_0200 | ALLOWMULTISELECT * | ALLOWMULTISELECT * | |\r\n| 0x0000_0400 | EXTENSIONDIFFERENT | | |\r\n| 0x0000_0800 | PATHMUSTEXIST * | PATHMUSTEXIST * | |\r\n| 0x0000_1000 | FILEMUSTEXIST | FILEMUSTEXIST * | |\r\n| 0x0000_2000 | CREATEPROMPT | CREATEPROMPT * | |\r\n| 0x0000_4000 | SHAREAWARE | SHAREAWARE | |\r\n| 0x0000_8000 | NOREADONLYRETURN | NOREADONLYRETURN | |\r\n| 0x0001_0000 | NOTESTFILECREATE | NOTESTFILECREATE | |\r\n| 0x0002_0000 | **NONETWORKBUTTON** | **HIDEMRUPLACES** | |\r\n| 0x0004_0000 | **NOLONGNAMES** | **HIDEPINNEDPLACES** | |\r\n| 0x0008_0000 | EXPLORER | | |\r\n| 0x0010_0000 | NODEREFERENCELINKS * | NODEREFERENCELINKS * | |\r\n| 0x0020_0000 | **LONGNAMES** | **OKBUTTONNEEDSINTERACTION** | |\r\n| 0x0040_0000 | ENABLEINCLUDENOTIFY | | |\r\n| 0x0080_0000 | ENABLESIZING | | |\r\n| 0x0100_0000 | USESHELLITEM | | |\r\n| 0x0200_0000 | DONTADDTORECENT | DONTADDTORECENT | |\r\n| 0x0400_0000 | | | |\r\n| 0x0800_0000 | | | |\r\n| 0x1000_0000 | FORCESHOWHIDDEN | FORCESHOWHIDDEN | |\r\n| 0x2000_0000 | | DEFAULTNOMINIMODE | |\r\n| 0x4000_0000 | | FORCEPREVIEWPANEON | |\r\n| 0x8000_0000 | | **SUPPORTSTREAMABLEITEMS** | **ADDEXTENSION** |\r\n\r\n\\* allowed to set in code as flags (i.e. preserved by masking)\r\n\r\nMost notably `FOS_PICKFOLDERS` conflicts with `OFN_ENABLEHOOK`. The existing code sort of supports only the flags having the same value in both API and passes the combination directly to the APIs. Few conflicting ones are enforced at call time and developers cannot disable them:\r\n\r\nFor legacy dialogs, that is:\r\n* `OFN_EXPLORER`\r\n* `OFN_ENABLEHOOK`\r\n* `OFN_ENABLESIZING`\r\n\r\nFor Vista dialogs, that is:\r\n* `FOS_DEFAULTNOMINIMODE`\r\n* `FOS_FORCEFILESYSTEM`\r\n\r\nUsing the existing infrastructure would mean either\r\n1) using `OFN_EXPLORER` bit to also mean `FOS_PICKFOLDERS`, or;\r\n2) adding a new custom `OPTION_PICKFOLDERS`, preferably as one of the unoccupied bits. \r\n\r\nThe former is messy (either requires casting from FOS or declaring fake OFN constant) and creates confusing code. The latter is in danger that new conflicting flags will be introduced, like it already happened with `OPTION_ADDEXTENSION`.\r\n\r\nI therefore decided for a potentially controversial solution - I split the backing field and track legacy and Vista options separately. The custom option stays in the legacy field, as no new flags are expected in the legacy API. I am willing to implement options 1) or 2) instead if that was preferred.\r\n\r\n### New visible members\r\n\r\nIn `OpenFileDialog`:\r\n* `public bool PickFolders { get; set; }`\r\n\r\nIn `FileDialog`:\r\n* `protected int VistaOptions { get; }`\r\n\r\n### CheckFileExists behavior\r\n\r\nThe `OpenFileDialog` turns on `CheckFileExists` by default. The property works as advertised, meaning users cannot confirm anything if only folders are available to pick. For convenience, setting the `PickFolders` option has a side effect of unsetting the `CheckFileExists` option.\r\n\r\n### Existing properties on folder dialog\r\n\r\n(excerpt from discussion in #4039)\r\n\r\nThese are the current public properties on the `FileDialog`.\r\n\r\nApplicable to folder selection:\r\n* `CustomPlaces`\r\n* `DereferenceLinks` - whether links to folders are followed or not allowed\r\n* `FileName` - e.g. _C:\\Users\\Thomas_\r\n* `FileNames` - always has 1 item at the moment\r\n* `InitialDirectory`\r\n* `SafeFileName` - e.g. _Thomas_\r\n* `SafeFileNames` - always has 1 item at the moment\r\n* `Tag`\r\n* `Title`\r\n\r\nDoing something, but wouldn't be necessary for folders:\r\n* `AddExtension` - internal WPF flag to ensure the file/folder name ends with an extension\r\n* `CheckFileExists` - makes it unable to select a folder, see above\r\n* `DefaultExt` - the extension to add by default\r\n* `ValidateNames` - this one is a red flag, the WPF documentation says \"indicating whether the dialog box accepts only valid Win32 file names.\" which is how the `OFN_NOVALIDATE` flag [works](https://docs.microsoft.com/en-us/windows/win32/api/commdlg/ns-commdlg-openfilenamea) in the legacy file dialogs. However, for the Vista dialogs, the `FOS_NOVALIDATE` flag [means](https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/ne-shobjidl_core-_fileopendialogoptions) \"check for situations that would prevent an application from opening the selected file, such as sharing violations or access denied errors.\"). In addition to the dialog behavior, WPF uses the flag for adding extensions and prompting for overwriting existing files.\r\n\r\nNote that `DefaultExt` with `AddExtensions` are already available for _open_ file dialog which doesn't make much sense, but they work the same when folders are selected.\r\n\r\nValid but currently without any effect:\r\n* `CheckPathExists` - only existing folders are available for selection currently\r\n* `RestoreDirectory` - applicable to legacy dialogs only, [not used](http://web.archive.org/web/20131017051601/http://msdn.microsoft.com/en-us/library/bb761832(VS.85).aspx) in Vista dialogs\r\n\r\nInvalid (the native call returns an error):\r\n* `Filter`\r\n* `FilterIndex`\r\n\r\n### Existing methods on folder dialog\r\n\r\n* `OpenFile` and `OpenFiles` throw `UnauthorisedAccessException` on folders. The existing code should already expect this type of exception when opening files.\r\n\r\n### Legacy behavior\r\n\r\nThe code currently throws `PlatformNotSupported` exception on Windows XP. If that is acceptable, exception message needs to be added. If not, support for `SHBrowseForFolder` API needs to be implemented, which carries non-trivial number of native types (or WinForms version called instead).\r\n\r\n## Customer Impact\r\n\r\nWithout this fix, users have to either use WinForms' `FolderBrowserDialog`, resort to 3rd party libraries or re-implement the whole `IFileDialog` API. #438 is currently the top voted issue in the repository.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nCompiled custom _PresentationFramework.dll_ and tested in 6.0.2 x86 app that both folder browsing and file browsing works as expected.\r\n\r\n## Risk\r\n\r\nOne public and one protected member are added. Existing behavior is not affected. Existing members (even private) still carry the same data. Minimal performance impact (most properties now change two fields) and minimal memory impact (one integer with corresponding generic type). \r\n\r\nUser code that processes \"used\" file dialogs could now be handed an instance that unexpectedly contains folders in the `FileName(s)` properties. This, however, would have to be explicitly caused using new code. Unexpected file operations on folders (i.e. trying to open them) yield IO exceptions that the existing code should be already handling.\r\n\r\n/cc @Symbai @ThomasGoulet73 @fabiant3 ","Url":"https://github.com/dotnet/wpf/pull/6351","RelatedDescription":"Open PR \"PickFolders option for OpenFileDialog\" (#6351)"},{"Id":"1191333160","IsPullRequest":true,"CreatedAt":"2022-04-04T07:12:38","Actor":"dotnet-maestro[bot]","Number":"6350","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220403.4\r\n- **Date Produced**: April 4, 2022 5:58:23 AM UTC\r\n- **Commit**: 6cc092ccf4eedcee415d8779a52bcc061846f7ca\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22203.3 to 7.0.0-preview.4.22203.4][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22203.3 to 7.0.0-preview.4.22203.4][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/713c51e...6cc092c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6350","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6350)"},{"Id":"1191310701","IsPullRequest":true,"CreatedAt":"2022-04-04T06:42:03","Actor":"dotnet-maestro[bot]","Number":"6349","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220403.3\r\n- **Date Produced**: April 4, 2022 5:50:43 AM UTC\r\n- **Commit**: 713c51eb66529e3367eca7ac39e0f2615a332d80\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22203.2 to 7.0.0-preview.4.22203.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22203.2 to 7.0.0-preview.4.22203.3][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/b105cc4...713c51e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6349","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6349)"},{"Id":"1191288566","IsPullRequest":true,"CreatedAt":"2022-04-04T06:16:50","Actor":"dotnet-maestro[bot]","Number":"6348","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220403.2\r\n- **Date Produced**: April 4, 2022 5:28:25 AM UTC\r\n- **Commit**: b105cc49b72e49934e4c3fc85d589eadde860155\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22203.1 to 7.0.0-preview.4.22203.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22203.1 to 7.0.0-preview.4.22203.2][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.3][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/03a5349...b105cc4\r\n[2]: https://github.com/dotnet/runtime/compare/c3843c5...c3e4495\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6348","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6348)"},{"Id":"1191271541","IsPullRequest":true,"CreatedAt":"2022-04-04T05:47:20","Actor":"dotnet-maestro[bot]","Number":"6347","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220403.1\r\n- **Date Produced**: April 4, 2022 4:59:39 AM UTC\r\n- **Commit**: 03a5349a0a9292ce7283e92927294d238c146389\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22201.2 to 7.0.0-preview.4.22203.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22201.2 to 7.0.0-preview.4.22203.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/7ea91b0...03a5349\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6347","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6347)"},{"Id":"1191027367","IsPullRequest":false,"CreatedAt":"2022-04-03T19:48:48","Actor":"miloush","Number":"6346","RawContent":null,"Title":"OpenFileDialog.ShowReadOnly does not work","State":"open","Body":"* .NET Core Version: 7.0.0-preview.2.22152.2\r\n* Windows version: 22581.1.amd64fre.ni_release.220318-1623\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n \r\n **Problem description:**\r\n\r\nThe `OpenFileDialog` ignores the `ShowReadOnly` property on the Vista code path.\r\n \r\n**Actual behavior:**\r\n\r\nNo check box in the dialog.\r\n \r\n **Expected behavior:**\r\n\r\nA check box in the dialog as per documentation.\r\n\r\nA dropdown option on the Open button would also be acceptable:\r\n<img src=\"https://user-images.githubusercontent.com/10546952/161445476-4e0af62e-5353-43d3-ab72-eda6425bda84.png\">\r\n\r\n **Minimal repro:**\r\n\r\n```C#\r\nOpenFileDialog ofd = new OpenFileDialog();\r\nofd.ShowReadOnly = true;\r\nofd.ShowDialog();\r\n```\r\n","Url":"https://github.com/dotnet/wpf/issues/6346","RelatedDescription":"Open issue \"OpenFileDialog.ShowReadOnly does not work\" (#6346)"},{"Id":"1190986858","IsPullRequest":true,"CreatedAt":"2022-04-03T17:02:42","Actor":"miloush","Number":"6345","RawContent":null,"Title":"Account for optional out parameters in IStream","State":"open","Body":"Fixes #6344 \r\n\r\n## Description\r\n\r\n`System.Windows.Media.StreamAsIStream.Write(byte[] buffer, uint cb, out uint cbWritten)` throws `NullReferenceException` when trying to set `cbWritten` because the `out int cbWritten` parameter has been passed in as null.\r\n\r\nAccording to the documentation, caller can pass `NULL` as `pcbWritten` to [IStream::Write](https://docs.microsoft.com/en-us/windows/win32/api/objidl/nf-objidl-isequentialstream-write) when they are not interested in the number of bytes written.\r\n\r\nThe `CManagedStreamWrapper` does not expect that and [simply passes](https://github.com/dotnet/wpf/blob/89d172db0b7a192de720c6cfba5e28a1e7d46123/src/Microsoft.DotNet.Wpf/src/WpfGfx/core/api/exports.cpp#L775-L782) the pointer to the managed assembly, however, CLR is not happy with writing to null out parameters.\r\n\r\nThe PR fixes the issue by always passing a valid reference to the managed assembly. If an output argument was omitted, a reference to a local variable on stack is passed instead, and the output value is thrown away.\r\n\r\nThe same convention applies to `IStream::Seek` and `IStream::CopyTo` methods.\r\n\r\n## Customer Impact\r\n\r\nCustomers are unable to use WIC encoders (and potentially decoders) that call `IStream` without the optional parameters (i.e. passing `NULL`). In the case of #6344, customers cannot save HEIF files using a paid encoder provided by Microsoft (built-in in previous Windows builds).\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nCompiled an updated _wpfgfx_cor3.dll_ and tested in .NET 6.0.2 x86 WPF application with the repro code in #6344.\r\n\r\n## Risk\r\n\r\nI am not aware of any risks, the fix does not affect any currently working scenario.\r\n","Url":"https://github.com/dotnet/wpf/pull/6345","RelatedDescription":"Open PR \"Account for optional out parameters in IStream\" (#6345)"},{"Id":"1190981201","IsPullRequest":false,"CreatedAt":"2022-04-03T16:41:39","Actor":"miloush","Number":"6344","RawContent":null,"Title":"BitmapEncoder.Save throws NullReferenceException","State":"open","Body":"* .NET Core Version: 6.0.300-preview.22154.4\r\n* Windows version: 22581.1.amd64fre.ni_release.220318-1623\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Yes\r\n \r\n **Problem description:**\r\n\r\nWhen using HEIF encoder, the `BitmapEncoder.Save` method throws a `NullReferenceException`. User cannot avoid this codepath.\r\n\r\nDiscovered in #6337. \r\n \r\n **Actual behavior:**\r\n\r\n```\r\nSystem.NullReferenceException\r\n  HResult=0x80004003\r\n  Message=Object reference not set to an instance of an object.\r\n  Source=PresentationCore\r\n  StackTrace:\r\n   at System.Windows.Media.StreamAsIStream.Write(Byte[] buffer, UInt32 cb, UInt32& cbWritten) in f:\\dd\\wpf\\src\\Core\\CSharp\\System\\Windows\\Media\\StreamAsIStream.cs:line 533\r\n```\r\n \r\n **Expected behavior:**\r\n\r\nNo exception.\r\n \r\n **Minimal repro:**\r\n\r\n```C#\r\nGuid heif = new Guid(0xe1e62521, 0x6787, 0x405b, 0xa3, 0x39, 0x50, 0x07, 0x15, 0xb5, 0x76, 0x3f);\r\nvar enc = BitmapEncoder.Create(heif);\r\nenc.Frames.Add(BitmapFrame.Create(BitmapSource.Create(100, 100, 96, 96, PixelFormats.Bgr32, null, new int[100 * 100], 100 * 4)));\r\nenc.Save(new MemoryStream());\r\n```\r\n\r\nRequires HEIF encoder to be installed, e.g. via _HEVC Video Extensions_ from store (`COMException` is thrown instead if encoder is not installed).","Url":"https://github.com/dotnet/wpf/issues/6344","RelatedDescription":"Open issue \"BitmapEncoder.Save throws NullReferenceException\" (#6344)"},{"Id":"1190654379","IsPullRequest":false,"CreatedAt":"2022-04-02T14:51:07","Actor":"AArnott","Number":"6343","RawContent":null,"Title":"FrameworkTemplate.FindName should provide a way to avoid InvalidOperationException","State":"open","Body":"The `FrameworkTemplate.FindName` method throws `InvalidOperationException` when the template doesn't match:\r\n\r\nhttps://github.com/dotnet/wpf/blob/559ca9bfc2b47691e9966fcb28c7378e7c1521fc/src/Microsoft.DotNet.Wpf/src/PresentationFramework/System/Windows/FrameworkTemplate.cs#L317-L320\r\n\r\nBut there appears to be no way for the caller to check this condition beforehand in order to avoid the exception. The `TemplateInternal` property is internal. And the actual object I have is `ContentPresenter`, whose `TemplateInternal` implementation just returns its `Template` property, which is *private*. That property is a dependency property backed by an internal field. So I appear to be cut off in all ways.\r\n\r\nFix ideas:\r\n1. Add a `TryFindName` method that won't throw. This would solve the whole problem.\r\n2. Expose the `ContentPresenter.Template` property. This would solve *my* problem but doesn't guarantee that the exception can be avoided for all control types.","Url":"https://github.com/dotnet/wpf/issues/6343","RelatedDescription":"Open issue \"FrameworkTemplate.FindName should provide a way to avoid InvalidOperationException\" (#6343)"},{"Id":"1190475970","IsPullRequest":true,"CreatedAt":"2022-04-02T03:05:05","Actor":"ThomasGoulet73","Number":"6342","RawContent":null,"Title":"Remove SecurityCriticalDataForMultipleGetAndSet","State":"open","Body":"## Description\r\nRemoves SecurityCriticalDataForMultipleGetAndSet which is unused since the removal of CAS attributes in #994.\r\n\r\nRemoves these 2 allocations from an empty new WPF application:\r\n![image](https://user-images.githubusercontent.com/51839772/161363392-2b9aa559-9a23-478f-92c6-2d37560d3335.png)\r\n\r\n## Customer Impact\r\nRemoves unnecessary allocations.\r\n\r\n## Regression\r\nNo.\r\n\r\n## Testing\r\nTested locally + CI.\r\n\r\n## Risk\r\nLow.","Url":"https://github.com/dotnet/wpf/pull/6342","RelatedDescription":"Open PR \"Remove SecurityCriticalDataForMultipleGetAndSet\" (#6342)"},{"Id":"1190144400","IsPullRequest":true,"CreatedAt":"2022-04-01T18:58:39","Actor":"dotnet-maestro[bot]","Number":"6341","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220401.2\r\n- **Date Produced**: April 1, 2022 6:03:50 PM UTC\r\n- **Commit**: 7ea91b02ce09e83616177bcc2bbf954e15f65a2b\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22201.1 to 7.0.0-preview.4.22201.2][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22180.7 to 7.0.0-preview.4.22201.1][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/350a820...7ea91b0\r\n[2]: https://github.com/dotnet/runtime/compare/c0db07b...c3843c5\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6341","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6341)"},{"Id":"1189835807","IsPullRequest":true,"CreatedAt":"2022-04-01T14:38:14","Actor":"dotnet-maestro[bot]","Number":"6340","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220401.1\r\n- **Date Produced**: April 1, 2022 1:30:33 PM UTC\r\n- **Commit**: 350a820f8d10762ca6f6fbb863af8afe29a615c3\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22181.1 to 7.0.0-preview.4.22201.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22181.1 to 7.0.0-preview.4.22201.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/05fbdd8...350a820\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6340","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6340)"},{"Id":"1189727870","IsPullRequest":true,"CreatedAt":"2022-04-01T12:54:49","Actor":"dotnet-maestro[bot]","Number":"6339","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220331.2\r\n- **Date Produced**: March 31, 2022 3:37:49 PM UTC\r\n- **Commit**: e0b311bcd81fc9e27bcf7715dcda62fa38dfa49a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22179.1 to 7.0.0-beta.22181.2][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22179.1 to 7.0.0-beta.22181.2][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22179.1 to 7.0.0-beta.22181.2][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22179.1 to 7.0.0-beta.22181.2][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22179.1 to 7.0.0-beta.22181.2][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/1527dc8...e0b311b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n- **Updates to .NET SDKs:**\r\n  - Updates sdk.version to 7.0.100-preview.2.22153.17\r\n  - Updates tools.dotnet to 7.0.100-preview.2.22153.17\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n","Url":"https://github.com/dotnet/wpf/pull/6339","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6339)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-04-06T03:30:29.2139418Z","RunDurationInMilliseconds":476}