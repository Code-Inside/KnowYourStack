{"Data":{"GitHub":{"Issues":[{"Id":"1198816229","IsPullRequest":false,"CreatedAt":"2022-04-10T00:21:22","Actor":"sam-wheat","Number":"6391","RawContent":null,"Title":"How to intercept a bound command?","State":"open","Body":"I wrote a simple control that displays a popup with a ListBox.  Implementer of my control can bind a command to `SelectionChangedCommand`, which will execute when user selects an item from the ListBox.  However, before `SelectionChangedCommand` executes, I want to set `IsDropDownOpen` property on my control to false which will close the popup.  \r\n\r\nBasically I want to intercept `SelectionChangedCommand`, set `IsDropDownOpen` to false, then allow `SelectionChangedCommand` to execute normally.  How do I do this?\r\n\r\n`StaysOpen` property of Popup does not achive the desired effect and in fact prevents the popup from closing when the mouse leaves.\r\n\r\nExample project attached.\r\n\r\nThank you\r\n[CommandProblem.zip](https://github.com/dotnet/wpf/files/8457976/CommandProblem.zip)\r\n.","Url":"https://github.com/dotnet/wpf/issues/6391","RelatedDescription":"Open issue \"How to intercept a bound command?\" (#6391)"},{"Id":"1198622061","IsPullRequest":true,"CreatedAt":"2022-04-09T14:28:59","Actor":"dotnet-maestro[bot]","Number":"6390","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:Coherency Updates)\r\n## Coherency Updates\r\n\r\nThe following updates ensure that dependencies with a *CoherentParentDependency*\r\nattribute were produced in a build used as input to the parent dependency's build.\r\nSee [Dependency Description Format](https://github.com/dotnet/arcade/blob/master/Documentation/DependencyDescriptionFormat.md#dependency-description-overview)\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Coherency Updates**:\r\n  - **System.CodeDom**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Configuration.ConfigurationManager**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Diagnostics.EventLog**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.DirectoryServices**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Drawing.Common**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Reflection.MetadataLoadContext**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Cryptography.Xml**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Security.Permissions**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Windows.Extensions**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.Platforms**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.IO.Packaging**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **System.Resources.Extensions**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Ref**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8 (parent: Microsoft.Private.Winforms)\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n[marker]: <> (End:Coherency Updates)\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220409.1\r\n- **Date Produced**: April 9, 2022 1:39:16 PM UTC\r\n- **Commit**: 8a8cdf84ae2519b6961f68c3bbbe4f8055478e84\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22208.2 to 7.0.0-preview.4.22209.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22208.2 to 7.0.0-preview.4.22209.1][1]\r\n  - **System.CodeDom**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Configuration.ConfigurationManager**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Diagnostics.EventLog**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.DirectoryServices**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Drawing.Common**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Reflection.MetadataLoadContext**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Security.Cryptography.Xml**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Security.Permissions**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Windows.Extensions**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **Microsoft.NETCore.Platforms**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.IO.Packaging**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **System.Resources.Extensions**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **Microsoft.NETCore.App.Ref**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **Microsoft.NETCore.App.Runtime.win-x64**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n  - **VS.Redist.Common.NetCore.SharedFramework.x64.7.0**: [from 7.0.0-preview.4.22201.3 to 7.0.0-preview.4.22208.8][2]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/c402e2a...8a8cdf8\r\n[2]: https://github.com/dotnet/runtime/compare/c3e4495...b8dc04b\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6390)","Url":"https://github.com/dotnet/wpf/pull/6390","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6390)"},{"Id":"1197597708","IsPullRequest":true,"CreatedAt":"2022-04-08T18:11:28","Actor":"dotnet-maestro[bot]","Number":"6389","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220408.2\r\n- **Date Produced**: April 8, 2022 5:22:09 PM UTC\r\n- **Commit**: c402e2a21cc3d6ab1c3fe6209ff829361aa596b9\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22208.1 to 7.0.0-preview.4.22208.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22208.1 to 7.0.0-preview.4.22208.2][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/6a38671...c402e2a\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6389)","Url":"https://github.com/dotnet/wpf/pull/6389","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6389)"},{"Id":"1197362326","IsPullRequest":true,"CreatedAt":"2022-04-08T14:31:44","Actor":"dotnet-maestro[bot]","Number":"6388","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220408.1\r\n- **Date Produced**: April 8, 2022 1:38:02 PM UTC\r\n- **Commit**: 6a3867101ca058010147742789d7ab52b11da0bd\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22207.7 to 7.0.0-preview.4.22208.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22207.7 to 7.0.0-preview.4.22208.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/eb36218...6a38671\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6388)","Url":"https://github.com/dotnet/wpf/pull/6388","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6388)"},{"Id":"1197259751","IsPullRequest":true,"CreatedAt":"2022-04-08T12:54:47","Actor":"dotnet-maestro[bot]","Number":"6387","RawContent":null,"Title":"[main] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 840bf684-917a-4879-f62c-08d8e93a0c51\r\n- **Build**: 20220406.10\r\n- **Date Produced**: April 6, 2022 11:05:52 PM UTC\r\n- **Commit**: 549523c3fc8929da1a3073d1a97f298e0d1dc342\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 7.0.0-beta.22181.2 to 7.0.0-beta.22206.10][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 7.0.0-beta.22181.2 to 7.0.0-beta.22206.10][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 7.0.0-beta.22181.2 to 7.0.0-beta.22206.10][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 7.0.0-beta.22181.2 to 7.0.0-beta.22206.10][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 7.0.0-beta.22181.2 to 7.0.0-beta.22206.10][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/e0b311b...549523c\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:840bf684-917a-4879-f62c-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6387)","Url":"https://github.com/dotnet/wpf/pull/6387","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/arcade\" (#6387)"},{"Id":"1197005726","IsPullRequest":false,"CreatedAt":"2022-04-08T08:26:12","Actor":"wstaelens","Number":"6386","RawContent":null,"Title":"XpsDocumentWriter.SaveAsXaml - BitmapMetadata is not available on BitmapImage","State":"open","Body":"* .NET Core Version: 6.0 (guess all versions)\r\n* Visual Studio 2019, 2022, 2022 preview\r\n \r\n **Problem description:**\r\n Attaching WinDbg Preview to a process I see lots of System.NotSupportedException happening with message  \"BitmapMetadata is not available on BitmapImage\"\r\n\r\nWhy throw instead of checking if metadata is supported or not ?\r\n\r\n **Actual behavior:** <!-- callstack for crashes / exceptions -->\r\n\r\n`(50e8.3f8): CLR exception - code e0434352 (first chance)\r\nException object: 000001f93a3e2b20\r\nException type:   System.NotSupportedException\r\nMessage:          BitmapMetadata is not available on BitmapImage.\r\nInnerException:   <none>\r\nStackTrace (generated):\r\n<none>\r\nStackTraceString: <none>\r\nHResult: 80131515\r\nOS Thread Id: 0x3f8 (19)\r\n        Child SP               IP Call Site\r\n000000ED8423BC68 00007ff8a4b44f69 [HelperMethodFrame: 000000ed8423bc68] \r\n000000ED8423BD60 00007ff831597011 System.Windows.Media.Imaging.BitmapImage.get_Metadata()\r\n000000ED8423BDA0 00007ff82e52057c System.Windows.Media.Imaging.BitmapFrame.Create(System.Windows.Media.Imaging.BitmapSource)\r\n000000ED8423BDF0 00007ff82e520442 System.Windows.Xps.Serialization.ImageSourceTypeConverter.ReEncodeImage(System.Windows.Media.Imaging.BitmapSource, System.Windows.Media.Imaging.BitmapEncoder, System.IO.Stream)\r\n000000ED8423BEB0 00007ff82e517e98 System.Windows.Xps.Serialization.ImageSourceTypeConverter.ConvertTo(System.ComponentModel.ITypeDescriptorContext, System.Globalization.CultureInfo, System.Object, System.Type)\r\n000000ED8423BF50 00007ff82e517744 System.Windows.Xps.Serialization.VisualSerializer.WriteBitmap(System.String, System.Windows.Media.ImageSource)\r\n000000ED8423C040 00007ff82e515dab System.Windows.Xps.Serialization.VisualSerializer.BrushToString(System.Windows.Media.Brush, System.Windows.Rect)\r\n000000ED8423C560 00007ff82e514da4 System.Windows.Xps.Serialization.VisualSerializer.FindBrush(System.Windows.Media.Brush, System.Windows.Rect)\r\n000000ED8423C5E0 00007ff82df723bc System.Windows.Xps.Serialization.VisualSerializer.WriteBrush(System.String, System.Windows.Media.Brush, System.Windows.Rect)\r\n000000ED8423C640 00007ff82df70e78 System.Windows.Xps.Serialization.VisualSerializer.System.Windows.Xps.Serialization.IMetroDrawingContext.DrawGeometry(System.Windows.Media.Brush, System.Windows.Media.Pen, System.Windows.Media.Geometry)\r\n000000ED8423C810 00007ff82e513f55 System.Windows.Xps.Serialization.DrawingContextFlattener.DrawImage(System.Windows.Media.ImageSource, System.Windows.Rect)\r\n000000ED8423C8A0 00007ff82df6b4ef System.Windows.Xps.Serialization.VisualTreeFlattener.DrawingWalk(System.Windows.Media.Drawing, System.Windows.Media.Matrix)\r\n000000ED8423CB80 00007ff82df6b7e8 System.Windows.Xps.Serialization.VisualTreeFlattener.DrawingWalk(System.Windows.Media.Drawing, System.Windows.Media.Matrix)\r\n000000ED8423CE60 00007ff82df6b7e8 System.Windows.Xps.Serialization.VisualTreeFlattener.DrawingWalk(System.Windows.Media.Drawing, System.Windows.Media.Matrix)\r\n000000ED8423D140 00007ff82df6b7e8 System.Windows.Xps.Serialization.VisualTreeFlattener.DrawingWalk(System.Windows.Media.Drawing, System.Windows.Media.Matrix)\r\n000000ED8423D420 00007ff82e46fa7b System.Windows.Xps.Serialization.VisualTreeFlattener.StartVisual(System.Windows.Media.Visual)\r\n000000ED8423D930 00007ff82e4f3da0 System.Windows.Xps.Serialization.ReachVisualSerializer.SerializeTree(System.Windows.Media.Visual, System.Xml.XmlWriter, System.Xml.XmlWriter)\r\n000000ED8423D9E0 00007ff82e4f377a System.Windows.Xps.Serialization.ReachUIElementCollectionSerializer.SerializeUIElements(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DA30 00007ff82e4eb27b System.Windows.Xps.Serialization.ReachSerializer.SerializeObject(System.Windows.Xps.Serialization.SerializablePropertyContext)\r\n000000ED8423DA70 00007ff82e4eb1a3 System.Windows.Xps.Serialization.ReachSerializer.SerializeProperties(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DAB0 00007ff82e4f104e System.Windows.Xps.Serialization.FixedPageSerializer.PersistObjectData(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DB90 00007ff82e4bf022 System.Windows.Xps.Serialization.ReachSerializer.SerializeObject(System.Object)\r\n000000ED8423DBD0 00007ff82e4bf022 System.Windows.Xps.Serialization.ReachSerializer.SerializeObject(System.Object)\r\n000000ED8423DC10 00007ff82e4efdb5 System.Windows.Xps.Serialization.ReachPageContentCollectionSerializer.SerializePageContent(System.Object)\r\n000000ED8423DC60 00007ff82e53b75a System.Windows.Xps.Serialization.ReachPageContentCollectionSerializer.SerializePageContents(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DCB0 00007ff82e4eb27b System.Windows.Xps.Serialization.ReachSerializer.SerializeObject(System.Windows.Xps.Serialization.SerializablePropertyContext)\r\n000000ED8423DCF0 00007ff82e4eb1a3 System.Windows.Xps.Serialization.ReachSerializer.SerializeProperties(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DD30 00007ff82e53ae35 System.Windows.Xps.Serialization.FixedDocumentSerializer.PersistObjectData(System.Windows.Xps.Serialization.SerializableObjectContext)\r\n000000ED8423DD80 00007ff82e4bf022 System.Windows.Xps.Serialization.ReachSerializer.SerializeObject(System.Object)\r\n000000ED8423DDC0 00007ff82e539ab4 System.Windows.Xps.Serialization.XpsSerializationManager.SaveAsXaml(System.Object)\r\n000000ED8423DE20 00007ff82e5397ef System.Windows.Xps.XpsDocumentWriter.SaveAsXaml(System.Object, Boolean)`\r\n \r\n **Expected behavior:**\r\n\r\nLooks like this is by design: https://stackoverflow.com/a/17027474/187650\r\nThough, would be much nicer to see if metadata is supported instead of throwing...\r\n \r\n\r\n","Url":"https://github.com/dotnet/wpf/issues/6386","RelatedDescription":"Open issue \"XpsDocumentWriter.SaveAsXaml - BitmapMetadata is not available on BitmapImage\" (#6386)"},{"Id":"1193980546","IsPullRequest":true,"CreatedAt":"2022-04-08T05:18:45","Actor":"singhashish-wpf","Number":"6370","RawContent":null,"Title":"use unscaled mouse coordinates for convex hull test (#6332)","State":"closed","Body":"Fixes #6220\r\n\r\n## Description\r\n\r\n<!-- Give a brief summary of the issue and how the pull request is fixing it. -->\r\nIn high DPI environment, most tooltips opened by the mouse close immediately.\r\n\r\nThis is because the SafeArea uses unscaled coordinates, while the current mouse point uses scaled coordinates.  In high DPI, these are different, leading to false negatives from the containment test \"is the mouse within the SafeArea\".\r\n\r\nFixed by using unscaled coordinates for the mouse point.  (And incidentally improving the perf by avoiding a lot of unnecessary transformations into, and out of, scaled coordinates.)\r\n\r\n## Customer Impact\r\n\r\n<!-- What is the impact to customers of not taking this fix? -->\r\nMake ToolTips great again (in high DPI).\r\n\r\n## Regression\r\n\r\n<!-- Is this fixing a problem that was introduced in the most recent release, ie., fixing a regression? -->\r\nRegression in PR #5931.\r\n\r\n## Testing\r\n\r\n<!-- What kind of testing has been done with the fix. -->\r\nTested by hand, but thoroughly, in .NET 4.8.1.  The automated tests don't cover high DPI, unless you explicitly run them on a machine whose primary monitor is high DPI.\r\n\r\nThis is a straightforward port of the .NET Fx fix but should be tested in .NET Core anyway.\r\n\r\n## Risk\r\nLow\r\n<!-- Please assess the risk of taking this fix. Provide details backing up your assessment. -->\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6370)","Url":"https://github.com/dotnet/wpf/pull/6370","RelatedDescription":"Closed or merged PR \"use unscaled mouse coordinates for convex hull test (#6332)\" (#6370)"},{"Id":"1196730935","IsPullRequest":true,"CreatedAt":"2022-04-08T02:09:52","Actor":"dotnet-maestro[bot]","Number":"6385","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220407.7\r\n- **Date Produced**: April 8, 2022 1:21:03 AM UTC\r\n- **Commit**: eb36218b4928084385a80f51c4eb628509087bae\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22207.6 to 7.0.0-preview.4.22207.7][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22207.6 to 7.0.0-preview.4.22207.7][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/5a2d392...eb36218\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6385)","Url":"https://github.com/dotnet/wpf/pull/6385","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6385)"},{"Id":"1196697054","IsPullRequest":true,"CreatedAt":"2022-04-08T01:07:16","Actor":"dotnet-maestro[bot]","Number":"6384","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220407.6\r\n- **Date Produced**: April 8, 2022 12:06:27 AM UTC\r\n- **Commit**: 5a2d392b32a4bd1d6849914082e596e33b16e537\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22207.5 to 7.0.0-preview.4.22207.6][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22207.5 to 7.0.0-preview.4.22207.6][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/4c39af9...5a2d392\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6384)","Url":"https://github.com/dotnet/wpf/pull/6384","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6384)"},{"Id":"1196685049","IsPullRequest":true,"CreatedAt":"2022-04-08T00:40:27","Actor":"dotnet-maestro[bot]","Number":"6383","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220407.5\r\n- **Date Produced**: April 7, 2022 11:47:22 PM UTC\r\n- **Commit**: 4c39af95b90ce8a643c35dded8e2c745634897e9\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22207.4 to 7.0.0-preview.4.22207.5][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22207.4 to 7.0.0-preview.4.22207.5][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/9ea7948...4c39af9\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6383)","Url":"https://github.com/dotnet/wpf/pull/6383","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6383)"},{"Id":"1196625510","IsPullRequest":true,"CreatedAt":"2022-04-07T22:45:56","Actor":"dotnet-maestro[bot]","Number":"6382","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220407.4\r\n- **Date Produced**: April 7, 2022 9:55:41 PM UTC\r\n- **Commit**: 9ea7948b3362053ba90aaffb165b1008515f4e1d\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22206.6 to 7.0.0-preview.4.22207.4][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22206.6 to 7.0.0-preview.4.22207.4][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/9f12f80...9ea7948\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6382)","Url":"https://github.com/dotnet/wpf/pull/6382","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6382)"},{"Id":"1196324589","IsPullRequest":true,"CreatedAt":"2022-04-07T17:27:07","Actor":"dotnet-maestro[bot]","Number":"6381","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220407.2\r\n- **Date Produced**: April 7, 2022 4:31:35 PM UTC\r\n- **Commit**: 88ff411715df6da3c1e6c789496f83042b470d3a\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22205.9 to 6.0.0-rtm.22207.2][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC12fb1d1&targetVersion=GC88ff411&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6381)","Url":"https://github.com/dotnet/wpf/pull/6381","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6381)"},{"Id":"1196231623","IsPullRequest":true,"CreatedAt":"2022-04-07T16:09:30","Actor":"dotnet-maestro[bot]","Number":"6380","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20220406.7\r\n- **Date Produced**: April 6, 2022 8:41:47 PM UTC\r\n- **Commit**: 254113fd7c3ee04f832c165d6aec1a6077de0d63\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.22178.5 to 6.0.0-beta.22206.7][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.22178.5 to 6.0.0-beta.22206.7][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.22178.5 to 6.0.0-beta.22206.7][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.22178.5 to 6.0.0-beta.22206.7][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.22178.5 to 6.0.0-beta.22206.7][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/f8c0d51...254113f\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6380)","Url":"https://github.com/dotnet/wpf/pull/6380","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#6380)"},{"Id":"1195775964","IsPullRequest":false,"CreatedAt":"2022-04-07T09:31:47","Actor":"martinivanoff","Number":"6379","RawContent":null,"Title":"Selection in WPF ComboBox cannot be changed if the ItemsSource is populated with objects defined as \"record\" instead of \"class\" and SelectedItem is bound to a property of the view model.","State":"open","Body":"* .NET Core Version: 6.0.3\r\n* Windows version: 19044.15876\r\n* Does the bug reproduce also in WPF for .NET Framework 4.8?: Not tested.\r\n \r\n **Problem description:**\r\n\r\nSelection of the __WPF ComboBox__ control cannot be changed if the ItemsSource is populated with objects defined as `record` instead of `class` and the __SelectedItem is bound__ to a property in the view model.\r\n\r\nThe issue appears in the WPF framework under .NET 6. \r\n\r\nThe attached project shows the described behavior. In the project, just try to select an item by opening the drop down and clicking onto any item. \r\n[WpfApp59.zip](https://github.com/dotnet/wpf/files/8441575/WpfApp59.zip)\r\n\r\nWhat I mean by `record` is the following:\r\n```\r\npublic record DataInfo\r\n{\r\n}\r\n```\r\n \r\n **Actual behavior:** \r\n\r\nWhen you run the project and open the ComboBox drop down, click on any item to select it. At this point nothing happens. The selection cannot be changed. If you subscribe to SelectionChanged, you will see that actually the clicked item is selected and then the selection is returned back to the previous one.\r\n \r\n **Expected behavior:**\r\n \r\nThe selection should be changed properly when you click on an item in the drop down.\r\n\r\n **Minimal repro:**\r\n\r\n ```\r\n<ComboBox ItemsSource=\"{Binding Items}\" \r\n                  SelectedItem=\"{Binding SelectedItem, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"\r\n                  DisplayMemberPath=\"Name\"\r\n                  VerticalAlignment=\"Center\"\r\n                  Width=\"300\"/>       \r\n```\r\n```\r\npublic class MainViewModel : INotifyPropertyChanged\r\n    {\r\n        private DataInfo selectedItem;\r\n        public DataInfo SelectedItem\r\n        {\r\n            get => selectedItem;\r\n            set { selectedItem = value; OnPropertyChanged(\"SelectedItem\"); }\r\n        }\r\n        public ObservableCollection<DataInfo> Items { get; set; }\r\n\r\n        public MainViewModel()\r\n        {\r\n            this.Items = new ObservableCollection<DataInfo>();\r\n            for (int i = 0; i < 10; i++)\r\n            {\r\n                Items.Add(new DataInfo() { Name = \"Item \" + i });\r\n            }\r\n            SelectedItem = Items[3];\r\n            \r\n        }\r\n\r\n        protected void OnPropertyChanged([CallerMemberName] String propertyName = \"\")\r\n        {\r\n            if (PropertyChanged != null)\r\n            {\r\n                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\r\n            }\r\n        }\r\n\r\n        public event PropertyChangedEventHandler? PropertyChanged;\r\n    }\r\n\r\n    public record DataInfo : INotifyPropertyChanged\r\n    {\r\n        private string name;\r\n\r\n        public string Name\r\n        {\r\n            get { return name; }\r\n            set { name = value; OnPropertyChanged(\"Name\"); }\r\n        }\r\n\r\n        protected void OnPropertyChanged([CallerMemberName] String propertyName = \"\")\r\n        {\r\n            if (PropertyChanged != null)\r\n            {\r\n                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\r\n            }\r\n        }\r\n\r\n        public event PropertyChangedEventHandler? PropertyChanged;\r\n    }\r\n```\r\n","Url":"https://github.com/dotnet/wpf/issues/6379","RelatedDescription":"Open issue \"Selection in WPF ComboBox cannot be changed if the ItemsSource is populated with objects defined as \"record\" instead of \"class\" and SelectedItem is bound to a property of the view model.\" (#6379)"},{"Id":"1195665291","IsPullRequest":true,"CreatedAt":"2022-04-07T08:27:22","Actor":"dotnet-maestro[bot]","Number":"6378","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220406.6\r\n- **Date Produced**: April 7, 2022 7:36:14 AM UTC\r\n- **Commit**: 9f12f80bb8e13eb20ea6d6e633e8bfbb1b0149c1\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22206.3 to 7.0.0-preview.4.22206.6][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22206.3 to 7.0.0-preview.4.22206.6][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/d6fbcca...9f12f80\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6378)","Url":"https://github.com/dotnet/wpf/pull/6378","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6378)"},{"Id":"1194387084","IsPullRequest":true,"CreatedAt":"2022-04-07T03:56:26","Actor":"singhashish-wpf","Number":"6372","RawContent":null,"Title":"update intellisense version","State":"closed","Body":"* Update the intellisense version\r\n* Avoid additional copy step\r\n* Avoid race conditions\r\n\r\n## Test\r\n\r\nManually verified the content against a previously published NuGet package.\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6372)","Url":"https://github.com/dotnet/wpf/pull/6372","RelatedDescription":"Closed or merged PR \"update intellisense version\" (#6372)"},{"Id":"1195358421","IsPullRequest":true,"CreatedAt":"2022-04-07T01:29:50","Actor":"dotnet-maestro[bot]","Number":"6377","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220406.3\r\n- **Date Produced**: April 7, 2022 12:40:37 AM UTC\r\n- **Commit**: d6fbccaf9f3dec7289bf5356249f540372ac6d5a\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22206.2 to 7.0.0-preview.4.22206.3][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22206.2 to 7.0.0-preview.4.22206.3][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/b623fed...d6fbcca\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6377)","Url":"https://github.com/dotnet/wpf/pull/6377","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6377)"},{"Id":"1195212404","IsPullRequest":true,"CreatedAt":"2022-04-06T22:04:50","Actor":"dotnet-maestro[bot]","Number":"6376","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220406.2\r\n- **Date Produced**: April 6, 2022 8:55:37 PM UTC\r\n- **Commit**: b623fed919fff76efed618eaa2142e4473a04803\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22206.1 to 7.0.0-preview.4.22206.2][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22206.1 to 7.0.0-preview.4.22206.2][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/6bda09e...b623fed\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6376)","Url":"https://github.com/dotnet/wpf/pull/6376","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6376)"},{"Id":"1195188831","IsPullRequest":true,"CreatedAt":"2022-04-06T21:34:15","Actor":"dotnet-maestro[bot]","Number":"6375","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220406.1\r\n- **Date Produced**: April 6, 2022 8:41:06 PM UTC\r\n- **Commit**: 6bda09ef3776a8484357d96c221ab338dc47ae4b\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22205.8 to 7.0.0-preview.4.22206.1][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22205.8 to 7.0.0-preview.4.22206.1][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/b4d21a5...6bda09e\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6375)","Url":"https://github.com/dotnet/wpf/pull/6375","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6375)"},{"Id":"1195139098","IsPullRequest":true,"CreatedAt":"2022-04-06T20:21:31","Actor":"miloush","Number":"6374","RawContent":null,"Title":"PickFolders option for OpenFileDialog (minimal)","State":"open","Body":"For discussion. Fixes #438. Further discussion in #4039. Previous attempt: #6351\r\n\r\n## Description\r\n\r\nAllows developers to ask the user to select a folder, a feature known as `FolderBrowserDialog` in WinForms.\r\n\r\nThis PR is the minimal code changes needed to introduce the feature. It closely reflects the underlying API design, i.e. the ability to specify `FOS_PICKFOLDERS` on the `IOpenFileDialog`. This is a backwards compatible solution - no public API has been moved or removed and no existing behavior has changed.\r\n\r\nA custom option `OPTION_PICKFOLDERS` is introduced that sets `FOS_PICKFOLDERS` and clears `OFN_FILEMUSTEXIST` when the dialog is prepared.\r\n\r\n### New visible members\r\n\r\nIn `OpenFileDialog`:\r\n* `public bool PickFolders { get; set; }`\r\n\r\n### Legacy behavior\r\n\r\nLegacy code path (pre-Vista) ignores the flag and shows standard file open dialog.\r\n\r\n## Customer Impact\r\n\r\nWithout this fix, users have to either use WinForms' `FolderBrowserDialog`, resort to 3rd party libraries or re-implement the whole `IFileDialog` API. #438 is currently the top voted issue in the repository.\r\n\r\n## Regression\r\n\r\nNo.\r\n\r\n## Testing\r\n\r\nCompiled custom _PresentationFramework.dll_ and tested in 6.0.2 x86 app that both folder browsing and file browsing works as expected.\r\n\r\n## Risk\r\n\r\nLow - existing behavior not affected, minimal code changes. Setting `Filter` on a dialog with `PickFolders` will throw `COMException` on `ShowDialog()`.\r\n\r\nThe bit used by `OPTION_PICKFOLDERS` is currently unused in both legacy and `IOpenFileDialog` API, but it might get allocated in the future. This would however not break this feature as the bits are masked out (same happened in the past with `OPTION_ADDEXTENSION`).\r\n\r\nUser code that processes \"used\" file dialogs could now be handed an instance that unexpectedly contains folders in the `FileName(s)` properties. This, however, would have to be explicitly caused using new code. Unexpected file operations on folders (i.e. trying to open them) yield IO exceptions that the existing code should be already handling.\r\n\r\n/cc @ThomasGoulet73 @batzen\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6374)","Url":"https://github.com/dotnet/wpf/pull/6374","RelatedDescription":"Open PR \"PickFolders option for OpenFileDialog (minimal)\" (#6374)"},{"Id":"1194086832","IsPullRequest":true,"CreatedAt":"2022-04-06T10:08:20","Actor":"singhashish-wpf","Number":"6371","RawContent":null,"Title":"Intellisense version update","State":"closed","Body":"* Update the intellisense version\r\n* Avoid additional copy step\r\n* Avoid race conditions\r\n\r\n\r\n## Test\r\n\r\nManually verified the content against a previously published NuGet package.\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6371)","Url":"https://github.com/dotnet/wpf/pull/6371","RelatedDescription":"Closed or merged PR \"Intellisense version update\" (#6371)"},{"Id":"1193654768","IsPullRequest":true,"CreatedAt":"2022-04-06T04:51:55","Actor":"vseanreesermsft","Number":"6362","RawContent":null,"Title":"Update branding to 6.0.5","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6362)","Url":"https://github.com/dotnet/wpf/pull/6362","RelatedDescription":"Closed or merged PR \"Update branding to 6.0.5\" (#6362)"},{"Id":"1193681844","IsPullRequest":true,"CreatedAt":"2022-04-06T04:50:38","Actor":"dotnet-maestro[bot]","Number":"6365","RawContent":null,"Title":"[release/6.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:64ecc23e-064a-456b-da03-08d961c27f17)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 64ecc23e-064a-456b-da03-08d961c27f17\r\n- **Build**: 20220328.5\r\n- **Date Produced**: March 28, 2022 7:04:19 PM UTC\r\n- **Commit**: f8c0d51185208227e582f76ac3c5003db237b689\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 6.0.0-beta.22161.1 to 6.0.0-beta.22178.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/879df78...f8c0d51\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:64ecc23e-064a-456b-da03-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6365)","Url":"https://github.com/dotnet/wpf/pull/6365","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dotnet/arcade\" (#6365)"},{"Id":"1193961254","IsPullRequest":true,"CreatedAt":"2022-04-06T03:55:46","Actor":"dotnet-maestro[bot]","Number":"6369","RawContent":null,"Title":"[main] Update dependencies from dotnet/winforms","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n## From https://github.com/dotnet/winforms\r\n- **Subscription**: dd483b3f-65b0-44ab-f62d-08d8e93a0c51\r\n- **Build**: 20220405.8\r\n- **Date Produced**: April 6, 2022 3:03:06 AM UTC\r\n- **Commit**: b4d21a581c6fb8c222423f7d225e6dc355cc4838\r\n- **Branch**: refs/heads/main\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.Dotnet.WinForms.ProjectTemplates**: [from 7.0.0-preview.4.22204.1 to 7.0.0-preview.4.22205.8][1]\r\n  - **Microsoft.Private.Winforms**: [from 7.0.0-preview.4.22204.1 to 7.0.0-preview.4.22205.8][1]\r\n\r\n[1]: https://github.com/dotnet/winforms/compare/1616cf1...b4d21a5\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:dd483b3f-65b0-44ab-f62d-08d8e93a0c51)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6369)","Url":"https://github.com/dotnet/wpf/pull/6369","RelatedDescription":"Closed or merged PR \"[main] Update dependencies from dotnet/winforms\" (#6369)"},{"Id":"1193951706","IsPullRequest":true,"CreatedAt":"2022-04-06T03:38:33","Actor":"dotnet-maestro[bot]","Number":"6368","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220405.9\r\n- **Date Produced**: April 6, 2022 2:49:16 AM UTC\r\n- **Commit**: 12fb1d1bf394066a31a76f68a6eca02a6fc56b91\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22205.6 to 6.0.0-rtm.22205.9][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC12fb1d1&targetVersion=GC12fb1d1&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6368)","Url":"https://github.com/dotnet/wpf/pull/6368","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6368)"},{"Id":"1193654699","IsPullRequest":true,"CreatedAt":"2022-04-06T02:13:53","Actor":"vseanreesermsft","Number":"6361","RawContent":null,"Title":"Update branding to 5.0.17","State":"closed","Body":"null\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6361)","Url":"https://github.com/dotnet/wpf/pull/6361","RelatedDescription":"Closed or merged PR \"Update branding to 5.0.17\" (#6361)"},{"Id":"1193772279","IsPullRequest":true,"CreatedAt":"2022-04-05T22:46:28","Actor":"dotnet-maestro[bot]","Number":"6367","RawContent":null,"Title":"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:934472a4-9da1-4b66-da04-08d961c27f17)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 934472a4-9da1-4b66-da04-08d961c27f17\r\n- **Build**: 20220405.6\r\n- **Date Produced**: April 5, 2022 9:42:55 PM UTC\r\n- **Commit**: 12fb1d1bf394066a31a76f68a6eca02a6fc56b91\r\n- **Branch**: refs/heads/release/6.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 6.0.0-rtm.22161.2 to 6.0.0-rtm.22205.6][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GCc8d46e6&targetVersion=GC12fb1d1&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:934472a4-9da1-4b66-da04-08d961c27f17)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6367)","Url":"https://github.com/dotnet/wpf/pull/6367","RelatedDescription":"Closed or merged PR \"[release/6.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6367)"},{"Id":"1193737210","IsPullRequest":true,"CreatedAt":"2022-04-05T22:23:55","Actor":"dotnet-maestro[bot]","Number":"6366","RawContent":null,"Title":"[release/5.0] Update dependencies from dnceng/internal/dotnet-wpf-int","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:879723a8-02ca-470e-70c0-08d83eef1915)\r\n## From https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int\r\n- **Subscription**: 879723a8-02ca-470e-70c0-08d83eef1915\r\n- **Build**: 20220405.5\r\n- **Date Produced**: April 5, 2022 9:12:05 PM UTC\r\n- **Commit**: 70a0cf8c57aa58a11ce005659ba13a2b235c8cfe\r\n- **Branch**: refs/heads/release/5.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.Wpf.DncEng**: [from 5.0.12-servicing.22103.6 to 5.0.12-servicing.22205.5][1]\r\n\r\n[1]: https://dev.azure.com/dnceng/internal/_git/dotnet-wpf-int/branches?baseVersion=GC4e0c495&targetVersion=GC70a0cf8&_a=files\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:879723a8-02ca-470e-70c0-08d83eef1915)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6366)","Url":"https://github.com/dotnet/wpf/pull/6366","RelatedDescription":"Closed or merged PR \"[release/5.0] Update dependencies from dnceng/internal/dotnet-wpf-int\" (#6366)"},{"Id":"1193680804","IsPullRequest":true,"CreatedAt":"2022-04-05T21:19:15","Actor":"dotnet-maestro[bot]","Number":"6364","RawContent":null,"Title":"[release/5.0] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:1b2e9dc5-44be-480a-8167-08d86afc0648)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: 1b2e9dc5-44be-480a-8167-08d86afc0648\r\n- **Build**: 20220309.5\r\n- **Date Produced**: March 9, 2022 9:39:48 PM UTC\r\n- **Commit**: ee744068a4fcccc5b8b56e0025f9c95aa19ff318\r\n- **Branch**: refs/heads/release/5.0\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n  - **Microsoft.DotNet.ApiCompat**: [from 5.0.0-beta.22055.3 to 5.0.0-beta.22159.5][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/e5953f2...ee74406\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:1b2e9dc5-44be-480a-8167-08d86afc0648)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6364)","Url":"https://github.com/dotnet/wpf/pull/6364","RelatedDescription":"Closed or merged PR \"[release/5.0] Update dependencies from dotnet/arcade\" (#6364)"},{"Id":"1193674541","IsPullRequest":true,"CreatedAt":"2022-04-05T20:51:41","Actor":"dotnet-maestro[bot]","Number":"6363","RawContent":null,"Title":"[release/3.1] Update dependencies from dotnet/arcade","State":"closed","Body":"This pull request updates the following dependencies\r\n\r\n[marker]: <> (Begin:f6560d32-4c6b-4ed3-5c71-08d72a4d3f20)\r\n## From https://github.com/dotnet/arcade\r\n- **Subscription**: f6560d32-4c6b-4ed3-5c71-08d72a4d3f20\r\n- **Build**: 20220309.6\r\n- **Date Produced**: March 9, 2022 9:51:37 PM UTC\r\n- **Commit**: aebcd10d76469b2e84cffd39d043574bc5357d22\r\n- **Branch**: refs/heads/release/3.x\r\n\r\n[DependencyUpdate]: <> (Begin)\r\n\r\n- **Updates**:\r\n  - **Microsoft.DotNet.ApiCompat**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.Arcade.Sdk**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.CodeAnalysis**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.GenAPI**: [from 1.0.0-beta.22077.9 to 1.0.0-beta.22159.6][1]\r\n  - **Microsoft.DotNet.Helix.Sdk**: [from 2.0.0-beta.22077.9 to 2.0.0-beta.22159.6][1]\r\n\r\n[1]: https://github.com/dotnet/arcade/compare/31e3d88...aebcd10\r\n\r\n[DependencyUpdate]: <> (End)\r\n\r\n\r\n[marker]: <> (End:f6560d32-4c6b-4ed3-5c71-08d72a4d3f20)\r\n\r\n\n\n###### Microsoft Reviewers: [Open in CodeFlow](https://portal.fabricbot.ms/api/codeflow?pullrequest=https://github.com/dotnet/wpf/pull/6363)","Url":"https://github.com/dotnet/wpf/pull/6363","RelatedDescription":"Closed or merged PR \"[release/3.1] Update dependencies from dotnet/arcade\" (#6363)"}],"ResultType":"GitHubIssue"}},"RunOn":"2022-04-11T03:30:29.5711972Z","RunDurationInMilliseconds":468}