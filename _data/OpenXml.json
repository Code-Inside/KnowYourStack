{"Data":{"Sdk":{"Events":[{"Id":"13389907090","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:39:30","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/798","RelatedDescription":"Merged pull request \"Simplify branching in RelationshipErrorHandler\" (#798) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389897809","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:38:35","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/800","RelatedDescription":"Merged pull request \"Reorganize csproj target declarations\" (#800) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389730719","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:21:52","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/800","RelatedDescription":"Opened pull request \"Reorganize csproj target declarations\" (#800) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389592200","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:08:04","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/799","RelatedDescription":"Merged pull request \"Update README.md\" (#799) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389590322","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:07:52","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/799","RelatedDescription":"Opened pull request \"Update README.md\" (#799) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389525194","Type":"PullRequestEvent","CreatedAt":"2020-09-02T19:01:29","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/798","RelatedDescription":"Opened pull request \"Simplify branching in RelationshipErrorHandler\" (#798) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13389425091","Type":"PullRequestEvent","CreatedAt":"2020-09-02T18:51:51","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/793","RelatedDescription":"Merged pull request \"Add a relationship rewriter to help sanitize malformed URIs\" (#793) at OfficeDev/Open-XML-SDK","RelatedBody":"Since .NET 4.5, there has been issues using the SDK with relationships that have malformed URIs. Specifically, this seems to be seen when docs have hyperlinks that are not valid URIs. This change adds a handler to rewrite this upon opening a document in case they exist. Subsequent user code can handle any other manipulation that is needed (such as removal of the offending hyperlink).\r\n\r\nFixes #715 "},{"Id":"13389425000","Type":"IssuesEvent","CreatedAt":"2020-09-02T18:51:50","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/715","RelatedDescription":"Closed issue \"One illegal uri in Relationship will destroy the document parsing\" (#715) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nThe PPTX document that include an illegal uri in Relationship will make the `System.IO.Packaging.InternalRelationshipCollection.ProcessRelationshipAttributes` throw an exception to  `OpenXmlPart.Load`.\r\n\r\nAnd the `OpenXmlPart.Load` can not catch the exception and it will break the `PresentationDocument.Open`.\r\n\r\n**Information**\r\n\r\n- .NET Target: All\r\n- DocumentFormat.OpenXml Version: 2.10.1\r\n\r\n**Repro**\r\n\r\n```csharp\r\nvar document = PresentationDocument.Open(\"hyperlink.pptx\", isEditable: false, openSettings)\r\n``` \r\n\r\nHere is the hyperlink.pptx file : https://1drv.ms/p/s!AiKjiQqRWKThlv5zkY4HoRvvJ3Ppdg?e=3kfdNU \r\n\r\n**Observed**\r\n\r\nThe PresentationDocument.Open throw the UriFormatException exception\r\n\r\n```\r\nSystem.UriFormatException: 'Invalid URI: The hostname could not be parsed.'\r\n```\r\n\r\nBecause the ppt\\slides\\_rels\\slide1.xml.rels contain this string\r\n\r\n```xml\r\n<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\" Target=\"mailto:!@#$%^&amp;*()_+}{:”?&gt;&lt;,./;’[]=-098766554321\" TargetMode=\"External\"/>\r\n```\r\n\r\nAs you can see, the `Target` is not an uri.\r\n\r\n**Expected**\r\n\r\nWe can design an exception handle API, and we can handle some illegal document.\r\n\r\nSee #38 #274 #297 #298 \r\n\r\nAnd the #298 only add more information but can not tolerate errors.\r\n\r\nAnd just as @twsouthwick says, we can not fix this in the OpenXML SDK project https://github.com/OfficeDev/Open-XML-SDK/issues/297#issuecomment-345560540 , but I think we can tolerate some errors"},{"Id":"13385727908","Type":"IssuesEvent","CreatedAt":"2020-09-02T13:50:43","Actor":"Corpac46","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/797","RelatedDescription":"Opened issue \"Looking for consultant/vendor with Open Office XML/Open XML SDK  Expertise\" (#797) at OfficeDev/Open-XML-SDK","RelatedBody":"Dear Open-XML-SDK Community,\r\n\r\nMy company is working on a large project where we are levering Open Office XML/Open XML SDK to manipulate/transform patent submission documents (Word format) as they are submitted online.  We are looking for somebody (or a vendor) with deep expertise with Open Office XML/Open XML SDK to provide technical consultation for the project.  We can accommodate a full-time resource for this role.   \r\n\r\nPlease let me know if you might know somebody who can help with this requirement.\r\n\r\nThanks!\r\n\r\n"},{"Id":"13372017387","Type":"IssuesEvent","CreatedAt":"2020-09-01T12:53:01","Actor":"p-kaczynski","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/796","RelatedDescription":"Closed issue \"Adding an image as per MSDN docs makes the file unreadable by Word for Office 365 (Windows)\" (#796) at OfficeDev/Open-XML-SDK","RelatedBody":"\r\n**Description**\r\n\r\nWhen creating a basic WordprocessingDocument using instructions from: https://docs.microsoft.com/en-us/office/open-xml/how-to-insert-a-picture-into-a-word-processing-document the document cannot be opened by the MS Word application specifically Microsoft Word for Office 365 MSO (16.0.12527.20986) (version 2002) on Windows 10 (also tested on macOS using the Word for Office 365 as well).\r\n\r\nWhen opening the warning monit appears:\r\n`Word experienced an error trying to open the file.`\r\n\r\nThe same file opens fine in Office 365 Online.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Core 3.1\r\n- DocumentFormat.OpenXml Version: 2.11.3\r\n\r\n**Repro**\r\nWrote a minimal reproduction. Generated 'test.docx' is unopenable by the mentioned Word application.\r\n\r\nhttps://github.com/p-kaczynski/OpenXmlImageRepro\r\n\r\nI have tried a number of things, like including/omitting editId, anchorId etc. vs the base code from MSDN, but the result is always the same.\r\n\r\n**Observed**\r\n\r\nAn error when opening the file using Word for Office 365 on Windows/Mac\r\n\r\nPlease note, that posibly the same issue was reported on SO by someone else very recently: https://stackoverflow.com/questions/63529065/inserting-image-corrupts-open-xml-sdk-generated-word-file\r\n\r\n**Expected**\r\n\r\nThe document should open correctly.\r\n"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-09-06T05:30:38.5449882Z","RunDurationInMilliseconds":787}