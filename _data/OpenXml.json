{"Data":{"Sdk":{"Events":[{"Id":"28177455396","Type":"IssuesEvent","CreatedAt":"2023-04-03T22:04:54","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1305","RelatedDescription":"Closed issue \"New ImagePart is created as .bin instead of real extension\" (#1305) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nI have asked the question on Stackoverflow:\r\nhttps://stackoverflow.com/questions/75100804/embedding-image-as-new-imagepart-creates-a-bin-file-using-open-xml-sdk\r\n\r\nI don't expect to get any answer there, and I am also increasingly curious whether, this is an implementation error but an issue in the SDK.\r\n\r\nIssue is, I create new embedded image in Excel and it is saved to ```/xl/media/image.[WhatEverExtensionItIs]```\r\nIf I create a new ImagePart with the SDK and feed it data like this:\r\n\r\n```\r\nImagePart new_ImagePart = worksheetPart.AddImagePart(ImagePartType.Tiff);\r\nstream.Position = 0;\r\nnew_ImagePart.FeedData(stream);\r\n```\r\n\r\nThen the file will be saved as ```/xl/media/image.bin```.\r\n\r\nThis behaviour it should not do. It should write the extension as .tiff, since this is the ```ImagePartType```, that I specify. Or secondly it should read the stream and identify it as .tiff through i.e. a magic number.\r\n\r\nIf you unzip the package and change the image extension to real extension, then the image will open perfectly and I have used a TIFF validator to confirm the image is well-formed. \r\n\r\nWhat do you think of this? Am I doing anything wrong in my implementation, or can we change the SDK to write real extension like Excel does?\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Use the supplied code to stream any TIFF image (or change ImagePartType to any other image type) to a new ImagePart\r\n2. Unzip the spreadsheet and go to /xl/media/ to find the file as a .bin\r\n3. Change extension to .tiff and the image will open perfectly\r\n\r\n**Observed behavior**\r\nImagePart creates a new image with .bin extension\r\n\r\n**Expected behavior**\r\nImagePart should create a new image with extension based on ImagePartType.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 11\r\n - Office version: 2212\r\n - .NET Target: .Net latest version\r\n - DocumentFormat.OpenXml Version: 2.19"},{"Id":"28177454954","Type":"PullRequestEvent","CreatedAt":"2023-04-03T22:04:53","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1380","RelatedDescription":"Merged pull request \"User correct file extension with images\" (#1380) at dotnet/Open-XML-SDK","RelatedBody":"This fixes #1305 "},{"Id":"28176959078","Type":"PullRequestEvent","CreatedAt":"2023-04-03T21:34:01","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1378","RelatedDescription":"Merged pull request \"Obsolete SaveAs\" (#1378) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"28175151989","Type":"PullRequestEvent","CreatedAt":"2023-04-03T20:01:12","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1381","RelatedDescription":"Opened pull request \"Fix casing for customXml element\" (#1381) at dotnet/Open-XML-SDK","RelatedBody":"This fixes #1350 "},{"Id":"28174479898","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:27:51","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1378","RelatedDescription":null,"RelatedBody":""},{"Id":"28174478853","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:27:48","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1378","RelatedDescription":"Closed pull request \"Obsolete SaveAs\" (#1378) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"28174453861","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:26:36","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1380","RelatedDescription":"Opened pull request \"User correct file extension with images\" (#1380) at dotnet/Open-XML-SDK","RelatedBody":"This fixes #1305 "},{"Id":"28174412887","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:24:38","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1373","RelatedDescription":"Merged pull request \"Remove OpenXmlPackage.Close and all references\" (#1373) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"28174398280","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:23:57","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1352","RelatedDescription":"Closed pull request \"Fix part extension lookup to set the correct found extension. Fixes #1305\" (#1352) at dotnet/Open-XML-SDK","RelatedBody":"This fixes #1305 "},{"Id":"28174352988","Type":"PullRequestEvent","CreatedAt":"2023-04-03T19:21:46","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1374","RelatedDescription":"Closed pull request \"Fix CustomXmlPart casing #1350\" (#1374) at dotnet/Open-XML-SDK","RelatedBody":"Change casing from customXML to customXml"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-04-04T03:30:25.5852588Z","RunDurationInMilliseconds":706}