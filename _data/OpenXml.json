{"Data":{"Sdk":{"Events":[{"Id":"25262402751","Type":"PullRequestEvent","CreatedAt":"2022-11-16T00:16:05","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1227","RelatedDescription":"Opened pull request \"Use .NET 7 SDK\" (#1227) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"25238012386","Type":"IssuesEvent","CreatedAt":"2022-11-15T03:44:19","Actor":"FullStackEngN","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1226","RelatedDescription":"Opened issue \"Bug with Open XML SDK: PowerPoint could not open the file created by v2.18 with mc:AlternateContent element\" (#1226) at OfficeDev/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThe customer generated PPTX documents by using OpenXML SDK, but PowerPoint would prompt Repair dialog while opening the document, and part of slide layout would be missed. This issue was not there when using OpenXML SDK 2.7.2 until upgraded OpenXML SDK to version 2.11~2.18.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/41477903/201820560-2990a00b-c11b-4afa-acec-ac48af4d8af0.png)\r\n\r\n\r\n**To Reproduce**\r\n\r\nSteps to reproduce the behavior:\r\n1. Use following code, to generate a new pptx file.\r\n\r\n`\r\npublic static SlideLayoutPart CreateSlideLayout(PackEngineContext packEngineContext, SlideLayoutPart sourceLayoutPart, PresentationDocument targetDoc, SlideMasterPart targetMasterPart, List<ImageCacheItem> imageCacheItems, PPTIdCounter pptIdCounter)\r\n{\r\n    SlideLayoutPart targetLayoutPart = targetMasterPart.AddNewPart<SlideLayoutPart>();\r\n    targetLayoutPart.FeedData(sourceLayoutPart);\r\n\r\n    if (targetMasterPart.IsRepeatNameOfSlideLayout(targetLayoutPart))\r\n    {\r\n        targetLayoutPart.SetNameofSlideLayout();\r\n    }\r\n\r\n    targetLayoutPart.AddPart(targetMasterPart, targetDoc.PresentationPart.GetIdOfPart(targetMasterPart));\r\n\r\n    bool needCloneDiagramParts = (sourceLayoutPart.DiagramColorsParts != null && sourceLayoutPart.DiagramColorsParts.Count() > 0) ||\r\n                                  (sourceLayoutPart.DiagramDataParts != null && sourceLayoutPart.DiagramDataParts.Count() > 0);\r\n    bool needCloneChartParts = sourceLayoutPart.HasChart();\r\n    AddImageRelatedParts(sourceLayoutPart, sourceLayoutPart.SlideLayout.CommonSlideData, sourceLayoutPart.VmlDrawingParts,\r\n                 targetLayoutPart, imageCacheItems, needCloneDiagramParts, needCloneChartParts);\r\n    HandleOtherParts(packEngineContext, sourceLayoutPart, sourceLayoutPart.SlideLayout.CommonSlideData,\r\n                 targetDoc, targetLayoutPart, targetLayoutPart.SlideLayout.CommonSlideData);\r\n\r\n    SlideLayoutId newLayoutId = new SlideLayoutId();\r\n    newLayoutId.Id = pptIdCounter.GetNextSlideMasterLayoutId();\r\n    newLayoutId.RelationshipId = targetMasterPart.GetIdOfPart(targetLayoutPart);\r\n    targetMasterPart.SlideMaster.SlideLayoutIdList.Append(newLayoutId);\r\n    targetLayoutPart.SlideLayout.Save();\r\n\r\n    return targetLayoutPart;\r\n}\r\n`\r\n\r\n**Observed behavior**\r\nPowerPoint will pop up repair error message when opening the error.pptx.\r\n\r\n**Expected behavior**\r\nNo repair prompt and slide layout would not be broken.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows\r\n - Office version 16.0.15726.20202\r\n - .NET Target: .NET Core\r\n - DocumentFormat.OpenXml Version: 2.18.0\r\n\r\n**Additional context**\r\n1. We compared the normal.pptx and error.pptx, then found the element order is different, if we manually change the element order, then PowerPoint can open the file successfully.\r\n3. The following code came from the directory &\\ppt\\slideMasters\\slideMaster1.xml, XML node in PPTX generated by openxml2.7.2 is as follows, the element AlternateContent was behind sldLayoutIdLst, and the document can be opened normally.\r\n![image](https://user-images.githubusercontent.com/41477903/201821102-d6fa1fb1-38e7-40f2-899f-a184d31d4d15.png)\r\n\r\n4. In version 2.11~2.18 of OpenXML, the generated XML document changed to such that the \"AlternateContent\" and \"p:sldLayoutIdLst\" were reversed, causing this problem.\r\n![image](https://user-images.githubusercontent.com/41477903/201821124-0e8f7a30-9625-4c3c-81e7-9ad5f580ed96.png)\r\n\r\n"},{"Id":"25230852448","Type":"PullRequestEvent","CreatedAt":"2022-11-14T19:41:52","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1222","RelatedDescription":"Merged pull request \"Update SVG package to fix\" (#1222) at OfficeDev/Open-XML-SDK","RelatedBody":"Update SVG package to fix [CVE-2021-26701](https://github.com/advisories/GHSA-ghhp-997w-qr28)"},{"Id":"25230343404","Type":"PullRequestEvent","CreatedAt":"2022-11-14T19:15:08","Actor":"tomjebo","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1224","RelatedDescription":"Merged pull request \"force install of nuget cli to >= 5.7.3 for CVE issue\" (#1224) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2022-11-16T03:30:27.4644166Z","RunDurationInMilliseconds":636}