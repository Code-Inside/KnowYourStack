{"Data":{"Sdk":{"Events":[{"Id":"16074538642","Type":"IssuesEvent","CreatedAt":"2021-04-25T04:51:46","Actor":"foxjazz","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/927","RelatedDescription":"Opened issue \"using memory stream doesn't work when adding chunked content\" (#927) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\nThis is using openxml worddocument processing.\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\n\r\nWhen opening the document from a file, the functions for adding content behave differently than when using memorystream to open the document.\r\n\r\n"},{"Id":"16062675753","Type":"IssuesEvent","CreatedAt":"2021-04-23T14:34:27","Actor":"zakkar1","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/926","RelatedDescription":"Opened issue \"Cannot apply styleindex in Excel using OpenXml SDK\" (#926) at OfficeDev/Open-XML-SDK","RelatedBody":"Hi ,\r\nI'm using a template xlsx file which contains some columns with Formats.\r\nWhen I populate my new Excel file I can replace the values but I cannot accomplish the format of the cells\r\nThe workflow is as follows\r\na. I'm taking the excel template which contains the preformatted columns. I have for example a column with number format , a column with a datetime format etc.\r\nb. I'm creating the new xlsx file according to my original template and then with code I'm replacing the values to each column. The values are replaces CORRECTLY so let's not stick to that.\r\n\r\nThe problem starts that If I have a value , a number let's say 34567 and in my excel I want to show it as Currency , in the generated excel I can see the number without the format.\r\n\r\nAlthough I have applied the styleindex property.\r\n\r\nBelow is some sample code from the last actions that my app is doing.\r\n\r\nThe InsertCellInWorkSheet contains the styleindex which originally came from the template\r\n\r\n```\r\nprivate static Cell InsertCellInWorksheet(Celll celll, WorksheetPart worksheetPart, SingleValues value)\r\n{\r\nvar worksheet = worksheetPart.Worksheet;\r\nvar sheetData = worksheet.GetFirstChild<SheetData>();\r\n\r\n          var rowIndex = Convert.ToUInt32(RowReg.Match(celll.CellReference).Value);\r\n          // If the worksheet does not contain a row with the specified row index, insert one.\r\n    \r\n          //this will be current row, next row or null\r\n          var nextOrCurrentRow = sheetData\r\n              .Elements<Row>() //take all rows\r\n              .Where(r => r.RowIndex.Value >= rowIndex) //where index equal or greater of current\r\n              .OrderBy(x => x.RowIndex.Value) //order by index\r\n              .FirstOrDefault();\r\n    \r\n          Row row = null;\r\n          //if it current row use it\r\n          if (nextOrCurrentRow != null && nextOrCurrentRow.RowIndex.Value == rowIndex)\r\n              row = nextOrCurrentRow;\r\n    \r\n          if (row == null)\r\n          {\r\n              row = new Row { RowIndex = new UInt32Value(rowIndex) };\r\n              //if not null then this is next row\r\n              if (nextOrCurrentRow != null)\r\n                  sheetData.InsertBefore(row, nextOrCurrentRow);\r\n              else\r\n                  sheetData.Append(row);\r\n          }\r\n    \r\n          // If there is not a cell with the specified column name, insert one.\r\n          if (row.Elements<Cell>().Any(c => c.CellReference.Value == celll.CellReference))\r\n          {\r\n              return row.Elements<Cell>().First(c => c.CellReference.Value == celll.CellReference);\r\n    \r\n          }\r\n    \r\n          // Cells must be in sequential order according to CellReference. Determine where to insert the new cell.\r\n          var newid = Common.Ab4ToInt(celll.CellReference.ToUpper());\r\n    \r\n          var refCell = row.Elements<Cell>()\r\n              .FirstOrDefault(\r\n                  cell => Common.Ab4ToInt(cell.CellReference.Value.ToUpper()) > newid);\r\n              \r\n          var newCell = new Cell { CellReference = celll.CellReference, StyleIndex = celll.StyleIndex  };\r\n                \r\n          row.InsertBefore(newCell, refCell);\r\n    \r\n          return newCell;\r\n}\r\n```\r\n\r\nEverything is SharedString\r\n\r\n```\r\nprivate static void SetCellValue(OpenXmlPartContainer wbPart, WorksheetPart worksheetPart, Celll celll, SingleValues value)\r\n{\r\nvar sheetCell = InsertCellInWorksheet(celll, worksheetPart,value);\r\n\r\n         //return;\r\n          var cellText = GetCellValue(sheetCell, wbPart);\r\n    \r\n          if (sheetCell.DataType == null)\r\n          {\r\n              //new cell?\r\n              sheetCell.DataType = new EnumValue<CellValues>(CellValues.String);\r\n              cellText = celll.Template;\r\n          }\r\n          var safeText = value.FirstOrDefault(x => x.Replaceable == celll.Label)?.Value?.Trim();\r\n          cellText = ResultToValue(safeText);\r\n    \r\n    \r\n          switch (sheetCell.DataType.Value)\r\n          {\r\n              case CellValues.SharedString:\r\n                  var sharedStringId = InsertSharedStringItem(cellText, wbPart , sheetCell).ToString(CultureInfo.InvariantCulture);\r\n                  sheetCell.CellValue = new CellValue(sharedStringId);\r\n                  break;\r\n              default:\r\n                  var textNode = new Text(cellText);\r\n                  sheetCell.CellValue = new CellValue(textNode.Text);\r\n                  break;\r\n          }\r\n    \r\n      }\r\nprivate static int InsertSharedStringItem(string text, OpenXmlPartContainer wbPart , Cell cell=null)\r\n{\r\nvar shareStringPart = GetOrCreateSharedStringTablePart(wbPart);\r\nvar i = 0;\r\n\r\n          // Iterate through all the items in the SharedStringTable. If the text already exists, return its index.\r\n          foreach (var item in shareStringPart.SharedStringTable.Elements<SharedStringItem>())\r\n          {\r\n              if (item.InnerText == text)\r\n                  return i;\r\n              i++;\r\n          }\r\n          // The text does not exist in the part. Create the SharedStringItem and return its index.\r\n              \r\n          shareStringPart.SharedStringTable.AppendChild(new SharedStringItem(new Text(text)));\r\n          shareStringPart.SharedStringTable.Save();\r\n    \r\n          return i;\r\n      }\r\n\r\n```\r\n\r\nCan anyone assist me on this ?\r\nI want to insert the data which is in string format and let Excel handle the formating which is already applied.\r\nAppreciate any help you could give me"},{"Id":"16055860573","Type":"IssuesEvent","CreatedAt":"2021-04-23T04:52:52","Actor":"Artyom-Petukhov","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/925","RelatedDescription":"Opened issue \"generated paraId values replaced with msword app\" (#925) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nParagraph have property ParagraphId\r\n```csharp\r\n        /// <summary>\r\n        /// <para>paraId, this property is only available in Office 2010 and later.</para>\r\n        /// <para>Represents the following attribute in the schema: w14:paraId</para>\r\n        /// </summary>\r\n        /// <remark>\r\n        /// xmlns:w14=http://schemas.microsoft.com/office/word/2010/wordml\r\n        /// </remark>\r\n\r\n#pragma warning disable CS0618 // Type or member is obsolete\r\n\r\n        [SchemaAttr(52, \"paraId\")]\r\n#pragma warning restore CS0618 // Type or member is obsolete\r\n\r\n        public HexBinaryValue? ParagraphId\r\n        {\r\n            get => GetAttribute<HexBinaryValue>();\r\n            set => SetAttribute(value);\r\n        }\r\n``` \r\n\r\nAccording to the issue #245 I tried to generate paraId for paragraphs (and set textId = \"77777777\" to respect spec). When I open generated docx with MS Word 2016/365 - it's Ok, no errors, no warnings etc.\r\n\r\nGenerated docx is protected from modifications, I can only add/modify/remove comments to it.\r\n\r\nAfter adding new comment to document and saving it - all paraId values replaced by MS Word to new values (in document.xml).\r\nWhen I open this docx with MS Word again, add new comment and save - paraId values remain the same.\r\n\r\n**QUESTION**\r\nHow generate paraId values for paragraphs so that the MS Word does not change their values?\r\nMy app needs these IDs not to change after adding comments.\r\n\r\n**Example**\r\ngenerated docx contains:\r\n<w:p w14:paraId=\"1AD69E69\" w14:textId=\"77777777\" ...\r\n\r\nafter adding comment via ms word (after 1st \"edit\" and all subsequent):\r\n<w:p w14:paraId=\"6B99AEB6\" w14:textId=\"77777777\" ..."},{"Id":"16038989149","Type":"PullRequestEvent","CreatedAt":"2021-04-22T04:21:56","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/924","RelatedDescription":"Opened pull request \"Cache search better in UniqueAttributeValueConstraint\" (#924) at OfficeDev/Open-XML-SDK","RelatedBody":"If a document happened to have a large number of elements that have the\r\nUniqueAttributeValueConstraint validation, it will end up recalculating\r\nthe values for the constraint way too often. This was because the\r\nconstraint was generating the cached lookup with a key using the\r\nattribute text itself. This change updates the lookup to cache all\r\npossible duplicates for the element in question so it only has to be\r\nsearched once.\r\n\r\nFixes #918 "},{"Id":"16031601768","Type":"IssuesEvent","CreatedAt":"2021-04-21T15:32:29","Actor":"g136660","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/923","RelatedDescription":"Opened issue \"Is it possible to split a document page by page into files? If the page sizes are known.\" (#923) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [ ] Issue with the OpenXml library\r\n- [x ] Question on library usage\r\n\r\nIs it possible to split a document page by page into files? If the page sizes are known.\r\nFor converting to PDF.\r\n"},{"Id":"16021838788","Type":"IssuesEvent","CreatedAt":"2021-04-21T01:25:37","Actor":"AndrewDavidoff","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/907","RelatedDescription":"Closed issue \"New NuGet prerelease 2.13.0-beta0001 with Office 2019 support\" (#907) at OfficeDev/Open-XML-SDK","RelatedBody":"This is a note that we released Beta version of SDK with support for Office 2019: namespaces and generated classes. Please give it a try and report issues, specifying NuGet package version number.\r\n\r\nYou need to check “Include prerelease” in VS NuGet Package Manager to see **2.13.0-beta0001** version.\r\n"},{"Id":"16021827843","Type":"IssuesEvent","CreatedAt":"2021-04-21T01:23:59","Actor":"AndrewDavidoff","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/922","RelatedDescription":"Opened issue \"New NuGet prerelease 2.13.0-beta0002 with Office 2019 support\" (#922) at OfficeDev/Open-XML-SDK","RelatedBody":"This is a note that on April 20th we released Beta 2 version of SDK with support for Office 2019: namespaces and generated classes. Please give it a try and report issues, specifying NuGet package version number.\r\n\r\nYou need to check “Include prerelease” in VS NuGet Package Manager to see 2.13.0-beta0002 version.\r\n"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2021-04-25T05:30:34.4470747Z","RunDurationInMilliseconds":749}