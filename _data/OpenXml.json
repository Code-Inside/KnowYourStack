{"Data":{"Sdk":{"Events":[{"Id":"26519199144","Type":"PullRequestEvent","CreatedAt":"2023-01-19T00:10:40","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1316","RelatedDescription":"Opened pull request \"Convert IdPartPair to readonly struct\" (#1316) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"26518847770","Type":"PullRequestEvent","CreatedAt":"2023-01-18T23:42:58","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1315","RelatedDescription":"Opened pull request \"Remove custom project load style\" (#1315) at dotnet/Open-XML-SDK","RelatedBody":"This had been in place for some performance issues in VS. It does make\ndevelopment challenging, and with the refactoring of the framework from\nthe strongly typed classes, Visual Studio seems to handle this better.\n"},{"Id":"26512434280","Type":"IssuesEvent","CreatedAt":"2023-01-18T18:10:08","Actor":"ThomasBarnekow","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1314","RelatedDescription":"Opened issue \"Macro-enabled document created with CreateFromTemplate() cannot be opened by Word\" (#1314) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\n\r\nAs described in this [stackoverflow question](https://stackoverflow.com/questions/75158776/wordprocessingdocument-createfromtemplate-method-creates-corrupted-ms-word-files) and [my answer](https://stackoverflow.com/questions/75158776/wordprocessingdocument-createfromtemplate-method-creates-corrupted-ms-word-files/75160516#75160516), Microsoft Word does not open a macro-enabled document (.docm) created from a macro-enabled template (.dotm) with the `WordprocessingDocument.CreateFromTemplate()` method. When using the same code to create a \"normal\" document (.docx) from a template (.dotx), Word opens the document without any issue.\r\n\r\nWhen validating both documents (i.e., .docm and .docx) with the `OpenXmlValidator`, no validation errors are reported (unless the template is attached, in which case one validation error related to the attached template is emitted in each case).\r\n\r\n**To Reproduce**\r\n\r\n```csharp\r\npublic sealed class CreateFromTemplateTests\r\n{\r\n    private readonly ITestOutputHelper _output;\r\n\r\n    public CreateFromTemplateTests(ITestOutputHelper output)\r\n    {\r\n        _output = output;\r\n    }\r\n\r\n    [Theory]\r\n    [InlineData(\"c:\\\\temp\\\\MacroEnabledTemplate.dotm\", \"c:\\\\temp\\\\MacroEnabledDocument.docm\")]\r\n    [InlineData(\"c:\\\\temp\\\\Template.dotx\", \"c:\\\\temp\\\\Document.docx\")]\r\n    public void CanCreateDocmFromDotm(string templatePath, string documentPath)\r\n    {\r\n        // Let's not attach the template, which is done by default. If a template is attached, the validator complains as follows:\r\n        // The element has unexpected child element 'http://schemas.openxmlformats.org/wordprocessingml/2006/main:attachedTemplate'.\r\n        using (var wordDocument = WordprocessingDocument.CreateFromTemplate(templatePath, false))\r\n        {\r\n            // Validate the document as created with CreateFromTemplate.\r\n            ValidateOpenXmlPackage(wordDocument);\r\n\r\n            // Save that document to disk so we can open it with Word, for example.\r\n            wordDocument.SaveAs(documentPath).Dispose();\r\n        }\r\n\r\n        using (WordprocessingDocument wordDocument = WordprocessingDocument.Open(documentPath, true))\r\n        {\r\n            // Validate the document that was opened from disk, just to see what Word would open.\r\n            ValidateOpenXmlPackage(wordDocument);\r\n        }\r\n    }\r\n\r\n    private void ValidateOpenXmlPackage(OpenXmlPackage openXmlPackage)\r\n    {\r\n        OpenXmlValidator validator = new(FileFormatVersions.Office2019);\r\n        List<ValidationErrorInfo> validationErrors = validator.Validate(openXmlPackage).ToList();\r\n\r\n        foreach (ValidationErrorInfo validationError in validationErrors)\r\n        {\r\n            _output.WriteLine(validationError.Description);\r\n        }\r\n\r\n        if (validationErrors.Any())\r\n        {\r\n            // Note that Word will most often be able to open the document even if there are validation errors.\r\n            throw new Exception(\"The validator found validation errors.\");\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThe above unit tests pass and no validation errors are reported. \r\n\r\nI could not attach the templates. However, I only created super-simple templates with one line of text and a hello world macro in the case of the macro-enabled template.\r\n\r\n**Observed behavior**\r\n\r\nThe Word document (.docx) created by the test can be opened as expected. The macro-enabled document (.docm) cannot be opened. In my case, Word neither displays the document nor reports any error. In the case of the original poster of the stackoverflow question, a runtime error seems to occur (which I could not reproduce).\r\n\r\n**Expected behavior**\r\n\r\nUsing `WordprocessingDocument.CreateFromTemplate()`, the Open XML SDK should be able to create a macro-enabled document (.docm) from a valid, macro-enabled template (.dotm) that can be opened by Microsoft Word.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 (in my case)\r\n - Office version: Word 365 version 16.0.14931.20648 32bit (OP on stackoverflow), Microsoft Word for M365 MSO (Version 2022 Build 16.0.14931.20858) 64-bit (in my case)\r\n - .NET Target: .NET 7.0 and net472 (in my case)\r\n - DocumentFormat.OpenXml Version: 2.19.0 (in both cases)\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-01-21T03:30:25.4255241Z","RunDurationInMilliseconds":750}