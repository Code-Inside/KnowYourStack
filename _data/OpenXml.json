{"Data":{"Sdk":{"Events":[{"Id":"51861487112","Type":"IssuesEvent","CreatedAt":"2025-07-09T06:37:04","Actor":"lindexi","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1953","RelatedDescription":"Closed issue \"SchemeColorValues TypeInitializationException with AOT issues\" (#1953) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nThe SchemeColorValues will cause the TypeInitializationException when running in AOT mode.\n\nThe stacktrace is \n\n```\nUnhandled exception. System.TypeInitializationException: A type initializer threw an exception. To determine which type, inspect the InnerException's StackTrace property.\n ---> System.NotSupportedException: 'DocumentFormat.OpenXml.Drawing.SchemeColorValues[]' is missing native code or metadata. This can happen for code that is not compatible with trimming or AOT. Inspect and fix trimming and AOT related warnings that were generated when the app was published. For more information see https://aka.ms/nativeaot-compatibility\n   at System.Reflection.Runtime.General.TypeUnifier.WithVerifiedTypeHandle(RuntimeArrayTypeInfo, RuntimeTypeInfo) + 0x66\n   at System.Array.InternalCreate(RuntimeType, Int32, Int32*, Int32*) + 0x1bb\n   at System.Array.CreateInstance(Type, Int32) + 0x4d\n   at System.RuntimeType.GetEnumValues() + 0x74\n   at DocumentFormat.OpenXml.EnumInfoLookup`1.EnumStringLookupImpl..ctor() + 0x66\n   at DocumentFormat.OpenXml.EnumInfoLookup`1..cctor() + 0x1c\n   at System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(StaticClassConstructionContext*) + 0xba\n   --- End of inner exception stack trace ---\n   at System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(StaticClassConstructionContext*) + 0x13c\n   at System.Runtime.CompilerServices.ClassConstructorRunner.CheckStaticClassConstructionReturnGCStaticBase(StaticClassConstructionContext*, Object) + 0xd\n   at DocumentFormat.OpenXml.EnumValue`1.ValidateSet(T) + 0x45\n   at DocumentFormat.OpenXml.OpenXmlSimpleValue`1.set_Value(T) + 0x17\n   at Program.<Main>$(String[] args) + 0x3c\n```\n\n**Screenshots**\nNone.\n\n**To Reproduce**\n\ncsproj:\n\n```xml\n<Project Sdk=\"Microsoft.NET.Sdk\">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net9.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include=\"DocumentFormat.OpenXml\" Version=\"2.20.0\" />\n  </ItemGroup>\n\n</Project>\n```\n\nProgram.cs:\n\n```csharp\nusing DocumentFormat.OpenXml.Drawing;\n\nSchemeColor color = new SchemeColor()\n{\n    Val = SchemeColorValues.Accent1\n};\nSchemeColorValues value = color.Val.Value;\nConsole.WriteLine(value);\n```\n\nThe publish command:\n\ndotnet publish /p:PublishAot=true -r win-x64\n\nRun the aot application and you can find the exception.\n\nMy mini repro code is in: https://github.com/lindexi/lindexi_gd/tree/b323b8cf2ee3bb7506810e29f8e84576f0639831/Pptx/WiheneakurFonejerarner\n\n**Observed behavior**\nThe application throws the exception.\n\n**Expected behavior**\nWork well\n\n**Desktop (please complete the following information):**\n - OS: Windows 11\n - Office version [e.g. 16.0.15427.20178]\n - .NET Target: .NET 9\n - DocumentFormat.OpenXml Version: 2.20.0\n\n**Additional context**\nAdd any other context about the problem here.\n"},{"Id":"51861200892","Type":"IssuesEvent","CreatedAt":"2025-07-09T06:28:59","Actor":"lindexi","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1953","RelatedDescription":"Opened issue \"SchemeColorValues TypeInitializationException with AOT issues\" (#1953) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nThe SchemeColorValues will cause the TypeInitializationException when running in AOT mode.\n\nThe stacktrace is \n\n```\nUnhandled exception. System.TypeInitializationException: A type initializer threw an exception. To determine which type, inspect the InnerException's StackTrace property.\n ---> System.NotSupportedException: 'DocumentFormat.OpenXml.Drawing.SchemeColorValues[]' is missing native code or metadata. This can happen for code that is not compatible with trimming or AOT. Inspect and fix trimming and AOT related warnings that were generated when the app was published. For more information see https://aka.ms/nativeaot-compatibility\n   at System.Reflection.Runtime.General.TypeUnifier.WithVerifiedTypeHandle(RuntimeArrayTypeInfo, RuntimeTypeInfo) + 0x66\n   at System.Array.InternalCreate(RuntimeType, Int32, Int32*, Int32*) + 0x1bb\n   at System.Array.CreateInstance(Type, Int32) + 0x4d\n   at System.RuntimeType.GetEnumValues() + 0x74\n   at DocumentFormat.OpenXml.EnumInfoLookup`1.EnumStringLookupImpl..ctor() + 0x66\n   at DocumentFormat.OpenXml.EnumInfoLookup`1..cctor() + 0x1c\n   at System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(StaticClassConstructionContext*) + 0xba\n   --- End of inner exception stack trace ---\n   at System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(StaticClassConstructionContext*) + 0x13c\n   at System.Runtime.CompilerServices.ClassConstructorRunner.CheckStaticClassConstructionReturnGCStaticBase(StaticClassConstructionContext*, Object) + 0xd\n   at DocumentFormat.OpenXml.EnumValue`1.ValidateSet(T) + 0x45\n   at DocumentFormat.OpenXml.OpenXmlSimpleValue`1.set_Value(T) + 0x17\n   at Program.<Main>$(String[] args) + 0x3c\n```\n\n**Screenshots**\nNone.\n\n**To Reproduce**\n\ncsproj:\n\n```xml\n<Project Sdk=\"Microsoft.NET.Sdk\">\n\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net9.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include=\"DocumentFormat.OpenXml\" Version=\"2.20.0\" />\n  </ItemGroup>\n\n</Project>\n```\n\nProgram.cs:\n\n```csharp\nusing DocumentFormat.OpenXml.Drawing;\n\nSchemeColor color = new SchemeColor()\n{\n    Val = SchemeColorValues.Accent1\n};\nSchemeColorValues value = color.Val.Value;\nConsole.WriteLine(value);\n```\n\nThe publish command:\n\ndotnet publish /p:PublishAot=true -r win-x64\n\nRun the aot application and you can find the exception.\n\nMy mini repro code is in: https://github.com/lindexi/lindexi_gd/tree/b323b8cf2ee3bb7506810e29f8e84576f0639831/Pptx/WiheneakurFonejerarner\n\n**Observed behavior**\nThe application throws the exception.\n\n**Expected behavior**\nWork well\n\n**Desktop (please complete the following information):**\n - OS: Windows 11\n - Office version [e.g. 16.0.15427.20178]\n - .NET Target: .NET 9\n - DocumentFormat.OpenXml Version: 2.20.0\n\n**Additional context**\nAdd any other context about the problem here.\n"},{"Id":"51547966168","Type":"IssuesEvent","CreatedAt":"2025-07-01T09:45:51","Actor":"sw-ms-hardiksenghani","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1951","RelatedDescription":"Opened issue \"Bug Report: System.OutOfMemoryException when writing large Excel file\" (#1951) at dotnet/Open-XML-SDK","RelatedBody":"Environment:\n\nOpenXmlWriter(Package:2.16.0)\n.NET Version: .Net Core 8\nOperating System: Windows 10\nIssue Summary:\n\nWe are generating an Excel file with approximately:\n\n180 columns\n500,000 rows\nCell formatting applied throughout\nWhile writing data using ClosedXML, the process fails after approximately 350,000 rows with the following exception:\n\nException in Stream was too long.\nException of type 'System.OutOfMemoryException' was thrown.\nSteps to Reproduce:\n\nCreate a workbook and worksheet.\nPopulate 180 columns with formatted data.\nLoop through and write 500,000 rows.\nSave the workbook.\nExpected Behavior: The Excel file should be generated successfully without memory issues.\n\nActual Behavior: The process throws an OutOfMemoryException after writing around 350,000 rows.\n\nAdditional Context:\n\nWe are using cell formatting (e.g., borders, font styles) for each cell.\nThe issue seems to be related to memory usage or stream limits during serialization.\nRequest:\n\nIs there a recommended approach to handle large datasets with formatting?\nAre there any memory optimization techniques or streaming options available in OpenXmlWriter?"},{"Id":"51528257819","Type":"PullRequestEvent","CreatedAt":"2025-06-30T22:59:34","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1950","RelatedDescription":"Opened pull request \"Bump gittools/actions from 3 to 4\" (#1950) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [gittools/actions](https://github.com/gittools/actions) from 3 to 4.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/gittools/actions/releases\">gittools/actions's releases</a>.</em></p>\n<blockquote>\n<h2>v4.0.0</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.2.1...v4.0.0\">168 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/25?closed=1\">10 issues</a> being closed.</p>\n<p><strong>Breaking changes</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1353\">#1353</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1353\">GitTools/actions#1353</a>) [ISSUE]: GitVersion.yml config file not detected</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1357\">#1357</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1357\">GitTools/actions#1357</a>) [ISSUE]: Upgrade AzureDevops minimal agent version</li>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1388\"><strong>!1388</strong></a> GitReleaseManager repository and owner input</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1396\">#1396</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1396\">GitTools/actions#1396</a>) [ISSUE]: Preserve only the &quot;_&quot; separated version and output variables to be in line with the GitHub actions and the GitVersion.Tool</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1495\">#1495</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1495\">GitTools/actions#1495</a>) [ISSUE]: Fix Azure Pipeline task build warning</li>\n</ul>\n<p><strong>Bugs</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1434\">#1434</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1434\">GitTools/actions#1434</a>) [ISSUE]: Allow customization of version variable set in $(Build.BuildNumber) for Azure DevOps GitVersion task</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1493\">#1493</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1493\">GitTools/actions#1493</a>) [ISSUE]: Azure DevOps Release pipeline throws the error on GitVersion updatebuildnumber</li>\n</ul>\n<p><strong>Documentation</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1402\">#1402</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1402\">GitTools/actions#1402</a>) [DOCS]: Update docs and <code>versions.md</code> to use v4 and GitVersion.Tool v6.1.x</li>\n</ul>\n<p><strong>Improvements</strong></p>\n<ul>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1627\"><strong>!1627</strong></a> Potential fix for code scanning alert no. 11: Incomplete string escaping or encoding</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1659\">#1659</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1659\">GitTools/actions#1659</a>) [ISSUE]: Unable to fetch GitVersion.Tool</li>\n</ul>\n<h3>SHA256 Hashes of the release artifacts</h3>\n<ul>\n<li><code>1ee9cc45adbd18a72f67cff6789bb9a7cc6b5a1aba2ad9b703df959ee316ec46\t- gittools.gittools-4.0.0.25063007.vsix</code></li>\n</ul>\n<h2>v3.2.1</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.2.0...v3.2.1\">50 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/24?closed=1\">1 issue</a> being closed.</p>\n<p><strong>Improvements</strong></p>\n<ul>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1586\"><strong>!1586</strong></a> updates GitVersion and GitReleaseManager versions</li>\n</ul>\n<h3>SHA256 Hashes of the release artifacts</h3>\n<ul>\n<li><code>1d446034a454176807f7c3846983ec4b8a4efef0e2e10cabef19f7ea1f428e33\t- gittools.gittools-3.2.1.25042514.vsix</code></li>\n</ul>\n<h2>v3.2.0</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.1.11...v3.2.0\">147 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/23?closed=1\">6 issues</a> being closed.</p>\n<p><strong>Bugs</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1400\">#1400</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1400\">GitTools/actions#1400</a>) [ISSUE]: Azure DevOps task v3.1.1 fails with 'Overwriting readonly variable is not permitted'</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1515\">#1515</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1515\">GitTools/actions#1515</a>) [ISSUE]: gitVersion execute task not immediately available after gitVersion setup task</li>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1554\"><strong>!1554</strong></a> Normalizes target path in dotnet tool</li>\n</ul>\n<!-- raw HTML omitted -->\n</blockquote>\n<p>... (truncated)</p>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/GitTools/actions/commit/81f0bc44e27a689ce858668d7a2081ac2387b605\"><code>81f0bc4</code></a> dist update</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/5eb6c7e6139e9ac778760eb980a0029884b66c48\"><code>5eb6c7e</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1664\">#1664</a> from IdsTeepe/feat/dotnet-based-nuget-query</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/e38db95cfb29ace9690550d110ae9c888a45cc4d\"><code>e38db95</code></a> Query all enabled sources</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/66027dc80dae741fa47b408ebc4572df6c4a0b8a\"><code>66027dc</code></a> Move builder to separate variable</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/1891d98f3a9c3b13ad77e3e55ecd0a893b665ce5\"><code>1891d98</code></a> Chore: Tiny comment, better variable naming.</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/93ee92665e60fd0c42148c97c77a0ad877a4f454\"><code>93ee926</code></a> Feat: Dynamically get query service from nuget package source</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/2169f9f60f09b337bd709fa944dd054a60dc6759\"><code>2169f9f</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1661\">#1661</a> from GitTools/dependabot/npm_and_yarn/eslint-c11f433916</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/efeecdc0788f250e53ea9f21b0ae4148f1a3646a\"><code>efeecdc</code></a> (npm): Bump eslint-plugin-prettier in the eslint group</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/7124bde385c3272f04a5fdf0fe2e4247636bbfc1\"><code>7124bde</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1662\">#1662</a> from GitTools/dependabot/npm_and_yarn/types-a55ad1e45f</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/b43ed1a2fdaf942dc8516c620b9174fa173b2e4f\"><code>b43ed1a</code></a> (npm): Bump <code>@​types/node</code> from 24.0.3 to 24.0.4 in the types group</li>\n<li>Additional commits viewable in <a href=\"https://github.com/gittools/actions/compare/v3...v4\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=gittools/actions&package-manager=github_actions&previous-version=3&new-version=4)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-07-25T03:30:20.9609053Z","RunDurationInMilliseconds":531}