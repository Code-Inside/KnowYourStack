{"Data":{"Sdk":{"Events":[{"Id":"12918808446","Type":"PullRequestEvent","CreatedAt":"2020-07-16T04:00:00","Actor":"lindexi","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/764","RelatedDescription":"Opened pull request \"Add Benchmark for create metadata\" (#764) at OfficeDev/Open-XML-SDK","RelatedBody":"https://github.com/OfficeDev/Open-XML-SDK/pull/758#issuecomment-658772892\r\n\r\n"},{"Id":"12917606948","Type":"IssuesEvent","CreatedAt":"2020-07-16T00:14:22","Actor":"github-actions[bot]","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/689","RelatedDescription":"Closed issue \"OpenXmlValidator Throws Incorrect Validation Error for CategoryAxis\" (#689) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nWhen validating a `CategoryAxis` with an `AxisPosition` child the `OpenXmlValidator` creates a validation error even though the xml is valid according the office xml specification (CT_CatAx has a child EG_AxShared which has an element CT_AxPos on page 4080 of part I of the specification).\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Framework\r\n- DocumentFormat.OpenXml Version: 2.10\r\n\r\n**Repro**\r\n\r\n```csharp\r\nvar categoryAxis = new DocumentFormat.OpenXml.Drawing.Charts.CategoryAxis();\r\ncategoryAxis.AppendChild(new DocumentFormat.OpenXml.Drawing.Charts.AxisPosition() { Val = new EnumValue<DocumentFormat.OpenXml.Drawing.Charts.AxisPositionValues>(DocumentFormat.OpenXml.Drawing.Charts.AxisPositionValues.Bottom) });\r\n\r\nvar validator = new Validation.OpenXmlValidator();\r\nvar errors = validator.Validate(categoryAxis);\r\n``` \r\n\r\n**Observed**\r\n\r\nThe `errors` variable has a single entry with a description of `The element has unexpected child element 'http://schemas.openxmlformats.org/drawingml/2006/chart:axPos.'...`\r\n\r\n**Expected**\r\n\r\nAccording to `CT_CatAx` in part I of the specification (page 4080) there must be child elements `axId`, `scaling`, `axPos`, and `crossAx`. The sample above only has a `axPos` child so I would expect to see three validation errors due to the other three required elements being missing. I would not expect to see a validation error saying that `axPos` is not a valid child since the specification says that it is."},{"Id":"12917606895","Type":"IssuesEvent","CreatedAt":"2020-07-16T00:14:21","Actor":"github-actions[bot]","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/701","RelatedDescription":"Closed issue \"Support non-nullable annotations\" (#701) at OfficeDev/Open-XML-SDK","RelatedBody":"With C# 8.0 and .NET Standard 2.1 (and other supported platforms), APIs can be annotated with nullability information. This issue will track any work to enable this. So far, this would include:\r\n\r\n- [x] Enable C# 8.0 in the project (#698)\r\n- [ ] Enable .NET Standard 2.1\r\n- [ ] Enable nullable annotations in non-.NET Standard 2.1 targets (through some shim to provide attributes that can be stripped out at compile time)"},{"Id":"12917265778","Type":"PullRequestEvent","CreatedAt":"2020-07-15T23:13:23","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/763","RelatedDescription":"Opened pull request \"Reduce huge perf impact from a couple semantic constraints\" (#763) at OfficeDev/Open-XML-SDK","RelatedBody":"This changes `IndexReferenceConstraint` and `ReferenceExistConstraint` to be much more performant. Two issues were found:\r\n\r\n- Using validation infrastructure to just iterate through all the children in a part. This was expensive.\r\n- Recalculating same required information many, many times\r\n\r\nFixes #760 "},{"Id":"12913244169","Type":"IssuesEvent","CreatedAt":"2020-07-15T16:06:09","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/762","RelatedDescription":"Opened issue \"Instrument project with DiagnosticSource\" (#762) at OfficeDev/Open-XML-SDK","RelatedBody":"In order to better identify and root cause issues, it would be helpful to get in depth logs as to what the system is doing. DiagnosticSource would be ideal for this. I haven't used it personally, but wanted to track a work item to add support for it within the project."},{"Id":"12913211165","Type":"IssuesEvent","CreatedAt":"2020-07-15T16:00:01","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/761","RelatedDescription":"Opened issue \"Integrate cancellation tokens in validation system\" (#761) at OfficeDev/Open-XML-SDK","RelatedBody":"There is a setting for max errors, but sometimes the validation can just take a long time. While we can explore perf issues, it would also be good to be able to cancel it using CancellationToken so all the built in ways to manage workflows with them can be used.\r\n\r\nInspired by #760 "},{"Id":"12909328721","Type":"IssuesEvent","CreatedAt":"2020-07-15T08:59:55","Actor":"06needhamt","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/760","RelatedDescription":"Opened issue \".XLSM file takes 33 minutes to validate\" (#760) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [X] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nThe attched .xlsm file takes appoximately 33 minutes to validate compared to several seconds for other files\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Framework 4.7.2\r\n- DocumentFormat.OpenXml Version: 2.11.2\r\n\r\n**Repro**\r\n\r\n```csharp\r\nclass Program\r\n    {\r\n        static List<ValidationErrorInfo> errorInfos;\r\n        \r\n        static void Main(string[] args)\r\n        {\r\n            OpenXmlPackage spreadsheetDocument = SpreadsheetDocument.Open(\"DiversenGrafieken.xlsm\", false);\r\n            Stopwatch stopwatch = new Stopwatch();\r\n\r\n            Console.WriteLine($\"DiversenGrafieken.xlsm: Validation Started at {DateTime.Now}\");\r\n\r\n            stopwatch.Start();\r\n            errorInfos = ValidateDocument(spreadsheetDocument);\r\n            stopwatch.Stop();\r\n\r\n            foreach (ValidationErrorInfo info in errorInfos)\r\n            {\r\n                Console.WriteLine(string.Format(\"DiversenGrafieken.xlsm Error Occurred {0}\", info.Description));\r\n            }\r\n\r\n            Console.WriteLine($\"DiversenGrafieken.xlsm: Validation Completed In {stopwatch.Elapsed}\");\r\n\r\n            Console.ReadKey();\r\n        }\r\n\r\n        static List<ValidationErrorInfo> ValidateDocument(OpenXmlPackage package)\r\n        {\r\n            OpenXmlValidator validator = new OpenXmlValidator(FileFormatVersions.Office2016);\r\n            List<ValidationErrorInfo> validationErrors = validator.Validate(package).ToList();\r\n\r\n            return validationErrors;\r\n        }\r\n    }\r\n``` \r\n\r\nLink to file\r\n[DiversenGrafieken.zip](https://github.com/OfficeDev/Open-XML-SDK/files/4924068/DiversenGrafieken.zip) NB. Rename to .xlsm\r\n\r\n\r\n**Observed**\r\n\r\nThe file takes approximately 33 minutes to validate\r\n\r\n**Expected**\r\n\r\nThe file should be validated in a more timely fasion\r\n"},{"Id":"12908166340","Type":"PullRequestEvent","CreatedAt":"2020-07-15T06:52:29","Actor":"lindexi","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/758","RelatedDescription":"Closed pull request \"Avoid multi-thread creates ElementMetadata object\" (#758) at OfficeDev/Open-XML-SDK","RelatedBody":"The origin code is not thread-safe and this is the test code\r\n\r\n```csharp\r\n    public class ElementMetadataTests\r\n    {\r\n        [Fact]\r\n        public void Create()\r\n        {\r\n            using ManualResetEvent resetEvent = new ManualResetEvent(false);\r\n\r\n            List<Thread> threadList = new List<Thread>();\r\n            var maxCount = 100;\r\n            var elementMetadataList = new ElementMetadata[maxCount];\r\n            for (var i = 0; i < maxCount; i++)\r\n            {\r\n                var n = i;\r\n                threadList.Add(new Thread(() =>\r\n                {\r\n                    resetEvent.WaitOne();\r\n                    var alternateContent = new AlternateContent();\r\n                    var metadata = ElementMetadata.Create(alternateContent);\r\n                    elementMetadataList[n] = metadata;\r\n                })\r\n                {\r\n                    IsBackground = true,\r\n                });\r\n            }\r\n\r\n            foreach (var thread in threadList)\r\n            {\r\n                thread.Start();\r\n            }\r\n\r\n            resetEvent.Set();\r\n            foreach (var thread in threadList)\r\n            {\r\n                thread.Join();\r\n            }\r\n\r\n            ElementMetadata elementMetadata = elementMetadataList[0];\r\n            foreach (var temp in elementMetadataList)\r\n            {\r\n                if (!ReferenceEquals(elementMetadata, temp))\r\n                {\r\n                    // If it enter this branch, means the ElementMetadata object is created more than once\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n```"},{"Id":"12906961297","Type":"PullRequestEvent","CreatedAt":"2020-07-15T03:21:20","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/757","RelatedDescription":"Merged pull request \"Remove unused ElementLookup.Contains method\" (#757) at OfficeDev/Open-XML-SDK","RelatedBody":"But now there's no code that uses the `Contains` method."}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-07-16T05:30:43.1990526Z","RunDurationInMilliseconds":984}