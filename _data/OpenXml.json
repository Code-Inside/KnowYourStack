{"Data":{"Sdk":{"Events":[{"Id":"33955958491","Type":"IssuesEvent","CreatedAt":"2023-12-06T22:19:00","Actor":"cdecinkoKnight","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1617","RelatedDescription":"Opened issue \"ResolveComReference not supported on the .NET Core version of MSBuild\" (#1617) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nUnable to build project in Docker container due to following error:  \r\nThe task \"ResolveComReference\" is not supported on the .NET Core version of MSBuild.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**To Reproduce**\r\nProject/solution builds fine locally in Visual Studio. But when deployed to our Docker container in OpenShift, we get the error above.\r\n\r\nSteps to reproduce the behavior:\r\nsee above\r\n\r\n**Observed behavior**\r\nProject does not build.\r\n\r\n**Expected behavior**\r\nWe would expect to see the solution build without errors.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Linux\r\n - Office version n/a\r\n - .NET Target: 6\r\n - DocumentFormat.OpenXml Version: 3.0.0\r\n\r\n**Additional context**\r\nnone\r\n"},{"Id":"33948941247","Type":"PullRequestEvent","CreatedAt":"2023-12-06T17:58:40","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1616","RelatedDescription":"Opened pull request \"Update README.md\" (#1616) at dotnet/Open-XML-SDK","RelatedBody":"This updates the sample links with correct tags and links to the docs"},{"Id":"33938778092","Type":"IssuesEvent","CreatedAt":"2023-12-06T13:01:28","Actor":"koviroli","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1615","RelatedDescription":"Opened issue \"Any kind of documents has property DocumentType with value of the simple type(Workbook, Presentation, Document)\" (#1615) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\n\r\nOpening any kind of document, let it be:\r\n-  .docx, .docm, .dotm, .dotx\r\n- .potm, .potx, .ppsm, .ppsx, .pptm, .ppss\r\n- .xltx, .xlsm, .xlsx, .xltm,\r\n\r\nthe DocumentType property will always be `SpreadsheetDocumentType.Workbook` in case of Excel files, `PresentationDocumentType.Presentation` in case of PowerPoint files and `WordprocessingDocumentType.Document` in case of Word files.\r\n\r\n**This is the behaviour with DocumentFormat.OpenXml 3.0.0.0 nuget package, but not with the previous version 2.20.0.**\r\n\r\n**To Reproduce**\r\n\r\n```\r\n// DocumentFormat.OpenXML - 2.20.0 doc.DocumentType = MacroEnabledWorkbook\r\n// DocumentFormat.OpenXML - 3.0.0 doc.DocumentType = Workbook\r\n[Fact]\r\npublic void XlsmDocumentType_ShouldBe_MacroEnabledWorkbook()\r\n{     \r\n    // Path to a Macro-Enabled excel document       \r\n    var fileBytes = File.ReadAllBytes(@\"PathTo\\Book1.xlsm\");\r\n    using (var m = new MemoryStream(fileBytes))\r\n    using (var pkg = System.IO.Packaging.Package.Open(m))\r\n    using (var doc = SpreadsheetDocument.Open(pkg))\r\n    {           \r\n        var expectedDocumentType = SpreadsheetDocumentType.MacroEnabledWorkbook;\r\n        Assert.Equal(expectedDocumentType, doc.DocumentType);                \r\n    }\r\n}\r\n```\r\n\r\n**Observed behavior**\r\nIf I open any kind of Word-, Excel- or PowerPoint document, it will have a DocumentType property with value of WorkBook, in case of Excel, Presentation in case of PowerPoint and Document in case of Word document.\r\n\r\n**Expected behavior**\r\nIf I open a Word-, Excel- or PowerPoint document, I expected to have DocumentType property with an enum value related to the document type, for example in case of Macro-Enabled Exel document, a `SpreadsheetDocumentType.MacroEnabledWorkbook`.\r\n\r\n*Example*\r\nOpening a Macro-Enabled excel file(*.xlsm):\r\nExpected value of `DocumentType ` property: `MacroEnabledWorkbook`.\r\nActual value of `DocumentType ` property: `Workbook`\r\n\r\nOpening a Macro-Enabled power point file(*.pptm):\r\nExpected value of DocumentType property:  `MacroEnabledPresentation`\r\nActual value of `DocumentType ` property: `Presentation`\r\n\r\nOpening a Macro-Enabled word file(*.docm):\r\nExpected value of DocumentType property: `MacroEnabledDocument`\r\nActual value of `DocumentType ` property: `Document`\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows\r\n - Office version: -\r\n - .NET Target: net6.0, net8.0\r\n - DocumentFormat.OpenXml Version: 3.0.0.0\r\n\r\n"},{"Id":"33913493850","Type":"IssuesEvent","CreatedAt":"2023-12-05T18:19:31","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1520","RelatedDescription":"Reopened issue \"Open XML SDK v3: struct IdPartPair\" (#1520) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nIt would be nice to mention all v3-breaking changes in the release notes clearly.\r\n\r\n**Screenshots**\r\nBug with the fix.\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/1197905/d00a99ed-b473-45c0-9781-635d8d883864)\r\n\r\n**To Reproduce**\r\n`IdPartPait` has been converted from class to struct in v3 (most likely for performance reasons).\r\n\r\nThis change silently broke code that worked fine before and checked the value with `null`.\r\nAfter the upgrade, the code compile without errors, but some branches became unreachable and app/library no longer works as expected.\r\n\r\n**Observed behavior**\r\nNo release notes yet ;)\r\n\r\n**Expected behavior**\r\nMention such cases inside the Breaking Changes section in released notes.\r\n\r\n**Additional context**\r\nI believe that it will be helpful for apps and library authors who decide to migrate to v3.\r\nFound [during migrating](https://github.com/sergey-tihon/Clippit/pull/63) my fork of PowerTools to SDK v3"},{"Id":"33879851849","Type":"PullRequestEvent","CreatedAt":"2023-12-04T19:19:23","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1614","RelatedDescription":"Opened pull request \"Bump actions/setup-dotnet from 3 to 4\" (#1614) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [actions/setup-dotnet](https://github.com/actions/setup-dotnet) from 3 to 4.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/actions/setup-dotnet/releases\">actions/setup-dotnet's releases</a>.</em></p>\n<blockquote>\n<h2>v4.0.0</h2>\n<h2>What's Changed</h2>\n<p>In the scope of this release, the version of the Node.js runtime was updated to 20. The majority of dependencies were updated to the latest versions. From now on, the code for the setup-dotnet will run on Node.js 20 instead of Node.js 16.</p>\n<p><strong>Breaking changes</strong></p>\n<p>Update Node.js runtime to version 20 by <a href=\"https://github.com/harithavattikuti\"><code>@​harithavattikuti</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/issues/484\">#484</a></p>\n<p><strong>Non-breaking changes</strong></p>\n<ul>\n<li>Refactor installer by <a href=\"https://github.com/nikolai-laevskii\"><code>@​nikolai-laevskii</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/432\">actions/setup-dotnet#432</a></li>\n<li>Allow json comments by <a href=\"https://github.com/nikolai-laevskii\"><code>@​nikolai-laevskii</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/431\">actions/setup-dotnet#431</a></li>\n<li>Sequential version install fix by <a href=\"https://github.com/nikolai-laevskii\"><code>@​nikolai-laevskii</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/433\">actions/setup-dotnet#433</a></li>\n<li>Update fast-xml-parser and dotnet installer scripts by <a href=\"https://github.com/IvanZosimov\"><code>@​IvanZosimov</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/437\">actions/setup-dotnet#437</a></li>\n<li>Update dependencies by <a href=\"https://github.com/IvanZosimov\"><code>@​IvanZosimov</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/440\">actions/setup-dotnet#440</a></li>\n<li>Bump word-wrap from 1.2.3 to 1.2.4 by <a href=\"https://github.com/dependabot\"><code>@​dependabot</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/444\">actions/setup-dotnet#444</a></li>\n<li>Update installers by <a href=\"https://github.com/nikolai-laevskii\"><code>@​nikolai-laevskii</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/462\">actions/setup-dotnet#462</a></li>\n<li>Update semver by <a href=\"https://github.com/dmitry-shibanov\"><code>@​dmitry-shibanov</code></a> in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/468\">actions/setup-dotnet#468</a></li>\n</ul>\n<h2>New Contributors</h2>\n<ul>\n<li><a href=\"https://github.com/HarithaVattikuti\"><code>@​HarithaVattikuti</code></a> made their first contribution in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/484\">actions/setup-dotnet#484</a></li>\n</ul>\n<p><strong>Full Changelog</strong>: <a href=\"https://github.com/actions/setup-dotnet/compare/v3...v4.0.0\">https://github.com/actions/setup-dotnet/compare/v3...v4.0.0</a></p>\n<h2>v3.2.0</h2>\n<h2>What's Changed</h2>\n<p>In scope of this minor release, the ability to cache the NuGet <code>global-packages</code> folder was added in <a href=\"https://redirect.github.com/actions/setup-dotnet/pull/303\">actions/setup-dotnet#303</a> by <a href=\"https://github.com/nogic1008\"><code>@​nogic1008</code></a></p>\n<p>For caching, the action uses the <a href=\"https://github.com/actions/toolkit/tree/main/packages/cache\"><code>@​toolkit/cache</code></a> library under the hood, which in turn allows getting rid of configuring the <a href=\"https://github.com/actions/cache\"><code>@​actions/cache</code></a> action separately.</p>\n<p>Such input parameters as <code>cache</code> and <code>cache-dependency-path</code> were added. The <code>cache</code> input is optional, and caching is turned off by default, <code>cache-dependency-path</code> is used to specify the path to a dependency file - <code>packages.lock.json</code>.</p>\n<p><strong>Example of use-case:</strong></p>\n<pre lang=\"yaml\"><code>- uses: actions/setup-dotnet@v3\n  with:\n    dotnet-version: 6.x\n    cache: true\n    cache-dependency-path: subdir/packages.lock.json\n</code></pre>\n<p>More details can be found in the <a href=\"https://github.com/actions/setup-dotnet#caching-nuget-packages\">action's documentation</a>.</p>\n<p><strong>Full Changelog</strong>: <a href=\"https://github.com/actions/setup-dotnet/compare/v3...v3.2.0\">https://github.com/actions/setup-dotnet/compare/v3...v3.2.0</a></p>\n<h2>v3.1.0</h2>\n<h2>What's Changed</h2>\n<p>This minor release includes the following new <strong>features</strong>:</p>\n<!-- raw HTML omitted -->\n</blockquote>\n<p>... (truncated)</p>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/4d6c8fcf3c8f7a60068d26b594648e99df24cee3\"><code>4d6c8fc</code></a> Upgrade Node to v20 (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/484\">#484</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/2216f56ae1eec353f06abd464e2ec435fa5f5d43\"><code>2216f56</code></a> Update semver (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/468\">#468</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/736bc6dea68eb71addebd0c89e1200178e145f0e\"><code>736bc6d</code></a> Merge pull request <a href=\"https://redirect.github.com/actions/setup-dotnet/issues/462\">#462</a> from akv-platform/update-installers</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/f5526c2d1bfe45e0d078b8929dc379a93229ca3b\"><code>f5526c2</code></a> Update installers</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/4dba25fa3156706981607e1598b263e056dc3008\"><code>4dba25f</code></a> Bump word-wrap from 1.2.3 to 1.2.4 (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/444\">#444</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/ada8800330ab5b086010be13121dd25e9297111e\"><code>ada8800</code></a> Bump semver from 6.3.0 to 6.3.1 (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/443\">#443</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/e1749123a8f5e9db8abf5ec8867696143bf9bf47\"><code>e174912</code></a> Update dependencies (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/440\">#440</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/a6be55a915808728eafbfb7fcba6275352dcf6e8\"><code>a6be55a</code></a> Update fast-xml-parser and dotnet installer scripts (<a href=\"https://redirect.github.com/actions/setup-dotnet/issues/437\">#437</a>)</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/9b407708251d576f3dac6969e4c0c453a00ff5d5\"><code>9b40770</code></a> Merge pull request <a href=\"https://redirect.github.com/actions/setup-dotnet/issues/433\">#433</a> from akv-platform/sequential-version-install-fix</li>\n<li><a href=\"https://github.com/actions/setup-dotnet/commit/48277343a530e8f1def38c41afa05da090100cf8\"><code>4827734</code></a> Reduce number of e2e tests</li>\n<li>Additional commits viewable in <a href=\"https://github.com/actions/setup-dotnet/compare/v3...v4\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=actions/setup-dotnet&package-manager=github_actions&previous-version=3&new-version=4)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"33842328713","Type":"IssuesEvent","CreatedAt":"2023-12-03T21:28:47","Actor":"toraritte","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1613","RelatedDescription":"Opened issue \"Data validations with formula to another sheet won't get returned\" (#1613) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nif data validation is a formula to another sheet, then it won't get returned.\r\n\r\n**Screenshots**\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/1965782/a690f445-500d-4425-b6a9-68b724661229)\r\n(Image taken from [NPOI issue #498](https://github.com/nissl-lab/npoi/issues/498).)\r\n\r\n\r\n**To Reproduce**\r\nUsing a minimal XLSX file [`external_data_validation_sample.xlsx`](https://github.com/nissl-lab/npoi/files/6514071/external_data_validation_sample.xlsx) (again, taken from [NPOI issue #498](https://github.com/nissl-lab/npoi/issues/498)) and the following F# code in `dotnet fsi`:\r\n\r\n```\r\n#r \"nuget: DocumentFormat.OpenXml, 3.0.0\";;\r\n\r\nopen DocumentFormat.OpenXml\r\nopen DocumentFormat.OpenXml.Packaging\r\nopen DocumentFormat.OpenXml.Spreadsheet\r\n\r\nlet GetDataValidationsByIndex (filePath: string) (sheetIndex: int) =\r\n    use spreadsheet = SpreadsheetDocument.Open(filePath, false)\r\n    let workbookPart = spreadsheet.WorkbookPart\r\n    let sheets = workbookPart.Workbook.Descendants<Sheet>() |> Seq.toArray\r\n\r\n    if sheetIndex >= 0 && sheetIndex < sheets.Length then\r\n        let sheet = sheets.[sheetIndex]\r\n        let worksheetPart = workbookPart.GetPartById(sheet.Id) :?> WorksheetPart\r\n        let dataValidations = worksheetPart.Worksheet.Descendants<DataValidations>()\r\n\r\n        let validations =\r\n            dataValidations\r\n            |> Seq.collect (fun dv ->\r\n                dv.Descendants<DataValidation>()\r\n                |> Seq.map (fun validation ->\r\n                    // Extract data validation details as needed\r\n                    validation\r\n                ))\r\n            |> Seq.toList\r\n\r\n        Some validations\r\n    else\r\n        printfn \"Sheet index '%d' out of range\" sheetIndex\r\n        None\r\n;;\r\n\r\nGetDataValidationsByIndex \"external_data_validation_sample.xlsx\" 0 |> Option.get |> List.map (fun v -> v.PromptTitle);;\r\nGetDataValidationsByIndex \"external_data_validation_sample.xlsx\" 1 |> Option.get |> List.map (fun v -> v.PromptTitle);;\r\n```\r\n\r\n**Observed behavior**\r\nBoth queries above will return empty lists.\r\n\r\n**Expected behavior**\r\nExpected to return data validations with formulas to other sheets (e.g., `=Sheet2!$B$2:$B$5`). (Tested the above function on an internal XLSX file as well, and all validations get returned, except the ones that refer to sheets in their formulas.)\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows, Mac\r\n - .NET Target: .NET Core 8.0\r\n - DocumentFormat.OpenXml Version: 3.0.0"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-12-08T03:30:24.1553573Z","RunDurationInMilliseconds":1692}