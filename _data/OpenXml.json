{"Data":{"Sdk":{"Events":[{"Id":"33038125169","Type":"IssuesEvent","CreatedAt":"2023-11-02T10:03:15","Actor":"RacovitaCalin","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1550","RelatedDescription":"Opened issue \"Bug with Open XML SDK\" (#1550) at dotnet/Open-XML-SDK","RelatedBody":"ISSUE DISCRIPTION \r\nThis error occurs when trying to export a large Excel file using the DocumentFormat.OpenXml.dll library, version 2.5.5631.0. For small files the export works.\r\nThe application is developed using .NET Framework 4.7.1 C#, hosted in a IIS server (Windows server 2016).\r\nThis issue appears only in Production environment and we cannot change the application without business approval.\r\nThe below error is displayed:\r\nError Message: Unable to create mutex. (Exception from HRESULT: 0x80131464)\r\nError Stack Trace:\r\nat System.IO.IsolatedStorage.IsolatedStorageFile.Open(String infoFile, String syncName)\r\nat System.IO.IsolatedStorage.IsolatedStorageFile.Lock(Boolean& locked)\r\nat System.IO.IsolatedStorage.IsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, IsolatedStorageFile isf)\r\nat MS.Internal.IO.Packaging.PackagingUtilities.SafeIsolatedStorageFileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, ReliableIsolatedStorageFileFolder folder)\r\nat MS.Internal.IO.Packaging.PackagingUtilities.CreateUserScopedIsolatedStorageFileStreamWithRandomName(Int32 retryCount, String& fileName)\r\nat MS.Internal.IO.Packaging.SparseMemoryStream.SwitchModeIfNecessary()\r\nat MS.Internal.IO.Packaging.SparseMemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\nat MS.Internal.IO.Packaging.CompressEmulationStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\nat MS.Internal.IO.Packaging.CompressStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\nat MS.Internal.IO.Zip.ProgressiveCrcCalculatingStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\nat MS.Internal.IO.Zip.ZipIOModeEnforcingStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\nat System.Xml.XmlUtf8RawTextWriter.FlushBuffer()\r\nat System.Xml.XmlUtf8RawTextWriter.RawText(Char* pSrcBegin, Char* pSrcEnd)\r\nat System.Xml.XmlUtf8RawTextWriter.RawText(String s)\r\nat System.Xml.XmlUtf8RawTextWriter.WriteEndElement(String prefix, String localName, String ns)\r\nat System.Xml.XmlWellFormedWriter.WriteEndElement()\r\nat DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\nat DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\nat DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\nat DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\nat DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\nat DocumentFormat.OpenXml.OpenXmlPartRootElement.WriteTo(XmlWriter xmlWriter)\r\nat DocumentFormat.OpenXml.OpenXmlPartRootElement.SaveToPart(OpenXmlPart openXmlPart)\r\nat DocumentFormat.OpenXml.Packaging.OpenXmlPackage.TrySavePartContent(OpenXmlPart part)\r\nat DocumentFormat.OpenXml.Packaging.OpenXmlPackage.SavePartContents()\r\nat DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose(Boolean disposing)\r\nat DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose()\r\nat ExeLib.OfficeOpenXml.ExcelDocument.GetStream()\r\nat FCPI.Controllers.ActionController.ExportExcel(String ProcedureName, Int32 IDAuthorizationKey, Int32 IDSubmission, Nullable`1 IDFileType) in C:\\Users\\ANDREIZ\\source\\repos\\BUC - FCPI\\FCPI\\Controllers\\ActionController.cs:line 106\r\nat lambda_method(Closure , ControllerBase , Object[] )\r\nat System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)\r\nat System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass42.<BeginInvokeSynchronousActionMethod>b__41()\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass37.<>c__DisplayClass39.<BeginInvokeActionMethodWithFilters>b__33()\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass4f.<InvokeActionMethodFilterAsynchronously>b__49()\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<>c__DisplayClass2a.<BeginInvokeAction>b__20()\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Controller.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar)\r\nat System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar)\r\nat System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult)\r\nat System.Web.Mvc.MvcHandler.<>c__DisplayClass8.<BeginProcessRequest>b__3(IAsyncResult asyncResult)\r\nat System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar)\r\nat System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult\r\n\r\nWe had a Microsoft ticket opened and they said that this error is not from their system and that we should check with your team.\r\n\r\n\r\n\r\nHi Ionela, Hi everyone,\r\n\r\nI hope you are doing well!\r\n\r\nI am reaching out to you about our support request together – as explained by my colleague Apoorva and myself previously, it seems that the configuration from an IIS point-of-view is working fine on both servers, and the issue is pointing towards OpenXML before Office is involved. I have discussed the situation with my manager (in CC), and as we are not able to assist further with this issue from an Office perspective, we will proceed with placing our support request into archival. If you have further questions within the scope of this issue, please do reopen the support request!\r\n\r\nYou may receive an invitation from Microsoft to complete a brief web feedback request. Your feedback is very important to us. We use it to continually improve our service. We would appreciate it if you can take the time to complete this feedback request.\r\n\r\nIn addition, if you would like to discuss any feedback or the case itself, you can contact me or my manager using the contact information in my signature.\r\n\r\nBelow is a summary of the support request for your records:\r\n\r\nIssue: With one of the production servers, there is an error that occurs when trying to export an Excel file by using a function with OpenXML, which receives some information from an SQL server and executes a stored procedure – the error says “Unable to create mutex. (Exception from HRESULT: 0x80131464)”. The error does not occur on any other server or locally, and also has occurred before but has disappeared and reappeared in the meantime.\r\n\r\nScope:\r\nWe will consider this case solved when the script executes successfully on the affected server, if technically achievable.\r\nAlso, if we provide a technical answer on why this goal is not reachable under the given Scenario/Architecture, the issue will be considered solved.\r\nIf the causes are related to 3rd party code, we can only explain them and act as resource for you when addressing the issue with the 3rd party support.\r\n\r\nAssessment: As the configuration from an IIS point-of-view is correct and works as expected on both servers, and the issue occurs before Office is involved with OpenXML, our recommendation is to open a new issue on the OpenXML team’s GitHub page and explain the situation there; this way, the library’s team would be able to provide more information on what is causing this behaviour. Here is the link for their GitHub page for when you have the opportunity: [Issues · dotnet/Open-XML-SDK · GitHub](https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=https%3a%2f%2fgithub.com%2fdotnet%2fOpen-XML-SDK%2fissues&umid=d22b16bc-d748-4cb4-83ff-7cb9d04b8955&auth=b0e6babbab0b4c41f3232ed00b99e652b05623ce-1c505fa4a49fe064e18c438185515b5374fcc6fb)\r\n\r\nI would like to thank you for your good cooperation, and wish you a wonderful day!\r\n\r\n\r\nKind regards,\r\n\r\nDaniel Vitorino\r\nSupport Engineer\r\nEMEA Office Developer Support\r\nCustomer Services and Support\r\nOffice: +351 21 060 32 04\r\nWorking hours: 09:00 - 18:00 UTC+1\r\n[dvitorino@microsoft.com](mailto:dvitorino@microsoft.com)\r\n \r\nTeam Manager | Jaime Correia | [jaime.correia@microsoft.com](mailto:jaime.correia@microsoft.com)\r\nIf you have any feedback about my work, please let either me or my manager Jaime Correia know at [jaime.correia@microsoft.com](mailto:jaime.correia@microsoft.com)\r\n\r\nCan you please help us understand why this happens and how we can still use the OpenXML library and make it work? \r\n \r\n[Issue Description.docx](https://github.com/dotnet/Open-XML-SDK/files/13237365/Issue.Description.docx)\r\n \r\n\r\n\r\n"},{"Id":"33037126272","Type":"IssuesEvent","CreatedAt":"2023-11-02T09:27:46","Actor":"m-gallesio","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1549","RelatedDescription":"Opened issue \"More ergonomic handling of comments\" (#1549) at dotnet/Open-XML-SDK","RelatedBody":"We recently had to add XLSX comment functionality to our project.\r\nMy starting example was [the Threaded Comments sample](https://github.com/dotnet/Open-XML-SDK/blob/main/samples/ThreadedCommentExample/Program.cs) which I finally managed to adapt, but it was a rather complex job for several reasons:\r\n- I get the sample is for *threaded* comments, but I think a simpler sample for basic comments would be useful (we did not need threaded comments, nor a strong association with AD users for authors).\r\n- The sample code could use more dedicated properties instead of the default `OpenXmlElement` constructor.\r\n- The sample specifies several miscellaneous parts which do not seem to be needed for a base case. The only one which we ended up needing is the final `VmlDrawingPart`.\r\n- I do not like the idea of having to provide a raw XML for said VML drawing. I have noticed there are actual classes for the various components, but I could not find a class for the VML root element.\r\n- The whole comment API is quite annoying to use, with needing to specify separately both the comment data and the shape data (I do realize this is an issue with the format more than the SDK, though).\r\n- Stemming ftom these last two points, the sample is hard-wired to add a comment to the A1 cell and *only* the A1 cell: adding comments in different cells requires more `<x:shape />` elements with dedicated attribute values.\r\n\r\n\r\nFor now we have satisfied our needs, but I still think this could warrant some attention."},{"Id":"33025441709","Type":"IssuesEvent","CreatedAt":"2023-11-01T21:28:40","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1548","RelatedDescription":"Opened issue \"New APIs to facillitate getting started\" (#1548) at dotnet/Open-XML-SDK","RelatedBody":"This is a placeholder issue as we revamp some of the docs to identify APIs we should add to better handle common cases that are exposed by nullability analysis.  There appears to be a lot of boilerplate to build up a document that requires null checking and then adding parts, etc that we could probably add some helper methods to simplify things.\r\n\r\nFor example:\r\n\r\n```csharp\r\nSheets? sheets = workbookPart.Workbook.GetFirstChild<Sheets>();\r\n```\r\n\r\nthis could be null, so defensively, we would want something like:\r\n\r\n```csharp\r\nSheets sheets = workbookPart.Workbook.GetFirstChild<Sheets>() ?? workbookPart.Workbook.AppendChild(new Sheets());\r\n```\r\n\r\nThis becomes cumbersome, when we could add something similar to:\r\n\r\n```csharp\r\nSheets sheets = workbookPart.Workbook.GetFirstChildOrAdd<Sheets>();\r\n```\r\n\r\nAddtional APIs may be helpful here, and so I'm creating this issue to track some of these quality of life related APIs."},{"Id":"32990496145","Type":"IssuesEvent","CreatedAt":"2023-10-31T17:39:44","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1546","RelatedDescription":"Opened issue \"Integrate Q1 2024 schema updates\" (#1546) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"32990482595","Type":"IssuesEvent","CreatedAt":"2023-10-31T17:39:14","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1545","RelatedDescription":"Opened issue \"Integrate Q4 2023 schema updates\" (#1545) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"32849213565","Type":"IssuesEvent","CreatedAt":"2023-10-25T20:57:27","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1544","RelatedDescription":"Closed issue \"Creation of TOC not working anymore after moving to release 2.20\" (#1544) at dotnet/Open-XML-SDK","RelatedBody":"We are facing the issue after moving away from OpenXML 2.75 to the new release stream 2.20. The call OpenXmlReader.Create(mySW.BaseStream) converting a stream into an OpenXMLElement is not anymore possible and compiling is resulting into an ERROR. Do you have an alternative solution to insert a TOC. It's was working very well up to now.\r\n```vb\r\n            Dim myOpenXMLElement As OpenXmlElement\r\n            Dim xmlString As XElement = <w:sdt xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'>\r\n                                            <w:sdtPr>\r\n                                                <w:docPartObj>\r\n                                                    <w:docPartGallery w:val='Table of Contents'/>\r\n                                                    <w:docPartUnique/>\r\n                                                </w:docPartObj>\r\n                                            </w:sdtPr>\r\n                                            <w:sdtEndPr>\r\n                                                <w:rPr>\r\n                                                    <w:rFonts w:asciiTheme='minorHAnsi' w:cstheme='minorBidi' w:eastAsiaTheme='minorHAnsi' w:hAnsiTheme='minorHAnsi'/>\r\n                                                    <w:color w:val='auto'/>\r\n                                                    <w:sz w:val='22'/>\r\n                                                    <w:szCs w:val='22'/>\r\n                                                    <w:lang w:eastAsia='en-US'/>\r\n                                                </w:rPr>\r\n                                            </w:sdtEndPr>\r\n                                            <w:sdtContent>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='ptHeading1'/>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:t>Table of Content</w:t>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='TOC1'/>\r\n                                                        <w:tabs>\r\n                                                            <w:tab w:val='right' w:leader='dot' w:pos='9350'/>\r\n                                                        </w:tabs>\r\n                                                        <w:rPr>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='begin' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:instrText xml:space='preserve'> TOC \\o \"1-<%= myTocLevel %>\" \\h \\ u </w:instrText>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='separate' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:r>\r\n                                                        <w:rPr>\r\n                                                            <w:b/>\r\n                                                            <w:bCs/>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                        <w:fldChar w:fldCharType='end' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                            </w:sdtContent>\r\n                                        </w:sdt>\r\n            Try\r\n                Using mySW As New StreamWriter(New MemoryStream)\r\n                    mySW.Write(xmlString.ToString)\r\n                    mySW.Flush()\r\n                    mySW.BaseStream.Seek(0, SeekOrigin.Begin)\r\n                    Dim myOpenXMLReader As OpenXmlReader = **OpenXmlReader.Create(mySW.BaseStream)**\r\n                    myOpenXMLReader.Read()\r\n                    myOpenXMLElement = myOpenXMLReader.LoadCurrentElement\r\n                    myOpenXMLReader.Close()\r\n                End Using\r\n```"},{"Id":"32828686488","Type":"IssuesEvent","CreatedAt":"2023-10-25T08:57:12","Actor":"laber0815","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1544","RelatedDescription":"Opened issue \"Creation of TOC not working anymore after moving to release 2.20\" (#1544) at dotnet/Open-XML-SDK","RelatedBody":"We are facing the issue after moving away from OpenXML 2.75 to the new release stream 2.20. The call OpenXmlReader.Create(mySW.BaseStream) converting a stream into an OpenXMLElement is not anymore possible and compiling is resulting into an ERROR. Do you have an alternative solution to insert a TOC. It's was working very well up to now.\r\n\r\n            Dim myOpenXMLElement As OpenXmlElement\r\n            Dim xmlString As XElement = <w:sdt xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'>\r\n                                            <w:sdtPr>\r\n                                                <w:docPartObj>\r\n                                                    <w:docPartGallery w:val='Table of Contents'/>\r\n                                                    <w:docPartUnique/>\r\n                                                </w:docPartObj>\r\n                                            </w:sdtPr>\r\n                                            <w:sdtEndPr>\r\n                                                <w:rPr>\r\n                                                    <w:rFonts w:asciiTheme='minorHAnsi' w:cstheme='minorBidi' w:eastAsiaTheme='minorHAnsi' w:hAnsiTheme='minorHAnsi'/>\r\n                                                    <w:color w:val='auto'/>\r\n                                                    <w:sz w:val='22'/>\r\n                                                    <w:szCs w:val='22'/>\r\n                                                    <w:lang w:eastAsia='en-US'/>\r\n                                                </w:rPr>\r\n                                            </w:sdtEndPr>\r\n                                            <w:sdtContent>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='ptHeading1'/>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:t>Table of Content</w:t>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='TOC1'/>\r\n                                                        <w:tabs>\r\n                                                            <w:tab w:val='right' w:leader='dot' w:pos='9350'/>\r\n                                                        </w:tabs>\r\n                                                        <w:rPr>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='begin' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:instrText xml:space='preserve'> TOC \\o \"1-<%= myTocLevel %>\" \\h \\ u </w:instrText>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='separate' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:r>\r\n                                                        <w:rPr>\r\n                                                            <w:b/>\r\n                                                            <w:bCs/>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                        <w:fldChar w:fldCharType='end' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                            </w:sdtContent>\r\n                                        </w:sdt>\r\n            Try\r\n                Using mySW As New StreamWriter(New MemoryStream)\r\n                    mySW.Write(xmlString.ToString)\r\n                    mySW.Flush()\r\n                    mySW.BaseStream.Seek(0, SeekOrigin.Begin)\r\n                    Dim myOpenXMLReader As OpenXmlReader = **OpenXmlReader.Create(mySW.BaseStream)**\r\n                    myOpenXMLReader.Read()\r\n                    myOpenXMLElement = myOpenXMLReader.LoadCurrentElement\r\n                    myOpenXMLReader.Close()\r\n                End Using\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-11-05T03:30:25.8204558Z","RunDurationInMilliseconds":649}