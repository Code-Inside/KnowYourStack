{"Data":{"Sdk":{"Events":[{"Id":"32990496145","Type":"IssuesEvent","CreatedAt":"2023-10-31T17:39:44","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1546","RelatedDescription":"Opened issue \"Integrate Q1 2024 schema updates\" (#1546) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"32990482595","Type":"IssuesEvent","CreatedAt":"2023-10-31T17:39:14","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1545","RelatedDescription":"Opened issue \"Integrate Q4 2023 schema updates\" (#1545) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"32849213565","Type":"IssuesEvent","CreatedAt":"2023-10-25T20:57:27","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1544","RelatedDescription":"Closed issue \"Creation of TOC not working anymore after moving to release 2.20\" (#1544) at dotnet/Open-XML-SDK","RelatedBody":"We are facing the issue after moving away from OpenXML 2.75 to the new release stream 2.20. The call OpenXmlReader.Create(mySW.BaseStream) converting a stream into an OpenXMLElement is not anymore possible and compiling is resulting into an ERROR. Do you have an alternative solution to insert a TOC. It's was working very well up to now.\r\n```vb\r\n            Dim myOpenXMLElement As OpenXmlElement\r\n            Dim xmlString As XElement = <w:sdt xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'>\r\n                                            <w:sdtPr>\r\n                                                <w:docPartObj>\r\n                                                    <w:docPartGallery w:val='Table of Contents'/>\r\n                                                    <w:docPartUnique/>\r\n                                                </w:docPartObj>\r\n                                            </w:sdtPr>\r\n                                            <w:sdtEndPr>\r\n                                                <w:rPr>\r\n                                                    <w:rFonts w:asciiTheme='minorHAnsi' w:cstheme='minorBidi' w:eastAsiaTheme='minorHAnsi' w:hAnsiTheme='minorHAnsi'/>\r\n                                                    <w:color w:val='auto'/>\r\n                                                    <w:sz w:val='22'/>\r\n                                                    <w:szCs w:val='22'/>\r\n                                                    <w:lang w:eastAsia='en-US'/>\r\n                                                </w:rPr>\r\n                                            </w:sdtEndPr>\r\n                                            <w:sdtContent>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='ptHeading1'/>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:t>Table of Content</w:t>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='TOC1'/>\r\n                                                        <w:tabs>\r\n                                                            <w:tab w:val='right' w:leader='dot' w:pos='9350'/>\r\n                                                        </w:tabs>\r\n                                                        <w:rPr>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='begin' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:instrText xml:space='preserve'> TOC \\o \"1-<%= myTocLevel %>\" \\h \\ u </w:instrText>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='separate' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:r>\r\n                                                        <w:rPr>\r\n                                                            <w:b/>\r\n                                                            <w:bCs/>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                        <w:fldChar w:fldCharType='end' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                            </w:sdtContent>\r\n                                        </w:sdt>\r\n            Try\r\n                Using mySW As New StreamWriter(New MemoryStream)\r\n                    mySW.Write(xmlString.ToString)\r\n                    mySW.Flush()\r\n                    mySW.BaseStream.Seek(0, SeekOrigin.Begin)\r\n                    Dim myOpenXMLReader As OpenXmlReader = **OpenXmlReader.Create(mySW.BaseStream)**\r\n                    myOpenXMLReader.Read()\r\n                    myOpenXMLElement = myOpenXMLReader.LoadCurrentElement\r\n                    myOpenXMLReader.Close()\r\n                End Using\r\n```"},{"Id":"32828686488","Type":"IssuesEvent","CreatedAt":"2023-10-25T08:57:12","Actor":"laber0815","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1544","RelatedDescription":"Opened issue \"Creation of TOC not working anymore after moving to release 2.20\" (#1544) at dotnet/Open-XML-SDK","RelatedBody":"We are facing the issue after moving away from OpenXML 2.75 to the new release stream 2.20. The call OpenXmlReader.Create(mySW.BaseStream) converting a stream into an OpenXMLElement is not anymore possible and compiling is resulting into an ERROR. Do you have an alternative solution to insert a TOC. It's was working very well up to now.\r\n\r\n            Dim myOpenXMLElement As OpenXmlElement\r\n            Dim xmlString As XElement = <w:sdt xmlns:w='http://schemas.openxmlformats.org/wordprocessingml/2006/main'>\r\n                                            <w:sdtPr>\r\n                                                <w:docPartObj>\r\n                                                    <w:docPartGallery w:val='Table of Contents'/>\r\n                                                    <w:docPartUnique/>\r\n                                                </w:docPartObj>\r\n                                            </w:sdtPr>\r\n                                            <w:sdtEndPr>\r\n                                                <w:rPr>\r\n                                                    <w:rFonts w:asciiTheme='minorHAnsi' w:cstheme='minorBidi' w:eastAsiaTheme='minorHAnsi' w:hAnsiTheme='minorHAnsi'/>\r\n                                                    <w:color w:val='auto'/>\r\n                                                    <w:sz w:val='22'/>\r\n                                                    <w:szCs w:val='22'/>\r\n                                                    <w:lang w:eastAsia='en-US'/>\r\n                                                </w:rPr>\r\n                                            </w:sdtEndPr>\r\n                                            <w:sdtContent>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='ptHeading1'/>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:t>Table of Content</w:t>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:pPr>\r\n                                                        <w:pStyle w:val='TOC1'/>\r\n                                                        <w:tabs>\r\n                                                            <w:tab w:val='right' w:leader='dot' w:pos='9350'/>\r\n                                                        </w:tabs>\r\n                                                        <w:rPr>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                    </w:pPr>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='begin' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:instrText xml:space='preserve'> TOC \\o \"1-<%= myTocLevel %>\" \\h \\ u </w:instrText>\r\n                                                    </w:r>\r\n                                                    <w:r>\r\n                                                        <w:fldChar w:fldCharType='separate' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                                <w:p>\r\n                                                    <w:r>\r\n                                                        <w:rPr>\r\n                                                            <w:b/>\r\n                                                            <w:bCs/>\r\n                                                            <w:noProof/>\r\n                                                        </w:rPr>\r\n                                                        <w:fldChar w:fldCharType='end' w:dirty='true'/>\r\n                                                    </w:r>\r\n                                                </w:p>\r\n                                            </w:sdtContent>\r\n                                        </w:sdt>\r\n            Try\r\n                Using mySW As New StreamWriter(New MemoryStream)\r\n                    mySW.Write(xmlString.ToString)\r\n                    mySW.Flush()\r\n                    mySW.BaseStream.Seek(0, SeekOrigin.Begin)\r\n                    Dim myOpenXMLReader As OpenXmlReader = **OpenXmlReader.Create(mySW.BaseStream)**\r\n                    myOpenXMLReader.Read()\r\n                    myOpenXMLElement = myOpenXMLReader.LoadCurrentElement\r\n                    myOpenXMLReader.Close()\r\n                End Using\r\n"},{"Id":"32779808243","Type":"IssuesEvent","CreatedAt":"2023-10-23T17:27:23","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1515","RelatedDescription":"Closed issue \"Get Current Page n\" (#1515) at dotnet/Open-XML-SDK","RelatedBody":"I have a part of a code that opens a docx document and edits it, it adds several things and one of those is the page number you're currently in, so it should look like \"Pag: 1/5\". Until last week it worked just fine, but today I noticed that it no longer displays the current page number but displays in its' place \"{PAGE}\", ending up with \"Pag:{PAGE}/5\". I'm using this code on a project and both the testing code and the server code have this problem (and I haven't updated the server code in more than a month.\r\n\r\nThe following code is how it gets the current page number, which worked before:\r\n` run.AppendChild(new SimpleField() { Instruction = \"PAGE\" });`\r\n\r\nThe full part that the code is in:\r\n```\r\npageCount = int.Parse(doc.ExtendedFilePropertiesPart.Properties.Pages.Text);\r\nparagraph = td32.AppendChild(new Paragraph(\r\n        new ParagraphProperties(\r\n            new Justification() { Val = JustificationValues.Left },\r\n            new Bold() { Val = OnOffValue.FromBoolean(true) })));\r\nrun = paragraph.AppendChild(new Run());\r\nrun.RunProperties = new DocumentFormat.OpenXml.Wordprocessing.RunProperties();\r\nfontSize = new DocumentFormat.OpenXml.Wordprocessing.FontSize() { Val = \"22\" };\r\nrun.RunProperties.Append(fontSize);\r\nrunFonts = new RunFonts() { Ascii = \"Arial\", HighAnsi = \"Arial\" };\r\nrun.RunProperties.Append(runFonts);\r\nbold = new Bold() { Val = false };\r\nrun.RunProperties.Append(bold);\r\nitalic = new Italic() { Val = false };\r\nrun.RunProperties.Append(italic);\r\nrun.AppendChild(new Text(\"Pág: \"));\r\nrun.AppendChild(new SimpleField() { Instruction = \"PAGE\" });\r\nrun.AppendChild(new Text(\"/\" + pageCount));\r\n```"},{"Id":"32779790306","Type":"IssuesEvent","CreatedAt":"2023-10-23T17:26:40","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1494","RelatedDescription":"Closed issue \"Is Storm-0978/CVE-2023-36884 affecting this library?\" (#1494) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nOn our project we're using `DocumentFormat.OpenXml` to convert OOXML documents to HTML (`WmlToHtmlConverter.ConvertToHtml(WordprocessingDocument, WmlToHtmlConverterSettings)`). Given the newly found [CVE-2023-36884 vulnerability](https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/) we've been trying to figure out if this library is affected by it. However, I can't seem to find details about how macros and remote content (altChunk) is loaded (if at all). Can you tell us if we need to take any precautions or if this library is safe from this vulnerability?\r\n\r\n**Server (please complete the following information):**\r\n - OS: Windows\r\n - .NET Target:.NET Framework 4.7.2\r\n - DocumentFormat.OpenXml Version: 2.20.0\r\n"},{"Id":"32726575735","Type":"IssuesEvent","CreatedAt":"2023-10-20T15:15:48","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1433","RelatedDescription":"Closed issue \"Help with modern comments in PowerPoint\" (#1433) at dotnet/Open-XML-SDK","RelatedBody":"Hi @tomjebo @mikeebowen \r\nFirst point :\r\n![image](https://user-images.githubusercontent.com/38904948/236021001-f1c1a584-971f-427c-aece-00e9bf1b789f.png)\r\ncould you please help me to update the above function that should work for \"Modern\" comments?\r\n\r\n_Originally posted by @garg716 in https://github.com/dotnet/Open-XML-SDK/issues/1133#issuecomment-1533163265_\r\n            "}],"ResultType":"GitHubEvent"}},"RunOn":"2023-11-01T03:30:23.3806286Z","RunDurationInMilliseconds":626}