{"Data":{"Sdk":{"Events":[{"Id":"45183706367","Type":"PullRequestEvent","CreatedAt":"2024-12-31T20:03:05","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1856","RelatedDescription":"Opened pull request \"Bump coverlet.collector and Microsoft.NETFramework.ReferenceAssemblies\" (#1856) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [coverlet.collector](https://github.com/coverlet-coverage/coverlet) and [Microsoft.NETFramework.ReferenceAssemblies](https://github.com/Microsoft/dotnet). These dependencies needed to be updated together.\nUpdates `coverlet.collector` from 6.0.2 to 6.0.3\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/coverlet-coverage/coverlet/releases\">coverlet.collector's releases</a>.</em></p>\n<blockquote>\n<h2>v6.0.3</h2>\n<h3>Fixed</h3>\n<ul>\n<li>Fix RuntimeConfigurationReader to support self-contained builds <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/pull/1705\">#1705</a> by <a href=\"https://github.com/pfeigl\">https://github.com/pfeigl</a></li>\n<li>Fix inconsistent filenames with UseSourceLink after .NET 8 <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1679\">#1679</a></li>\n<li>Fix hanging tests <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/989\">#989</a></li>\n<li>Fix coverlet instrumentation becomes slow after installing dotnet sdk 8.0.200 <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1620\">#1620</a></li>\n<li>Fix upgrading v6.0.1 to v6.0.2 increases instrumentation time <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1649\">#1649</a></li>\n<li>Fix Unable to instrument module - NET 8 <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1631\">#1631</a></li>\n<li>Fix slow modules filtering process <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1646\">#1646</a> by <a href=\"https://github.com/BlackGad\">https://github.com/BlackGad</a></li>\n<li>Fix incorrect coverage await using in generic method <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1490\">#1490</a></li>\n</ul>\n<h3>Improvements</h3>\n<ul>\n<li>Cache the regex used in InstrumentationHelper <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1693\">#1693</a></li>\n<li>Enable dotnetTool integration tests for linux <a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/660\">#660</a></li>\n</ul>\n<p><a href=\"https://github.com/coverlet-coverage/coverlet/compare/v6.0.2...v6.0.3\">Diff between 6.0.2 and 6.0.3</a></p>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/fc40a2691e96df4c75139e2ada5c51a658741ff6\"><code>fc40a26</code></a> release version (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1724\">#1724</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/7095dd01cc8c2f9c9d9dd5af171e74794aea2038\"><code>7095dd0</code></a> update changelog (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1721\">#1721</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/302886a4302cce14b2019737aeb3b18f9eb4e489\"><code>302886a</code></a> Fix filename update for activated UseSourceFile option (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1681\">#1681</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/973200cfd3af473deead6a3a2ef03957c242e09e\"><code>973200c</code></a> workaround for &quot;Failed to instrument modules&quot; (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1700\">#1700</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/c2e6aeecb96358d74889f3150e4d1bab85f412ec\"><code>c2e6aee</code></a> Fix RuntimeConfigurationReader to support SelfContained builds (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1705\">#1705</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/de1a30ab70dde7f275de65aabebfb3d1351ad8f3\"><code>de1a30a</code></a> Update System.Text.Json version (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1710\">#1710</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/3004bb777ea3b8849038b28b34417daa3d900276\"><code>3004bb7</code></a> Enable tests &quot;Hang due to System.Console.ReadKey()&quot; (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1707\">#1707</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/7e0c7e87e9be3c04b68cbb4a4dbd0ee27996609e\"><code>7e0c7e8</code></a> enable dotnetTool integration tests for linux and MacOS (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1701\">#1701</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/c01ef486105b7f87bd89743725e30680bf34b6b8\"><code>c01ef48</code></a> Update Mono.Cecil 0.11.6 (Directory.Packages.props) (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1706\">#1706</a>)</li>\n<li><a href=\"https://github.com/coverlet-coverage/coverlet/commit/7c8c6fae2715308a0116e2b40221f06cbf07e7bd\"><code>7c8c6fa</code></a> add known issue BadImageFormatException (<a href=\"https://redirect.github.com/coverlet-coverage/coverlet/issues/1696\">#1696</a>)</li>\n<li>Additional commits viewable in <a href=\"https://github.com/coverlet-coverage/coverlet/compare/v6.0.2...v6.0.3\">compare view</a></li>\n</ul>\n</details>\n<br />\n\nUpdates `Microsoft.NETFramework.ReferenceAssemblies` from 1.0.3 to 1.0.3\n<details>\n<summary>Commits</summary>\n<ul>\n<li>See full diff in <a href=\"https://github.com/Microsoft/dotnet/commits\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"45165732925","Type":"IssuesEvent","CreatedAt":"2024-12-30T20:40:22","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1855","RelatedDescription":"Opened issue \"`authorsPart` should have a capitol A.\" (#1855) at dotnet/Open-XML-SDK","RelatedBody":"Description\n\n`authorsPart` attribute on `PresentationPart` should be `AuthorsPart` (capitol A)\n\nInformation\n\n.NET Target: any\nDocumentFormat.OpenXml Version: 2.15.0+\nExpected\n\n`authorsPart` should have a capitol A."},{"Id":"45164355229","Type":"PullRequestEvent","CreatedAt":"2024-12-30T19:10:53","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1852","RelatedDescription":"Closed pull request \"Bump danielpalme/ReportGenerator-GitHub-Action from 5.4.1 to 5.4.2\" (#1852) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [danielpalme/ReportGenerator-GitHub-Action](https://github.com/danielpalme/reportgenerator-github-action) from 5.4.1 to 5.4.2.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/danielpalme/reportgenerator-github-action/releases\">danielpalme/ReportGenerator-GitHub-Action's releases</a>.</em></p>\n<blockquote>\n<h2>5.4.2</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/700\">#700</a> Fixed handling of .netconfig files (sourceDirectories, reportTypes, plugins, assemblyFilters, etc.)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/716\">#716</a> Increased precision of percentages in CsvSummary and TextSummary reports (contributed by <a href=\"https://github.com/tomap\"><code>@​tomap</code></a>)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/719\">#719</a> Fixed badges in MarkdownAssembliesSummary report</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/94ea1575fb6924d22f2639373a5c4d945fdbe178\"><code>94ea157</code></a> 5.4.2</li>\n<li>See full diff in <a href=\"https://github.com/danielpalme/reportgenerator-github-action/compare/5.4.1...5.4.2\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=danielpalme/ReportGenerator-GitHub-Action&package-manager=github_actions&previous-version=5.4.1&new-version=5.4.2)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"45164354672","Type":"PullRequestEvent","CreatedAt":"2024-12-30T19:10:51","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1854","RelatedDescription":"Opened pull request \"Bump danielpalme/ReportGenerator-GitHub-Action from 5.4.1 to 5.4.3\" (#1854) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [danielpalme/ReportGenerator-GitHub-Action](https://github.com/danielpalme/reportgenerator-github-action) from 5.4.1 to 5.4.3.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/danielpalme/reportgenerator-github-action/releases\">danielpalme/ReportGenerator-GitHub-Action's releases</a>.</em></p>\n<blockquote>\n<h2>5.4.3</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/717\">#717</a> Added new new coverage type &quot;Full method coverage&quot; (percentage of methods that are fully covered)</li>\n</ul>\n<h2>5.4.2</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/700\">#700</a> Fixed handling of .netconfig files (sourceDirectories, reportTypes, plugins, assemblyFilters, etc.)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/716\">#716</a> Increased precision of percentages in CsvSummary and TextSummary reports (contributed by <a href=\"https://github.com/tomap\"><code>@​tomap</code></a>)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/719\">#719</a> Fixed badges in MarkdownAssembliesSummary report</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/c38c522d4b391c1b0da979cbb2e902c0a252a7dc\"><code>c38c522</code></a> 5.4.3</li>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/94ea1575fb6924d22f2639373a5c4d945fdbe178\"><code>94ea157</code></a> 5.4.2</li>\n<li>See full diff in <a href=\"https://github.com/danielpalme/reportgenerator-github-action/compare/5.4.1...5.4.3\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=danielpalme/ReportGenerator-GitHub-Action&package-manager=github_actions&previous-version=5.4.1&new-version=5.4.3)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"45061647345","Type":"IssuesEvent","CreatedAt":"2024-12-24T13:01:42","Actor":"ChandrasekarML","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1853","RelatedDescription":"Opened issue \"Bug with Open XML SDK\" (#1853) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nhow to track changes in a word document with inserted and deleted word by word along with color Inserted updating track changes, but deleted not updating track changes.\n\nSample code:\npublic void TrackChangesInWord(string filePath, string newText, string oldText)\n{\n    using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(filePath, true))\n    {\n        var mainPart = wordDoc.MainDocumentPart;\n        var body = mainPart.Document.Body;\n\n        foreach (var paragraph in body.Elements<Paragraph>())\n        {\n            var runs = paragraph.Elements<Run>().ToList();\n            string combinedText = string.Join(\"\", runs.Select(r => r.GetFirstChild<Text>()?.Text ?? string.Empty));\n\n            if (combinedText.Contains(oldText))\n            {\n                // Find the start index of the old text\n                int startIndex = combinedText.IndexOf(oldText);\n\n                // Remove all existing runs\n                foreach (var run in runs)\n                {\n                    run.Remove();\n                }\n\n                // Add text before the old word\n                if (startIndex > 0)\n                {\n                    string beforeText = combinedText.Substring(0, startIndex);\n                    paragraph.AppendChild(new Run(new Text(beforeText)));\n                }\n\n                // Add deleted text as a tracked change\n                var deletedRun = new DeletedRun\n                {\n                    Author = \"AuthorName\",\n                    Date = DateTime.Now\n                };\n                var deletedTextRun = new Run\n                {\n                    RunProperties = new RunProperties(new Color { Val = \"FF0000\" }) // Red for deleted\n                };\n                deletedTextRun.AppendChild(new Text(oldText));\n                deletedRun.AppendChild(deletedTextRun);\n                paragraph.AppendChild(deletedRun);\n\n                // Add inserted text as a tracked change\n                var insertedRun = new InsertedRun\n                {\n                    Author = \"AuthorName\",\n                    Date = DateTime.Now\n                };\n                var insertedTextRun = new Run\n                {\n                    RunProperties = new RunProperties(new Color { Val = \"00FF00\" }) // Green for inserted\n                };\n                insertedTextRun.AppendChild(new Text(newText));\n                insertedRun.AppendChild(insertedTextRun);\n                paragraph.AppendChild(insertedRun);\n\n                // Add text after the old word\n                string afterText = combinedText.Substring(startIndex + oldText.Length);\n                if (!string.IsNullOrEmpty(afterText))\n                {\n                    paragraph.AppendChild(new Run(new Text(afterText)));\n                }\n            }\n        }\n\n        mainPart.Document.Save();\n    }\n}\n\n"},{"Id":"45044443715","Type":"PullRequestEvent","CreatedAt":"2024-12-23T19:33:30","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1852","RelatedDescription":"Opened pull request \"Bump danielpalme/ReportGenerator-GitHub-Action from 5.4.1 to 5.4.2\" (#1852) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [danielpalme/ReportGenerator-GitHub-Action](https://github.com/danielpalme/reportgenerator-github-action) from 5.4.1 to 5.4.2.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/danielpalme/reportgenerator-github-action/releases\">danielpalme/ReportGenerator-GitHub-Action's releases</a>.</em></p>\n<blockquote>\n<h2>5.4.2</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/700\">#700</a> Fixed handling of .netconfig files (sourceDirectories, reportTypes, plugins, assemblyFilters, etc.)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/716\">#716</a> Increased precision of percentages in CsvSummary and TextSummary reports (contributed by <a href=\"https://github.com/tomap\"><code>@​tomap</code></a>)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/719\">#719</a> Fixed badges in MarkdownAssembliesSummary report</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/94ea1575fb6924d22f2639373a5c4d945fdbe178\"><code>94ea157</code></a> 5.4.2</li>\n<li>See full diff in <a href=\"https://github.com/danielpalme/reportgenerator-github-action/compare/5.4.1...5.4.2\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=danielpalme/ReportGenerator-GitHub-Action&package-manager=github_actions&previous-version=5.4.1&new-version=5.4.2)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"44975200869","Type":"IssuesEvent","CreatedAt":"2024-12-20T09:19:49","Actor":"Kezzya","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1851","RelatedDescription":"Opened issue \"On desktop Word file is corrupted, but I can open it online or with Libre Office or WPS...\" (#1851) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nHello, I create generation of word file from dotx template. But in desktop Word Office app I can't open file, but with another ways, I can open (WPS, Libre Office, Google Docs, Online Office)\nWhat the problem? Is this because I clone dotx file and generate docx?\n\n`public ActionResult GenerateDocument(int reportViewId, int rid)\n{\n\n    string templatePath = Server.MapPath(\"~/Content/templates/word/Template.dotx\");\n    if (RepView.WordTemplateFileName != null)\n    {\n        templatePath = Server.MapPath(\"\\\\UserFiles\\\\ReportViewWordTemplates\\\\\" + RepView.WordTemplateFileId);\n    }\n    string outputPath = Server.MapPath(\"~/generated.docx\");\n\n    using (MemoryStream memoryStream = new MemoryStream())\n    {\n        try\n        {\n            using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(templatePath, false))\n            {\n                wordDoc.Clone(memoryStream);\n            }\n\n        }\n        catch\n        {\n            using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(templatePath, false))\n            {\n                wordDoc.Clone(memoryStream);\n            }\n        }\n\n        using (WordprocessingDocument generatedDoc = WordprocessingDocument.Open(memoryStream, true))\n        {\n            memoryStream.Position = 0;\n            var mainDocumentPart = generatedDoc.MainDocumentPart;\n\n            var body = mainDocumentPart.Document.Body;\n\n            var headerParts = generatedDoc.MainDocumentPart.HeaderParts;\n            var footerParts = generatedDoc.MainDocumentPart.FooterParts;\n\n            foreach (var parts in headerParts)\n            {\n                foreach (var currentText in parts.RootElement.Descendants<DocumentFormat.OpenXml.Wordprocessing.Text>())\n                {\n                    currentText.Text = currentText.Text.Replace(\"Header\", header);\n                }\n            }\n            foreach (var parts in footerParts)\n            {\n                foreach (var currentText in parts.RootElement.Descendants<DocumentFormat.OpenXml.Wordprocessing.Text>())\n                {\n                    currentText.Text = currentText.Text.Replace(\"Bottom\", bottom);\n                }\n            }\n\n            ImagePart imgp = mainDocumentPart.AddImagePart(ImagePartType.Png);\n            var textElements = body.Descendants<Text>()\n          .Where(t => t.Text.Contains(\"text\"))\n          .FirstOrDefault();\n   \n            var run = new Run(new Text());\n            if (textElements != null)\n            {\n                run = textElements.Parent as Run;\n            }\n           \n            foreach (var item in headers)\n            {\n                if (blocks.Where(p => p.DocumentConstructorHeaderId == item.DocumentConstructorHeaderId).Count() != 0)\n                {\n                    \n                    if (item.SizeTitle > 1)\n                    {\n                        AddHeading(body, item.Title, 1, mainDocumentPart.StyleDefinitionsPart);\n                    }\n                    else\n                    {\n                        AddHeading(body, item.Title, 2, mainDocumentPart.StyleDefinitionsPart);\n                    }\n                }\n\n                foreach (var list in newBlocks.Where(p => p.DocumentConstructorHeaderId == item.DocumentConstructorHeaderId).OrderBy(p => p.Npp).ToList())\n                {\n                    if (list.ImageData != null)\n                    {\n                        using (var imageStream = new MemoryStream(list.ImageData))\n                        {\n                            imgp.FeedData(imageStream);\n                        }\n\n                        AddImageToBody(mainDocumentPart, list.ImageData);\n                    }\n                    /*if (list.Content != null)\n                    {\n                        AddHeading(body, item.Title, 1, mainDocumentPart.StyleDefinitionsPart);\n                    }*/\n\n                    Paragraph para = body.AppendChild(new Paragraph());\n\n                    if (textElements != null)\n                    {\n                        // Извлекаем свойства Run\n                        var runProperties = run.RunProperties?.CloneNode(true);\n                        var newRun = new Run(new Text(list.Content));\n                        newRun.PrependChild(runProperties);\n                        para.AppendChild(newRun);\n                    }\n                    else\n                    {\n                        para.AppendChild(new Run(new Text(list.Content)));\n                    }\n                    ReplaceText(body, \"text\", \"\");\n                }\n            }\n            generatedDoc.Close();\n        }\n        return File(memoryStream.ToArray(), \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", \"generated.docx\");\n    }\n}`\n\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-01-02T03:30:25.4713089Z","RunDurationInMilliseconds":609}