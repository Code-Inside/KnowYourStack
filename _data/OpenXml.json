{"Data":{"Sdk":{"Events":[{"Id":"48825332254","Type":"IssuesEvent","CreatedAt":"2025-04-18T10:31:32","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/795","RelatedDescription":"Closed issue \"Can't Create Lists in the NumberingDefinitionsPart as expected\" (#795) at dotnet/Open-XML-SDK","RelatedBody":"Is this a:\r\n- [ X ] Issue with the OpenXml library\r\n- [ maybe? ] Question on library usage\r\n\r\n**Description**\r\n\r\nWhen trying to create paragraphs in a list allowing the Numbering instance that contains the numbering definitions fails produce listed output in the document file if it is referenced by the NumberingDefinitionsPart.Numbering property\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Core 3.1\r\n- DocumentFormat.OpenXml Version: 2.11.3\r\n\r\n**Repro**\r\n\r\n```csharp\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing DocumentFormat.OpenXml;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Wordprocessing;\r\nusing Microsoft.VisualStudio.TestTools.UnitTesting;\r\n\r\nnamespace OpenXmlNumberingPartBusted\r\n{\r\n    [TestClass]\r\n    [TestCategory(\"Integration\")]\r\n    public class OpenXmlNumberingPartTests\r\n    {\r\n        private static IEnumerable<object[]> Factories => new[]\r\n        {\r\n            new object[] { new NumberingFactoryExpectedToWork() }, //will pass unit tests but produces documents without lists\r\n            new object[] { new NumberingFactoryWorkaround() } //will produce documents with numbered lists but will not pass tests\r\n        };\r\n\r\n        [TestMethod]\r\n        [DynamicData(nameof(Factories))]\r\n        public void CreateADocument_WithNumberingParts_PartsComeOutNumbered(INumberingFactory numberingFactory)\r\n        {\r\n            var fileLocation = $\"./TestResults/{Guid.NewGuid()}.docx\"; // Using a real file instead of a memory stream so that the actual output can be inspected\r\n            using var document = WordprocessingDocument.Create(fileLocation, WordprocessingDocumentType.Document);\r\n            var mainPart = document.AddMainDocumentPart();\r\n            mainPart.Document = new Document();\r\n            mainPart.Document.AppendChild(new Body());\r\n\r\n            var numbering1 = numberingFactory.CreateNewNumberingSequence(document);\r\n            var paragraph = document.MainDocumentPart.Document.Body.AppendChild(new Paragraph());\r\n            var properties = paragraph.ParagraphProperties ??= new ParagraphProperties();\r\n            properties.AppendChild(numbering1.CloneNode(true));\r\n            paragraph.AppendChild(new Run(new Text(\"1\")));\r\n            paragraph = document.MainDocumentPart.Document.Body.AppendChild(new Paragraph());\r\n            properties = paragraph.ParagraphProperties ??= new ParagraphProperties();\r\n            properties.AppendChild(numbering1.CloneNode(true));\r\n            paragraph.AppendChild(new Run(new Text(\"2\")));\r\n\r\n            var numbering2 = numberingFactory.CreateNewNumberingSequence(document);\r\n            paragraph = document.MainDocumentPart.Document.Body.AppendChild(new Paragraph());\r\n            properties = paragraph.ParagraphProperties ??= new ParagraphProperties();\r\n            properties.AppendChild(numbering2.CloneNode(true));\r\n            paragraph.AppendChild(new Run(new Text(\"one\")));\r\n            paragraph = document.MainDocumentPart.Document.Body.AppendChild(new Paragraph());\r\n            properties = paragraph.ParagraphProperties ??= new ParagraphProperties();\r\n            properties.AppendChild(numbering2.CloneNode(true));\r\n            paragraph.AppendChild(new Run(new Text(\"two\")));\r\n\r\n            document.Save();\r\n            Console.WriteLine(fileLocation);\r\n            document.Close();\r\n            // Even when saved to disk and restored one method passes unit tests but does not produce numbers on the list and one produces numbers on the list but fails the test.\r\n            using var saveDocument = WordprocessingDocument.Open(fileLocation, false);\r\n            Assert.AreEqual(2, saveDocument.MainDocumentPart.NumberingDefinitionsPart.Numbering.Descendants<AbstractNum>().Count());\r\n            Assert.AreEqual(2, saveDocument.MainDocumentPart.NumberingDefinitionsPart.Numbering.Descendants<NumberingInstance>().Count());\r\n        }\r\n\r\n        public interface INumberingFactory\r\n        {\r\n            NumberingProperties CreateNewNumberingSequence(WordprocessingDocument document);\r\n        }\r\n\r\n        private class NumberingFactoryExpectedToWork : INumberingFactory\r\n        {\r\n            public NumberingProperties CreateNewNumberingSequence(WordprocessingDocument document)\r\n            {\r\n                var definitions = document.MainDocumentPart.NumberingDefinitionsPart ??\r\n                                  document.MainDocumentPart.AddNewPart<NumberingDefinitionsPart>();\r\n                var numbering = definitions.Numbering ??= new Numbering(); // The property should be initialized since it is the root of the part.  Not that big a deal though.\r\n\r\n                var baseNumbering = numbering.AppendChild\r\n                (\r\n                    new AbstractNum\r\n                    (\r\n                        new Level\r\n                        {\r\n                            NumberingFormat = new NumberingFormat\r\n                            {\r\n                                Val = NumberFormatValues.Decimal\r\n                            },\r\n                            LevelIndex = 0\r\n                        }\r\n                    )\r\n                    {\r\n                        AbstractNumberId = numbering\r\n                            .Descendants<AbstractNum>()\r\n                            .Select<AbstractNum, int>(an => an.AbstractNumberId)\r\n                            .DefaultIfEmpty(0)\r\n                            .Max() + 1,\r\n                        MultiLevelType = new MultiLevelType {Val = MultiLevelValues.SingleLevel},\r\n                    }\r\n                );\r\n                var numberingInstance = numbering.AppendChild\r\n                (\r\n                    new NumberingInstance\r\n                    {\r\n                        NumberID = numbering\r\n                            .Descendants<NumberingInstance>()\r\n                            .Select<NumberingInstance, int>(an => an.NumberID)\r\n                            .DefaultIfEmpty(0)\r\n                            .Max() + 1,\r\n                        AbstractNumId = new AbstractNumId {Val = baseNumbering.AbstractNumberId}\r\n                    }\r\n                );\r\n\r\n                // It doesn't make a difference if it gets saved or not.\r\n                // If the instance of Numbering is associated with the Numbering property of the part the resulting document will not be numbered.\r\n                //numbering.Save(definitions);\r\n\r\n                return new NumberingProperties\r\n                {\r\n                    NumberingId = new NumberingId { Val = numberingInstance.NumberID },\r\n                    NumberingLevelReference = new NumberingLevelReference { Val = 0 }\r\n                };\r\n            }\r\n        }\r\n\r\n        private class NumberingFactoryWorkaround : INumberingFactory\r\n        {\r\n            //save the numbering instance away from the part so that it can be repeatedly saved with more elements\r\n            private readonly Numbering _numbering = new Numbering();\r\n\r\n            public NumberingProperties CreateNewNumberingSequence(WordprocessingDocument document)\r\n            {\r\n                // The numbering part API does not work correctly.\r\n                // Any Numbering instance that becomes associated with the part as its property does not produce numbering in the final document\r\n\r\n                var definitions = document.MainDocumentPart.NumberingDefinitionsPart ??\r\n                                  document.MainDocumentPart.AddNewPart<NumberingDefinitionsPart>();\r\n                definitions.Numbering ??= new Numbering(); // The property must be accessed but cannot be used.  It is null even on a new instance where this is the root part.\r\n                // Using Numbering.Load produces the same result.\r\n\r\n                var baseNumbering = new AbstractNum\r\n                (\r\n                    new Level\r\n                    {\r\n                        NumberingFormat = new NumberingFormat\r\n                        {\r\n                            Val = NumberFormatValues.Decimal\r\n                        },\r\n                        LevelIndex = 0\r\n                    }\r\n                )\r\n                {\r\n                    AbstractNumberId = _numbering\r\n                        .Descendants<AbstractNum>()\r\n                        .Select<AbstractNum, int>(an => an.AbstractNumberId)\r\n                        .DefaultIfEmpty(0)\r\n                        .Max() + 1,\r\n                    MultiLevelType = new MultiLevelType {Val = MultiLevelValues.SingleLevel},\r\n                };\r\n                var numberingInstance = new NumberingInstance\r\n                {\r\n                    NumberID = _numbering\r\n                        .Descendants<NumberingInstance>()\r\n                        .Select<NumberingInstance, int>(an => an.NumberID)\r\n                        .DefaultIfEmpty(0)\r\n                        .Max() + 1,\r\n                    AbstractNumId = new AbstractNumId {Val = baseNumbering.AbstractNumberId}\r\n                };\r\n\r\n                _numbering.AppendChild(baseNumbering);\r\n                _numbering.AppendChild(numberingInstance);\r\n                _numbering.Save(definitions);\r\n                // Assigning a new Numbering to the property has the same result as using one accessed from the property, even if it was saved first.\r\n\r\n                return new NumberingProperties\r\n                {\r\n                    NumberingId = new NumberingId {Val = numberingInstance.NumberID},\r\n                    NumberingLevelReference = new NumberingLevelReference {Val = 0}\r\n                };\r\n            }\r\n        }\r\n    }\r\n}\r\n``` \r\nhttps://github.com/hypnopotamus/OpenXmlNumberingPartBusted\r\n\r\n**Observed**\r\n\r\nIt doesn't seem to matter what else happens, if the Numbering instance is references as the root element (in the Numbering property) of the NumberingDefinitionsPart of the document then the output will not be displayed in a list.  Creating a new Numbering with child elements and calling it's Save method with the NumberingDefinitionsPart as a parameter will produce listed output in the document, so long as that Numbering instance is not referenced by the part's property.  Creating a new Numbering instance and calling Load with the part as a parameter produces the same result, child elements of that Numbering will not be reflected in the final document output.\r\n\r\nCreating numbering definitions using the workaround does not allow those definitions to be inspected through the document, they must be held outside the document (e.g. adding additional numberings after the first, unit testing)\r\n\r\n**Expected**\r\n\r\nThe Numbering property of NumberingDefinitionsPart should have a reference to a valid element after being created and adding valid child elements to it then using the NumberingID on a paragraph's properties, should produce a listed output in the document and should be visible in the in-memory representation of the document.\r\n"},{"Id":"48712590295","Type":"IssuesEvent","CreatedAt":"2025-04-15T16:17:59","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1919","RelatedDescription":"Closed issue \"Reserve NuGet prefix\" (#1919) at dotnet/Open-XML-SDK","RelatedBody":"Hello\n\nThis is kind of a documentation request.\n\nI was wondering if the NuGet prefix could be reserved?\nhttps://www.nuget.org/packages/DocumentFormat.OpenXml\n\nThank you for your consideration, Alex"},{"Id":"48680616954","Type":"IssuesEvent","CreatedAt":"2025-04-15T00:52:38","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1184","RelatedDescription":"Closed issue \"DocumentType Strict does not exist\" (#1184) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nDocumentType Strict does not exist if you want to change document type. See available options for changing document types for spreadsheets:\r\n\r\nhttps://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheetdocumenttype?view=openxml-2.8.1\r\n\r\n**Information**\r\n\r\n- DocumentFormat.OpenXml Version: (ie 2.7.2)\r\n\r\n**Repro**\r\n\r\n```csharp\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n``` \r\n\r\n**Observed**\r\n\r\nNo Strict DocumentType exist for changing DocumentType.\r\n\r\n**Expected**\r\n\r\nYou can save files as Strict in the file type dropdown menu in Office, but you cannot select Strict as a DocumentType in the SDK.\r\n"},{"Id":"48605151950","Type":"IssuesEvent","CreatedAt":"2025-04-11T23:46:25","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/875","RelatedDescription":"Closed issue \"OpenXML SDK will throw exception when a percentage with % char\" (#875) at dotnet/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n\r\n**Description**\r\n\r\nWhen the document contains `%` characters, I use the OpenXML SDK to read a percentage value, an exception will be thrown. \r\n\r\n**Information**\r\n\r\n- .NET Target: All\r\n- DocumentFormat.OpenXml Version: 2.12.0\r\n\r\nhttps://github.com/lindexi/lindexi_gd/tree/9b506dea/RurlejileGearhuheljale\r\n\r\n```csharp\r\n                    var background = slide.CommonSlideData.Background;\r\n                    var backgroundProperties = background.BackgroundProperties;\r\n                    var solidFill = backgroundProperties.GetFirstChild<SolidFill>();\r\n                    var solidFillRgbColorModelHex = solidFill.RgbColorModelHex;\r\n                    var alpha = solidFillRgbColorModelHex.GetFirstChild<Alpha>();\r\n                    try\r\n                    {\r\n                        int alphaVal = alpha.Val;\r\n                    }\r\n                    catch (Exception e)\r\n                    {\r\n                        // Input string was not in a correct format.\r\n                        Console.WriteLine(e);\r\n                    }\r\n``` \r\n\r\nThe document:\r\n\r\n```xml\r\n    <p:bg>\r\n      <p:bgPr>\r\n        <a:solidFill>\r\n          <a:srgbClr val=\"383747\">\r\n            <a:alpha val=\"100.00%\" />\r\n          </a:srgbClr>\r\n        </a:solidFill>\r\n      </p:bgPr>\r\n    </p:bg>\r\n```\r\n\r\n**Observed**\r\n\r\nThe code throw exception\r\n\r\n```\r\nint alphaVal = alpha.Val;\r\n```\r\n\r\n\r\n**Expected**\r\n\r\nIt can convert to int value. We can convert `100%` to 100000 value\r\n"},{"Id":"48548110572","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:16","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1142","RelatedDescription":"Closed issue \"Strict Excel Files Have Invalid int32 Data Types\" (#1142) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nExcel files saved as \"Strict Open XML\" contain a number of int32 validation errors related to hidden percentage values in the schema.\r\n\r\nFor context of this error see: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\nFor possible explanation: \r\n\"In ISO 29500-1 20.1.8.36 gs (Gradient stops) the pos attribute is defined:\r\nSpecifies where this gradient stop should appear in the color band. This position is specified in the range [0%, 100%], which corresponds to the beginning and the end of the color band respectively.\r\n\r\nSo, the SDK's validation (the CLI uses the SDK to get the validation errors) is wrong, but that means the issue is with the SDK and not the validator CLI.\"\r\n\r\n**Information**\r\n\r\n- .NET Target: (ie .NET Framework, .NET Core, UWP, Xamarin, etc)\r\n- DocumentFormat.OpenXml Version: (ie 2.7.2)\r\n\r\n**Repro**\r\n\r\nUse OOXML Validator 1.1 to reproduce the validation errors on any generic Excel spreadsheet you save as \"Strict Open XML\".\r\n\r\nLink to OOXML Validator 1.1: https://github.com/mikeebowen/OOXML-Validator\r\n\r\nSee this issue for an Excel test file, that you can use to reproduce the errors with: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\n**Observed**\r\n\r\nThe following errors in XML are created by OOXML Validator. The creator of OOXML Validator ahve informed me the validation errors stem from a bug in the SDK and have advised me to post the issue here.\r\n\r\nSee the XML log below.\r\n\r\n<ValidationErrorInfoList FilePath=\"C:\\db\\_Testdata\\Regneark\\Excel-testkorpus\\Book1.xlsx\" IsStrict=\"true\"> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '90%'. The string '90%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '130%'. The string '130%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '150%'. The string '150%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '93%'. The string '93%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '170%'. The string '170%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '95%'. The string '95%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '78%'. The string '78%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '99%'. The string '99%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '94%'. The string '94%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '81%'. The string '81%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '109%'. The string '109%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '73%'. The string '73%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '67%'. The string '67%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> </ValidationErrorInfoList>\r\n\r\n**Expected**\r\n\r\nThere should be no int32 validation errors when Excel saves spreadsheets in \"Strict Open XML\" file format.\r\n"},{"Id":"48548110522","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:16","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1142","RelatedDescription":"Closed issue \"Strict Excel Files Have Invalid int32 Data Types\" (#1142) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nExcel files saved as \"Strict Open XML\" contain a number of int32 validation errors related to hidden percentage values in the schema.\r\n\r\nFor context of this error see: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\nFor possible explanation: \r\n\"In ISO 29500-1 20.1.8.36 gs (Gradient stops) the pos attribute is defined:\r\nSpecifies where this gradient stop should appear in the color band. This position is specified in the range [0%, 100%], which corresponds to the beginning and the end of the color band respectively.\r\n\r\nSo, the SDK's validation (the CLI uses the SDK to get the validation errors) is wrong, but that means the issue is with the SDK and not the validator CLI.\"\r\n\r\n**Information**\r\n\r\n- .NET Target: (ie .NET Framework, .NET Core, UWP, Xamarin, etc)\r\n- DocumentFormat.OpenXml Version: (ie 2.7.2)\r\n\r\n**Repro**\r\n\r\nUse OOXML Validator 1.1 to reproduce the validation errors on any generic Excel spreadsheet you save as \"Strict Open XML\".\r\n\r\nLink to OOXML Validator 1.1: https://github.com/mikeebowen/OOXML-Validator\r\n\r\nSee this issue for an Excel test file, that you can use to reproduce the errors with: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\n**Observed**\r\n\r\nThe following errors in XML are created by OOXML Validator. The creator of OOXML Validator ahve informed me the validation errors stem from a bug in the SDK and have advised me to post the issue here.\r\n\r\nSee the XML log below.\r\n\r\n<ValidationErrorInfoList FilePath=\"C:\\db\\_Testdata\\Regneark\\Excel-testkorpus\\Book1.xlsx\" IsStrict=\"true\"> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '90%'. The string '90%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '130%'. The string '130%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '150%'. The string '150%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '93%'. The string '93%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '170%'. The string '170%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '95%'. The string '95%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '78%'. The string '78%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '99%'. The string '99%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '94%'. The string '94%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '81%'. The string '81%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '109%'. The string '109%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '73%'. The string '73%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '67%'. The string '67%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> </ValidationErrorInfoList>\r\n\r\n**Expected**\r\n\r\nThere should be no int32 validation errors when Excel saves spreadsheets in \"Strict Open XML\" file format.\r\n"},{"Id":"48548110150","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:15","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1190","RelatedDescription":"Closed issue \"Validation of Excel Strict files reports two errors\" (#1190) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nValidating any Strict conformance .xlsx spreadsheet results in 45 validation errors of which none should exist. I have already reported 43 of the errors in another issue, which are all related to the same issue, and now I report the last two errors. \r\n\r\nOpen XML SDK Validator gives the following two errors. Both files have been created with Excel, saved as Open XML Strict and nothing have been changed in them since, which for me logically should mean they are both valid, but the validator reports these two.\r\n\r\nCan you do anything to correct this?\r\n\r\n```\r\nFILEPATH\r\n--> File format is invalid - Spreadsheet has 45 validation errors\r\n--> Error 1\r\n----> Description: The 'dateCompatibility' attribute is not declared.\r\n----> ErrorType: Schema\r\n----> Node: DocumentFormat.OpenXml.Spreadsheet.WorkbookProperties\r\n----> Path: /x:workbook[1]/x:workbookPr[1]\r\n----> Part: /xl/workbook.xml\r\n--> Error 2\r\n----> Description: The element has unexpected child element 'http://schemas.openxmlformats.org/spreadsheetml/2006/main:start'. List of possible elements expected: <http://schemas.openxmlformats.org/spreadsheetml/2006/main:left>.\r\n----> ErrorType: Schema\r\n----> Node: DocumentFormat.OpenXml.Spreadsheet.Border\r\n----> Path: /x:styleSheet[1]/x:borders[1]/x:border[1]\r\n----> Part: /xl/styles.xml\r\n----> Related Node: DocumentFormat.OpenXml.Spreadsheet.StartBorder\r\n----> Related Node Inner Text:\r\n```"},{"Id":"48548110156","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:15","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1190","RelatedDescription":"Closed issue \"Validation of Excel Strict files reports two errors\" (#1190) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nValidating any Strict conformance .xlsx spreadsheet results in 45 validation errors of which none should exist. I have already reported 43 of the errors in another issue, which are all related to the same issue, and now I report the last two errors. \r\n\r\nOpen XML SDK Validator gives the following two errors. Both files have been created with Excel, saved as Open XML Strict and nothing have been changed in them since, which for me logically should mean they are both valid, but the validator reports these two.\r\n\r\nCan you do anything to correct this?\r\n\r\n```\r\nFILEPATH\r\n--> File format is invalid - Spreadsheet has 45 validation errors\r\n--> Error 1\r\n----> Description: The 'dateCompatibility' attribute is not declared.\r\n----> ErrorType: Schema\r\n----> Node: DocumentFormat.OpenXml.Spreadsheet.WorkbookProperties\r\n----> Path: /x:workbook[1]/x:workbookPr[1]\r\n----> Part: /xl/workbook.xml\r\n--> Error 2\r\n----> Description: The element has unexpected child element 'http://schemas.openxmlformats.org/spreadsheetml/2006/main:start'. List of possible elements expected: <http://schemas.openxmlformats.org/spreadsheetml/2006/main:left>.\r\n----> ErrorType: Schema\r\n----> Node: DocumentFormat.OpenXml.Spreadsheet.Border\r\n----> Path: /x:styleSheet[1]/x:borders[1]/x:border[1]\r\n----> Part: /xl/styles.xml\r\n----> Related Node: DocumentFormat.OpenXml.Spreadsheet.StartBorder\r\n----> Related Node Inner Text:\r\n```"},{"Id":"48548109983","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:15","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1223","RelatedDescription":"Closed issue \"Support validation of conformance\" (#1223) at dotnet/Open-XML-SDK","RelatedBody":"**Is your feature request related to a problem? Please describe.**\r\nIn the following, I will be referring to code adopted in the context of spreadsheets and therefore not all code pieces may be reuseable for text or presentations.\r\n\r\nOpen XML SDK currently supports the two following means of identifying OOXML conformance (either Transitional or Strict).\r\n\r\nFirst, you have the class ```Conformance```, which is a property saved to ```workbook.xml``` based on the ```ConformanceClass``` enum. So you have to go to ```WorkbookPart.Workbook.Conformance``` to find this.\r\n\r\nSecond, you have ```StrictRelationshipFound```, which is a bool value you can fetch from root level. Here's the code in Open XML SDK:\r\n```\r\n/// <summary>\r\n/// Gets a value indicating whether this package contains Transitional relationships converted from Strict.\r\n /// </summary>\r\npublic bool StrictRelationshipFound { get; private set; }\r\n```\r\n\r\nThe question is whether these two ways of identifying conformance, actually checks for a VALID STRICT or VALID TRANSITIONAL OOXML file? With conformance class, it only fetches the property, meaning it does not check if any INVALID TRANSITIONAL features appear in the file. I don't know how StrictPropertyRelationship works, and judging from the summary, it only finds existing Transitional files, that have been converted to Strict conformance, but it does not identify Strict files created as Strict. However, when I test this on files, whether the file was Transitional has no relevance, it will find any Strict file. But how is this qualified, will it simply look for the conformance class value or will it also check for existence of X, Y, Z properties for instance many namespaces are different between the two conformance modes and these should be checked.\r\n\r\nI think it is OK, if both of the outlined means of identification simply check for conformance class value, but I don't think this is sufficient for validation of a VALID STRICT or VALID TRANSITIONAL file. All differences specified in the OOXML ISO standard should be separated into two different ways of validating a file. At the moment the validator does not distinct between a Transtional and a Strict file, so how can I know if a Strict does not contain any Transitional features, it is not allowed to contain?\r\n\r\nI refer to this issue about discussion on Strict validation and a brief (I have not have found all, for instance it does not mention anything about namespaces) outlining of conformance differences as outlined in the OOXML standard: https://github.com/mikeebowen/ooxml-validator-vscode/issues/14\r\n\r\nTwo other places to find some (non-exhaustive) info:\r\n- [Transitional to Strict](https://github.com/Asbjoedt/CLISC/wiki/OOXML:-Transitional-to-Strict)\r\n- [Strict to Transitional](https://github.com/Asbjoedt/CLISC/wiki/OOXML:-Strict-to-Transitional)\r\n\r\n**Describe the solution you'd like**\r\nThe Open XML SDK validator method is this:\r\n```\r\nvar validator = new OpenXmlValidator();\r\nvar validation_errors = validator.Validate(filepath).ToList();\r\n```\r\n\r\nWhat we need is a parameter for method ```Validate()``` to specify which conformane should the document be validated against: ```transitional``` or ```strict``` and for this purpose can the ```ConformanceClass``` enum be used - [link to enum](https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.conformanceclass?view=openxml-2.8.1).\r\n\r\nThen it should report errors for Strict, which may not be errors for Transitional and vice versa. If no errors is reported, then the file is by logic valid, or you can create a bool or any other value to return determining succesful validation.\r\n\r\n**Describe alternatives you've considered**\r\nUnfortunately, I know of no other OOXML validators out there. I think it is crucial, that Microsoft fully supports the OOXML ISO standard, which means supporting Strict conformance. The life cycle of data begins with creation and ends with deletion or archiving. Right now this life cycle is not fully supported, because data quality for archiving means Strict conformance of OOXML.\r\n\r\n**Additional context**\r\nHere's my prototype repo for digital archiving of spreadsheets using Open XML SDK. You can find info on Strict conformance in the wiki: https://github.com/Asbjoedt/CLISC\r\n"},{"Id":"48548109789","Type":"IssuesEvent","CreatedAt":"2025-04-10T15:16:15","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1223","RelatedDescription":"Closed issue \"Support validation of conformance\" (#1223) at dotnet/Open-XML-SDK","RelatedBody":"**Is your feature request related to a problem? Please describe.**\r\nIn the following, I will be referring to code adopted in the context of spreadsheets and therefore not all code pieces may be reuseable for text or presentations.\r\n\r\nOpen XML SDK currently supports the two following means of identifying OOXML conformance (either Transitional or Strict).\r\n\r\nFirst, you have the class ```Conformance```, which is a property saved to ```workbook.xml``` based on the ```ConformanceClass``` enum. So you have to go to ```WorkbookPart.Workbook.Conformance``` to find this.\r\n\r\nSecond, you have ```StrictRelationshipFound```, which is a bool value you can fetch from root level. Here's the code in Open XML SDK:\r\n```\r\n/// <summary>\r\n/// Gets a value indicating whether this package contains Transitional relationships converted from Strict.\r\n /// </summary>\r\npublic bool StrictRelationshipFound { get; private set; }\r\n```\r\n\r\nThe question is whether these two ways of identifying conformance, actually checks for a VALID STRICT or VALID TRANSITIONAL OOXML file? With conformance class, it only fetches the property, meaning it does not check if any INVALID TRANSITIONAL features appear in the file. I don't know how StrictPropertyRelationship works, and judging from the summary, it only finds existing Transitional files, that have been converted to Strict conformance, but it does not identify Strict files created as Strict. However, when I test this on files, whether the file was Transitional has no relevance, it will find any Strict file. But how is this qualified, will it simply look for the conformance class value or will it also check for existence of X, Y, Z properties for instance many namespaces are different between the two conformance modes and these should be checked.\r\n\r\nI think it is OK, if both of the outlined means of identification simply check for conformance class value, but I don't think this is sufficient for validation of a VALID STRICT or VALID TRANSITIONAL file. All differences specified in the OOXML ISO standard should be separated into two different ways of validating a file. At the moment the validator does not distinct between a Transtional and a Strict file, so how can I know if a Strict does not contain any Transitional features, it is not allowed to contain?\r\n\r\nI refer to this issue about discussion on Strict validation and a brief (I have not have found all, for instance it does not mention anything about namespaces) outlining of conformance differences as outlined in the OOXML standard: https://github.com/mikeebowen/ooxml-validator-vscode/issues/14\r\n\r\nTwo other places to find some (non-exhaustive) info:\r\n- [Transitional to Strict](https://github.com/Asbjoedt/CLISC/wiki/OOXML:-Transitional-to-Strict)\r\n- [Strict to Transitional](https://github.com/Asbjoedt/CLISC/wiki/OOXML:-Strict-to-Transitional)\r\n\r\n**Describe the solution you'd like**\r\nThe Open XML SDK validator method is this:\r\n```\r\nvar validator = new OpenXmlValidator();\r\nvar validation_errors = validator.Validate(filepath).ToList();\r\n```\r\n\r\nWhat we need is a parameter for method ```Validate()``` to specify which conformane should the document be validated against: ```transitional``` or ```strict``` and for this purpose can the ```ConformanceClass``` enum be used - [link to enum](https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.conformanceclass?view=openxml-2.8.1).\r\n\r\nThen it should report errors for Strict, which may not be errors for Transitional and vice versa. If no errors is reported, then the file is by logic valid, or you can create a bool or any other value to return determining succesful validation.\r\n\r\n**Describe alternatives you've considered**\r\nUnfortunately, I know of no other OOXML validators out there. I think it is crucial, that Microsoft fully supports the OOXML ISO standard, which means supporting Strict conformance. The life cycle of data begins with creation and ends with deletion or archiving. Right now this life cycle is not fully supported, because data quality for archiving means Strict conformance of OOXML.\r\n\r\n**Additional context**\r\nHere's my prototype repo for digital archiving of spreadsheets using Open XML SDK. You can find info on Strict conformance in the wiki: https://github.com/Asbjoedt/CLISC\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-04-21T03:30:22.9952807Z","RunDurationInMilliseconds":580}