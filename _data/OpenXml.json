{"Data":{"Sdk":{"Events":[{"Id":"13789128538","Type":"IssuesEvent","CreatedAt":"2020-10-09T08:23:50","Actor":"sorensenmatias","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/812","RelatedDescription":"Opened issue \"Memory problems when modifying slide containing lots of elements\" (#812) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nI have a presentation with a lot of vector graphics on the slides. I want to inspect the SlidePart of each Slide using the Descendants method and modify some elements. This loads the entire DOM of the slide in memory, which ends spending gigabytes of memory. Memory profiling shows that each slide allocates something along the lines of 200000 objects in memory.\r\n\r\nIt seems that there is no way to avoid loading the entire DOM to memory? I have experimented with using the OpenXmlReader to read the desired elements from the SlidePart, modify them accordingly, and then write them back using the OpenXmlWriter. \r\nThis avoid loading the DOM of all elements, but it is hard to get it right because the elements returned by the OpenXmlReader are different instances and are therefore detached from the SlidePart and Slide.\r\nThis makes subsequent modifications of elements of the SlidePart difficult.\r\n\r\nI think it is needed to have a way to easily modify elements without exhausting a lot of memory.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Core 3.1\r\n- DocumentFormat.OpenXml Version: 2.11.3\r\n\r\n**Repro**\r\n\r\nCreate a presentation containing a slide with a lot of shapes with vector graphics and access the Slide property of the SlidePart. \r\n\r\n`     <p:sp>\r\n          <p:nvSpPr>\r\n            <p:cNvPr id=\"206\" name=\"Freeform 11\" />\r\n            <p:cNvSpPr>\r\n              <a:spLocks />\r\n            </p:cNvSpPr>\r\n            <p:nvPr />\r\n          </p:nvSpPr>\r\n          <p:spPr bwMode=\"auto\">\r\n            <a:xfrm>\r\n              <a:off x=\"7046\" y=\"2799\" />\r\n              <a:ext cx=\"6\" cy=\"21\" />\r\n            </a:xfrm>\r\n            <a:custGeom>\r\n              <a:avLst />\r\n              <a:gdLst>\r\n                <a:gd name=\"T0\" fmla=\"*/ 3 w 3\" />\r\n                <a:gd name=\"T1\" fmla=\"*/ 5 h 12\" />\r\n                <a:gd name=\"T2\" fmla=\"*/ 1 w 3\" />\r\n                <a:gd name=\"T3\" fmla=\"*/ 11 h 12\" />\r\n                <a:gd name=\"T4\" fmla=\"*/ 1 w 3\" />\r\n                <a:gd name=\"T5\" fmla=\"*/ 7 h 12\" />\r\n                <a:gd name=\"T6\" fmla=\"*/ 3 w 3\" />\r\n                <a:gd name=\"T7\" fmla=\"*/ 1 h 12\" />\r\n                <a:gd name=\"T8\" fmla=\"*/ 3 w 3\" />\r\n                <a:gd name=\"T9\" fmla=\"*/ 5 h 12\" />\r\n              </a:gdLst>\r\n              <a:ahLst />\r\n              <a:cxnLst>\r\n                <a:cxn ang=\"0\">\r\n                  <a:pos x=\"T0\" y=\"T1\" />\r\n                </a:cxn>\r\n                <a:cxn ang=\"0\">\r\n                  <a:pos x=\"T2\" y=\"T3\" />\r\n                </a:cxn>\r\n                <a:cxn ang=\"0\">\r\n                  <a:pos x=\"T4\" y=\"T5\" />\r\n                </a:cxn>\r\n                <a:cxn ang=\"0\">\r\n                  <a:pos x=\"T6\" y=\"T7\" />\r\n                </a:cxn>\r\n                <a:cxn ang=\"0\">\r\n                  <a:pos x=\"T8\" y=\"T9\" />\r\n                </a:cxn>\r\n              </a:cxnLst>\r\n              <a:rect l=\"0\" t=\"0\" r=\"r\" b=\"b\" />\r\n              <a:pathLst>\r\n                <a:path w=\"3\" h=\"12\">\r\n                  <a:moveTo>\r\n                    <a:pt x=\"3\" y=\"5\" />\r\n                  </a:moveTo>\r\n                  <a:cubicBezTo>\r\n                    <a:pt x=\"2\" y=\"8\" />\r\n                    <a:pt x=\"2\" y=\"11\" />\r\n                    <a:pt x=\"1\" y=\"11\" />\r\n                  </a:cubicBezTo>\r\n                  <a:cubicBezTo>\r\n                    <a:pt x=\"0\" y=\"12\" />\r\n                    <a:pt x=\"0\" y=\"10\" />\r\n                    <a:pt x=\"1\" y=\"7\" />\r\n                  </a:cubicBezTo>\r\n                  <a:cubicBezTo>\r\n                    <a:pt x=\"1\" y=\"4\" />\r\n                    <a:pt x=\"2\" y=\"1\" />\r\n                    <a:pt x=\"3\" y=\"1\" />\r\n                  </a:cubicBezTo>\r\n                  <a:cubicBezTo>\r\n                    <a:pt x=\"3\" y=\"0\" />\r\n                    <a:pt x=\"3\" y=\"2\" />\r\n                    <a:pt x=\"3\" y=\"5\" />\r\n                  </a:cubicBezTo>\r\n                  <a:close />\r\n                </a:path>\r\n              </a:pathLst>\r\n            </a:custGeom>\r\n            <a:grpFill />\r\n            <a:ln>\r\n              <a:noFill />\r\n            </a:ln>\r\n            <a:extLst>\r\n              <a:ext uri=\"{91240B29-F687-4F45-9708-019B960494DF}\">\r\n                <a14:hiddenLine xmlns:a14=\"http://schemas.microsoft.com/office/drawing/2010/main\" w=\"9525\">\r\n                  <a:solidFill>\r\n                    <a:srgbClr val=\"000000\" />\r\n                  </a:solidFill>\r\n                  <a:round />\r\n                  <a:headEnd />\r\n                  <a:tailEnd />\r\n                </a14:hiddenLine>\r\n              </a:ext>\r\n            </a:extLst>\r\n          </p:spPr>\r\n          <p:txBody>\r\n            <a:bodyPr vert=\"horz\" wrap=\"square\" lIns=\"91440\" tIns=\"0\" rIns=\"72000\" bIns=\"0\" numCol=\"1\" anchor=\"t\" anchorCtr=\"0\" compatLnSpc=\"1\">\r\n              <a:prstTxWarp prst=\"textNoShape\">\r\n                <a:avLst />\r\n              </a:prstTxWarp>\r\n            </a:bodyPr>\r\n            <a:lstStyle />\r\n            <a:p>\r\n              <a:endParaRPr lang=\"en-GB\">\r\n                <a:solidFill>\r\n                  <a:schemeClr val=\"tx2\" />\r\n                </a:solidFill>\r\n              </a:endParaRPr>\r\n            </a:p>\r\n          </p:txBody>\r\n        </p:sp>`\r\n\r\n**Observed**\r\n\r\nMemory exhaustion occours.\r\n\r\n**Expected**\r\n\r\nSome way to modify big presentations without loading everything to memory.\r\n"},{"Id":"13692661739","Type":"PullRequestEvent","CreatedAt":"2020-09-30T17:13:26","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/811","RelatedDescription":"Merged pull request \"Fix the typo in GetReferenceRelationship\" (#811) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13672701420","Type":"PullRequestEvent","CreatedAt":"2020-09-29T08:51:54","Actor":"lindexi","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/811","RelatedDescription":"Opened pull request \"Fix the typo in GetReferenceRelationship\" (#811) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"13644489057","Type":"IssuesEvent","CreatedAt":"2020-09-25T18:58:59","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/204","RelatedDescription":"Reopened issue \"Add SVG as ImagePartType for Office 2016 support\" (#204) at OfficeDev/Open-XML-SDK","RelatedBody":"Hi,\r\n\r\nOffice 2016 now (finally) supports svg as a vector image format (https://support.office.com/en-gb/article/Insert-SVG-images-in-Microsoft-Office-69f29d39-194a-4072-8c35-dbe5e7ea528c)\r\nAs far as I can see the OpenXml SDK does not currently have support for this yet (as ImagePartType for example).\r\nAre there any plans of adding it in the future, or any roadblocks that might inhibit implementing it?"}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-10-11T05:30:38.4268622Z","RunDurationInMilliseconds":756}