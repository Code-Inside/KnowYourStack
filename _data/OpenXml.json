{"Data":{"Sdk":{"Events":[{"Id":"12853129535","Type":"IssuesEvent","CreatedAt":"2020-07-08T21:58:21","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/734","RelatedDescription":"Reopened issue \"PEverify issues using 2.10.0+ NuGet versions of OpenXml\" (#734) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nOpenXML NuGet libraries with version 2.10.0 and upwards fail PEverify.\r\n\r\n**Information**\r\n\r\n- DocumentFormat.OpenXml Version: 2.10.0 and upwards\r\n- Microsoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\n\r\n**Repro**\r\n\r\nRun PEverify (available in Developer Command Prompt for VS, I'm using 2019 version) on DocumentFormat.OpenXML.dll\r\n\r\n**Observed**\r\n\r\n```\r\npeverify DocumentFormat.OpenXml.dll\r\n\r\nMicrosoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\nCopyright (c) Microsoft Corporation.  All rights reserved.\r\n\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::get_Length][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::GetIndex][offset 0x00000044] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ValidatorCollection::GetEnumerator][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::get_Current][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::MoveNext][offset 0x00000012] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Property][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Value][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::SetValue][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n8 Error(s) Verifying DocumentFormat.OpenXml.dll\r\n\r\n```\r\nWhile the library works fine in simple console applications / libraries, I found it will fail to work when ILmerged into MS CRM Sandbox (which is running on partial trust towards external DLLs), which is what led me to check the DLL using PEverify. Previous version (2.9.1 and earlier) don't have PEverify errors and their usage in MS CRM Sandbox doesn't cause issues.\r\n\r\n**Expected**\r\n\r\nPEverify should not show any errors. DLL should be usable after ILmerge in MS CRM Sandbox (partial trust env)."},{"Id":"12852869013","Type":"PullRequestEvent","CreatedAt":"2020-07-08T21:23:39","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/745","RelatedDescription":"Opened pull request \"Mark obsolete methods to not show up in intellisense\" (#745) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"12852840316","Type":"PullRequestEvent","CreatedAt":"2020-07-08T21:20:06","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/740","RelatedDescription":"Merged pull request \"Alter DeletePartCore to use TryGetPartById\" (#740) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #713, test included"},{"Id":"12852840279","Type":"IssuesEvent","CreatedAt":"2020-07-08T21:20:06","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/713","RelatedDescription":"Closed issue \"The OpenXmlPartContainer.DeletePart will throw exception when the id not found\" (#713) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nAs we can see the OpenXmlPartContainer.DeletePart can delete the part, but this API will throw ArgumentOutOfRangeException when the part with the specified id does not exist.\r\n\r\nBecause the `DeletePart` call the `DeletePartCore` which will call the `GetPartById` to get the part.\r\n\r\nhttps://github.com/OfficeDev/Open-XML-SDK/blob/0f1764a866e36d615e22d247e780fb7675046e9a/src/DocumentFormat.OpenXml/Packaging/OpenXmlPartContainer.cs#L1762\r\n\r\nBut the `GetPartById` will throw ArgumentOutOfRangeException when the part with the specified id does not exist.\r\n\r\nhttps://github.com/OfficeDev/Open-XML-SDK/blob/0f1764a866e36d615e22d247e780fb7675046e9a/src/DocumentFormat.OpenXml/Packaging/OpenXmlPartContainer.cs#L529-L547\r\n\r\nYes, it means that the branch will never enter when the id not found\r\n\r\nhttps://github.com/OfficeDev/Open-XML-SDK/blob/0f1764a866e36d615e22d247e780fb7675046e9a/src/DocumentFormat.OpenXml/Packaging/OpenXmlPartContainer.cs#L1764-L1768\r\n\r\n**Information**\r\n\r\n- .NET Target: All \r\n- DocumentFormat.OpenXml Version: 2.10.1\r\n\r\n**Repro**\r\n\r\n```csharp\r\npublic static void Delete(this string id, OpenXmlPart part)\r\n{\r\n     part.DeletePart(id);\r\n}\r\n``` \r\n\r\n**Observed**\r\n\r\nThe `part.DeletePart` will throw the exception when the part with the specified id does not exist.\r\n\r\n**Expected**\r\n\r\nAs the other API design, the delete method should not throw exception the element does not exist.\r\n"},{"Id":"12851826415","Type":"PullRequestEvent","CreatedAt":"2020-07-08T19:21:51","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/744","RelatedDescription":"Merged pull request \"Ensure .NET Framework builds pass PEVerify\" (#744) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #734 "},{"Id":"12851826365","Type":"IssuesEvent","CreatedAt":"2020-07-08T19:21:51","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/734","RelatedDescription":"Closed issue \"PEverify issues using 2.10.0+ NuGet versions of OpenXml\" (#734) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nOpenXML NuGet libraries with version 2.10.0 and upwards fail PEverify.\r\n\r\n**Information**\r\n\r\n- DocumentFormat.OpenXml Version: 2.10.0 and upwards\r\n- Microsoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\n\r\n**Repro**\r\n\r\nRun PEverify (available in Developer Command Prompt for VS, I'm using 2019 version) on DocumentFormat.OpenXML.dll\r\n\r\n**Observed**\r\n\r\n```\r\npeverify DocumentFormat.OpenXml.dll\r\n\r\nMicrosoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\nCopyright (c) Microsoft Corporation.  All rights reserved.\r\n\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::get_Length][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::GetIndex][offset 0x00000044] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ValidatorCollection::GetEnumerator][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::get_Current][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::MoveNext][offset 0x00000012] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Property][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Value][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::SetValue][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n8 Error(s) Verifying DocumentFormat.OpenXml.dll\r\n\r\n```\r\nWhile the library works fine in simple console applications / libraries, I found it will fail to work when ILmerged into MS CRM Sandbox (which is running on partial trust towards external DLLs), which is what led me to check the DLL using PEverify. Previous version (2.9.1 and earlier) don't have PEverify errors and their usage in MS CRM Sandbox doesn't cause issues.\r\n\r\n**Expected**\r\n\r\nPEverify should not show any errors. DLL should be usable after ILmerge in MS CRM Sandbox (partial trust env)."},{"Id":"12851573355","Type":"IssuesEvent","CreatedAt":"2020-07-08T18:53:05","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/701","RelatedDescription":"Reopened issue \"Support non-nullable annotations\" (#701) at OfficeDev/Open-XML-SDK","RelatedBody":"With C# 8.0 and .NET Standard 2.1 (and other supported platforms), APIs can be annotated with nullability information. This issue will track any work to enable this. So far, this would include:\r\n\r\n- [x] Enable C# 8.0 in the project (#698)\r\n- [ ] Enable .NET Standard 2.1\r\n- [ ] Enable nullable annotations in non-.NET Standard 2.1 targets (through some shim to provide attributes that can be stripped out at compile time)"},{"Id":"12851567968","Type":"IssuesEvent","CreatedAt":"2020-07-08T18:52:27","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/689","RelatedDescription":"Reopened issue \"OpenXmlValidator Throws Incorrect Validation Error for CategoryAxis\" (#689) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nWhen validating a `CategoryAxis` with an `AxisPosition` child the `OpenXmlValidator` creates a validation error even though the xml is valid according the office xml specification (CT_CatAx has a child EG_AxShared which has an element CT_AxPos on page 4080 of part I of the specification).\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Framework\r\n- DocumentFormat.OpenXml Version: 2.10\r\n\r\n**Repro**\r\n\r\n```csharp\r\nvar categoryAxis = new DocumentFormat.OpenXml.Drawing.Charts.CategoryAxis();\r\ncategoryAxis.AppendChild(new DocumentFormat.OpenXml.Drawing.Charts.AxisPosition() { Val = new EnumValue<DocumentFormat.OpenXml.Drawing.Charts.AxisPositionValues>(DocumentFormat.OpenXml.Drawing.Charts.AxisPositionValues.Bottom) });\r\n\r\nvar validator = new Validation.OpenXmlValidator();\r\nvar errors = validator.Validate(categoryAxis);\r\n``` \r\n\r\n**Observed**\r\n\r\nThe `errors` variable has a single entry with a description of `The element has unexpected child element 'http://schemas.openxmlformats.org/drawingml/2006/chart:axPos.'...`\r\n\r\n**Expected**\r\n\r\nAccording to `CT_CatAx` in part I of the specification (page 4080) there must be child elements `axId`, `scaling`, `axPos`, and `crossAx`. The sample above only has a `axPos` child so I would expect to see three validation errors due to the other three required elements being missing. I would not expect to see a validation error saying that `axPos` is not a valid child since the specification says that it is."},{"Id":"12851305341","Type":"PullRequestEvent","CreatedAt":"2020-07-08T18:22:22","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/742","RelatedDescription":"Merged pull request \"Remove unnecessary code\" (#742) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"12851292297","Type":"PullRequestEvent","CreatedAt":"2020-07-08T18:20:52","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/744","RelatedDescription":"Opened pull request \"Ensure .NET Framework builds pass PEVerify\" (#744) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-07-09T05:30:42.7247511Z","RunDurationInMilliseconds":981}