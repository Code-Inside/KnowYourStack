{"Data":{"Sdk":{"Events":[{"Id":"46899466640","Type":"IssuesEvent","CreatedAt":"2025-02-24T16:54:43","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1867","RelatedDescription":"Closed issue \"AcceptAllChanges word document Open XML SDK\" (#1867) at dotnet/Open-XML-SDK","RelatedBody":"It seems like you're trying to read and accept all changes in a Word document using C#. However, you're facing an issue where the MoveTo method is not properly cloning the data. Kindly help me.\n\nPlease find below a sample code for AcceptAll changes:\n\n```csharp\nprivate void AcceptAllChanges(string filePath)\n{\n    using (WordprocessingDocument doc = WordprocessingDocument.Open(filePath, true))\n    {\n        var body = doc.MainDocumentPart.Document.Body;\n\n        // Accept Inserted text (InsertedRun elements)\n        var insertedRuns = body.Descendants<InsertedRun>().ToList();\n        foreach (var insertedRun in insertedRuns)\n        {\n            var parent = insertedRun.Parent;\n            foreach (var child in insertedRun.ChildElements.ToList())\n            {\n                parent.InsertBefore(child.CloneNode(true), insertedRun);\n            }\n            insertedRun.Remove();\n        }\n\n        // Remove Deleted text (DeletedRun elements)\n        var deletedRuns = body.Descendants<DeletedRun>().ToList();\n        foreach (var deletedRun in deletedRuns)\n        {\n            deletedRun.Remove();\n        }\n\n        // Remove MoveFrom and MoveTo elements\n        var moveFromElements = body.Descendants<MoveFrom>().ToList();\n        var moveToElements = body.Descendants<MoveTo>().ToList();\n\n        foreach (var moveFrom in moveFromElements)\n        {\n            moveFrom.Remove();\n        }\n\n        //foreach (var moveTo in moveToElements)\n        //{\n        //    var parent = moveTo.Parent;\n        //    foreach (var child in moveTo.ChildElements.ToList())\n        //    {\n        //        parent.InsertBefore(child.CloneNode(true), moveTo);\n        //    }\n        //    moveTo.Remove();\n        //}\n        foreach (var moveTo in moveToElements)\n        {\n            // Iterate over the Run elements inside MoveTo\n            foreach (var run in moveTo.Elements<Run>())\n            {\n                // Now iterate over the Text elements inside each Run\n                foreach (var text in run.Elements<Text>())\n                {\n                    // Append the text content from MoveTo elements\n                    //sb.Append(text.Text);\n                    Console.WriteLine($\"Moved Insertion Text: {text.Text}\");  // For debugging\n                }\n            }\n\n            // Optional: If you want to move the content out of MoveTo and remove the MoveTo element\n            var parent = moveTo.Parent;\n            foreach (var run in moveTo.Elements<Run>())\n            {\n                foreach (var child in run.ChildElements)\n                {\n                    parent.InsertBefore(child.CloneNode(true), moveTo); // Insert content before the MoveTo element\n                }\n            }\n            moveTo.Remove(); // Remove the MoveTo element itself\n        }\n\n        // Remove other tracked changes (paragraph properties, table properties, etc.)\n        var pPrChanges = body.Descendants<ParagraphPropertiesChange>().ToList();\n        foreach (var pPrChange in pPrChanges)\n        {\n            pPrChange.Remove();\n        }\n\n        var tblPrChanges = body.Descendants<TablePropertiesChange>().ToList();\n        foreach (var tblPrChange in tblPrChanges)\n        {\n            tblPrChange.Remove();\n        }\n\n        // Save the changes\n        doc.MainDocumentPart.Document.Save();\n    }\n}\n```"},{"Id":"46899423948","Type":"IssuesEvent","CreatedAt":"2025-02-24T16:53:41","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1871","RelatedDescription":"Closed issue \"Please give name of missing package in exception \"Specified part does not exist in the package.\"\" (#1871) at dotnet/Open-XML-SDK","RelatedBody":"**Is your feature request related to a problem? Please describe.**\nI download a file from the internet (i.e. out of my control), the excel file is corrupt - I cannot open it with OpenXML neither with the OpenXML productivity tool, but in Excel it opens. Excel seems more fault tolerant btw.\n\n**Describe the solution you'd like**\nPlease give the name of the part that is missing in the exception message, this reduces the time greatly to find the issue.\nSpecified part '[NAMEOFPART]' does not exist in the package.\n\nStack Trace:\n```\nSystem.InvalidOperationException: Specified part does not exist in the package.\n   at System.IO.Packaging.Package.GetPart(Uri partUri)\n   at DocumentFormat.OpenXml.Features.PackageFeatureBase.DocumentFormat.OpenXml.Packaging.IPackage.GetPart(Uri uriTarget)\n   at DocumentFormat.OpenXml.Packaging.Builder.DelegatingPackageFeature.GetPart(Uri uriTarget)\n   at DocumentFormat.OpenXml.Packaging.PackageUriHandlingExtensions.MalformedUriHandlingPackage.GetPart(Uri uriTarget)\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPart.Load(OpenXmlPackage openXmlPackage, OpenXmlPart parent, Uri uriTarget, String id)\n   at DocumentFormat.OpenXml.Packaging.PartRelationshipsFeature.LoadReferencedPartsAndRelationships()\n   at DocumentFormat.OpenXml.Packaging.PartRelationshipsFeature.get_RelationshipMap()\n   at DocumentFormat.OpenXml.Packaging.PartRelationshipsFeature.DocumentFormat.OpenXml.Features.IPartRelationshipsFeature.get_Count()\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.LoadAllParts()\n   at DocumentFormat.OpenXml.Features.StrictNamespaceExtensions.StrictNamespaceFeature.DocumentFormat.OpenXml.Features.IStrictNamespaceFeature.get_Found()\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.get_StrictRelationshipFound()\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPart.LoadDomTree[T]()\n   at DocumentFormat.OpenXml.Packaging.SharedStringTablePart.get_SharedStringTable()\n\n```\n**Describe alternatives you've considered**\nLoad the file in excel, save it, extract it, compare files one by one and move one difference after each other and try to reopen it to find the issue.\n\n**Additional context**\nSame problem: https://stackoverflow.com/questions/11212374/specified-part-does-not-exist-in-the-package\n\nexample file: https://www.rba.gov.au/statistics/tables/xls/d03hist.xlsx?v=2025-02-08-17-05-12\nin this case, some invalid rel references to drawings which do not exist have to be removed, you get the idea:\nwarn: Excel removing invalid reference 'xl/drawings/drawing1.xml' from 'xl/worksheets/_rels/sheet1.xml.rels'\nwarn: Excel removing invalid reference 'xl/printerSettings/printerSettings1.bin' from 'xl/worksheets/_rels/sheet1.xml.rels'\nwarn: Excel removing invalid reference 'xl/drawings/vmlDrawing1.vml' from 'xl/worksheets/_rels/sheet1.xml.rels'\nwarn: Excel removing invalid reference 'xl/drawings/drawing2.xml' from 'xl/worksheets/_rels/sheet2.xml.rels'\nwarn: Excel removing invalid reference 'xl/printerSettings/printerSettings2.bin' from 'xl/worksheets/_rels/sheet2.xml.rels'\nwarn: Excel removing invalid reference 'xl/drawings/vmlDrawing2.vml' from 'xl/worksheets/_rels/sheet2.xml.rels'\nwarn: Excel removing invalid reference 'xl/drawings/drawing3.xml' from 'xl/worksheets/_rels/sheet3.xml.rels'\nwarn: Excel removing invalid reference 'xl/printerSettings/printerSettings3.bin' from 'xl/worksheets/_rels/sheet3.xml.rels'\nwarn: Excel removing invalid reference 'xl/drawings/vmlDrawing3.vml' from 'xl/worksheets/_rels/sheet3.xml.rels'\n"},{"Id":"46898474803","Type":"IssuesEvent","CreatedAt":"2025-02-24T16:30:15","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1740","RelatedDescription":"Closed issue \"Can't Add video or audio to premade presentation\" (#1740) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nCan't Add video or audio to premade presentations\n\n\n\n**To Reproduce**\nThis is my code, I load a PowerPoint presentation from disk and make text changes to the slide after I call these methods to add audio/video.\n```csharp\npublic void AddVideoToPresentation(PresentationDocument presentationDocument, string audioFilePath)\n{\n    int PicID = 915;\n    PresentationPart presentationPart = presentationDocument.PresentationPart;\n    var slideCount = presentationPart.Presentation.SlideIdList.Count();\n    var videoEmbedId = string.Format(\"audioId{0}{1}\", slideCount, PicID++);\n    var mediaEmbedId = string.Format(\"medId{0}{1}\", slideCount, PicID++);\n\n    SlidePart slidepart = presentationDocument.PresentationPart.SlideParts.LastOrDefault();\n\n    MediaDataPart mediaDataPart1 = presentationDocument.CreateMediaDataPart(\"audio/mp3\", \".mp3\");\n    System.IO.Stream mediaDataPart1Stream = File.OpenRead(audioFilePath);\n    mediaDataPart1.FeedData(mediaDataPart1Stream);\n    mediaDataPart1Stream.Close();\n\n    slidepart.AddAudioReferenceRelationship(mediaDataPart1, videoEmbedId);\n    slidepart.AddMediaReferenceRelationship(mediaDataPart1, mediaEmbedId);\n\n    slidepart.Slide.Save();\n\n    AddVid(presentationDocument);\n}\n\n\npublic void AddVid(PresentationDocument presentationDocument)\n{\n    PresentationPart presentationPart = presentationDocument.PresentationPart;\n    SlidePart slidepart = presentationDocument.PresentationPart.AddNewPart<SlidePart>(\"rxId3\");\n    MediaDataPart mediaDataPart1 = presentationDocument.CreateMediaDataPart(\"video/mp4\", \".mp4\");\n    System.IO.Stream mediaDataPart1Stream = System.IO.File.Open(@\"D:\\samplevideo.mp4\", System.IO.FileMode.Open);\n    mediaDataPart1.FeedData(mediaDataPart1Stream);\n    mediaDataPart1Stream.Close();\n\n    slidepart.AddMediaReferenceRelationship(mediaDataPart1, \"rxId2\");\n    slidepart.AddVideoReferenceRelationship(mediaDataPart1, \"rxId1\");\n}\n```\n\n**Observed behavior**\nNo Video or audio embedded in the presentation\n\n**Expected behavior**\nPlay audio after slide transition\n\n**Desktop (please complete the following information):** \n```csharp\n<Project Sdk=\"Microsoft.NET.Sdk\">\n\n  <PropertyGroup>\n    <OutputType>WinExe</OutputType>\n    <TargetFramework>net6.0-windows</TargetFramework>\n    <Nullable>enable</Nullable>\n    <UseWindowsForms>true</UseWindowsForms>\n    <ImplicitUsings>enable</ImplicitUsings>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include=\"DocumentFormat.OpenXml\" Version=\"2.20.0\" />\n    <PackageReference Include=\"Microsoft.Office.Interop.PowerPoint\" Version=\"15.0.4420.1018\" />\n    <PackageReference Include=\"Mscc.GenerativeAI\" Version=\"1.5.0\" />\n    <PackageReference Include=\"Newtonsoft.Json\" Version=\"13.0.3\" />\n    <PackageReference Include=\"OpenXmlPowerTools.NetCore\" Version=\"1.1.0\" />\n    <PackageReference Include=\"System.ServiceModel.Syndication\" Version=\"8.0.0\" />\n  </ItemGroup>\n\n  <ItemGroup>\n    <Reference Include=\"office\">\n      <HintPath>..\\..\\..\\..\\..\\Windows\\assembly\\GAC_MSIL\\office\\15.0.0.0__71e9bce111e9429c\\OFFICE.DLL</HintPath>\n    </Reference>\n  </ItemGroup>\n\n</Project>\n```\n\n"},{"Id":"46807446025","Type":"IssuesEvent","CreatedAt":"2025-02-21T07:11:48","Actor":"lindexi","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1874","RelatedDescription":"Opened issue \"Setting `PackageProperties.Title` with 0x0001 Unicode Characters in OpenXML Results in an Error\" (#1874) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nWhen attempting to configure the `PackageProperties.Title` attribute of a `PresentationDocument` within OpenXML, inserting a string containing the Unicode character `\\u0001` (often known as a soft hyphen) generates an `ArgumentException`. This occurs despite the presence of other valid properties.\n\n\n**Screenshots**\nNone.\n\n**To Reproduce**\n\nThe mini repro code is:\n\n```csharp\nusing System;\n\nusing (var presentationDocument =\n       DocumentFormat.OpenXml.Packaging.PresentationDocument.Open(\"Test.pptx\", true))\n{\n    presentationDocument.PackageProperties.Title = \"\\u0001\";\n}\n```\n\nThe `Test.pptx` is any normal pptx file.\n\nYou can find all my demo project in https://github.com/lindexi/lindexi_gd/tree/6baba8b5407c1d23119d3ac150b1ab5af4cd810c/Pptx/FukemqibairLaylalljerowhem\n\n\n**Observed behavior**\n\nRun my mini repro code, and you can find the exception:\n\n```\n System.ArgumentException:“'', hexadecimal value 0x01, is an invalid character.”\n  \t System.Private.Xml.dll!System.Xml.XmlUtf8RawTextWriter.InvalidXmlChar(int ch, byte* pDst, bool entitize)\t\n  \t System.Private.Xml.dll!System.Xml.XmlUtf8RawTextWriter.WriteElementTextBlock(char* pSrc, char* pSrcEnd)\t\n  \t System.Private.Xml.dll!System.Xml.XmlUtf8RawTextWriter.WriteString(string text)\t\n  \t System.Private.Xml.dll!System.Xml.XmlWellFormedWriter.WriteString(string text)\t\n  \t System.IO.Packaging.dll!System.IO.Packaging.PartBasedPackageProperties.SerializeDirtyProperties()\t\n  \t System.IO.Packaging.dll!System.IO.Packaging.PartBasedPackageProperties.Flush()\t\n  \t System.IO.Packaging.dll!System.IO.Packaging.PartBasedPackageProperties.Close()\t\n  \t System.IO.Packaging.dll!System.IO.Packaging.Package.System.IDisposable.Dispose()\t\n  \t System.IO.Packaging.dll!System.IO.Packaging.Package.Close()\t\n  \t DocumentFormat.OpenXml.Framework.dll!DocumentFormat.OpenXml.Features.StreamPackageFeature.Dispose(bool disposing)\t\n  \t DocumentFormat.OpenXml.Framework.dll!DocumentFormat.OpenXml.Features.StreamPackageFeature.Dispose()\t\n  \t DocumentFormat.OpenXml.Framework.dll!DocumentFormat.OpenXml.Packaging.PackageFeatureCollection.DocumentFormat.OpenXml.Features.IContainerDisposableFeature.Dispose()\t\n  \t DocumentFormat.OpenXml.Framework.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose(bool disposing)\t\n  \t DocumentFormat.OpenXml.Framework.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose()\t\n >\t FukemqibairLaylalljerowhem.dll!Program.<Main>$(string[] args)\n```\n\n**Expected behavior**\n\nWork well without exception.\n\n**Desktop (please complete the following information):**\n - .NET Target: .NET 9\n - DocumentFormat.OpenXml Version: 3.2.0\n\n**Additional context**\n\nThis error throw in dotnet runtime library: https://github.com/dotnet/runtime/blob/c1fe87ad88532f0e80de3739fe7b215e6e1f8b90/src/libraries/System.Private.Xml/src/System/Xml/Core/XmlUtf8RawTextWriter.cs#L932\n"},{"Id":"46421766575","Type":"PullRequestEvent","CreatedAt":"2025-02-10T19:37:10","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1854","RelatedDescription":"Closed pull request \"Bump danielpalme/ReportGenerator-GitHub-Action from 5.4.1 to 5.4.3\" (#1854) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [danielpalme/ReportGenerator-GitHub-Action](https://github.com/danielpalme/reportgenerator-github-action) from 5.4.1 to 5.4.3.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/danielpalme/reportgenerator-github-action/releases\">danielpalme/ReportGenerator-GitHub-Action's releases</a>.</em></p>\n<blockquote>\n<h2>5.4.3</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/717\">#717</a> Added new new coverage type &quot;Full method coverage&quot; (percentage of methods that are fully covered)</li>\n</ul>\n<h2>5.4.2</h2>\n<ul>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/700\">#700</a> Fixed handling of .netconfig files (sourceDirectories, reportTypes, plugins, assemblyFilters, etc.)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/716\">#716</a> Increased precision of percentages in CsvSummary and TextSummary reports (contributed by <a href=\"https://github.com/tomap\"><code>@​tomap</code></a>)</li>\n<li><a href=\"https://redirect.github.com/danielpalme/reportgenerator-github-action/issues/719\">#719</a> Fixed badges in MarkdownAssembliesSummary report</li>\n</ul>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/c38c522d4b391c1b0da979cbb2e902c0a252a7dc\"><code>c38c522</code></a> 5.4.3</li>\n<li><a href=\"https://github.com/danielpalme/ReportGenerator-GitHub-Action/commit/94ea1575fb6924d22f2639373a5c4d945fdbe178\"><code>94ea157</code></a> 5.4.2</li>\n<li>See full diff in <a href=\"https://github.com/danielpalme/reportgenerator-github-action/compare/5.4.1...5.4.3\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=danielpalme/ReportGenerator-GitHub-Action&package-manager=github_actions&previous-version=5.4.1&new-version=5.4.3)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-02-25T03:30:22.3382634Z","RunDurationInMilliseconds":745}