{"Data":{"Sdk":{"Events":[{"Id":"38144201486","Type":"IssuesEvent","CreatedAt":"2024-05-07T01:30:38","Actor":"HanJason","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1709","RelatedDescription":"Opened issue \"When opening a pptx file, it prompts that there is a problem with the content and needs to be repaired.\" (#1709) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nWhen opening a pptx file, it prompts that there is a problem with the content and needs to be repaired.\r\n\r\n**Screenshots**\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/3375750/7493e3e3-e4dc-437f-b3bf-faaa29f488ac)\r\n\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/3375750/bde6b769-484b-4e48-a750-758c121ede76)\r\n\r\n\r\n**To Reproduce**\r\n\r\nOnly insert a slide into the target file.\r\n\r\nSteps to reproduce the behavior:\r\nRun the program and open the output file\r\n\r\n**Observed behavior**\r\nPowerPoint found a problem with content in c:\\..\\bin\\Debug\\net6.0\\abc_copy.pptx.\r\nPowerPoint can attempt to repair the presentation.\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: [Windows]\r\n - .NET Target: ( .NET Core NET6.0)\r\n - DocumentFormat.OpenXml Version: (2.20.0)\r\n\r\n**Additional context**\r\n```C#\r\nusing DocumentFormat.OpenXml;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Presentation;\r\n\r\nvar pathfile = AppDomain.CurrentDomain.BaseDirectory + \"abc.pptx\";\r\nvar destinationFilePath = AppDomain.CurrentDomain.BaseDirectory + \"abc_copy.pptx\";\r\n\r\nusing (PresentationDocument sourcePresentation = PresentationDocument.Open(pathfile, false))\r\n{\r\n    using var mStream = new MemoryStream();\r\n    PresentationDocument destinationPresentation = PresentationDocument.Create(mStream, PresentationDocumentType.Presentation);\r\n\r\n    foreach (var part in sourcePresentation.Parts)\r\n    {\r\n        destinationPresentation.AddPart(part.OpenXmlPart, part.RelationshipId);\r\n    }\r\n\r\n    PresentationPart? presentationPart = destinationPresentation.PresentationPart;\r\n    if (presentationPart is not null && presentationPart.Presentation is not null)\r\n    {\r\n        Presentation presentation = presentationPart.Presentation;\r\n\r\n        if (presentation.SlideIdList is not null)\r\n        {\r\n            //presentation.SlideIdList.AppendChild(new SlideId() { Id = (uint)234533, RelationshipId = \"r_rid1\" });\r\n            List<string> titlesList = new List<string>();\r\n            var len = presentation.SlideIdList.Elements<SlideId>().Count();\r\n            var slideIdList = presentation.SlideIdList.Elements<SlideId>()?.ToList() ?? new List<SlideId>();\r\n            for (int i = 0; i < len; i++)\r\n            {\r\n                var slideId = slideIdList[i];\r\n                if (slideId.RelationshipId is null)\r\n                {\r\n                    continue;\r\n                }\r\n                SlidePart slidePart = (SlidePart)presentationPart.GetPartById(slideId.RelationshipId!);\r\n                if (slidePart is null)\r\n                {\r\n                    throw new ArgumentNullException(\"presentationDocument\");\r\n                }\r\n                //copy slide part \r\n                SlidePart newSlidePart = presentationPart.AddNewPart<SlidePart>();\r\n                newSlidePart.FeedData(slidePart.GetStream());\r\n                newSlidePart.AddPart(slidePart.SlideLayoutPart);\r\n\r\n                slideId.InsertAfterSelf<SlideId>(new SlideId() { RelationshipId = presentationPart.GetIdOfPart(newSlidePart) });\r\n            }\r\n        }\r\n    }\r\n    destinationPresentation.Save();\r\n    File.WriteAllBytes(destinationFilePath, mStream.ToArray());\r\n}\r\n```\r\n[abc.pptx](https://github.com/dotnet/Open-XML-SDK/files/15228287/abc.pptx)\r\n[abc_copy.pptx](https://github.com/dotnet/Open-XML-SDK/files/15228288/abc_copy.pptx)\r\n\r\n"},{"Id":"38135997235","Type":"PullRequestEvent","CreatedAt":"2024-05-06T18:51:50","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1708","RelatedDescription":"Opened pull request \"Feb 2024 Schema Update with obsolete extensions\" (#1708) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"37934616026","Type":"PullRequestEvent","CreatedAt":"2024-04-29T23:00:01","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1706","RelatedDescription":"Merged pull request \"Increase approvers to 2 for deployment.\" (#1706) at dotnet/Open-XML-SDK","RelatedBody":"This is to tighten security for nuget deployment."},{"Id":"37927111403","Type":"PullRequestEvent","CreatedAt":"2024-04-29T18:23:53","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1682","RelatedDescription":"Closed pull request \"Bump NuGet.Resolver from 6.8.0 to 6.9.1\" (#1682) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [NuGet.Resolver](https://github.com/NuGet/NuGet.Client) from 6.8.0 to 6.9.1.\n<details>\n<summary>Commits</summary>\n<ul>\n<li>See full diff in <a href=\"https://github.com/NuGet/NuGet.Client/commits\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=NuGet.Resolver&package-manager=nuget&previous-version=6.8.0&new-version=6.9.1)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nYou can trigger a rebase of this PR by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>\n\n> **Note**\n> Automatic rebases have been disabled on this pull request as it has been open for over 30 days."}],"ResultType":"GitHubEvent"}},"RunOn":"2024-05-07T03:30:19.9978865Z","RunDurationInMilliseconds":671}