{"Data":{"Sdk":{"Events":[{"Id":"12866649359","Type":"PullRequestEvent","CreatedAt":"2020-07-10T04:30:41","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/747","RelatedDescription":null,"RelatedBody":"Fixes #743 "},{"Id":"12866649157","Type":"PullRequestEvent","CreatedAt":"2020-07-10T04:30:38","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/747","RelatedDescription":"Closed pull request \"Use full name for SmartTagId and SmartId\" (#747) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #743 "},{"Id":"12866325708","Type":"PullRequestEvent","CreatedAt":"2020-07-10T03:21:26","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"reopened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/747","RelatedDescription":null,"RelatedBody":"Fixes #743 "},{"Id":"12866325521","Type":"PullRequestEvent","CreatedAt":"2020-07-10T03:21:24","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/747","RelatedDescription":"Closed pull request \"Use full name for SmartTagId and SmartId\" (#747) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #743 "},{"Id":"12866291160","Type":"PullRequestEvent","CreatedAt":"2020-07-10T03:14:35","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/747","RelatedDescription":"Opened pull request \"Use full name for SmartTagId and SmartId\" (#747) at OfficeDev/Open-XML-SDK","RelatedBody":"Fixes #743 "},{"Id":"12865445443","Type":"PullRequestEvent","CreatedAt":"2020-07-10T00:20:13","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/746","RelatedDescription":"Merged pull request \"Skip attribute required semantic check if the required attribute exists\" (#746) at OfficeDev/Open-XML-SDK","RelatedBody":"The semantic constraint `AttributeRequiredConditionToValue` does not need to be checked if the required value exists. This was causing incorrect semantic validation of the form `Semantic Error : Attribute 'si' should be present when the value of attribute 't' is 'shared'`. Now, if the required value exists, the constraint is exited without looking further as there is no way it could fail.\r\n\r\nFixes #735 "},{"Id":"12865445422","Type":"IssuesEvent","CreatedAt":"2020-07-10T00:20:13","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/735","RelatedDescription":"Closed issue \"Semantic Error : Attribute 'si' should be present when the value of attribute 't' is 'shared'.\" (#735) at OfficeDev/Open-XML-SDK","RelatedBody":"Is this a:\r\n- [X] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nSemantic Error : Attribute 'si' should be present when the value of attribute 't' is 'shared'.  On 2 separate valid Office 365 Excel documents.\r\n\r\n**Information**\r\n\r\n- .NET Target: NET 4.6.2\r\n- DocumentFormat.OpenXml Version: 2.11.0\r\n\r\n**Repro**\r\n\r\n``` csharp\r\nclass Program\r\n    {\r\n        static void Main(string[] args)\r\n        {\r\n            OpenXmlPackage spreadsheetDocument1 = SpreadsheetDocument.Open(\"DiversenBerekeningen.xlsm\", false);\r\n            List<ValidationErrorInfo> errorInfos1 = ValidateDocument(spreadsheetDocument1);\r\n\r\n            foreach (ValidationErrorInfo info in errorInfos1)\r\n            {\r\n                Console.WriteLine(string.Format(\"DiversenBerekeningen.xlsm Error Occurred {0}\", info.Description)); \r\n            }\r\n\r\n            OpenXmlPackage spreadsheetDocument2 = SpreadsheetDocument.Open(\"DiversenGrafiekenPeltier.xlsm\", false);\r\n            List<ValidationErrorInfo> errorInfos2 = ValidateDocument(spreadsheetDocument2);\r\n\r\n            foreach (ValidationErrorInfo info in errorInfos2)\r\n            {\r\n                Console.WriteLine(string.Format(\"DiversenGrafiekenPeltier.xlsm Validaton Error Occurred {0}\", info.Description));\r\n            }\r\n\r\n            Console.ReadKey();\r\n        }\r\n\r\n        static List<ValidationErrorInfo> ValidateDocument(OpenXmlPackage package)\r\n        {\r\n            OpenXmlValidator validator = new OpenXmlValidator(FileFormatVersions.Office2019);\r\n            List<ValidationErrorInfo> validationErrors = validator.Validate(package).ToList();\r\n\r\n            return validationErrors;\r\n        }\r\n    }\r\n```\r\n\r\n**Observed**\r\n\r\nThe following validation error was reported on both files.\r\n\r\nSemantic Error : Attribute 'si' should be present when the value of attribute 't' is 'shared'\r\n\r\n**Expected**\r\n\r\nBoth files should have been validated successfully without errors.\r\n\r\n[Invalid Files.zip](https://github.com/OfficeDev/Open-XML-SDK/files/4730346/Invalid.Files.zip)\r\n"},{"Id":"12864853788","Type":"PullRequestEvent","CreatedAt":"2020-07-09T22:32:19","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/746","RelatedDescription":"Opened pull request \"Skip attribute required semantic check if the required attribute exists\" (#746) at OfficeDev/Open-XML-SDK","RelatedBody":"The semantic constraint `AttributeRequiredConditionToValue` does not need to be checked if the required value exists. This was causing incorrect semantic validation of the form `Semantic Error : Attribute 'si' should be present when the value of attribute 't' is 'shared'`. Now, if the required value exists, the constraint is exited without looking further as there is no way it could fail.\r\n\r\nFixes #735 "},{"Id":"12862602015","Type":"IssuesEvent","CreatedAt":"2020-07-09T17:51:13","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/734","RelatedDescription":"Closed issue \"PEverify issues using 2.10.0+ NuGet versions of OpenXml\" (#734) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nOpenXML NuGet libraries with version 2.10.0 and upwards fail PEverify.\r\n\r\n**Information**\r\n\r\n- DocumentFormat.OpenXml Version: 2.10.0 and upwards\r\n- Microsoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\n\r\n**Repro**\r\n\r\nRun PEverify (available in Developer Command Prompt for VS, I'm using 2019 version) on DocumentFormat.OpenXML.dll\r\n\r\n**Observed**\r\n\r\n```\r\npeverify DocumentFormat.OpenXml.dll\r\n\r\nMicrosoft (R) .NET Framework PE Verifier.  Version  4.0.30319.0\r\nCopyright (c) Microsoft Corporation.  All rights reserved.\r\n\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::get_Length][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1[T]::GetIndex][offset 0x00000044] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ValidatorCollection::GetEnumerator][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::get_Current][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+Enumerator[T]::MoveNext][offset 0x00000012] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Property][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::get_Value][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n[IL]: Error: [C:\\Project\\bin\\Debug\\DocumentFormat.OpenXml.dll : DocumentFormat.OpenXml.Framework.ElementPropertyCollection`1+PropertyEntry[T]::SetValue][offset 0x00000001] Cannot change initonly field outside its .ctor.\r\n8 Error(s) Verifying DocumentFormat.OpenXml.dll\r\n\r\n```\r\nWhile the library works fine in simple console applications / libraries, I found it will fail to work when ILmerged into MS CRM Sandbox (which is running on partial trust towards external DLLs), which is what led me to check the DLL using PEverify. Previous version (2.9.1 and earlier) don't have PEverify errors and their usage in MS CRM Sandbox doesn't cause issues.\r\n\r\n**Expected**\r\n\r\nPEverify should not show any errors. DLL should be usable after ILmerge in MS CRM Sandbox (partial trust env)."}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2020-07-10T05:30:44.3203171Z","RunDurationInMilliseconds":863}