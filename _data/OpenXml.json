{"Data":{"Sdk":{"Events":[{"Id":"41218396757","Type":"PullRequestEvent","CreatedAt":"2024-08-21T15:53:28","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1774","RelatedDescription":"Opened pull request \"Add open xml editor extension for Visual Studio Project\" (#1774) at dotnet/Open-XML-SDK","RelatedBody":"This moves the archived repo for the Open Xml Editor extension for Visual Studio from [Open-XML-Package-Editor-Power-Tool-for-Visual-Studio](https://github.com/OfficeDev/Open-XML-Package-Editor-Power-Tool-for-Visual-Studio) to the Open-XML-SDK repo."},{"Id":"41186089232","Type":"IssuesEvent","CreatedAt":"2024-08-20T18:41:22","Actor":"AlfredHellstern","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/807","RelatedDescription":"Closed issue \"Large parts cannot be written on .NET Core due to OutOfMemoryException\" (#807) at dotnet/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nI was using ClosedXML to create large excel files (100k rows with 63 colums) and I faced issue with OutOfMemoryException. I found some examples of OpenXML using SAX, so I tried to switch to OpenXML, but it didn't help me. I tried to remove all my code (reading from DB, etc.) to try if that works, but I still get OutOfMemoryException.\r\n\r\nMy code is based on [http://polymathprogrammer.com/2012/08/06/how-to-properly-use-openxmlwriter-to-write-large-excel-files/](url)\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Core 3.1\r\n- DocumentFormat.OpenXml Version: 2.11.3\r\n\r\n**EDIT:** Same code is working fine in .NET Framework 4.7.2 with same DocumentFormat.OpenXml version.\r\n\r\n**Repro**\r\nThis is simple code that I use at the moment. I am testing with RAM limited to 500 MB (testing purpose). I don't think that this code can consume so much RAM.\r\n\r\n```csharp\r\nusing (SpreadsheetDocument document = SpreadsheetDocument.Create(filePath, SpreadsheetDocumentType.Workbook))\r\n{\r\n    document.AddWorkbookPart();\r\n\r\n    WorksheetPart wsp = document.WorkbookPart.AddNewPart<WorksheetPart>();\r\n\r\n    using (OpenXmlWriter writer = OpenXmlWriter.Create(wsp))\r\n    {\r\n        List<OpenXmlAttribute> oxa;\r\n        writer.WriteStartElement(new Worksheet());\r\n        writer.WriteStartElement(new SheetData());\r\n\r\n        for (int i = 0; i < 100000; i++)\r\n        {\r\n            oxa = new List<OpenXmlAttribute>();\r\n            oxa.Add(new OpenXmlAttribute(\"r\", null, i.ToString()));\r\n            writer.WriteStartElement(new Row(), oxa);\r\n\r\n            for (int j = 0; j < 40; j++)\r\n            {\r\n                oxa = new List<OpenXmlAttribute>();\r\n                oxa.Add(new OpenXmlAttribute(\"t\", null, \"str\"));\r\n                writer.WriteStartElement(new Cell(), oxa);\r\n                writer.WriteElement(new CellValue(\"test\"));\r\n                writer.WriteEndElement();\r\n            }\r\n\r\n            writer.WriteEndElement();\r\n        }\r\n\r\n        writer.WriteEndElement(); // end of sheetdata\r\n        writer.WriteEndElement(); //end of worksheet\r\n    }\r\n\r\n    using (OpenXmlWriter writer = OpenXmlWriter.Create(document.WorkbookPart))\r\n    {\r\n        writer.WriteStartElement(new Workbook());\r\n        writer.WriteStartElement(new Sheets());\r\n\r\n        writer.WriteElement(new Sheet() { Id = document.WorkbookPart.GetIdOfPart(wsp), SheetId = 1, Name = \"Test\" });\r\n\r\n        writer.WriteEndElement();\r\n        writer.WriteEndElement();\r\n    }\r\n}\r\n``` \r\n\r\n**Observed**\r\n\r\n```\r\nSystem.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.\r\n   at System.IO.MemoryStream.set_Capacity(Int32 value)\r\n   at System.IO.MemoryStream.EnsureCapacity(Int32 value)\r\n   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)\r\n   at System.Xml.XmlUtf8RawTextWriter.FlushBuffer()\r\n   at System.Xml.XmlUtf8RawTextWriter.RawText(Char* pSrcBegin, Char* pSrcEnd)\r\n   at System.Xml.XmlUtf8RawTextWriter.RawText(String s)\r\n   at System.Xml.XmlUtf8RawTextWriter.WriteEndElement(String prefix, String localName, String ns)\r\n   at System.Xml.XmlWellFormedWriter.WriteEndElement()\r\n   at DocumentFormat.OpenXml.OpenXmlPartWriter.WriteEndElement()\r\n````\r\n\r\n**Expected**\r\n\r\nExcel file in filePath with 100k rows and 40 columns with string \"test\" in all cells.\r\n"},{"Id":"41165607734","Type":"PullRequestEvent","CreatedAt":"2024-08-20T08:20:57","Actor":"waydalee","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1773","RelatedDescription":"Opened pull request \"优化路径为NULL的资源判断\" (#1773) at dotnet/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2024-08-24T03:30:20.1350266Z","RunDurationInMilliseconds":610}