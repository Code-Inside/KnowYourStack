{"Data":{"Sdk":{"Events":[{"Id":"24532174667","Type":"IssuesEvent","CreatedAt":"2022-10-11T17:23:43","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1214","RelatedDescription":"Closed issue \"EMF file stream does not convert properly\" (#1214) at OfficeDev/Open-XML-SDK","RelatedBody":"I have a word document that has an EMF image file in it. I have to read that image file and save it in the system. Following is the code that I am using:\r\n\r\n```csharp\r\n  var lstImages = selectedImage.Descendants < DocumentFormat.OpenXml.Drawing.Pictures.Picture > ();\r\n\r\n  if (lstImages != null && lstImages.Any())\r\n  {\r\n    foreach(var image in lstImages)\r\n   {\r\n      string imageFileName = image.NonVisualPictureProperties?.NonVisualDrawingProperties?.Name;\r\n      string blip = image.BlipFill.Blip.Embed.Value;\r\n      ImagePart img = (ImagePart) wordDoc.MainDocumentPart.GetPartById(blip);\r\n      GetExtension(ref fileName, imageFileName, img);\r\n      string binaryDateTime = _dateTimeHelper.GetDateTimeUtcNow().ToBinary().ToString();\r\n\r\n      var stream = img.GetStream();\r\n      var byteStream = new byte[stream.Length];\r\n      int length = (int) stream.Length;\r\n      stream.Read(byteStream, 0, length);\r\n      stream.Dispose();\r\n      var uploadPath = \"D://ImageFile//\"\r\n\r\n      if (!_directoryManager.Exists(uploadPath)) {\r\n        _directoryManager.CreateDirectory(uploadPath);\r\n      }\r\n\r\n      fileName = string.Concat(binaryDateTime, \"_\", fileName);\r\n\r\n      string completePath = string.Concat(uploadPath, fileName);\r\n\r\n      using(var fileStream = new FileStream(completePath, FileMode.OpenOrCreate)) {\r\n\r\n        // Write bytestream to disk\r\n        fileStream.Write(byteStream, 0, length);\r\n        fileStream.Close();\r\n      }\r\n    }\r\n  }\r\n```\r\nThe saved file when being open says the file is damaged. Can you guide what is it that I am doing wrong or is there an easier way to save or convert EMF file as png?"},{"Id":"24530191506","Type":"PullRequestEvent","CreatedAt":"2022-10-11T15:49:35","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1215","RelatedDescription":"Opened pull request \"Add RichData sample and fix casing for rdRichValueWebImage\" (#1215) at OfficeDev/Open-XML-SDK","RelatedBody":"- Fixes incorrect casing for rdRichValueWebImage part TargetName and TargetPath\r\n- Adds sample for adding RichData to a spreadsheet"},{"Id":"24517446079","Type":"IssuesEvent","CreatedAt":"2022-10-11T06:48:43","Actor":"SanaWaseem","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1214","RelatedDescription":"Opened issue \"EMF file stream does not convert properly\" (#1214) at OfficeDev/Open-XML-SDK","RelatedBody":"I have a word document that has an EMF image file in it. I have to read that image file and save it in the system. Following is the code that I am using:\r\n\r\n```\r\n  var lstImages = selectedImage.Descendants < DocumentFormat.OpenXml.Drawing.Pictures.Picture > ();\r\n\r\n  if (lstImages != null && lstImages.Any())\r\n  {\r\n    foreach(var image in lstImages)\r\n   {\r\n      string imageFileName = image.NonVisualPictureProperties?.NonVisualDrawingProperties?.Name;\r\n      string blip = image.BlipFill.Blip.Embed.Value;\r\n      ImagePart img = (ImagePart) wordDoc.MainDocumentPart.GetPartById(blip);\r\n      GetExtension(ref fileName, imageFileName, img);\r\n      string binaryDateTime = _dateTimeHelper.GetDateTimeUtcNow().ToBinary().ToString();\r\n\r\n      var stream = img.GetStream();\r\n      var byteStream = new byte[stream.Length];\r\n      int length = (int) stream.Length;\r\n      stream.Read(byteStream, 0, length);\r\n      stream.Dispose();\r\n      var uploadPath = \"D://ImageFile//\"\r\n\r\n      if (!_directoryManager.Exists(uploadPath)) {\r\n        _directoryManager.CreateDirectory(uploadPath);\r\n      }\r\n\r\n      fileName = string.Concat(binaryDateTime, \"_\", fileName);\r\n\r\n      string completePath = string.Concat(uploadPath, fileName);\r\n\r\n      using(var fileStream = new FileStream(completePath, FileMode.OpenOrCreate)) {\r\n\r\n        // Write bytestream to disk\r\n        fileStream.Write(byteStream, 0, length);\r\n        fileStream.Close();\r\n      }\r\n    }\r\n  }\r\n```\r\nThe saved file when being open says the file is damaged. Can you guide what is it that I am doing wrong or is there an easier way to save or convert EMF file as png?"}],"ResultType":"GitHubEvent"}},"RunOn":"2022-10-15T03:30:25.6182167Z","RunDurationInMilliseconds":617}