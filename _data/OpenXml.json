{"Data":{"Sdk":{"Events":[{"Id":"32342304581","Type":"IssuesEvent","CreatedAt":"2023-10-05T13:42:47","Actor":"tauheedul","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1532","RelatedDescription":"Opened issue \"Feature request for Open XML SDK - Exclude unsupported XML characters during file generation\" (#1532) at dotnet/Open-XML-SDK","RelatedBody":"I have encountered an scenario where a user has entered data into the database which included control characters (most likely from a 3rd party system).\r\n\r\nSubequently when attempting to export the data to an OpenXML spreadsheet directly from the database e.g. creating a spreadsheet using a DataTable with no pre-processing, the Open XML plugin fails because of the invalid hex characters detected.\r\n\r\n**Suggested solution**\r\nUpon saving a datatable and while parsing each column value, detect Invalid Xml Characters and exclude them from the output file or transform them to an XML equivalent character where possible.\r\n\r\n**The workaround**\r\nThe workaround for us is to find every field at source and exclude invalid characters being added to the database, but this isn't feasable for a large system.\r\n\r\nThe other solution is to map the data table manually parse every column while mapping the columns and exclude special characters there, but that adds additional overhead for large datasets because the table will be iterated again when OpenXML opens the dataset.\r\n\r\n**Example error**\r\n\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/9335220/77930566-bd6d-4511-aa47-aae3418bb631)\r\n\r\n- Exception message\r\n\r\n'', hexadecimal value 0x02, is an invalid character.\r\n\r\n- Exception stacktrace\r\n\r\n   at System.Xml.XmlUtf8RawTextWriter.InvalidXmlChar(Int32 ch, Byte* pDst, Boolean entitize)\r\n   at System.Xml.XmlUtf8RawTextWriter.WriteElementTextBlock(Char* pSrc, Char* pSrcEnd)\r\n   at System.Xml.XmlUtf8RawTextWriter.WriteString(String text)\r\n   at System.Xml.XmlWellFormedWriter.WriteString(String text)\r\n   at DocumentFormat.OpenXml.OpenXmlLeafTextElement.WriteContentTo(XmlWriter w)\r\n   at DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\n   at DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\n   at DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\n   at DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\n   at DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\n   at DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\n   at DocumentFormat.OpenXml.OpenXmlElement.WriteTo(XmlWriter xmlWriter)\r\n   at DocumentFormat.OpenXml.OpenXmlCompositeElement.WriteContentTo(XmlWriter w)\r\n   at DocumentFormat.OpenXml.OpenXmlPartRootElement.WriteTo(XmlWriter xmlWriter)\r\n   at DocumentFormat.OpenXml.OpenXmlPartRootElement.Save(Stream stream)\r\n   at DocumentFormat.OpenXml.OpenXmlPartRootElement.SaveToPart(OpenXmlPart openXmlPart)\r\n   at DocumentFormat.OpenXml.OpenXmlPartRootElement.Save()\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.TrySavePartContent(OpenXmlPart part)\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.SavePartContents(Boolean save)\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose(Boolean disposing)\r\n   at DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Dispose()\r\n   at TestOpenXmlSpreadsheet.Helper.ExportToExcelDownload(DataSet dataSet) in C:\\Users\\user\\Source\\repos\\TestOpenXmlSpreadsheet\\TestOpenXmlSpreadsheet\\Form1.cs:line 118\r\n   at TestOpenXmlSpreadsheet.Form1.btnTest_Click(Object sender, EventArgs e) in C:\\Users\\user\\Source\\repos\\TestOpenXmlSpreadsheet\\TestOpenXmlSpreadsheet\\Form1.cs:line 39\r\n   at System.Windows.Forms.Control.OnClick(EventArgs e)\r\n   at System.Windows.Forms.Button.OnClick(EventArgs e)\r\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\r\n   at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)\r\n   at System.Windows.Forms.Control.WndProc(Message& m)\r\n   at System.Windows.Forms.ButtonBase.WndProc(Message& m)\r\n   at System.Windows.Forms.Button.WndProc(Message& m)\r\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)\r\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, WM msg, IntPtr wparam, IntPtr lparam)\r\n"},{"Id":"32324764464","Type":"PullRequestEvent","CreatedAt":"2023-10-04T23:16:34","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1531","RelatedDescription":"Merged pull request \"August 2023 Microsoft 365 update\" (#1531) at dotnet/Open-XML-SDK","RelatedBody":"### Added\r\n\r\n- `DocumentFormat.OpenXml.Office.PowerPoint.Y2023.M02.Main` namespace\r\n- `DocumentFormat.OpenXml.Office.PowerPoint.Y2022.M03.Main` namespace\r\n- `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2021.ExtLinks2021` namespace\r\n\r\n### Breaking Changes\r\n\r\n- `Model3D` now represents the modified xml element tag name `am3d.model3d` (Previously `am3d.model3D`)\r\n- Removed `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2022.PivotRichData.PivotCacheHasRichValuePivotCacheRichInfo`\r\n- Removed `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2022.PivotRichData.`"},{"Id":"32210961793","Type":"PullRequestEvent","CreatedAt":"2023-09-29T20:01:01","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1531","RelatedDescription":"Opened pull request \"August 2023 Microsoft 365 update\" (#1531) at dotnet/Open-XML-SDK","RelatedBody":"### Added\r\n\r\n- `DocumentFormat.OpenXml.Office.PowerPoint.Y2023.M02.Main` namespace\r\n- `DocumentFormat.OpenXml.Office.PowerPoint.Y2022.M03.Main` namespace\r\n- `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2021.ExtLinks2021` namespace\r\n\r\n### Breaking Changes\r\n\r\n- `Model3D` now represents the modified xml element tag name `am3d.model3d` (Previously `am3d.model3D`)\r\n- Removed `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2022.PivotRichData.PivotCacheHasRichValuePivotCacheRichInfo`\r\n- Removed `DocumentFormat.OpenXml.Office.SpreadSheetML.Y2022.PivotRichData."},{"Id":"32150106016","Type":"IssuesEvent","CreatedAt":"2023-09-27T16:58:12","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1520","RelatedDescription":"Closed issue \"Open XML SDK v3: struct IdPartPair\" (#1520) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nIt would be nice to mention all v3-breaking changes in the release notes clearly.\r\n\r\n**Screenshots**\r\nBug with the fix.\r\n![image](https://github.com/dotnet/Open-XML-SDK/assets/1197905/d00a99ed-b473-45c0-9781-635d8d883864)\r\n\r\n**To Reproduce**\r\n`IdPartPait` has been converted from class to struct in v3 (most likely for performance reasons).\r\n\r\nThis change silently broke code that worked fine before and checked the value with `null`.\r\nAfter the upgrade, the code compile without errors, but some branches became unreachable and app/library no longer works as expected.\r\n\r\n**Observed behavior**\r\nNo release notes yet ;)\r\n\r\n**Expected behavior**\r\nMention such cases inside the Breaking Changes section in released notes.\r\n\r\n**Additional context**\r\nI believe that it will be helpful for apps and library authors who decide to migrate to v3.\r\nFound [during migrating](https://github.com/sergey-tihon/Clippit/pull/63) my fork of PowerTools to SDK v3"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-10-09T03:30:24.3082556Z","RunDurationInMilliseconds":678}