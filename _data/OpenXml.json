{"Data":{"Sdk":{"Events":[{"Id":"23995522324","Type":"IssuesEvent","CreatedAt":"2022-09-14T07:12:27","Actor":"lindexi","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1205","RelatedDescription":"Opened issue \"Throw OpenXmlPackageException A shared part is referenced by multiple source parts with a different relationship type\" (#1205) at OfficeDev/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThe OpenXML SDK will throw OpenXmlPackageException when open the special pptx file.\r\n\r\n```\r\nDocumentFormat.OpenXml.Packaging.OpenXmlPackageException: 'A shared part is referenced by multiple source parts with a different relationship type.'\r\n```\r\n\r\nAnd this pptx file can open well with Office PowerPoint.\r\n\r\n---\r\n\r\nWhy the OpenXML SDK throw OpenXmlPackageException ?\r\n\r\nBecause the Relationship define the same part with a different relationship type. Such the test file in my repo, and the content in `slide1.xml.rels` is:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\r\n  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout\" Target=\"../slideLayouts/slideLayout1.xml\" />\r\n  <Relationship Id=\"rId5\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\" Target=\"NULL\" TargetMode=\"External\" />\r\n  <Relationship Id=\"rId21\" Type=\"http://schemas.microsoft.com/office/2006/relationships/recovered\" Target=\"../media/media1.mp3\" />\r\n  <Relationship Id=\"rId19\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"../media/media1.mp3\" />\r\n  <Relationship Id=\"rId20\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image1.png\" />\r\n</Relationships>\r\n```\r\n\r\nAnd you can find the Type of `media1.mp3` is `http://schemas.microsoft.com/office/2006/relationships/recovered` and `http://schemas.microsoft.com/office/2007/relationships/media`\r\n\r\n**Screenshots**\r\n![](https://user-images.githubusercontent.com/16054566/190082500-386c2389-08da-4675-8427-85c0c5ab9eed.png)\r\n\r\n\r\n**To Reproduce**\r\n\r\nMy test code: https://github.com/lindexi/lindexi_gd/tree/d50ffc8321cbe33c50752557684581f1b1dc78f8/WhulaylurnurCearkolaifonerebairkur\r\n\r\n1. Download my code from: https://github.com/lindexi/lindexi_gd/tree/d50ffc8321cbe33c50752557684581f1b1dc78f8/WhulaylurnurCearkolaifonerebairkur\r\n2. Run the code\r\n3. See error\r\n\r\n**Observed behavior**\r\n\r\nThrow the OpenXmlPackageException.\r\n\r\n```\r\nDocumentFormat.OpenXml.Packaging.OpenXmlPackageException: 'A shared part is referenced by multiple source parts with a different relationship type.'\r\n```\r\n\r\nCall stack:\r\n\r\n```\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Load(System.IO.Packaging.Package package)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.PresentationDocument.Open(string path, bool isEditable, DocumentFormat.OpenXml.Packaging.OpenSettings openSettings)\tUnknown\r\n>\t[Exception] WhulaylurnurCearkolaifonerebairkur.dll!Program.<Main>$(string[] args) Line 3\tC#\r\n \tDocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Load(System.IO.Packaging.Package package)\tUnknown\r\n \tDocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.PresentationDocument.Open(string path, bool isEditable, DocumentFormat.OpenXml.Packaging.OpenSettings openSettings)\tUnknown\r\n \tWhulaylurnurCearkolaifonerebairkur.dll!Program.<Main>$(string[] args) Line 3\tC#\r\n```\r\n\r\n**Expected behavior**\r\nThe OpenXML SDK can open the document. And I think we should handle the `http://schemas.microsoft.com/office/2006/relationships/recovered` type.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 21H2 19044\r\n - Office version None.\r\n - .NET Target: dotnet 6.0.9\r\n - DocumentFormat.OpenXml Version: 2.18.0\r\n\r\n\r\n"},{"Id":"23920818641","Type":"IssuesEvent","CreatedAt":"2022-09-09T16:41:13","Actor":"tomjebo","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1141","RelatedDescription":"Closed issue \"An exception occurred while getting the layoutid attribute of the series instance in the chart\" (#1141) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- DocumentFormat.OpenXml.Office2016.Drawing.ChartDrawing\r\n- [x] Question on library usage\r\n![image](https://user-images.githubusercontent.com/53579403/162919221-7813e8db-3f00-4756-88e8-209fe269c5db.png)\r\n\r\n**Description**\r\nI'm try get the enumeration value from LayoutId attribute of the chart，but an exception is thrown here。\r\nBecause of  the 'funnel' is not a available enumeration value in the SeriesLayout type.\r\n\r\n**Information**\r\nthe exception code is shown below\r\n```c#\r\n            var series = CharSpace.Chart?.PlotArea?.PlotAreaRegion?.GetFirstChild<Series>();\r\n            var seriesLayoutId = series?.LayoutId;\r\n\r\n            try\r\n            {\r\n                // an exception is throw herer\r\n                var seriesLayout = seriesLayoutId?.Value;\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                Console.WriteLine(e);\r\n                throw;\r\n            }\r\n```\r\nPPT file xml information: \r\n```XML\r\n        <cx:series layoutId=\"funnel\" uniqueId=\"{ADE74266-3349-4984-B193-39D3FBD9289F}\">\r\n          <cx:tx>\r\n            <cx:txData>\r\n              <cx:f>Sheet1!$B$1</cx:f>\r\n              <cx:v>系列 1</cx:v>\r\n            </cx:txData>\r\n          </cx:tx>\r\n          <cx:dataLabels>\r\n            <cx:visibility seriesName=\"0\" categoryName=\"0\" value=\"1\" />\r\n          </cx:dataLabels>\r\n          <cx:dataId val=\"0\" />\r\n        </cx:series>\r\n```\r\n\r\n- .NET Target: net6.0\r\n- DocumentFormat.OpenXml Version: (ie 2.15.0)\r\n\r\n**Observed**\r\nException stack: \r\n```\r\nSystem.FormatException\r\n  HResult=0x80131537\r\n  Message=The text value is not a valid enumeration value.\r\n  Source=DocumentFormat.OpenXml\r\n  StackTrace:\r\n   在 DocumentFormat.OpenXml.EnumValue`1.Parse(String input)\r\n   在 DocumentFormat.OpenXml.OpenXmlSimpleValue`1.get_Value()\r\n   在 Cvte.PptxToEnbx.Converters.ElementConverters.ChartsConverter.PlotAreaConverters.CommonChartExtensionSaveInfoConverter.SetSaveInfo(ChartSaveInfo saveInfo) 在 I:\\Source\\Project\\pptx2enbx\\Cvte.PptxToEnbx.Converters\\ElementConverters\\ChartsConverter\\PlotAreaConverters\\ChartExtensionElementConverters_\\CommonChartExtensionSaveInfoConverter.cs 中: 第 43 行\r\n\r\n  此异常最初是在此调用堆栈中引发的: \r\n    DocumentFormat.OpenXml.EnumValue<T>.Parse(string)\r\n    DocumentFormat.OpenXml.OpenXmlSimpleValue<T>.Value.get()\r\n    Cvte.PptxToEnbx.Converters.ElementConverters.ChartsConverter.PlotAreaConverters.CommonChartExtensionSaveInfoConverter.SetSaveInfo(Cvte.Paint.Chart.ChartSaveInfo) (位于 CommonChartExtensionSaveInfoConverter.cs 中)\r\n```\r\nTest demo : https://github.com/OpenIssues/GettingLayoutidThrowException.git\r\n**Expected**\r\nWhen I get the enumeration value dont throw exption.\r\n"},{"Id":"23875792229","Type":"PullRequestEvent","CreatedAt":"2022-09-07T18:55:12","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1204","RelatedDescription":"Merged pull request \"Update Directory.Build.targets\" (#1204) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"23874848857","Type":"PullRequestEvent","CreatedAt":"2022-09-07T18:00:41","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1204","RelatedDescription":"Opened pull request \"Update Directory.Build.targets\" (#1204) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"23874737217","Type":"PullRequestEvent","CreatedAt":"2022-09-07T17:54:21","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1203","RelatedDescription":"Merged pull request \"Fix link in RELEASE.md\" (#1203) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"23874726369","Type":"PullRequestEvent","CreatedAt":"2022-09-07T17:53:47","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1203","RelatedDescription":"Opened pull request \"Fix RELEASE.md\" (#1203) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2022-09-15T03:30:27.675222Z","RunDurationInMilliseconds":595}