{"Data":{"Sdk":{"Events":[{"Id":"26637652250","Type":"IssuesEvent","CreatedAt":"2023-01-24T23:51:14","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1319","RelatedDescription":"Opened issue \"Add pull request numbers to CHANGELOG\" (#1319) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"26627596742","Type":"IssuesEvent","CreatedAt":"2023-01-24T15:33:58","Actor":"Asbjoedt","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1318","RelatedDescription":"Opened issue \"AddEmbeddedPackagePart is saved to wrong path\" (#1318) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\n\r\n_ISSUE 1_\r\n\r\nYou can iterate all EmbeddedPackageParts by doing the below. It iterates WorksheetParts and then each EmbeddedPackagePart.\r\n```\r\nusing (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(filepath, true))\r\n{\r\n    IEnumerable<WorksheetPart> worksheetParts = spreadsheet.WorkbookPart.WorksheetParts;\r\n    foreach (WorksheetPart worksheetPart in worksheetParts)\r\n    {\r\n        IEnumerable<EmbeddedPackagePart> embedpackages = worksheetPart.EmbeddedPackageParts;\r\n        foreach (EmbeddedPackagePart part in embedpackages)\r\n        {\r\n\r\n        }\r\n    }\r\n}\r\n```\r\nYou can delete any EmbeddedPackagePart by deleting it at the WorksheetPart level like this.\r\n```\r\nworksheetPart.DeletePart(part);\r\n```\r\n\r\nHowever, if you want to AddEmbeddedPackagePart you can do so also at the WorksheetPart level:\r\n```\r\nEmbeddedPackagePart embedpack = worksheetPart.AddEmbeddedPackagePart(contentType);\r\n```\r\nBut the new EmbeddedPackagePart will be saved to this URI where a new ```embeddings``` folder will be created:\r\n```\r\nxl/worksheets/embeddings/package.bin\r\n```\r\nIf you use Excel, all EmbeddedPackageParts are saved in this folder instead:\r\n```\r\nxl/embeddings/package.bin\r\n```\r\n\r\nIs this correct behaviour? Should Open XML SDK also save the part to ```xl/embeddings```?\r\n\r\n_ISSUE 2:_\r\n\r\nExcel saves the EmbeddedPackagePart with original extension i.e. ```.xlsx```.\r\n\r\nOpen XML SDK saves EmbeddedPackagePart with ```.bin``` extension.\r\n\r\n**Observed behavior**\r\n1. EmbeddedPackagePart is saved to ```xl\\worksheets\\embeddings```\r\n\r\n2. EmbeddedPackagePart is saved with ```.bin``` extension.\r\n\r\n**Expected behavior**\r\n1. EmbeddedPackagePart should be saved to ```xl\\embeddings```\r\n\r\n2. EmbeddedPackagePart should be saved with the original extension of the package i.e. ```.xlsx```.\r\n\r\n**Desktop (please complete the following information):**\r\n* OS: Windows 11\r\n* Office version: 2212\r\n* .NET Target: .Net latest version\r\n* DocumentFormat.OpenXml Version: 2.19\r\n\r\n\r\n"},{"Id":"26614428400","Type":"IssuesEvent","CreatedAt":"2023-01-24T05:06:12","Actor":"shailesh1984","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1317","RelatedDescription":"Closed issue \"System.IO.FileFormatException: File contains corrupted data - Excel file(.xlsx)\" (#1317) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nGetting \"System.IO.FileFormatException: File contains corrupted data\" error in SpreadsheetDocument.Open(filename, false); method for excel(.xlsx) file\r\n\r\nError Detail : \r\nSystem.Exception: OpenXML failed to open Pricing file | ‘System.IO.FileFormatException: File contains corrupted data.\r\n\tat MS.Internal.IO.2ip.ZipIOEndOfCentralDirectoryBlock.FindPosition(Stream archiveStream)\r\n\tat MS.Internal.IO.Zip.ZiplOEndOfCentralDirectoryBlock.SeekableLoad(ZipIOBlockManager blockManager)\r\n\tat MS.Internal.IO.Zip.ZipArchive..ctor(Stream archiveStream, FileMode mode, FileAccess access, Boolean streaming, Boolean ownStream)at\r\nMS.Internal.IO.2ip.ZipArchive.OpenOnFile(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)\r\n\tat System.IO.Packaging.ZipPackage..ctor(String path, FileMode mode, Fileccess access, FileShare share, Boolean streaming)\r\n\tat System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare, Boolean streaming)\r\n\tat DocunentFormat.OpenXnl.Packaging.OpenknlPackage-OpenCore(String path, Boolean readiiniteMode)\r\n\tat DocumentFormat.Openxnl.Packaging.SpreadsheetDocument.Open(String path, Boolean isEditable, OpenSettings openSettings)\r\n\r\nHow to fix this issue?"},{"Id":"26587673274","Type":"IssuesEvent","CreatedAt":"2023-01-23T04:16:57","Actor":"shailesh1984","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1317","RelatedDescription":"Opened issue \"System.IO.FileFormatException: File contains corrupted data - Excel file(.xlsx)\" (#1317) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nGetting \"System.IO.FileFormatException: File contains corrupted data\" error in SpreadsheetDocument.Open(filename, false); method for excel(.xlsx) file\r\n\r\nError Detail : \r\nSystem.Exception: OpenXML failed to open Pricing file | ‘System.IO.FileFormatException: File contains corrupted data.\r\n\tat MS.Internal.IO.2ip.ZipIOEndOfCentralDirectoryBlock.FindPosition(Stream archiveStream)\r\n\tat MS.Internal.IO.Zip.ZiplOEndOfCentralDirectoryBlock.SeekableLoad(ZipIOBlockManager blockManager)\r\n\tat MS.Internal.IO.Zip.ZipArchive..ctor(Stream archiveStream, FileMode mode, FileAccess access, Boolean streaming, Boolean ownStream)at\r\nMS.Internal.IO.2ip.ZipArchive.OpenOnFile(String path, FileMode mode, FileAccess access, FileShare share, Boolean streaming)\r\n\tat System.IO.Packaging.ZipPackage..ctor(String path, FileMode mode, Fileccess access, FileShare share, Boolean streaming)\r\n\tat System.IO.Packaging.Package.Open(String path, FileMode packageMode, FileAccess packageAccess, FileShare packageShare, Boolean streaming)\r\n\tat DocunentFormat.OpenXnl.Packaging.OpenknlPackage-OpenCore(String path, Boolean readiiniteMode)\r\n\tat DocumentFormat.Openxnl.Packaging.SpreadsheetDocument.Open(String path, Boolean isEditable, OpenSettings openSettings)\r\n\r\nHow to fix this issue?"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-01-25T03:30:26.9075975Z","RunDurationInMilliseconds":711}