{"Data":{"Sdk":{"Events":[{"Id":"46046752935","Type":"PullRequestEvent","CreatedAt":"2025-01-29T22:24:49","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1774","RelatedDescription":"Closed pull request \"Add open xml editor extension for Visual Studio Project\" (#1774) at dotnet/Open-XML-SDK","RelatedBody":"This moves the archived repo for the Open Xml Editor extension for Visual Studio from [Open-XML-Package-Editor-Power-Tool-for-Visual-Studio](https://github.com/OfficeDev/Open-XML-Package-Editor-Power-Tool-for-Visual-Studio) to the Open-XML-SDK repo."},{"Id":"46042775758","Type":"PullRequestEvent","CreatedAt":"2025-01-29T20:01:12","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1866","RelatedDescription":"Opened pull request \"add mp4 to MediaDataPartType enum\" (#1866) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"45966461833","Type":"IssuesEvent","CreatedAt":"2025-01-27T22:35:49","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1665","RelatedDescription":"Closed issue \"Excel in-cell dropdown\" (#1665) at dotnet/Open-XML-SDK","RelatedBody":"I have this code below. The purpose of this code is to set very specific cell's to have drop down values. Not all cells in the column must have this dropdown and the data types differ for each cell.\r\n\r\nThis works fine and excel is created.\r\n\r\nThe issue here is that in Excel, for each cell that have a dropdown applied you need to:\r\n1. Select the cell\r\n2. Select the \"Data\" tab\r\n3. Select \"Data Validation\"\r\n4. Check the \"in-cell dropdown\" checkbox\r\nbefore the cell have a drop  down option\r\n\r\nThis code was developed using several sources to try and resolve the issue, and all of the sources advise more or less the same code\r\n\r\n```csharp\r\nif (data.ApplyLookup(x, rowIndex))\r\n{\r\n\tstring columnName = GetExcelColumnName(x + 1);\r\n\t\r\n\tDataValidation dataValidation = new DataValidation\r\n\t{\r\n\t\tType = DataValidationValues.List,\r\n\t\tShowDropDown = true,\r\n\t\tAllowBlank = true,\r\n\t\tSequenceOfReferences = new ListValue<StringValue> { InnerText = $\"{columnName}{rowIndex}\" }\r\n\t};\r\n\t\r\n\tstring lookupString = $\"\\\"{string.Join(\",\", data.LookupValues[x].Select(kv => kv.Value))}\\\"\";\r\n\tdataValidation.Formula1 = new Formula1(lookupString);\r\n\t\r\n\tdataValidations.Append(dataValidation);\r\n}\r\n```\r\n"},{"Id":"45965965785","Type":"IssuesEvent","CreatedAt":"2025-01-27T22:16:09","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/801","RelatedDescription":"Closed issue \"code of docs about create pptx result without any content\" (#801) at dotnet/Open-XML-SDK","RelatedBody":"- [ âˆš ] Question on library usage\r\n\r\nhttps://docs.microsoft.com/en-us/office/open-xml/how-to-create-a-presentation-document-by-providing-a-file-name\r\n\r\nsample code same to docs\r\n[ConsoleApp.zip](https://github.com/OfficeDev/Open-XML-SDK/files/5180913/ConsoleApp.zip)\r\n\r\nresult:\r\n![result](https://user-images.githubusercontent.com/16309962/92345502-21efa600-f0fc-11ea-9ff4-fb7c98f3cbd4.jpg)\r\n"},{"Id":"45965822197","Type":"IssuesEvent","CreatedAt":"2025-01-27T22:10:25","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1685","RelatedDescription":"Closed issue \"Excel with Comments is not working with Open XML SDK\" (#1685) at dotnet/Open-XML-SDK","RelatedBody":"0\r\n\r\nWe are trying to export excel with comments using Open Xml. I have tried with below code snippet and its showing comments in the Sheet Object but when exported to excel the comments are not displaying in the cells after opening excel.\r\n\r\n```csharp\r\n#public byte[] ExportJsonDatatoExcelWithComments()\r\n{\r\n\r\n    MemoryStream memoryStream = new MemoryStream();\r\n    SpreadsheetDocument spreadsheet = SpreadsheetDocument.Create(memoryStream, DocumentFormat.OpenXml.SpreadsheetDocumentType.Workbook);\r\n    WorkbookPart workbookPart = spreadsheet.AddWorkbookPart();\r\n\r\n    workbookPart.Workbook = new Workbook();\r\n    Sheets sheets = workbookPart.Workbook.AppendChild<Sheets>(new Sheets());\r\n    //OpenSheet\r\n    WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();\r\n    SheetData sheetData = new SheetData();\r\n    worksheetPart.Worksheet = new Worksheet(sheetData);\r\n\r\n    var sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = \"test\" };\r\n    sheets.Append(sheet);\r\n    \r\n    WorksheetCommentsPart worksheetCommentsPart1 = worksheetPart.AddNewPart<WorksheetCommentsPart>();\r\n    GenerateWorksheetCommentsPart1Content(worksheetCommentsPart1);\r\n\r\n    OpenXmlWriter DataWriter = OpenXmlWriter.Create(worksheetPart);\r\n    DataWriter.WriteStartElement(sheetData);\r\n    DataWriter.WriteStartElement(worksheetPart.Worksheet);\r\n    \r\n    //closedata\r\n    DataWriter.WriteEndElement();\r\n    DataWriter.Close();\r\n    //\r\n    //render\r\n    // worksheetPart = null;\r\n    workbookPart.Workbook.Save();\r\n    spreadsheet.Save();\r\n    spreadsheet.Close();\r\n    memoryStream.Position = 0;\r\n    return memoryStream.ToArray();\r\n}\r\n\r\npublic void GenerateWorksheetCommentsPart1Content(WorksheetCommentsPart worksheetCommentsPart)\r\n{\r\n    Comments comments1 = new Comments() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = \"xr\" } };\r\n\r\n\r\n    Authors authors1 = new Authors();\r\n    Author author1 = new Author();\r\n    author1.Text = \"User1\";\r\n\r\n    authors1.Append(author1);\r\n\r\n    CommentList commentList1 = new CommentList();\r\n\r\n    Comment comment1 = new Comment() { Reference = \"A3\", AuthorId = (UInt32Value)12, ShapeId = (UInt32Value)10, Guid = Guid.NewGuid().ToString() };\r\n    comment1.SetAttribute(new OpenXmlAttribute(\"xr\", \"uid\", \"http://schemas.microsoft.com/office/spreadsheetml/2014/revision\", \"{811649EF-4CB5-4311-BE14-228133003BE4}\"));\r\n\r\n    CommentText commentText1 = new CommentText();\r\n\r\n    Run run1 = new Run();\r\n\r\n    RunProperties runProperties1 = new RunProperties();\r\n    FontSize fontSize3 = new FontSize() { Val = 9D };\r\n    Color color3 = new Color() { Indexed = (UInt32Value)81U };\r\n    RunFont runFont1 = new RunFont() { Val = \"Tahoma\" };\r\n    RunPropertyCharSet runPropertyCharSet1 = new RunPropertyCharSet() { Val = 1 };\r\n\r\n    runProperties1.Append(fontSize3);\r\n    runProperties1.Append(color3);\r\n    runProperties1.Append(runFont1);\r\n    runProperties1.Append(runPropertyCharSet1);\r\n    Text text1 = new Text() { Space = SpaceProcessingModeValues.Preserve };\r\n    text1.Text = \"This is my comment!\\nThis is line 2!\\n\";\r\n\r\n    run1.Append(runProperties1);\r\n    run1.Append(text1);\r\n\r\n    commentText1.Append(run1);\r\n\r\n    comment1.Append(commentText1);\r\n\r\n    commentList1.Append(comment1);\r\n\r\n    comments1.Append(authors1);\r\n    comments1.Append(commentList1);\r\n   \r\n    worksheetCommentsPart.Comments = comments1;\r\n}\r\n```\r\nPlease let me know what is the issue with the code and how can we show comments for particular cell."},{"Id":"45965754053","Type":"IssuesEvent","CreatedAt":"2025-01-27T22:07:44","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1778","RelatedDescription":"Closed issue \"EndnotesPart.AddHyperlinkRelationship not generating proper endnotes.xml.rels\" (#1778) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nAdding an endnote having hyperlink into a document having no existing relationship for an endnote part is not generating proper endnotes.xml.rels file due to which generated document cannot be open using MS word or any other related application.\r\n\r\n**Screenshots**\r\n\r\n![image](https://github.com/user-attachments/assets/85f3883b-5265-4086-8cd2-9616e67a58b6)\r\n![image](https://github.com/user-attachments/assets/10e50b3e-27fc-49a4-83f2-470d9e0b1261)\r\n\r\n\r\n**To Reproduce**\r\nKindly run attached console app to reproduce the issue.\r\n[EndnotesWithURLIssue.zip](https://github.com/user-attachments/files/16747036/EndnotesWithURLIssue.zip)\r\n\r\n**Observed behavior**\r\nIf same code is executed (EndnotesPart.AddHyperlinkRelationship) for document already having an existing relationship present for endnotepart then generated document can be opened.\r\n\r\n**Expected behavior**\r\nEndnotesPart.AddHyperlinkRelationship should create a proper endnotes.xml.rels if not present.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: windows 10\r\n - Office version: 16.0.17628.20188\r\n - .NET Target: 4.8\r\n - DocumentFormat.OpenXml Version: 2.5.0, 3.1.0\r\n\r\n**Debug Info**\r\nAdding below code before adding hyperlink relationship fixes the issue.\r\n\r\n```\r\nif(!document.Package.PartExists(new Uri(\"/word/_rels/endnotes.xml.rels\", UriKind.Relative)))\r\n{\r\n    var part = document.Package.CreatePart(new Uri(\"/word/_rels/endnotes.xml.rels\", UriKind.Relative), \"application/vnd.openxmlformats-package.relationships+xml\");\r\n    part.Package.Flush();\r\n}\r\n\r\n```\r\n"},{"Id":"45965648406","Type":"IssuesEvent","CreatedAt":"2025-01-27T22:03:37","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1864","RelatedDescription":"Closed issue \"Word file is corrupted after replacing the header in a word document which has section breaks using Open XML SDK\" (#1864) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nHi, I am using the replace the header in a word processing document code which uses two documents. The header in fromFile.docx to be replaced in toFile.docx. The file toFile.docx already have section breaks. The section breaks can be added using Layout tab in word, select Breaks --> Section Breaks--> Next Page and save the document. After the header replacement code execution the toFile.docx became corrupted. Facing this issue and how this can be fixed. The code is given below.\n\n```csharp\nusing DocumentFormat.OpenXml.Packaging;\nusing DocumentFormat.OpenXml.Spreadsheet;\nusing DocumentFormat.OpenXml.Wordprocessing;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nstring fromFile = @\"C:\\Users\\jhe\\Desktop\\LearnAndTech\\HeaderAndFooter\\MSDNTest\\fromFile.docx\";\nstring toFile = @\"C:\\Users\\jhe\\Desktop\\LearnAndTech\\HeaderAndFooter\\MSDNTest\\toFile.docx\";\n\nAddHeaderFromTo(fromFile, toFile);\n\n\nstatic void AddHeaderFromTo(string fromFile, string toFile)\n{\n    // Replace header in target document with header of source document.\n    using (WordprocessingDocument wdDoc = WordprocessingDocument.Open(toFile, true))\n    using (WordprocessingDocument wdDocSource = WordprocessingDocument.Open(fromFile, true))\n    {\n        if (wdDocSource.MainDocumentPart is null || wdDocSource.MainDocumentPart.HeaderParts is null)\n        {\n            throw new ArgumentNullException(\"MainDocumentPart and/or HeaderParts is null.\");\n        }\n\n        if (wdDoc.MainDocumentPart is null)\n        {\n            throw new ArgumentNullException(\"MainDocumentPart is null.\");\n        }\n\n        MainDocumentPart mainPart = wdDoc.MainDocumentPart;\n\n        // Delete the existing header part.\n        mainPart.DeleteParts(mainPart.HeaderParts);\n\n        // Create a new header part.\n        DocumentFormat.OpenXml.Packaging.HeaderPart headerPart = mainPart.AddNewPart<HeaderPart>();\n\n        // Get Id of the headerPart.\n        string rId = mainPart.GetIdOfPart(headerPart);\n\n        // Feed target headerPart with source headerPart.\n\n        DocumentFormat.OpenXml.Packaging.HeaderPart? firstHeader = wdDocSource.MainDocumentPart.HeaderParts.FirstOrDefault();\n\n        wdDocSource.MainDocumentPart.HeaderParts.FirstOrDefault();\n\n        if (firstHeader is not null)\n        {\n            headerPart.FeedData(firstHeader.GetStream());\n        }\n\n        if (mainPart.Document.Body is null)\n        {\n            throw new ArgumentNullException(\"Body is null.\");\n        }\n\n        // Get SectionProperties and Replace HeaderReference with new Id.\n        IEnumerable<DocumentFormat.OpenXml.Wordprocessing.SectionProperties> sectPrs = mainPart.Document.Body.Elements<SectionProperties>();\n        foreach (var sectPr in sectPrs)\n        {\n            // Delete existing references to headers.\n            sectPr.RemoveAllChildren<HeaderReference>();\n\n            // Create the new header reference node.\n            sectPr.PrependChild<HeaderReference>(new HeaderReference() { Id = rId });\n        }\n    }\n}\n```\n\n**To Reproduce**\nCreate fromFile.docx and toFile.docx files with headers.\nAdd section breaks to toFile.docx. The section breaks can be added using Layout tab in word, select Breaks --> Section Breaks--> Next Page and save the document. Execute the above code. \n\n\n**Observed behavior**\nA popup will be shown while opening the toFile.docx after the above code execution which says 'word found unreadable contents in toFile.docx. Do you want to recover the contents of this document? '.\n\n**Expected behavior**\nOpen the file without corruption or any error,\n\n**Desktop (please complete the following information):**\n - OS: Windows 10\n - Office version : Microsoft 365 Apps for enterprise Version 2412\n - .NET Target: any\n - DocumentFormat.OpenXml Version: 3.2.0\n\nThanks in advance."}],"ResultType":"GitHubEvent"}},"RunOn":"2025-02-05T03:30:23.9399155Z","RunDurationInMilliseconds":656}