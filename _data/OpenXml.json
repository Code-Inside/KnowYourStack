{"Data":{"Sdk":{"Events":[{"Id":"4607532104","Type":"IssuesEvent","CreatedAt":"2025-11-11T17:28:36","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1635","RelatedDescription":"Closed issue \"Read sensitivity labelled documents\" (#1635) at dotnet/Open-XML-SDK","RelatedBody":"Add support for reading sensitivity labelled documents. As of today if document is labelled by sensitivity then openXML does not work. Also there is no workaround DLLs other than interop DLLs."},{"Id":"4603117045","Type":"IssuesEvent","CreatedAt":"2025-11-11T14:12:14","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"labeled","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1970","RelatedDescription":null,"RelatedBody":"I'm using version 3.3\n\nWith .NET 10, when opening an document already formed with PNG images (2 or 3) and close it, some images have zero size in media folder after disposing. The first one is generally untouched, but the other ones are all empty.\n\nThe same document in .NET 9 behave correctly (images are not empty).\n\n\n"},{"Id":"4603111491","Type":"IssuesEvent","CreatedAt":"2025-11-11T14:11:59","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"assigned","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1970","RelatedDescription":null,"RelatedBody":"I'm using version 3.3\n\nWith .NET 10, when opening an document already formed with PNG images (2 or 3) and close it, some images have zero size in media folder after disposing. The first one is generally untouched, but the other ones are all empty.\n\nThe same document in .NET 9 behave correctly (images are not empty).\n\n\n"},{"Id":"4603050956","Type":"IssuesEvent","CreatedAt":"2025-11-11T14:09:15","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"assigned","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1971","RelatedDescription":null,"RelatedBody":"I am trying to open this file [testFile.docx](https://docs.google.com/document/d/1VVVcLk07EujdzBI9jTHSdYv5pP6mBOyw/edit?usp=drive_link&ouid=109338977916725867907&rtpof=true&sd=true)\n\nusing the code\n\n```c#\n static void Main(string[] args)\n {\n     try\n     {\n         using (WordprocessingDocument doc = WordprocessingDocument.Open(\"testFile.docx\", false))\n         {\n             Console.WriteLine(\"File is opened!\");\n         }\n     }\n     catch (Exception ex)\n     {\n         Console.WriteLine(\"General Exception caught:\");\n         Console.WriteLine($\"Type: {ex.GetType()}\");\n         Console.WriteLine($\"Message: {ex.Message}\");\n         Console.WriteLine($\"StackTrace: {ex.StackTrace}\");\n     }\n }\n```\n\nBut I am getting this message which isn't helpful\n\n> General Exception caught:\n> Type: System.InvalidOperationException\n> Message: Specified part does not exist in the package.\n> StackTrace:    at System.IO.Packaging.Package.GetPart(Uri partUri)\n>    at DocumentFormat.OpenXml.Features.PackageFeatureBase.DocumentFormat.OpenXml.Packaging.IPackage.GetPart(Uri uriTarget)\n>    at DocumentFormat.OpenXml.Packaging.PackageUriHandlingExtensions.MalformedUriHandlingPackage.GetPart(Uri uriTarget)\n>    at DocumentFormat.OpenXml.Packaging.OpenXmlPart.Load(OpenXmlPackage openXmlPackage, OpenXmlPart parent, Uri uriTarget, String id)\n>    at DocumentFormat.OpenXml.Packaging.PartRelationshipsFeature.LoadReferencedPartsAndRelationships()\n>    at DocumentFormat.OpenXml.Packaging.PartRelationshipsFeature.DocumentFormat.OpenXml.Features.IReferenceRelationshipsFeature.get_Relationships()\n>    at DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.get_ExternalRelationships()\n>    at Demo.Program.Main(String[] args) in ...\n\nIs there a way to find which part is missing?"},{"Id":"4570653379","Type":"IssuesEvent","CreatedAt":"2025-11-10T09:48:49","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1966","RelatedDescription":"Closed issue \"how to copy  <w:drawing> <wp:inline  to other docx？\" (#1966) at dotnet/Open-XML-SDK","RelatedBody":"Can someone provide an example?\n\nthanks\n\nThe current approach is to save the original document as a new file, delete all the body content, place the relevant XML into the paragraph, and generate a new document. However, there is some error.\n```csharp\nopenXmlElement2 is DocumentFormat.OpenXml.Wordprocessing.Run\n<w:r> <w:drawing> <wp:inline>\n\nDocumentFormat.OpenXml.Wordprocessing.Paragraph paragraph6 = new DocumentFormat.OpenXml.Wordprocessing.Paragraph();\nforeach (OpenXmlElement element in openXmlElement1.Elements<DocumentFormat.OpenXml.Wordprocessing.ParagraphProperties>())\n{\n    OpenXmlElement newChild6 = element.CloneNode(true);\n    newChild6.RemoveAllChildren<SectionProperties>();\n    newChild6.RemoveAllChildren<ParagraphBorders>();\n    paragraph6.AppendChild<OpenXmlElement>(newChild6);\n}\nparagraph6.AppendChild<OpenXmlElement>(openXmlElement2.CloneNode(true));\ntableXmlElementList.Add(openXmlElement2);\ntablebody2.AppendChild<OpenXmlElement>(paragraph6.CloneNode(true));\n\nusing (WordprocessingDocument wordprocessingDocument2 = WordprocessingDocument.Open(temp1, true))\n{\n    Body body1 = wordprocessingDocument2.MainDocumentPart.Document.Body;\n\n    OpenXmlElement newChild11 = body1.Elements<SectionProperties>().FirstOrDefault<SectionProperties>().CloneNode(true);\n    newChild11.RemoveAllChildren<FooterReference>();\n    newChild11.RemoveAllChildren<HeaderReference>();\n    IEnumerable<PageMargin> source = newChild11.Descendants<PageMargin>();\n    if (source.Count<PageMargin>() > 0)\n        source.FirstOrDefault<PageMargin>().Bottom = (Int32Value)1710;\n    else\n        newChild11.Append((OpenXmlElement)new PageMargin()\n        {\n            Bottom = (Int32Value)1710\n        });\n    mathbody.AppendChild<OpenXmlElement>(newChild11);\n    wordprocessingDocument2.MainDocumentPart.Document.RemoveAllChildren<Body>();\n    wordprocessingDocument2.MainDocumentPart.Document.RemoveAllChildren<DocumentBackground>();\n    wordprocessingDocument2.MainDocumentPart.Document.Append((OpenXmlElement)mathbody);\n    wordprocessingDocument2.Save();\n}\n```\n=========================================\n```xml\n-<w:drawing>\n\n\n-<wp:inline wp14:editId=\"7BB75690\" wp14:anchorId=\"3EDB3CC6\" distR=\"0\" distL=\"0\" distB=\"0\" distT=\"0\">\n\n<wp:extent cx=\"3960000\" cy=\"2412000\"/>\n\n<wp:effectExtent r=\"2540\" b=\"7620\" t=\"0\" l=\"0\"/>\n\n\n-<wp:docPr name=\"图表 1\" id=\"6\">\n\n\n-<a:extLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">\n\n\n-<a:ext uri=\"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}\">\n\n<a16:creationId id=\"{05A109B0-8715-5C68-1F51-FAAAA0F641B6}\" xmlns:a16=\"http://schemas.microsoft.com/office/drawing/2014/main\"/>\n\n</a:ext>\n\n</a:extLst>\n\n</wp:docPr>\n\n<wp:cNvGraphicFramePr/>\n\n\n-<a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">\n\n\n-<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">\n\n<c:chart xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId4\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"/>\n\n</a:graphicData>\n\n</a:graphic>\n\n</wp:inline>\n\n</w:drawing>\n```"},{"Id":"4559147447","Type":"IssuesEvent","CreatedAt":"2025-11-09T14:17:14","Actor":"koviroli","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1972","RelatedDescription":"Opened issue \"SpreadsheetDocument.Save() throws OpenXmlPackageException when saving .xlsb file due to unexpected styles.bin content type\" (#1972) at dotnet/Open-XML-SDK","RelatedBody":"\n### Describe the bug\n\nSaving an `.xlsb` opened via `SpreadsheetDocument` throws an `OpenXmlPackageException` about an unexpected content type for `/xl/styles.bin`. This occurs even if no modifications are made; simply opening and calling `Save()` triggers the error for `.xlsb`. The same code path works for `.xlsx` and `.xlsm`.\n\n### Exception\n\n```\nDocumentFormat.OpenXml.Packaging.OpenXmlPackageException: 'The document cannot be opened because there is an invalid part with an unexpected content type. \n[Part Uri=/xl/styles.bin], \n[Content Type=application/vnd.ms-excel.styles], \n[Expected Content Type=application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml].'\n```\n\n\nA temporary workaround is to force-get all public properties of the SpreadsheetDocument instance before saving; after doing so, Save() succeeds.\n\n### Screenshots\n\nN/A\n\n### To Reproduce\n\nA self-contained, minimal repro (console app):\n\n```\nusing DocumentFormat.OpenXml.Packaging;\n\nvar filePath = @\"PathToXlsb\\Book1.xlsm\";\nvar fileBytes = File.ReadAllBytes(filePath);\n\n\nvar stream = new MemoryStream();\nstream.Write(fileBytes, 0, fileBytes.Length);\nstream.Position = 0;\n\nusing var spreadsheetDocument = SpreadsheetDocument.Open(stream, true);\n\n// works with this solution\n//foreach (var prop in spreadsheetDocument.GetType().GetProperties())\n//{\n//    try\n//    {\n//        _ = prop.GetValue(spreadsheetDocument);\n//    }\n//    catch { }\n//}\n\n// Throws exception\nspreadsheetDocument.Save();\n```\n\n\n### Steps\n\n1. Open any `.xlsb` file with `SpreadsheetDocument.Open(stream, true)`.\n2. Immediately call `spreadsheetDocument.Save()`.\n3. Observe the `OpenXmlPackageException`.\n\n### Observed behavior\n\nAccessing all public properties on `SpreadsheetDocument` prior to saving (reflection-based getter loop) makes the save succeed.\n\n### Expected behavior\n\nOpening a valid `.xlsb` file, optionally modifying custom properties, and calling `Save()` should succeed without requiring any reflection-based workarounds.\n\n### Desktop (please complete the following information)\n\n- OS: Windows 11 Home (26100.2033)\n- Office version: N/A (repro does not require Office; opening/saving via SDK)\n- .NET Target: .NET 8 and .NET 10 (both reproduce)\n- DocumentFormat.OpenXml Version(s) tested: 3.3.0, 3.2.0, 3.1.1, 3.0.2, 3.0.1\n\n### Additional context\n\n- Only happens with `.xlsb`. The same code works for `.xlsx` and `.xlsm`.\n- The behavior cannot be reproduced with `WordprocessingDocument` or `PresentationDocument` for their respective formats.\n- The workaround (calling getters for all public properties on `SpreadsheetDocument`) suggests a lazy-loading/initialization or part registration issue specific to `.xlsb` styles content types."},{"Id":"4486889423","Type":"IssuesEvent","CreatedAt":"2025-11-05T19:09:35","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1944","RelatedDescription":"Closed issue \"Obsolete PivotCacheDynamicArray class\" (#1944) at dotnet/Open-XML-SDK","RelatedBody":"CT_PivotCacheDynamicArrayExt has been removed in the latest schema update so PivotCacheDynamicArray should be obsoleted until it can be removed in v4"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-11-13T03:30:23.2761516Z","RunDurationInMilliseconds":656}