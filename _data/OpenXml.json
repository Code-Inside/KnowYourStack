{"Data":{"Sdk":{"Events":[{"Id":"51547966168","Type":"IssuesEvent","CreatedAt":"2025-07-01T09:45:51","Actor":"sw-ms-hardiksenghani","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1951","RelatedDescription":"Opened issue \"Bug Report: System.OutOfMemoryException when writing large Excel file\" (#1951) at dotnet/Open-XML-SDK","RelatedBody":"Environment:\n\nOpenXmlWriter(Package:2.16.0)\n.NET Version: .Net Core 8\nOperating System: Windows 10\nIssue Summary:\n\nWe are generating an Excel file with approximately:\n\n180 columns\n500,000 rows\nCell formatting applied throughout\nWhile writing data using ClosedXML, the process fails after approximately 350,000 rows with the following exception:\n\nException in Stream was too long.\nException of type 'System.OutOfMemoryException' was thrown.\nSteps to Reproduce:\n\nCreate a workbook and worksheet.\nPopulate 180 columns with formatted data.\nLoop through and write 500,000 rows.\nSave the workbook.\nExpected Behavior: The Excel file should be generated successfully without memory issues.\n\nActual Behavior: The process throws an OutOfMemoryException after writing around 350,000 rows.\n\nAdditional Context:\n\nWe are using cell formatting (e.g., borders, font styles) for each cell.\nThe issue seems to be related to memory usage or stream limits during serialization.\nRequest:\n\nIs there a recommended approach to handle large datasets with formatting?\nAre there any memory optimization techniques or streaming options available in OpenXmlWriter?"},{"Id":"51528257819","Type":"PullRequestEvent","CreatedAt":"2025-06-30T22:59:34","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1950","RelatedDescription":"Opened pull request \"Bump gittools/actions from 3 to 4\" (#1950) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [gittools/actions](https://github.com/gittools/actions) from 3 to 4.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/gittools/actions/releases\">gittools/actions's releases</a>.</em></p>\n<blockquote>\n<h2>v4.0.0</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.2.1...v4.0.0\">168 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/25?closed=1\">10 issues</a> being closed.</p>\n<p><strong>Breaking changes</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1353\">#1353</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1353\">GitTools/actions#1353</a>) [ISSUE]: GitVersion.yml config file not detected</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1357\">#1357</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1357\">GitTools/actions#1357</a>) [ISSUE]: Upgrade AzureDevops minimal agent version</li>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1388\"><strong>!1388</strong></a> GitReleaseManager repository and owner input</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1396\">#1396</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1396\">GitTools/actions#1396</a>) [ISSUE]: Preserve only the &quot;_&quot; separated version and output variables to be in line with the GitHub actions and the GitVersion.Tool</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1495\">#1495</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1495\">GitTools/actions#1495</a>) [ISSUE]: Fix Azure Pipeline task build warning</li>\n</ul>\n<p><strong>Bugs</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1434\">#1434</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1434\">GitTools/actions#1434</a>) [ISSUE]: Allow customization of version variable set in $(Build.BuildNumber) for Azure DevOps GitVersion task</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1493\">#1493</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1493\">GitTools/actions#1493</a>) [ISSUE]: Azure DevOps Release pipeline throws the error on GitVersion updatebuildnumber</li>\n</ul>\n<p><strong>Documentation</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1402\">#1402</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1402\">GitTools/actions#1402</a>) [DOCS]: Update docs and <code>versions.md</code> to use v4 and GitVersion.Tool v6.1.x</li>\n</ul>\n<p><strong>Improvements</strong></p>\n<ul>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1627\"><strong>!1627</strong></a> Potential fix for code scanning alert no. 11: Incomplete string escaping or encoding</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1659\">#1659</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1659\">GitTools/actions#1659</a>) [ISSUE]: Unable to fetch GitVersion.Tool</li>\n</ul>\n<h3>SHA256 Hashes of the release artifacts</h3>\n<ul>\n<li><code>1ee9cc45adbd18a72f67cff6789bb9a7cc6b5a1aba2ad9b703df959ee316ec46\t- gittools.gittools-4.0.0.25063007.vsix</code></li>\n</ul>\n<h2>v3.2.1</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.2.0...v3.2.1\">50 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/24?closed=1\">1 issue</a> being closed.</p>\n<p><strong>Improvements</strong></p>\n<ul>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1586\"><strong>!1586</strong></a> updates GitVersion and GitReleaseManager versions</li>\n</ul>\n<h3>SHA256 Hashes of the release artifacts</h3>\n<ul>\n<li><code>1d446034a454176807f7c3846983ec4b8a4efef0e2e10cabef19f7ea1f428e33\t- gittools.gittools-3.2.1.25042514.vsix</code></li>\n</ul>\n<h2>v3.2.0</h2>\n<p>As part of this release we had <a href=\"https://github.com/GitTools/actions/compare/v3.1.11...v3.2.0\">147 commits</a> which resulted in <a href=\"https://github.com/GitTools/actions/milestone/23?closed=1\">6 issues</a> being closed.</p>\n<p><strong>Bugs</strong></p>\n<ul>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1400\">#1400</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1400\">GitTools/actions#1400</a>) [ISSUE]: Azure DevOps task v3.1.1 fails with 'Overwriting readonly variable is not permitted'</li>\n<li>[<strong><a href=\"https://redirect.github.com/gittools/actions/issues/1515\">#1515</a></strong>](<a href=\"https://redirect.github.com/GitTools/actions/issues/1515\">GitTools/actions#1515</a>) [ISSUE]: gitVersion execute task not immediately available after gitVersion setup task</li>\n<li><a href=\"https://redirect.github.com/GitTools/actions/pull/1554\"><strong>!1554</strong></a> Normalizes target path in dotnet tool</li>\n</ul>\n<!-- raw HTML omitted -->\n</blockquote>\n<p>... (truncated)</p>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/GitTools/actions/commit/81f0bc44e27a689ce858668d7a2081ac2387b605\"><code>81f0bc4</code></a> dist update</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/5eb6c7e6139e9ac778760eb980a0029884b66c48\"><code>5eb6c7e</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1664\">#1664</a> from IdsTeepe/feat/dotnet-based-nuget-query</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/e38db95cfb29ace9690550d110ae9c888a45cc4d\"><code>e38db95</code></a> Query all enabled sources</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/66027dc80dae741fa47b408ebc4572df6c4a0b8a\"><code>66027dc</code></a> Move builder to separate variable</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/1891d98f3a9c3b13ad77e3e55ecd0a893b665ce5\"><code>1891d98</code></a> Chore: Tiny comment, better variable naming.</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/93ee92665e60fd0c42148c97c77a0ad877a4f454\"><code>93ee926</code></a> Feat: Dynamically get query service from nuget package source</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/2169f9f60f09b337bd709fa944dd054a60dc6759\"><code>2169f9f</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1661\">#1661</a> from GitTools/dependabot/npm_and_yarn/eslint-c11f433916</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/efeecdc0788f250e53ea9f21b0ae4148f1a3646a\"><code>efeecdc</code></a> (npm): Bump eslint-plugin-prettier in the eslint group</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/7124bde385c3272f04a5fdf0fe2e4247636bbfc1\"><code>7124bde</code></a> Merge pull request <a href=\"https://redirect.github.com/gittools/actions/issues/1662\">#1662</a> from GitTools/dependabot/npm_and_yarn/types-a55ad1e45f</li>\n<li><a href=\"https://github.com/GitTools/actions/commit/b43ed1a2fdaf942dc8516c620b9174fa173b2e4f\"><code>b43ed1a</code></a> (npm): Bump <code>@â€‹types/node</code> from 24.0.3 to 24.0.4 in the types group</li>\n<li>Additional commits viewable in <a href=\"https://github.com/gittools/actions/compare/v3...v4\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=gittools/actions&package-manager=github_actions&previous-version=3&new-version=4)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"51438860573","Type":"PullRequestEvent","CreatedAt":"2025-06-27T18:32:58","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1949","RelatedDescription":"Opened pull request \"Obsolete PivotCacheRichInfo and PivotCacheDynamicArray classes\" (#1949) at dotnet/Open-XML-SDK","RelatedBody":"- closes #1946 \r\n- closes #1944 "},{"Id":"51421697127","Type":"IssuesEvent","CreatedAt":"2025-06-27T11:12:26","Actor":"alexa-padberg","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1948","RelatedDescription":"Closed issue \"Getting Error that Powerpoint needs to be repaired after adding video through open xml\" (#1948) at dotnet/Open-XML-SDK","RelatedBody":"I am currently trying to add in a video element to a powerpoint that I am creating. I have tried both of microsofts functions in the openxml sdk\nas well as a chat line on github about having a similar issue. https://github.com/dotnet/Open-XML-SDK/issues/1740\n\nI am not entirely sure what the problem is, but I always get a notification that the powerpoint has to be repaired and every time I open it, there is not video or image displayed on the slide. Oddly enough, when I open the powerpoint, the video is displayed on the slide correcntly. I cannot figure out where the xml is messed up and causing the repair error.  Here is my current function\n\n```csharp\n public async static Task AddVideo(PresentationDocument presentationDocument, SlidePart slidePart, string videoFilePath, string coverPicPath)\n {\n\n     string imgEmbedId = \"imgid\", embedId = \"embedid\", mediaEmbedId = \"mediaid\";\n     UInt32Value shapeId = 5;\n   \n         PresentationPart presentationPart = presentationDocument.PresentationPart;\n\n         //Get slides ids.\n         OpenXmlElementList slidesIds = presentationPart.Presentation.SlideIdList.ChildElements;\n\n       \n\n         //Get slide part by relationshipID\n         //SlidePart? slidePart = (SlidePart)presentationPart.GetPartById(videoSldRelationshipId);\n\n         // Create video Media Data Part (content type, extension)\n         MediaDataPart mediaDataPart = presentationDocument.CreateMediaDataPart(\"video/mp4\", \".mp4\");\n\n         //Get the video file and feed the stream\n         using (Stream mediaDataPartStream = File.OpenRead(videoFilePath))\n         {\n             mediaDataPart.FeedData(mediaDataPartStream);\n         }\n         //Adds a VideoReferenceRelationship to the MainDocumentPart\n         slidePart.AddVideoReferenceRelationship(mediaDataPart, embedId);\n\n         //Adds a MediaReferenceRelationship to the SlideLayoutPart\n         slidePart.AddMediaReferenceRelationship(mediaDataPart, mediaEmbedId);\n\n         NonVisualDrawingProperties nonVisualDrawingProperties = new NonVisualDrawingProperties() { Id = shapeId, Name = \"video\" };\n         A.VideoFromFile videoFromFile = new A.VideoFromFile() { Link = embedId };\n\n         ApplicationNonVisualDrawingProperties appNonVisualDrawingProperties = new ApplicationNonVisualDrawingProperties();\n         appNonVisualDrawingProperties.Append(videoFromFile);\n\n         //adds sample image to the slide with id to be used as reference in blip\n         ImagePart imagePart = slidePart.AddImagePart(ImagePartType.Png, imgEmbedId);\n         using (Stream data = File.OpenRead(coverPicPath))\n         {\n             imagePart.FeedData(data);\n         }\n\n         if (slidePart!.Slide!.CommonSlideData!.ShapeTree == null)\n         {\n             throw new NullReferenceException(\"Presentation shape tree is empty\");\n         }\n\n         //Getting existing shape tree object from PowerPoint\n         P.ShapeTree shapeTree = slidePart.Slide.CommonSlideData.ShapeTree;\n\n         // specifies the existence of a picture within a presentation.\n         // It can have non-visual properties, a picture fill as well as shape properties attached to it.\n         Picture picture = new Picture();\n         NonVisualPictureProperties nonVisualPictureProperties = new NonVisualPictureProperties();\n\n       //  A.HyperlinkOnClick hyperlinkOnClick = new A.HyperlinkOnClick() { Id = \"\", Action = \"ppaction://media\" };\n        // nonVisualDrawingProperties.Append(hyperlinkOnClick);\n\n         NonVisualPictureDrawingProperties nonVisualPictureDrawingProperties = new NonVisualPictureDrawingProperties();\n         A.PictureLocks pictureLocks = new A.PictureLocks() { NoChangeAspect = true };\n         nonVisualPictureDrawingProperties.Append(pictureLocks);\n\n         ApplicationNonVisualDrawingPropertiesExtensionList appNonVisualDrawingPropertiesExtensionList = new ApplicationNonVisualDrawingPropertiesExtensionList();\n         ApplicationNonVisualDrawingPropertiesExtension appNonVisualDrawingPropertiesExtension = new ApplicationNonVisualDrawingPropertiesExtension() { Uri = \"{DAA4B4D4-6D71-4841-9C94-3DE7FCFB9230}\" };\n\n     P14.Media media = new() { Embed = mediaEmbedId };\n     media.AddNamespaceDeclaration(\"p14\", \"http://schemas.microsoft.com/office/powerpoint/2010/main\");\n\n     appNonVisualDrawingPropertiesExtension.Append(media);\n     appNonVisualDrawingPropertiesExtensionList.Append(appNonVisualDrawingPropertiesExtension);\n     appNonVisualDrawingProperties.Append(appNonVisualDrawingPropertiesExtensionList);\n\n          nonVisualPictureProperties.Append(nonVisualDrawingProperties);\n         nonVisualPictureProperties.Append(nonVisualPictureDrawingProperties);\n     //start here for commenting shit out\n         nonVisualPictureProperties.Append(appNonVisualDrawingProperties);\n\n         //Prepare shape properties to display picture\n         BlipFill blipFill = new BlipFill();\n         A.Blip blip = new A.Blip() { Embed = imgEmbedId };\n     A.Stretch stretch = new A.Stretch();\n     A.FillRectangle fillRectangle = new A.FillRectangle();\n     A.Transform2D transform2D = new A.Transform2D();\n     A.Offset offset = new A.Offset() { X = 4801938, Y = 1960881 };\n     A.Extents extents = new A.Extents() { Cx = 7410381, Cy = 3165566 };\n\n     \n      long arialX = (long)GeoPoserPowerPointFrame.arialX;  // Horizontal position\n     long arialY = (long)GeoPoserPowerPointFrame.arialY;\n\n     A.PresetGeometry presetGeometry = new A.PresetGeometry() { Preset = A.ShapeTypeValues.Rectangle };\n     A.AdjustValueList adjValueList = new A.AdjustValueList();\n\n     stretch.Append(fillRectangle);\n         blipFill.Append(blip);\n         blipFill.Append(stretch);\n         transform2D.Append(offset);\n         transform2D.Append(extents);\n         presetGeometry.Append(adjValueList);\n     P.ShapeProperties pShapeProperties = new P.ShapeProperties();\n\n     ShapeProperties shapeProperties = new ShapeProperties();\n         pShapeProperties.Append(transform2D);\n         pShapeProperties.Append(presetGeometry);\n\n         //adds all elements to the slide's shape tree\n         picture.Append(nonVisualPictureProperties);\n         picture.Append(blipFill);\n         picture.Append(pShapeProperties);\n\n         shapeTree.Append(picture);\n     \n }\n```"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-07-02T03:30:21.7264912Z","RunDurationInMilliseconds":612}