{"Data":{"Sdk":{"Events":[{"Id":"22966552148","Type":"IssuesEvent","CreatedAt":"2022-07-19T20:30:47","Actor":"TrplM","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1181","RelatedDescription":"Closed issue \"Invalid document when `TableColumn.CalculatedColumnFormula` has array formula \" (#1181) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nWhen a `tableColumn` definition contains a `calculatedColumnFormula` that is an array formula (e.g. `<x:calculatedColumnFormula>{A2+A2}</x:calculatedColumnFormula>`) the resulting document (xlsx) is invalid but repairable.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET 6\r\n- DocumentFormat.OpenXml Version: (2.16.0)\r\n- ClosedXML (0.96.0)\r\n\r\n**Repro**\r\n\r\n```csharp\r\nnamespace ClosedXML.Excel.Tests\r\n{\r\n    using ClosedXML.Excel;\r\n    using System.IO;\r\n\r\n    internal class Program\r\n    {\r\n        private const string output_directory = \"test_data\";\r\n\r\n        internal static void Main(string[] args)\r\n        {\r\n            Directory.CreateDirectory(output_directory);\r\n\r\n            not_working();\r\n            working_v1();\r\n            working_v2();\r\n\r\n            //Array formulas in TableColumn.CalculatedColumnFormula generates invalid xlsx file\r\n            static void not_working()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n                ws.Cell(2, 2).FormulaA1 = \"{Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]}\";\r\n                ws.Cell(3, 2).FormulaA1 = \"{Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]}\";\r\n\r\n                using var not_working = File.Create(Path.Join(output_directory, \"not_working.xlsx\"));\r\n\r\n                wb.SaveAs(not_working);\r\n            }\r\n\r\n            static void working_v1()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n               //non-unique table formulas prevents addition of x:calculatedColumnFormula\r\n                ws.Cell(2, 2).FormulaA1 = \"{Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]}\";\r\n                ws.Cell(3, 2).FormulaA1 = \"{Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]}\";\r\n\r\n                using var working_v1 = File.Create(Path.Join(output_directory, \"working_v1.xlsx\"));\r\n\r\n                wb.SaveAs(working_v1);\r\n            }\r\n\r\n            //Normal formulas in TableColumn.CalculatedColumnFormula generates valid xlsx file\r\n            static void working_v2()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n                ws.Cell(2, 2).FormulaA1 = \"Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]\";\r\n                ws.Cell(3, 2).FormulaA1 = \"Table1[[#This Row],[Values]]+Table1[[#This Row],[Values]]\";\r\n\r\n                using var working_v2 = File.Create(Path.Join(output_directory, \"working_v2.xlsx\"));\r\n\r\n                wb.SaveAs(working_v2, validate: true, evaluateFormulae: true);\r\n            }\r\n\r\n            static (IXLWorkbook, IXLWorksheet) create_base_document()\r\n            {\r\n                var wb = new XLWorkbook();\r\n                var ws = wb.Worksheets.Add(\"Test data\");\r\n\r\n                ws.Cell(1, 1).Value = \"Values\";\r\n                ws.Cell(1, 2).Value = \"Sum\";\r\n\r\n                ws.Cell(2, 1).Value = 1;\r\n                ws.Cell(3, 1).Value = 1;\r\n\r\n                ws.Range(\"A1\", \"B3\").CreateTable();\r\n\r\n                return (wb, ws);\r\n            }\r\n        }\r\n    }\r\n}\r\n``` \r\n\r\n**Observed**\r\n\r\nExcel was able to open the file by repairing or removing the unreadable content.\r\n*Removed Records: Table from /xl/tables/table1.xml part (Table)*\r\n\r\n**Expected**\r\n\r\nDocument should be generated without errors\r\n"},{"Id":"22965753460","Type":"IssuesEvent","CreatedAt":"2022-07-19T19:40:45","Actor":"TrplM","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1181","RelatedDescription":"Opened issue \"Invalid document when `TableColumn.CalculatedColumnFormula` has array formula \" (#1181) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n**Description**\r\n\r\nWhen a `tableColumn` definition contains a `calculatedColumnFormula` that is an array formula (e.g. `<x:calculatedColumnFormula>{A2+A2}</x:calculatedColumnFormula>`) the resulting document (xlsx) is invalid but repairable.\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET 6\r\n- DocumentFormat.OpenXml Version: (2.16.0)\r\n- ClosedXML (0.96.0)\r\n\r\n**Repro**\r\n\r\n```csharp\r\nnamespace ClosedXML.Excel.Tests\r\n{\r\n    using ClosedXML.Excel;\r\n    using System.IO;\r\n\r\n    internal class Program\r\n    {\r\n        private const string output_directory = \"test_data\";\r\n\r\n        internal static void Main(string[] args)\r\n        {\r\n            Directory.CreateDirectory(output_directory);\r\n\r\n            not_working();\r\n            working_v1();\r\n            working_v2();\r\n\r\n            //Array formulas in TableColumn.CalculatedColumnFormula generates invalid xlsx file\r\n            static void not_working()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n                ws.Cell(2, 2).FormulaA1 = \"{A2+A2}\";\r\n                ws.Cell(3, 2).FormulaA1 = \"{A3+A3}\";\r\n\r\n                using var not_working = File.OpenWrite(Path.Join(output_directory, \"not_working.xlsx\"));\r\n\r\n                wb.SaveAs(not_working);\r\n            }\r\n\r\n            static void working_v1()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n                ws.Cell(2, 2).FormulaA1 = \"{A2+A2+A2}\"; //non-unique table formulas prevents addition of x:calculatedColumnFormula\r\n                ws.Cell(3, 2).FormulaA1 = \"{A3+A3}\";\r\n\r\n                using var working_v1 = File.OpenWrite(Path.Join(output_directory, \"working_v1.xlsx\"));\r\n\r\n                wb.SaveAs(working_v1);\r\n            }\r\n\r\n            //Normal formulas in TableColumn.CalculatedColumnFormula generates valid xlsx file\r\n            static void working_v2()\r\n            {\r\n                var (wb, ws) = create_base_document();\r\n\r\n                ws.Cell(2, 2).FormulaA1 = \"A2+A2\";\r\n                ws.Cell(3, 2).FormulaA1 = \"A3+A3\";\r\n\r\n                using var working_v2 = File.OpenWrite(Path.Join(output_directory, \"working_v2.xlsx\"));\r\n\r\n                wb.SaveAs(working_v2);\r\n            }\r\n\r\n            static (IXLWorkbook, IXLWorksheet) create_base_document()\r\n            {\r\n                var wb = new XLWorkbook();\r\n                var ws = wb.Worksheets.Add(\"Test data\");\r\n\r\n                ws.Cell(1, 1).Value = \"Values\";\r\n                ws.Cell(2, 1).Value = 1;\r\n                ws.Cell(3, 1).Value = 1;\r\n\r\n                ws.Range(\"A1\", \"B3\").CreateTable();\r\n\r\n                return (wb, ws);\r\n            }\r\n        }\r\n    }\r\n}\r\n``` \r\n\r\n**Observed**\r\n\r\nExcel was able to open the file by repairing or removing the unreadable content.\r\n*Removed Records: Table from /xl/tables/table1.xml part (Table)*\r\n\r\n**Expected**\r\n\r\nDocument should be generated without errors\r\n"},{"Id":"22840910640","Type":"PullRequestEvent","CreatedAt":"2022-07-12T21:45:19","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1180","RelatedDescription":"Opened pull request \"add threaded comment example\" (#1180) at OfficeDev/Open-XML-SDK","RelatedBody":"This commit adds example code for adding a threaded comment to and XLSX document."},{"Id":"22800972656","Type":"IssuesEvent","CreatedAt":"2022-07-11T06:06:34","Actor":"ttnnphuoc","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1179","RelatedDescription":"Opened issue \" OpenXML does not allow special character such as &, \", >, < in hyperlink, it can throw exception when get worksheet instance\" (#1179) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n**Description**\r\n\r\n OpenXML does not allow special character such as &, \", >, < in hyperlink, it can throw exception when get worksheet instance\r\n\r\n**Observed**\r\n\r\n OpenXML does not allow special character such as &, \", >, < in hyperlink, it can throw exception when get worksheet instance\r\n\r\n**Expected**\r\nAllow  special character such \r\n"},{"Id":"22716389362","Type":"PullRequestEvent","CreatedAt":"2022-07-06T02:44:15","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1178","RelatedDescription":"Merged pull request \"Remove IOpenXmlNamespaceResolver from qname\" (#1178) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"22715661654","Type":"PullRequestEvent","CreatedAt":"2022-07-06T01:36:44","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1178","RelatedDescription":"Opened pull request \"Remove IOpenXmlNamespaceResolver from qname\" (#1178) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2022-07-20T03:30:26.8211723Z","RunDurationInMilliseconds":567}