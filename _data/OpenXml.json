{"Data":{"Sdk":{"Events":[{"Id":"31672261394","Type":"IssuesEvent","CreatedAt":"2023-09-07T15:50:02","Actor":"maedula","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1443","RelatedDescription":"Closed issue \"Open XML SDK ZIP local file header is not compliant to ISO/IEC 29500-2. Incorrect \"general purpose bit flag\" settings\" (#1443) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThe currently created XLSX files are not compliant to OpenXML specification ISO/IEC 29500-2. The reason is that in reference to the ZIP Appnote (ZIP File Format Specification Version 6.2.0) and the listed \"Requirements on package implementers\" in chapter B.4 are not met. What I would like to challenge in particular is the set \"General purpose bit flag\" of the ZIP local file header.  The currently used bit flag is utilizing bit 11, which is unsupported. \r\n\r\nFollowing references are hex representations of the XLSX file...\r\nOpenXML SDK used incorrect local file header: 50 4B 03 04 14 00 00 **_08_** 08 00\r\nMicrosoft Excel used correct file header:            50 4B 03 04 14 00 **_06_** 00 08 00\r\n\r\nSo Microsoft Excel by defaults seems to use \"super fast compression\" method by default with bit1 and bit2 toggled.\r\n\r\nWhen using .net framework as a target, the headers are written correctly and thus compliant to ISO/IEC 29500-2.\r\n\r\nCheck out for your reference\r\nhttps://standards.iso.org/ittf/PubliclyAvailableStandards/c077818_ISO_IEC_29500-2_2021(E).zip\r\nhttp://www.pkware.com/documents/APPNOTE/APPNOTE_6.2.0.txt\r\n\r\n**To Reproduce**\r\n```\r\nusing System.IO.Packaging;\r\nusing DocumentFormat.OpenXml;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Spreadsheet;\r\n\r\nCreateSpreadsheetWorkbook(\"C:\\\\Temp\\\\test.xlsx\");\r\n\r\nvoid CreateSpreadsheetWorkbook(string filepath)\r\n{\r\n\t// Create a spreadsheet document by supplying the filepath.\r\n\t// By default, AutoSave = true, Editable = true, and Type = xlsx.\r\n\tSpreadsheetDocument spreadsheetDocument = SpreadsheetDocument.\r\n\t\tCreate(filepath, SpreadsheetDocumentType.Workbook);\r\n\tspreadsheetDocument.CompressionOption = CompressionOption.SuperFast;\r\n\r\n\t// Add a WorkbookPart to the document.\r\n\tWorkbookPart workbookpart = spreadsheetDocument.AddWorkbookPart();\r\n\tworkbookpart.Workbook = new Workbook();\r\n\r\n\t// Add a WorksheetPart to the WorkbookPart.\r\n\tWorksheetPart worksheetPart = workbookpart.AddNewPart<WorksheetPart>();\r\n\tworksheetPart.Worksheet = new Worksheet(new SheetData());\r\n\r\n\t// Add Sheets to the Workbook.\r\n\tSheets sheets = spreadsheetDocument.WorkbookPart!.Workbook.\r\n\t\tAppendChild<Sheets>(new Sheets());\r\n\r\n\t// Append a new worksheet and associate it with the workbook.\r\n\tSheet sheet = new Sheet() { Id = spreadsheetDocument.WorkbookPart.\r\n\t\tGetIdOfPart(worksheetPart), SheetId = 1, Name = \"mySheet\" };\r\n\tsheets.Append(sheet);\r\n\r\n\tworkbookpart.Workbook.Save();\r\n\r\n\t// Close the document.\r\n\tspreadsheetDocument.Dispose();\r\n}\r\n```\r\n\r\nSteps to reproduce the behavior:\r\n1. Create an empty excel spreadsheet and store it in XLSX\r\n2. Check with your favorite HEX file viewer the corresponding local file header\r\n4. See that the general purpose flag is set to a unsupported \"general purpose bit flag\", where bit 11 is toggled\r\n\r\n**Expected behavior**\r\nGive the same correct result for .net Core like for .net framework and thus OpenXML SDK will be compliant to the definitions of ISO_IEC_29500-2. The chosen CompressionOption in the .net code should be correctly considered for the \"general purpose bit flag\".\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows\r\n - Office version 16.0.1398.20008\r\n - .NET Target: .NET Core 6\r\n - DocumentFormat.OpenXml Version: 2.20.0)\r\n"},{"Id":"31625986666","Type":"IssuesEvent","CreatedAt":"2023-09-06T05:25:10","Actor":"sergey-tihon","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1521","RelatedDescription":"Closed issue \"Release 3.0.0-beta3 on NuGet\" (#1521) at dotnet/Open-XML-SDK","RelatedBody":"**Is your feature request related to a problem? Please describe.**\r\nPlease publish all beta versions on NuGet.\r\nIt will help us test out apps and libs against upcoming changes.\r\nAs well as publish beta versions of other libs built on top of Open-XML-SDK.\r\n\r\n**Describe the solution you'd like**\r\nPublish all beta versions on NuGet\r\n\r\n**Describe alternatives you've considered**\r\nAzure blob feeds do not work well for lib authors.\r\n\r\n**Additional context**\r\nAdd any other context or screenshots about the feature request here.\r\n"},{"Id":"31621164190","Type":"IssuesEvent","CreatedAt":"2023-09-05T23:11:27","Actor":"github-actions[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1524","RelatedDescription":"Closed issue \"Manual approval required for workflow run 6090546969: Approval for publishing to Nuget.org\" (#1524) at dotnet/Open-XML-SDK","RelatedBody":"Please approve or deny the deployment to Nuget.org\n\nWorkflow is pending manual review.\nURL: https://github.com/dotnet/Open-XML-SDK/actions/runs/6090546969\n\nRequired approvers: [twsouthwick tomjebo mikeebowen]\n\nRespond \"approved\", \"approve\", \"lgtm\", \"yes\" to continue workflow or \"denied\", \"deny\", \"no\" to cancel."},{"Id":"31620899537","Type":"IssuesEvent","CreatedAt":"2023-09-05T22:50:15","Actor":"github-actions[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1524","RelatedDescription":"Opened issue \"Manual approval required for workflow run 6090546969: Approval for publishing to Nuget.org\" (#1524) at dotnet/Open-XML-SDK","RelatedBody":"Please approve or deny the deployment to Nuget.org\n\nWorkflow is pending manual review.\nURL: https://github.com/dotnet/Open-XML-SDK/actions/runs/6090546969\n\nRequired approvers: [twsouthwick tomjebo mikeebowen]\n\nRespond \"approved\", \"approve\", \"lgtm\", \"yes\" to continue workflow or \"denied\", \"deny\", \"no\" to cancel."},{"Id":"31620738079","Type":"PullRequestEvent","CreatedAt":"2023-09-05T22:37:38","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1523","RelatedDescription":"Merged pull request \"Update release.yml\" (#1523) at dotnet/Open-XML-SDK","RelatedBody":"add shell: pwsh, so release to nuget knows which shell to use"},{"Id":"31617740092","Type":"PullRequestEvent","CreatedAt":"2023-09-05T19:52:16","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1523","RelatedDescription":"Opened pull request \"Update release.yml\" (#1523) at dotnet/Open-XML-SDK","RelatedBody":"add shell: pwsh, so release to nuget knows which shell to use"},{"Id":"31612777130","Type":"IssuesEvent","CreatedAt":"2023-09-05T16:01:37","Actor":"github-actions[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1522","RelatedDescription":"Closed issue \"Manual approval required for workflow run 6086613320: Approval for publishing to Nuget.org\" (#1522) at dotnet/Open-XML-SDK","RelatedBody":"Please approve or deny the deployment to Nuget.org\n\nWorkflow is pending manual review.\nURL: https://github.com/dotnet/Open-XML-SDK/actions/runs/6086613320\n\nRequired approvers: [twsouthwick tomjebo mikeebowen]\n\nRespond \"approved\", \"approve\", \"lgtm\", \"yes\" to continue workflow or \"denied\", \"deny\", \"no\" to cancel."},{"Id":"31611658221","Type":"IssuesEvent","CreatedAt":"2023-09-05T15:21:22","Actor":"github-actions[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1522","RelatedDescription":"Opened issue \"Manual approval required for workflow run 6086613320: Approval for publishing to Nuget.org\" (#1522) at dotnet/Open-XML-SDK","RelatedBody":"Please approve or deny the deployment to Nuget.org\n\nWorkflow is pending manual review.\nURL: https://github.com/dotnet/Open-XML-SDK/actions/runs/6086613320\n\nRequired approvers: [twsouthwick tomjebo mikeebowen]\n\nRespond \"approved\", \"approve\", \"lgtm\", \"yes\" to continue workflow or \"denied\", \"deny\", \"no\" to cancel."}],"ResultType":"GitHubEvent"}},"RunOn":"2023-09-11T03:30:24.2766398Z","RunDurationInMilliseconds":655}