{"Data":{"Sdk":{"Events":[{"Id":"14945793691","Type":"IssuesEvent","CreatedAt":"2021-01-26T05:07:48","Actor":"wtujvk","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/863","RelatedDescription":"Opened issue \"This document is missing a relationship\" (#863) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library  2.11.3\r\n- [x] Question on library usage\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\nThis document is missing a relationship，say \"数据包中不存在指定部件\"， how to skip error or provide callback function ?\r\nPlease provide a simple description of the issue encountered.\r\n\r\n**Information**\r\n\r\n- .NET Target: (net461)\r\n- DocumentFormat.OpenXml Version: (2.11.3)\r\n\r\n**Repro**\r\n\r\n```csharp\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n``` \r\n\r\nWhen I unzip the docx file, on the path \" word\\_rels\\document.xml.rels\", I found  \"Target=\"../NULL\"/\"\r\nAre there any where to skip error relationship or delete error relationship ?\r\nI use RemoveMalformedHyperlinksRelationshipErrorHandler to solve， but It not work.\r\n![image](https://user-images.githubusercontent.com/17868266/105802835-f3a13300-5fd6-11eb-8dd8-f8c6662d7e9d.png)\r\n\r\n**Observed**\r\n\r\nPlease add your observed behavior here\r\nSkip error or fix document.\r\n**Expected**\r\n\r\nPlease add your expected behavior here.\r\n"},{"Id":"14945661200","Type":"PullRequestEvent","CreatedAt":"2021-01-26T04:44:41","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/862","RelatedDescription":"Opened pull request \"Enable nullable reference types in OpenXmlPackage and subclasses\" (#862) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"14945338972","Type":"PullRequestEvent","CreatedAt":"2021-01-26T03:47:45","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/861","RelatedDescription":"Merged pull request \"Enable nullable types on OpenXmlDomReader\" (#861) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"14945042168","Type":"PullRequestEvent","CreatedAt":"2021-01-26T03:00:18","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/861","RelatedDescription":"Opened pull request \"Enable nullable types on OpenXmlDomReader\" (#861) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"14943754457","Type":"PullRequestEvent","CreatedAt":"2021-01-25T23:46:03","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/860","RelatedDescription":"Merged pull request \"Update README for reader updates\" (#860) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"14943753686","Type":"PullRequestEvent","CreatedAt":"2021-01-25T23:45:56","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/860","RelatedDescription":"Opened pull request \"Update README for reader updates\" (#860) at OfficeDev/Open-XML-SDK","RelatedBody":""},{"Id":"14930739604","Type":"IssuesEvent","CreatedAt":"2021-01-25T03:50:27","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/858","RelatedDescription":"Closed issue \"数据包中不存在指定部件\" (#858) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n数据包中不存在指定部件\r\n\r\nTranslation: The specified part does not exist in the packet\r\n\r\n File.Stream -> MemoryStream\r\n调用  WordprocessingDocument.Open(memoryStream, true)\r\n\r\n**Information**\r\n\r\n- .NET Target: (NET Frameworknet461)\r\n- DocumentFormat.OpenXml Version: (2.11.3)\r\n\r\n**Repro**\r\n\r\n```csharp\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n``` \r\n\r\n**Observed**\r\n\r\n在 System.IO.Packaging.Package.GetPart(Uri partUri)\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPart.Load(OpenXmlPackage openXmlPackage, OpenXmlPart parent, Uri uriTarget, String id, Dictionary`2 loadedParts)\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(OpenXmlPackage openXmlPackage, OpenXmlPart sourcePart, RelationshipCollection relationshipCollection, Dictionary`2 loadedParts)\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPart.Load(OpenXmlPackage openXmlPackage, OpenXmlPart parent, Uri uriTarget, String id, Dictionary`2 loadedParts)\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(OpenXmlPackage openXmlPackage, OpenXmlPart sourcePart, RelationshipCollection relationshipCollection, Dictionary`2 loadedParts)\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Load()\r\n   在 DocumentFormat.OpenXml.Packaging.OpenXmlPackage.OpenCore(Stream stream, Boolean readWriteMode)\r\n   在 DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open(Stream stream, Boolean isEditable, OpenSettings openSettings)\r\n   在 DocumentFormat.OpenXml.Packaging.WordprocessingDocument.Open(Stream stream, Boolean isEditable)\r\n\r\n\r\n**Expected**\r\n\r\nPlease add your expected behavior here.\r\n"},{"Id":"14918429565","Type":"IssuesEvent","CreatedAt":"2021-01-22T21:40:37","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/848","RelatedDescription":"Closed issue \"Lost whitespace in power point\" (#848) at OfficeDev/Open-XML-SDK","RelatedBody":"Hi,\r\nI encountered the following issue using the OpenXML SDK\r\n\r\n**Description**\r\nI am reading in a simple pptx file (see the resource in the repro section) using the OpenXML SDK (code provided in the repro section).\r\nFirst opening the file and then reading the slide part with the OpenXMLReader.\r\nThe text element containing only white spaces is trimmed and after reading contains no characters.\r\nThis behaviour destroys the layout of manually indented content if the file would be saved after reading it.\r\n\r\nSimilar reports:\r\nhttps://stackoverflow.com/questions/6106044/missing-whitespace-within-pptx-paragraphs-using-openxmlsdk?rq=1\r\nhttps://stackoverflow.com/questions/7153387/powerpoint-openxml-whitespace-is-disappearing?rq=1\r\n\r\n**Information**\r\n\r\n- .NET Target: .NET Core\r\n- DocumentFormat.OpenXml Version: 2.11.3\r\n\r\n**Repro**\r\nI have created a small example using an example pptx file with one slide\r\nhttps://github.com/lklein53/openxmlsdk-whitespace\r\n\r\n**Observed**\r\n\r\nThe xml reader used internally is configured to ignore insignificant whitespaces which results in the removal of the whitespaces in the text element. I haven't seen the possibility to change that behaviour. For word documents there is the xml:space=preserve attribute added to such text nodes which seems to be not the case for power point files. \r\n\r\n**Expected**\r\n\r\nIt would be nice if it would be possible to configure the current behaviour to explicitly keep insignificant whitespaces if that is desired by the user of the SDK. I could implement this functionality if you think it should be added.\r\n\r\nPlease let me know if I am using the OpenXMLReader wrong and there is another way to read in the slide part.\r\n\r\nThanks for your help and kind regards,\r\nLars\r\n\r\n(edit by @twsouthwick)\r\n\r\n```csharp\r\nusing System;\r\nusing System.Linq;\r\nusing System.Reflection;\r\nusing DocumentFormat.OpenXml;\r\nusing DocumentFormat.OpenXml.Drawing;\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing Xunit;\r\nusing Path = System.IO.Path;\r\n\r\nnamespace TestProject1 {\r\npublic class UnitTest1 {\r\n  [Fact]\r\n  public void Test1() {\r\n    const string fileName = \"Resources/example.pptx\";\r\n    var path = Path.Combine(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location) ?? throw new InvalidOperationException(), fileName);\r\n    using var doc = PresentationDocument.Open(path, false);\r\n    var slide = doc.PresentationPart.SlideParts.First();\r\n    var reader = OpenXmlReader.Create(slide);\r\n    reader.Read();\r\n    var element = reader.LoadCurrentElement();\r\n    var text = element.Descendants<Text>().First();\r\n    Assert.Equal(\" \", text.Text);\r\n  }\r\n}\r\n}\r\n```"},{"Id":"14918406615","Type":"PullRequestEvent","CreatedAt":"2021-01-22T21:37:50","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/857","RelatedDescription":"Merged pull request \"Openxmlreader ignorews option\" (#857) at OfficeDev/Open-XML-SDK","RelatedBody":"Changes discussed in #848 @twsouthwick "},{"Id":"14918224530","Type":"PullRequestEvent","CreatedAt":"2021-01-22T21:17:05","Actor":"twsouthwick","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/859","RelatedDescription":"Merged pull request \"Enable nullable annotations for OpenXmlAttribute\" (#859) at OfficeDev/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"},"PowerTools":{"Events":[],"ResultType":"GitHubEvent"}},"RunOn":"2021-01-26T05:30:39.2165046Z","RunDurationInMilliseconds":738}