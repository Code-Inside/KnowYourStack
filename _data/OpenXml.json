{"Data":{"Sdk":{"Events":[{"Id":"44078376904","Type":"IssuesEvent","CreatedAt":"2024-11-22T00:16:17","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1745","RelatedDescription":"Closed issue \"Bug with Open XML SDK v3.0.2 - Exception in AddWorkbookPart Method\" (#1745) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nWith v3.0.2 AddWorkbookPart method is throwing exception - The specified package is invalid. The main part is missing.\r\n\r\nRefer attached file ([EmptyExcel.xlsx](https://github.com/user-attachments/files/16085950/EmptyExcel.xlsx)) to be used with below sample code.\r\n```\r\nusing (SpreadsheetDocument document = SpreadsheetDocument.Open($\"EmptyExcel.xlsx\", true))\r\n {\r\n     if (document.WorkbookPart != null)\r\n     {\r\n         document.DeletePart(document.WorkbookPart);\r\n     }\r\n\r\n     /*** below line throws error ***/\r\n     var workbookPart = document.AddWorkbookPart();\r\n     workbookPart.Workbook.Save();\r\n }\r\n```\r\n\r\n**Observed behavior**\r\nException - The specified package is invalid. The main part is missing. **Kindly note that same is working with v2.20.0.**\r\n\r\n**Expected behavior**\r\nIt should add workbook part instead of throwing exception.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows\r\n - Office version: e.g. 16.0.17531.20190\r\n - .NET Target: .NET Framework 4.8\r\n - DocumentFormat.OpenXml Version: 3.0.2\r\n\r\n**Debug Info**\r\nAdding below line post delete part call resolves issue\r\n\r\n`document.ChangeDocumentType(SpreadsheetDocumentType.Workbook);`"},{"Id":"44078376829","Type":"IssuesEvent","CreatedAt":"2024-11-22T00:16:17","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1745","RelatedDescription":"Closed issue \"Bug with Open XML SDK v3.0.2 - Exception in AddWorkbookPart Method\" (#1745) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nWith v3.0.2 AddWorkbookPart method is throwing exception - The specified package is invalid. The main part is missing.\r\n\r\nRefer attached file ([EmptyExcel.xlsx](https://github.com/user-attachments/files/16085950/EmptyExcel.xlsx)) to be used with below sample code.\r\n```\r\nusing (SpreadsheetDocument document = SpreadsheetDocument.Open($\"EmptyExcel.xlsx\", true))\r\n {\r\n     if (document.WorkbookPart != null)\r\n     {\r\n         document.DeletePart(document.WorkbookPart);\r\n     }\r\n\r\n     /*** below line throws error ***/\r\n     var workbookPart = document.AddWorkbookPart();\r\n     workbookPart.Workbook.Save();\r\n }\r\n```\r\n\r\n**Observed behavior**\r\nException - The specified package is invalid. The main part is missing. **Kindly note that same is working with v2.20.0.**\r\n\r\n**Expected behavior**\r\nIt should add workbook part instead of throwing exception.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows\r\n - Office version: e.g. 16.0.17531.20190\r\n - .NET Target: .NET Framework 4.8\r\n - DocumentFormat.OpenXml Version: 3.0.2\r\n\r\n**Debug Info**\r\nAdding below line post delete part call resolves issue\r\n\r\n`document.ChangeDocumentType(SpreadsheetDocumentType.Workbook);`"},{"Id":"44078376597","Type":"PullRequestEvent","CreatedAt":"2024-11-22T00:16:16","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1836","RelatedDescription":"Merged pull request \"Use default document type if no main part is available\" (#1836) at dotnet/Open-XML-SDK","RelatedBody":"Fixes #1745\n"},{"Id":"44035646007","Type":"PullRequestEvent","CreatedAt":"2024-11-20T23:44:24","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1834","RelatedDescription":"Merged pull request \"Move version for genapi to central package version\" (#1834) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"44035638894","Type":"PullRequestEvent","CreatedAt":"2024-11-20T23:44:01","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1835","RelatedDescription":"Merged pull request \"Use Artifacts output for builds\" (#1835) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"44034220756","Type":"PullRequestEvent","CreatedAt":"2024-11-20T22:37:25","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1836","RelatedDescription":"Opened pull request \"Use default document type if no main part is available\" (#1836) at dotnet/Open-XML-SDK","RelatedBody":"Fixes #1745\n"},{"Id":"44032851868","Type":"PullRequestEvent","CreatedAt":"2024-11-20T21:40:37","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1835","RelatedDescription":"Opened pull request \"Use Artifacts output for builds\" (#1835) at dotnet/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2024-11-23T03:30:21.3785057Z","RunDurationInMilliseconds":814}