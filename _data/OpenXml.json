{"Data":{"Sdk":{"Events":[{"Id":"21516351913","Type":"IssuesEvent","CreatedAt":"2022-04-28T10:13:43","Actor":"caglarsarikaya","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1143","RelatedDescription":"Closed issue \"Price Reading From xlsx file\" (#1143) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [x] Question on library usage\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\n\r\nI am uploading some products in excel, There are only two columns one is name other is price. I have read rows from excel as you suggested, also I added a method reading with cell index because when a cell is null, it was sliding. \r\n\r\nI keep the inner text from the cell if the cell has a datatype\r\n\r\n`    \r\nstring value = cell?.InnerText;\r\n\r\ncase CellValues.SharedString:\r\n               value = stringTablePart.SharedStringTable.ChildElements[Int32.Parse(value)].InnerText?.Trim();\r\n               break;\r\n\r\nreturn value;\r\n`\r\n I get the value like that, everything is ok except price. It changes the signs. firstly removes all dots, then replaces the comma to dot \r\nex1. value from excel 1.200.000,50 -> reads like 12000000.5\r\n\r\nso dot and comma comes from culture number seperator settings, culture and cultureUI and current thread culture and ui set as tr-TR because tr culture has . for group seperator and comma for decimal seperator. \r\n\r\nWhy is this excel reading like that?\r\n\r\n**Information**\r\n\r\n- .NET Target: (.Net 5)\r\n- DocumentFormat.OpenXml Version: (ie 2.13.0)\r\n\r\n**Repro**\r\n\r\n```csharp\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n``` \r\n\r\n**Observed**\r\n\r\nvalue saved in excel 1.500,70\r\nread like 1500.7\r\n\r\n**Expected**\r\n\r\nit should read the same as how is written. Because the convert working with culture settings, this is a string value and I will parse this to decimal. (1500.7) this is converted as (15007) because . is group separetor.\r\n\r\nPlease add your expected behavior here.\r\n"},{"Id":"21442557672","Type":"IssuesEvent","CreatedAt":"2022-04-24T23:32:37","Actor":"pulmuone","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1145","RelatedDescription":"Opened issue \"write error\" (#1145) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [v] Issue with the OpenXml library\r\n- [ ] Question on library usage\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\nError Message :\r\n\r\nSystem.ArgumentException: '', hexadecimal value 0x1D, is an invalid character.\r\n\r\nDocumentFormat.OpenXml Version 2.16.0\r\n\r\nXamarin \r\n"},{"Id":"21426521473","Type":"PullRequestEvent","CreatedAt":"2022-04-22T22:19:14","Actor":"mikeebowen","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/pull/1144","RelatedDescription":"Opened pull request \"Update SDK to Follow Microsoft Releasing Open Source guidelines\" (#1144) at OfficeDev/Open-XML-SDK","RelatedBody":"This commit adds missing files and information to comply with the [Microsoft guidelines for releasing open source](https://docs.opensource.microsoft.com/releasing/)"},{"Id":"21415864269","Type":"IssuesEvent","CreatedAt":"2022-04-22T10:45:21","Actor":"caglarsarikaya","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1143","RelatedDescription":"Opened issue \"Price Reading From xlsx file\" (#1143) at OfficeDev/Open-XML-SDK","RelatedBody":"# Before submitting an issue, please fill this out\r\n\r\nIs this a:\r\n- [x] Issue with the OpenXml library\r\n- [x] Question on library usage\r\n\r\nIf you have answered that this is a question, please ask it on StackOverflow instead of here.\r\nThis issue tracker is meant to track product issues while StackOverflow excels at answering questions\r\n\r\n---------------- Remove this line and above before posting ----------------\r\n\r\n**Description**\r\n\r\nI am uploading some products in excel, There are only two columns one is name other is price. I have read rows from excel as you suggested, also I added a method reading with cell index because when a cell is null, it was sliding. \r\n\r\nI keep the inner text from the cell if the cell has a datatype\r\n\r\n`    \r\nstring value = cell?.InnerText;\r\n\r\ncase CellValues.SharedString:\r\n               value = stringTablePart.SharedStringTable.ChildElements[Int32.Parse(value)].InnerText?.Trim();\r\n               break;\r\n\r\nreturn value;\r\n`\r\n I get the value like that, everything is ok except price. It changes the signs. firstly removes all dots, then replaces the comma to dot \r\nex1. value from excel 1.200.000,50 -> reads like 12000000.5\r\n\r\nso dot and comma comes from culture number seperator settings, culture and cultureUI and current thread culture and ui set as tr-TR because tr culture has . for group seperator and comma for decimal seperator. \r\n\r\nWhy is this excel reading like that?\r\n\r\n**Information**\r\n\r\n- .NET Target: (.Net 5)\r\n- DocumentFormat.OpenXml Version: (ie 2.13.0)\r\n\r\n**Repro**\r\n\r\n```csharp\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n``` \r\n\r\n**Observed**\r\n\r\nvalue saved in excel 1.500,70\r\nread like 1500.7\r\n\r\n**Expected**\r\n\r\nit should read the same as how is written. Because the convert working with culture settings, this is a string value and I will parse this to decimal. (1500.7) this is converted as (15007) because . is group separetor.\r\n\r\nPlease add your expected behavior here.\r\n"},{"Id":"21392314215","Type":"IssuesEvent","CreatedAt":"2022-04-21T08:21:48","Actor":"Asbjoedt","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1142","RelatedDescription":"Opened issue \"Strict Files Have Invalid int32 Data Types\" (#1142) at OfficeDev/Open-XML-SDK","RelatedBody":"**Description**\r\n\r\nExcel files saved as \"Strict Open XML\" contain a number of int32 validation errors related to hidden percentage values in the schema.\r\n\r\nFor context of this error see: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\nFor possible explanation: \r\n\"In ISO 29500-1 20.1.8.36 gs (Gradient stops) the pos attribute is defined:\r\nSpecifies where this gradient stop should appear in the color band. This position is specified in the range [0%, 100%], which corresponds to the beginning and the end of the color band respectively.\r\n\r\nSo, the SDK's validation (the CLI uses the SDK to get the validation errors) is wrong, but that means the issue is with the SDK and not the validator CLI.\"\r\n\r\n**Information**\r\n\r\n- .NET Target: (ie .NET Framework, .NET Core, UWP, Xamarin, etc)\r\n- DocumentFormat.OpenXml Version: (ie 2.7.2)\r\n\r\n**Repro**\r\n\r\nUse OOXML Validator 1.1 to reproduce the validation errors on any generic Excel spreadsheet you save as \"Strict Open XML\".\r\n\r\nLink to OOXML Validator 1.1: https://github.com/mikeebowen/OOXML-Validator\r\n\r\nSee this issue for an Excel test file, that you can use to reproduce the errors with: https://github.com/mikeebowen/OOXML-Validator/issues/6\r\n\r\n**Observed**\r\n\r\nThe following errors in XML are created by OOXML Validator. The creator of OOXML Validator ahve informed me the validation errors stem from a bug in the SDK and have advised me to post the issue here.\r\n\r\nSee the XML log below.\r\n\r\n<ValidationErrorInfoList FilePath=\"C:\\db\\_Testdata\\Regneark\\Excel-testkorpus\\Book1.xlsx\" IsStrict=\"true\"> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '90%'. The string '90%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '130%'. The string '130%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '98%'. The string '98%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '150%'. The string '150%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '93%'. The string '93%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '170%'. The string '170%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '95%'. The string '95%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '63%'. The string '63%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'lim' has invalid value '800%'. The string '800%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '78%'. The string '78%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '120%'. The string '120%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '99%'. The string '99%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '94%'. The string '94%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '102%'. The string '102%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '100%'. The string '100%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '81%'. The string '81%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '109%'. The string '109%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '50%'. The string '50%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '73%'. The string '73%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '103%'. The string '103%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'pos' has invalid value '0%'. The string '0%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '67%'. The string '67%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '105%'. The string '105%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> <ValidationErrorInfo> <Description>The attribute 'val' has invalid value '110%'. The string '110%' is not a valid 'Int32' value.</Description> <Path>DocumentFormat.OpenXml.XmlPath</Path> <Id>Sch_AttributeValueDataTypeDetailed</Id> <ErrorType>Schema</ErrorType> </ValidationErrorInfo> </ValidationErrorInfoList>\r\n\r\n**Expected**\r\n\r\nThere should be no int32 validation errors when Excel saves spreadsheets in \"Strict Open XML\" file format.\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2022-04-29T03:30:25.3482799Z","RunDurationInMilliseconds":523}