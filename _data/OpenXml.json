{"Data":{"Sdk":{"Events":[{"Id":"29013339178","Type":"PullRequestEvent","CreatedAt":"2023-05-11T21:19:07","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1429","RelatedDescription":"Opened pull request \"Convert OpenXmlElementList to be a struct\" (#1429) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"29012563311","Type":"PullRequestEvent","CreatedAt":"2023-05-11T20:39:11","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1421","RelatedDescription":"Merged pull request \"Use fluent syntax with FlatOpc creation\" (#1421) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"28982526656","Type":"IssuesEvent","CreatedAt":"2023-05-10T18:58:48","Actor":"FabioZumbi12","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1428","RelatedDescription":"Opened issue \"Method not found w/ System.IO.Packaging version 7.0.0\" (#1428) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nHaving an error when using with System.IO.Packaging 7.0.0\r\n\r\n```\r\nSystem.MissingMethodException\r\n  HResult=0x80131513\r\n  Message=Método não encontrado: 'System.IO.Packaging.PackageProperties DocumentFormat.OpenXml.Packaging.OpenXmlPackage.get_PackageProperties()'.\r\n```\r\n\r\nDowngraded to System.IO.Packaging 6.0.0 and works as spected\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**To Reproduce**\r\nOn init the var\r\n```c#\r\nvar wb = new XLWorkbook(file.InputStream);\r\n```\r\n\r\nSteps to reproduce the behavior:\r\n1. Go to '...'\r\n2. Click on '....'\r\n3. Scroll down to '....'\r\n4. See error\r\n\r\n**Observed behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Expected behavior**\r\nImport the XLS from inputstream\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: W11\r\n - Office version: NA\r\n - .NET Target: .NET Framework 4.6.1\r\n - DocumentFormat.OpenXml Version: 2.20.0 w/ System.IO.Packaging 7.0.0\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n"},{"Id":"28910240626","Type":"IssuesEvent","CreatedAt":"2023-05-08T07:23:20","Actor":"MarcusCoding","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1423","RelatedDescription":"Closed issue \"Word document not readable content after adding image\" (#1423) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nAfter adding an image to an word document using open xml sdk 2.7.1,\r\nthe user can't use the document because it has \"unreadable content\".\r\nWithout adding an image and only changing text, no error occurs.\r\nThe code to add the image is from the microsoft example.\r\n(https://learn.microsoft.com/en-us/office/open-xml/how-to-insert-a-picture-into-a-word-processing-document)\r\n\r\nI already tried using the open xml sdk 2.5 productivity tool, but it shows 35 errors.\r\nEven after saving it as a normal document (clicking yes in the document on the error dialog),\r\n the tool shows 35 errors.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n![image](https://user-images.githubusercontent.com/61208946/235175121-5faf1e63-8a51-40db-b8c9-7520d2c37454.png)\r\n![image](https://user-images.githubusercontent.com/61208946/235175179-be6904bb-ebb4-4f7e-90d1-e9719d4d7d64.png)\r\n\r\n\r\n**To Reproduce**\r\n```\r\n using (WordprocessingDocument document = WordprocessingDocument.Open(@\"C:\\PROJEKTE\\KUNDEN_REPOS\\kiepe\\OPEN_XML\\Servicebericht23.docx\", true))\r\n                {\r\n                    var elementsBody = document.MainDocumentPart.Document.Body;\r\n\r\n                    Table table = document.MainDocumentPart.Document.Body.Elements<Table>().ElementAt(1);\r\n                    var tableRow = table.Elements<DocumentFormat.OpenXml.Wordprocessing.TableRow>().ElementAt(1);\r\n                    DocumentFormat.OpenXml.Wordprocessing.TableCell c = tableRow.Elements<DocumentFormat.OpenXml.Wordprocessing.TableCell>().ElementAt(0);\r\n                    c.RemoveAllChildren();\r\n\r\n                    var mainPart = document.MainDocumentPart;\r\n                    ImagePart imagePart = mainPart.AddImagePart(ImagePartType.Png);\r\n\r\n                    using (FileStream stream = new FileStream(@\"C:\\Users\\voigt\\Pictures\\CloseIcon.png\", FileMode.Open))\r\n                    {\r\n                        imagePart.FeedData(stream);\r\n                    }\r\n\r\n                    AddImageToCell(c, mainPart.GetIdOfPart(imagePart), 2638425L, 1758950L, 2638623L, 1759082L, 1, $\"Bild_1.png\");\r\n\r\n                    document.Save();\r\n                    document.Close();\r\n}\r\n\r\n     private static void AddImageToCell(DocumentFormat.OpenXml.Wordprocessing.TableCell cell, string relationshipId)\r\n        {\r\n            var element = new DocumentFormat.OpenXml.Wordprocessing.Drawing(\r\n              new DW.Inline(\r\n                  new DW.Extent()\r\n                  {\r\n                      Cx = 2638425L,\r\n                      Cy = 628650L\r\n                  },\r\n                  new DW.EffectExtent() { LeftEdge = 0L, TopEdge = 0L, RightEdge = 0L, BottomEdge = 6350L },\r\n                  new DW.DocProperties() { Id = 2U, Name = \"Picture 1\" },\r\n                  new DW.NonVisualGraphicFrameDrawingProperties(new A.GraphicFrameLocks() { NoChangeAspect = true, NoResize = false, NoSelection = false }),\r\n                  new A.Graphic(new A.GraphicData(new PIC.Picture(\r\n                              new PIC.NonVisualPictureProperties(\r\n                                  new PIC.NonVisualDrawingProperties()\r\n                                  {\r\n                                      Id = 1U,\r\n                                      Name = \"image.png\"\r\n                                  },\r\n                                  new PIC.NonVisualPictureDrawingProperties()),\r\n                              new PIC.BlipFill(\r\n                                  new A.Blip(\r\n                                      new A.BlipExtensionList(\r\n                                          new A.BlipExtension()\r\n                                          {\r\n                                              Uri = \"{28A0092B-C50C-407E-A947-70E740481C1C}\"\r\n                                          }))\r\n                                  {\r\n                                      Embed = relationshipId,\r\n                                      CompressionState = A.BlipCompressionValues.Print\r\n                                  },\r\n                                  new A.Stretch(new A.FillRectangle())),\r\n                              new PIC.ShapeProperties(\r\n                                  new A.Transform2D(new A.Offset() { X = 0L, Y = 0L }, new A.Extents() { Cx = 2638631L, Cy = 628699L }),\r\n                                  new A.PresetGeometry(new A.AdjustValueList()) { Preset = A.ShapeTypeValues.Rectangle })))\r\n                  {\r\n                      Uri = \"http://schemas.openxmlformats.org/drawingml/2006/picture\"\r\n                  }))\r\n              {\r\n                  DistanceFromTop = 0U,\r\n                  DistanceFromBottom = 0U,\r\n                  DistanceFromLeft = 0U,\r\n                  DistanceFromRight = 0U,\r\n                  EditId = \"50D07946\"\r\n              });\r\n\r\n            cell.Append(new DocumentFormat.OpenXml.Wordprocessing.Paragraph(new DocumentFormat.OpenXml.Wordprocessing.Run(element)));\r\n        }\r\n\r\n```\r\n\r\nSteps to reproduce the behavior:\r\n1. Open document \"Servicebericht23.docx\" using open xml sdk\r\n2. get the second table (index 1)\r\n3. get the second row\r\n4. remove all children\r\n5. add an image (png)\r\n6. save the document\r\n\r\n**Observed behavior**\r\nThe document has no readable content and shows an error to the user.\r\n\r\n**Expected behavior**\r\nThe document can be opened without error.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 Pro 22H2\r\n - Office version: Microsoft® Word für Microsoft 365 MSO (Version 2303 Build 16.0.16227.20202) 64 Bit \r\n - .NET Target: NET Framework 4.6.2 / console application\r\n - DocumentFormat.OpenXml Version: 2.7.1 \r\n\r\n**Additional context**\r\n[Servicebericht23.docx](https://github.com/dotnet/Open-XML-SDK/files/11354511/Servicebericht23.docx)\r\n"},{"Id":"28833660713","Type":"IssuesEvent","CreatedAt":"2023-05-03T22:20:44","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1400","RelatedDescription":"Closed issue \"Need to be able to add relationships, etc without using Package\" (#1400) at dotnet/Open-XML-SDK","RelatedBody":"              How do I do this now that `Package` is `Obsolete`?\r\n```cs\r\nvar newId = (uint)(spreadsheetDocument.Package.GetRelationships().Count() + 1);\r\nvar rId   = \"relId\" + newId;\r\n\r\n...\r\n\r\nspreadsheetDocument.Package.CreateRelationship(uri,\r\n                                               TargetMode.Internal,\r\n                                               \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\r\n                                               rId);\r\n```\r\n\r\nIt would be nice if the `Obsolete` message pointed us in the right direction. I'm rolling back to `2.19.0` for now.\r\n\r\n_Originally posted by @michaelcsikos in https://github.com/dotnet/Open-XML-SDK/issues/1295#issuecomment-1506581653_\r\n            "},{"Id":"28833660421","Type":"PullRequestEvent","CreatedAt":"2023-05-03T22:20:42","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1426","RelatedDescription":"Merged pull request \"Expose IPackage and related APIs\" (#1426) at dotnet/Open-XML-SDK","RelatedBody":"This will enable users to retrieve the underlying package, but it is marked as experimental using obsolete. If using a newer compiler, this may be suppressed with the associated diagnostic id, otherwise, it will just show up as obsoleted APIs with the message.\r\n\r\nFixes #1400 "},{"Id":"28828459410","Type":"PullRequestEvent","CreatedAt":"2023-05-03T17:54:05","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1426","RelatedDescription":"Opened pull request \"Expose IPackage and related APIs\" (#1426) at dotnet/Open-XML-SDK","RelatedBody":"This will enable users to retrieve the underlying package, but it is marked as experimental using obsolete. If using a newer compiler, this may be suppressed with the associated diagnostic id, otherwise, it will just show up as obsoleted APIs with the message.\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2023-05-12T03:30:25.2433657Z","RunDurationInMilliseconds":731}