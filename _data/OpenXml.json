{"Data":{"Sdk":{"Events":[{"Id":"36419049666","Type":"IssuesEvent","CreatedAt":"2024-03-11T03:23:21","Actor":"NiranjanGodboleMaersk","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1688","RelatedDescription":"Opened issue \"Unable to read cells with % symbol\" (#1688) at dotnet/Open-XML-SDK","RelatedBody":"I am working on Net core with Open XML. In my excel there is value 100%. I am trying to read as below\r\n\r\nGetCellValue method\r\n\r\n```\r\npublic static string GetCellValue(SpreadsheetDocument doc, Cell cell)\r\n{\r\n    if (cell.CellValue != null)\r\n    {\r\n        string value = cell.CellValue.InnerText;\r\n        if (cell.DataType != null && cell.DataType.Value == CellValues.SharedString)\r\n        {\r\n            return doc.WorkbookPart.SharedStringTablePart.SharedStringTable.ChildElements.ElementAt(int.Parse(value)).InnerText;\r\n        }\r\n        else\r\n        {\r\n            return value;\r\n        }\r\n    }\r\n    return string.Empty;\r\n}\r\n```\r\n\r\nGetCell method\r\n\r\n```\r\npublic static Cell GetCell(Worksheet worksheet, string columnName, uint rowIndex)\r\n {\r\n     Row row = worksheet.GetFirstChild<SheetData>().Elements<Row>().FirstOrDefault(r => r.RowIndex == rowIndex);\r\n\r\n     if (row != null)\r\n     {\r\n         return row.Elements<Cell>().FirstOrDefault(c => string.Compare(c.CellReference.Value, columnName + rowIndex, true) == 0);\r\n     }\r\n     return null;\r\n }\r\n```\r\n\r\nI am reading as below.\r\n\r\nvar data = OpenXmlReader.GetCellValue(spreadsheetDocument, OpenXmlReader.GetCell(workSheet, \"E\", 11));\r\n\r\nThe data is coming as 1 whereas actual value in my excel is 100%. I am not sure why this is not properly reading. Can someone please help me? Any help would be appreciated. Thanks\r\n\r\n"},{"Id":"36289508599","Type":"PullRequestEvent","CreatedAt":"2024-03-06T08:40:10","Actor":"chacha21","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1686","RelatedDescription":"Opened pull request \"fixed meta-code generation for non-english host build context\" (#1686) at dotnet/Open-XML-SDK","RelatedBody":"Meta-code generation assumes a dot as decimal point, which is not the case in French, for instance. If the host build context is using a french locale, the project could not be built.\r\n\r\nAdding a few `System.Globalization.CultureInfo.InvariantCulture` fixes the problem.\r\n\r\n#1657"},{"Id":"36283870734","Type":"IssuesEvent","CreatedAt":"2024-03-06T04:20:45","Actor":"ChigurupatiAjay","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1685","RelatedDescription":"Opened issue \"Excel with Comments is not working with Open XML SDK\" (#1685) at dotnet/Open-XML-SDK","RelatedBody":"0\r\n\r\nWe are trying to export excel with comments using Open Xml. I have tried with below code snippet and its showing comments in the Sheet Object but when exported to excel the comments are not displaying in the cells after opening excel.\r\n\r\n```\r\n#public byte[] ExportJsonDatatoExcelWithComments()\r\n{\r\n\r\n    MemoryStream memoryStream = new MemoryStream();\r\n    SpreadsheetDocument spreadsheet = SpreadsheetDocument.Create(memoryStream, DocumentFormat.OpenXml.SpreadsheetDocumentType.Workbook);\r\n    WorkbookPart workbookPart = spreadsheet.AddWorkbookPart();\r\n\r\n    workbookPart.Workbook = new Workbook();\r\n    Sheets sheets = workbookPart.Workbook.AppendChild<Sheets>(new Sheets());\r\n    //OpenSheet\r\n    WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();\r\n    SheetData sheetData = new SheetData();\r\n    worksheetPart.Worksheet = new Worksheet(sheetData);\r\n\r\n    var sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = \"test\" };\r\n    sheets.Append(sheet);\r\n    \r\n    WorksheetCommentsPart worksheetCommentsPart1 = worksheetPart.AddNewPart<WorksheetCommentsPart>();\r\n    GenerateWorksheetCommentsPart1Content(worksheetCommentsPart1);\r\n\r\n    OpenXmlWriter DataWriter = OpenXmlWriter.Create(worksheetPart);\r\n    DataWriter.WriteStartElement(sheetData);\r\n    DataWriter.WriteStartElement(worksheetPart.Worksheet);\r\n    \r\n    //closedata\r\n    DataWriter.WriteEndElement();\r\n    DataWriter.Close();\r\n    //\r\n    //render\r\n    // worksheetPart = null;\r\n    workbookPart.Workbook.Save();\r\n    spreadsheet.Save();\r\n    spreadsheet.Close();\r\n    memoryStream.Position = 0;\r\n    return memoryStream.ToArray();\r\n}\r\n\r\npublic void GenerateWorksheetCommentsPart1Content(WorksheetCommentsPart worksheetCommentsPart)\r\n{\r\n    Comments comments1 = new Comments() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = \"xr\" } };\r\n\r\n\r\n    Authors authors1 = new Authors();\r\n    Author author1 = new Author();\r\n    author1.Text = \"User1\";\r\n\r\n    authors1.Append(author1);\r\n\r\n    CommentList commentList1 = new CommentList();\r\n\r\n    Comment comment1 = new Comment() { Reference = \"A3\", AuthorId = (UInt32Value)12, ShapeId = (UInt32Value)10, Guid = Guid.NewGuid().ToString() };\r\n    comment1.SetAttribute(new OpenXmlAttribute(\"xr\", \"uid\", \"http://schemas.microsoft.com/office/spreadsheetml/2014/revision\", \"{811649EF-4CB5-4311-BE14-228133003BE4}\"));\r\n\r\n    CommentText commentText1 = new CommentText();\r\n\r\n    Run run1 = new Run();\r\n\r\n    RunProperties runProperties1 = new RunProperties();\r\n    FontSize fontSize3 = new FontSize() { Val = 9D };\r\n    Color color3 = new Color() { Indexed = (UInt32Value)81U };\r\n    RunFont runFont1 = new RunFont() { Val = \"Tahoma\" };\r\n    RunPropertyCharSet runPropertyCharSet1 = new RunPropertyCharSet() { Val = 1 };\r\n\r\n    runProperties1.Append(fontSize3);\r\n    runProperties1.Append(color3);\r\n    runProperties1.Append(runFont1);\r\n    runProperties1.Append(runPropertyCharSet1);\r\n    Text text1 = new Text() { Space = SpaceProcessingModeValues.Preserve };\r\n    text1.Text = \"This is my comment!\\nThis is line 2!\\n\";\r\n\r\n    run1.Append(runProperties1);\r\n    run1.Append(text1);\r\n\r\n    commentText1.Append(run1);\r\n\r\n    comment1.Append(commentText1);\r\n\r\n    commentList1.Append(comment1);\r\n\r\n    comments1.Append(authors1);\r\n    comments1.Append(commentList1);\r\n   \r\n    worksheetCommentsPart.Comments = comments1;\r\n}\r\n```\r\nPlease let me know what is the issue with the code and how can we show comments for particular cell."},{"Id":"36276639897","Type":"PullRequestEvent","CreatedAt":"2024-03-05T21:30:48","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1679","RelatedDescription":"Merged pull request \"Register temp file for dispose\" (#1679) at dotnet/Open-XML-SDK","RelatedBody":"Cleaning up the temporary file and adding a comment about ownership\r\n\r\nFixes #1658\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2024-03-11T03:30:19.0831105Z","RunDurationInMilliseconds":575}