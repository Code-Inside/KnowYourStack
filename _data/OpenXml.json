{"Data":{"Sdk":{"Events":[{"Id":"43536833635","Type":"IssuesEvent","CreatedAt":"2024-11-05T21:21:39","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1757","RelatedDescription":"Closed issue \"Insert Image into Excel doesn't seems to work anymore.\" (#1757) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nI have tried all samples / methods that I can find in the web, but none is working. All results are either the image missing or Excel throw error when opening.\r\n\r\n**To Reproduce**\r\n\r\nUse this sample below, easy to follow.\r\n\r\nhttps://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/How%20to%20insert%20image%20into%20Excel%20using%20Open%20XML%20SDK/%5BC%23%5D-How%20to%20insert%20image%20into%20Excel%20using%20Open%20XML%20SDK/C%23\r\n"},{"Id":"43536754275","Type":"IssuesEvent","CreatedAt":"2024-11-05T21:18:43","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1784","RelatedDescription":"Closed issue \"Office2010.Excel - ConditionalFormatting  example\" (#1784) at dotnet/Open-XML-SDK","RelatedBody":"Describe the API or scenario A clear and concise description of the scenario you'd like documented: I would like to apply conditional formatting to the 'C' column in an Excel sheet using the ConditionalFormatting class from the DocumentFormat.OpenXml.Office2010.Excel namespace. The conditional formatting should display icons based on the cell values as follows:\r\n•\tA green check mark for a value of 1\r\n•\tA red X for values greater than 1\r\n•\tNo icon for a value of 0\r\nAttempts Please include any attempts you have made to figure this out: I have attempted to implement this using the Open-XML-SDK, but I am having trouble with the correct setup of the ConditionalFormatting and ConditionalFormattingRule classes. \r\n\r\nRelated scenarios Any related documentation/samples/StackOverflow posts you have found: I have not found any specific examples or documentation that cover this exact scenario. Most examples I found are for basic conditional formatting without custom icons.\r\nAdditional context Add any other context about the problem here: I am using the Open-XML-SDK to generate Excel files programmatically. Detailed documentation or a sample code snippet demonstrating the correct usage of ConditionalFormatting with custom icons would be very helpful.\r\n\r\nthe expected result, something like this:\r\n\r\n\r\n```\r\n<x14:conditionalFormattings xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\">\r\n\t\t<x14:conditionalFormatting xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">\r\n\t\t\t<x14:cfRule type=\"iconSet\" priority=\"1\" id=\"{39D2A77C-A416-446B-91A5-8D3E3C96830E}\">\r\n\t\t\t\t<x14:iconSet iconSet=\"3Symbols\" showValue=\"0\" custom=\"1\">\r\n\t\t\t\t\t<x14:cfvo type=\"percent\">\r\n\t\t\t\t\t\t<xm:f>0</xm:f>\r\n\t\t\t\t\t</x14:cfvo>\r\n\t\t\t\t\t<x14:cfvo type=\"num\" gte=\"0\">\r\n\t\t\t\t\t\t<xm:f>0</xm:f>\r\n\t\t\t\t\t</x14:cfvo>\r\n\t\t\t\t\t<x14:cfvo type=\"num\" gte=\"0\">\r\n\t\t\t\t\t\t<xm:f>1</xm:f>\r\n\t\t\t\t\t</x14:cfvo>\r\n\t\t\t\t\t<x14:cfIcon iconSet=\"NoIcons\" iconId=\"0\"/>\r\n\t\t\t\t\t<x14:cfIcon iconSet=\"3Symbols\" iconId=\"2\"/>\r\n\t\t\t\t\t<x14:cfIcon iconSet=\"3Symbols\" iconId=\"0\"/>\r\n\t\t\t\t</x14:iconSet>\r\n\t\t\t</x14:cfRule>\r\n\t\t\t<xm:sqref>C1:C1048576</xm:sqref>\r\n\t\t</x14:conditionalFormatting>\r\n\t</x14:conditionalFormattings>\r\n\r\n```"},{"Id":"43534056739","Type":"PullRequestEvent","CreatedAt":"2024-11-05T19:37:51","Actor":"AlfredHellstern","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1820","RelatedDescription":"Opened pull request \"Update README.md\" (#1820) at dotnet/Open-XML-SDK","RelatedBody":"removed supported Frameworks section, it was causing more confusion than it was helpful"},{"Id":"43533057031","Type":"PullRequestEvent","CreatedAt":"2024-11-05T19:02:06","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1819","RelatedDescription":"Opened pull request \"Get strict relationship status before opening stream\" (#1819) at dotnet/Open-XML-SDK","RelatedBody":"Fixes #1802\n"},{"Id":"43470210425","Type":"IssuesEvent","CreatedAt":"2024-11-04T08:14:00","Actor":"JerryJian","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1818","RelatedDescription":"Opened issue \"AddAlternativeFormatImportPart produces corrupted docx document on net48, but works fine on net4.8\" (#1818) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nRun the following code on .net48 and .net8.0, and then extract the generated docx file with 7zip, the .net48 output file has an error:\n\n```\ndata error: word\\_rels\\document.xml.rels\n```\n\nThe code:\n```c#\ninternal class Program\n{\n    static void Main(string[] args)\n    {\n        var m_stream = new MemoryStream();\n        GenerateDocx(m_stream);\n        m_stream.Position = 0;\n\n        var mydoc = WordprocessingDocument.Open(m_stream, true, new OpenSettings \n        {\n            MarkupCompatibilityProcessSettings = new MarkupCompatibilityProcessSettings(\n                MarkupCompatibilityProcessMode.ProcessAllParts,\n                FileFormatVersions.Office2010)\n        });\n        var mainPart = mydoc.MainDocumentPart!;\n\n        var alternativeFormatImportPart = mainPart.AddAlternativeFormatImportPart(AlternativeFormatImportPartType.Html);\n        alternativeFormatImportPart.FeedData(new MemoryStream(new UTF8Encoding(true).GetBytes(\"<html>Hello</html>\")));\n        mydoc.Save();\n\n        using var fs = new FileStream(\"result.docx\", FileMode.Create, FileAccess.ReadWrite);\n        m_stream.Position = 0;\n        m_stream.CopyTo(fs);\n    }\n\n    private static void GenerateDocx(MemoryStream m_stream)\n    {\n        using var wpDocument = WordprocessingDocument.Create(m_stream, WordprocessingDocumentType.Document);\n        MainDocumentPart mainPart = wpDocument.AddMainDocumentPart();\n        mainPart.Document = new Document(new Body(new Paragraph(new Run(new Text(\"Here comes HTML {{ds}:html}\")))));\n        wpDocument.Save();\n    }\n}\n```\n\n**Screenshots**\n![Image](https://github.com/user-attachments/assets/7f5a3d48-ed1a-4126-b3fa-38ca174b94ef)\n\n**To Reproduce**\nThe code in the **Describe the bug** section.\n\nSteps to reproduce the behavior:\n1. Create an console application, and paste the Program code above.\n2. Switch to net48, run the program, the output docx file is in the output directory of the project.\n3. Extract the output docx file with 7zip.\n4. See error like described above.\n\n**Observed behavior**\nThe output file of net48 is corrupted \n\n**Expected behavior**\nThe files produced by net48 are the same as those produced by net8.0\n\n**Desktop (please complete the following information):**\n - OS: Windows 11\n - .NET Target: .NET Framework 4.8 and .NET 8.0\n - DocumentFormat.OpenXml Version: 3.1.1\n\n**Additional context**\nAdd any other context about the problem here.\n"},{"Id":"43469283518","Type":"IssuesEvent","CreatedAt":"2024-11-04T07:37:37","Actor":"ChandrasekarML","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1817","RelatedDescription":"Opened issue \"Bug with Open XML SDK\" (#1817) at dotnet/Open-XML-SDK","RelatedBody":"have issue with Track changes new word and old word in the word document.\nBut Inserted Run newword working properly, but detetion not working prolerly.\n\n\nSource Code i have tried it.\n\n public void WordUpdate3(string filePath)\n {\n     string newWord = \"NewWord\";\n     string wordToDelete = \"POWERUP\";\n\n     using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(filePath, true))\n     {\n         Body body = wordDoc.MainDocumentPart.Document.Body;\n\n         ReplaceWordWithTracking2(body, wordToDelete, newWord);\n\n         wordDoc.MainDocumentPart.Document.Save();\n     }\n }\n\n private void ReplaceWordWithTracking2(Body body, string targetWord, string newWord)\n {\n     Paragraph targetParagraph = body.Elements<Paragraph>()\n                             .FirstOrDefault(p => p.InnerText.Contains(targetWord));\n\n     if (targetParagraph != null)\n     {\n         Run targetRun = targetParagraph.Elements<Run>()\n                                        .FirstOrDefault(r => r.InnerText.Contains(targetWord));\n\n         if (targetRun != null)\n         {\n             // Step 1: Create a DeletedRun for tracking the deletion\n             DeletedRun deletedRun = new DeletedRun();\n\n             // Set author and date attributes on the DeletedRun\n             deletedRun.SetAttribute(new OpenXmlAttribute(\"author\", \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\", \"AuthorName\"));\n             deletedRun.SetAttribute(new OpenXmlAttribute(\"date\", \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\", DateTime.Now.ToString(\"s\")));\n\n             // Add the deleted word with strikethrough formatting and color\n             RunProperties runProperties = new RunProperties();\n             Color color = new Color() { Val = \"FF0000\" }; // Red color for deleted text\n             runProperties.Append(color);\n             runProperties.Append(new Strike()); // Strikethrough for deletion\n\n             Run deletedWordRun = new Run(runProperties, new Text(targetWord));\n             deletedRun.Append(deletedWordRun); // Append the deleted word run to DeletedRun\n\n             // Insert the DeletedRun before the target run\n             targetRun.Parent.InsertBefore(deletedRun, targetRun);\n\n             // Step 2: Remove the original target run\n             targetRun.Remove();\n\n             // Step 3: Create an InsertedRun for tracking the insertion\n             InsertedRun insertedRun = new InsertedRun();\n\n             // Set author and date attributes on the InsertedRun\n             insertedRun.SetAttribute(new OpenXmlAttribute(\"author\", \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\", \"AuthorName\"));\n             insertedRun.SetAttribute(new OpenXmlAttribute(\"date\", \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\", DateTime.Now.ToString(\"s\")));\n\n             // Add the new word with color formatting\n             Run insertedWordRun = new Run(new Text(newWord))\n             {\n                 RunProperties = new RunProperties(new Color { Val = \"00FF00\" }) // Green color for inserted word\n             };\n             insertedRun.Append(insertedWordRun); // Append the inserted word run to InsertedRun\n\n             // Insert the InsertedRun after the DeletedRun\n             deletedRun.Parent.InsertAfter(insertedRun, deletedRun);\n         }\n         else\n         {\n             Console.WriteLine(\"Target Run is null.\");\n         }\n     }\n     else\n     {\n         Console.WriteLine(\"Target Paragraph is null.\");\n     }\n }\n"},{"Id":"43343812083","Type":"IssuesEvent","CreatedAt":"2024-10-30T09:26:55","Actor":"HansiZou","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1816","RelatedDescription":"Opened issue \"How to insert image into cell in xlsx file?\" (#1816) at dotnet/Open-XML-SDK","RelatedBody":"I hope use openxml insert image into one cell(embed) in xlsx file。\nthen use winrar unzip this xlsx。\ndir:\n![Image](https://github.com/user-attachments/assets/af15cf1d-5e53-4751-a940-8dacee103335)\n![Image](https://github.com/user-attachments/assets/4828be9c-892a-4c04-bb07-49b1d78f451e)\n![Image](https://github.com/user-attachments/assets/8846bccd-2b52-4f1f-9b13-6060d8914e9f)\nI want to have relations \ncellimages.xml\ncellimages.xml.rels"}],"ResultType":"GitHubEvent"}},"RunOn":"2024-11-08T03:30:22.6266408Z","RunDurationInMilliseconds":674}