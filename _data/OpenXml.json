{"Data":{"Sdk":{"Events":[{"Id":"51008319722","Type":"IssuesEvent","CreatedAt":"2025-06-17T14:03:16","Actor":"mkaszewiak","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1937","RelatedDescription":"Closed issue \"Bug with Open XML SDK\" (#1937) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\nImproper Handling of Indentation and Hierarchy in Word Document Extraction Using Open XML\n**Screenshots**\n\n<!-- Failed to upload \"SnipImage.JPG\" -->\n\n**To Reproduce**\nbelow is the code i am using \n ```csharp private static string ConvertParagraphToHtml(WordprocessingDocument doc, Paragraph paragraph)\n {\n     StringBuilder paraHtml = new StringBuilder();\n     bool inBold = false;\n     const float PointsPerInch = 72.0f;\n     const float TabWidthInInches = 0.5f;\n     const int TwipsPerPoint = 20; // 1 point = 20 twips\n     const string TabRepresentation = \"<t>\"; // Use <t> to represent a tab in HTML\n\n     string paragraphText = GetParagraphText(paragraph).TrimEnd('\\r', '\\n');\n     if (string.IsNullOrEmpty(paragraphText))\n     {\n         return \"\";\n     }\n\n     // Handle initial tabs before numbering\n     StringBuilder preNumberingTabs = new StringBuilder();\n     foreach (Run run in paragraph.Elements<Run>())\n     {\n         if (run.Elements<TabChar>().Any())\n         {\n             preNumberingTabs.Append(TabRepresentation);\n         }\n         else\n         {\n             // Stop collecting tabs once we hit non-tab content\n             if (!string.IsNullOrEmpty(run.InnerText))\n                 break;\n         }\n     }\n\n     // Handle indentation\n     ParagraphProperties paraProps = paragraph.GetFirstChild<ParagraphProperties>();\n     Indentation indentation = paraProps?.GetFirstChild<Indentation>();\n\n     float leftIndentPoints = indentation?.Left != null && int.TryParse(indentation.Left, out int leftTwips)\n         ? leftTwips / (float)TwipsPerPoint : 0f;\n     float firstLineIndentPoints = indentation?.FirstLine != null && int.TryParse(indentation.FirstLine, out int firstLineTwips)\n         ? firstLineTwips / (float)TwipsPerPoint : 0f;\n     float rightIndentPoints = indentation?.Right != null && int.TryParse(indentation.Right, out int rightTwips)\n         ? rightTwips / (float)TwipsPerPoint : 0f;\n\n     float leftIndentInches = leftIndentPoints / PointsPerInch;\n     if (leftIndentInches > 0)\n     {\n         var loopTimes = (int)(leftIndentInches / TabWidthInInches);\n         for (int i = 0; i < loopTimes; i++)\n         {\n             preNumberingTabs.Append(TabRepresentation);\n         }\n     }\n\n     // Append pre-numbering tabs and indentation\n     paraHtml.Append(preNumberingTabs.ToString());\n\n     // Handle list numbering\n     string listPrefix = \"\";\n     var numberingProperties = paragraph.Elements<ParagraphProperties>().FirstOrDefault()?.NumberingProperties;\n     var numberingId = numberingProperties?.NumberingId?.Val?.Value;\n     var numberingLevel = numberingProperties?.NumberingLevelReference?.Val?.Value ?? 0;\n\n     if (numberingProperties != null && numberingId.HasValue)\n     {\n         try\n         {\n             var numberingPart = doc.MainDocumentPart?.NumberingDefinitionsPart;\n             var numbering = numberingPart?.Numbering;\n             var abstractNumId = numbering?.Elements<NumberingInstance>()\n                 .FirstOrDefault(n => n.NumberID?.Value == numberingId)?.AbstractNumId?.Val?.Value;\n             var abstractNum = numbering?.Elements<AbstractNum>()\n                 .FirstOrDefault(n => n.AbstractNumberId?.Value == abstractNumId);\n             var level = abstractNum?.Elements<Level>().FirstOrDefault(l => l.LevelIndex?.Value == numberingLevel);\n             if (level != null)\n             {\n                 int listItemCount = 0;\n                 var paragraphs = doc.MainDocumentPart?.Document.Body.Elements<Paragraph>();\n                 if (paragraphs != null)\n                 {\n                     foreach (var p in paragraphs)\n                     {\n                         var np = p.Elements<ParagraphProperties>().FirstOrDefault()?.NumberingProperties;\n                         var pNumId = np?.NumberingId?.Val?.Value;\n                         var pLevel = np?.NumberingLevelReference?.Val?.Value ?? 0;\n                         if (pNumId == numberingId && pLevel == numberingLevel)\n                         {\n                             listItemCount++;\n                             if (p == paragraph)\n                                 break;\n                         }\n                     }\n                 }\n\n                 string listNumber = listItemCount.ToString();\n                 var numberFormatMap = new Dictionary<NumberFormatValues, string>\n         {\n             { NumberFormatValues.Decimal, \"decimal\" },\n             { NumberFormatValues.LowerLetter, \"lowerletter\" },\n             { NumberFormatValues.UpperLetter, \"upperletter\" },\n             { NumberFormatValues.LowerRoman, \"lowerroman\" },\n             { NumberFormatValues.UpperRoman, \"upperroman\" },\n             { NumberFormatValues.Bullet, \"bullet\" }\n         };\n                 var numberStyle = numberFormatMap.TryGetValue(level.NumberingFormat?.Val?.Value ?? NumberFormatValues.Decimal, out var style)\n                     ? style\n                     : \"decimal\";\n                 switch (numberStyle.ToLower())\n                 {\n                     case \"lowerletter\":\n                         listNumber = ((char)('a' + listItemCount - 1)).ToString();\n                         break;\n                     case \"upperletter\":\n                         listNumber = ((char)('A' + listItemCount - 1)).ToString();\n                         break;\n                     case \"lowerroman\":\n                         listNumber = ToRoman(listItemCount).ToLower();\n                         break;\n                     case \"upperroman\":\n                         listNumber = ToRoman(listItemCount).ToUpper();\n                         break;\n                     case \"bullet\":\n                         listNumber = level.LevelText?.Val?.Value ?? \"•\";\n                         break;\n                     default:\n                         listNumber = listItemCount.ToString(); // Decimal\n                         break;\n                 }\n\n                 string numberFormat = level.LevelText?.Val?.Value ?? \"%1.\";\n                 listPrefix = numberFormat.Replace(\"%1\", listNumber);\n                 // Add tab after number if not a bullet\n                 if (numberStyle.ToLower() != \"bullet\")\n                 {\n                     listPrefix += TabRepresentation;\n                 }\n             }\n         }\n         catch (Exception ex)\n         {\n             Console.WriteLine($\"Error processing list numbering: {ex.Message}\");\n             listPrefix = \"\"; // Fallback to empty prefix\n         }\n     }\n\n     // Append list prefix after tabs and indentation\n     paraHtml.Append(listPrefix);\n\n     // Process runs for bold formatting, text, and tabs\n     bool numberProcessed = string.IsNullOrEmpty(listPrefix); // Skip runs until numbering is processed\n     foreach (Run run in paragraph.Elements<Run>())\n     {\n         // Skip runs that are part of numbering if listPrefix was generated\n         if (!numberProcessed && run.InnerText == listPrefix.TrimEnd(TabRepresentation.ToCharArray()))\n         {\n             numberProcessed = true;\n             continue;\n         }\n\n         // Handle tab elements\n         if (run.Elements<TabChar>().Any())\n         {\n             paraHtml.Append(TabRepresentation);\n             continue;\n         }\n\n         string runText = run.InnerText ?? \"\";\n         bool isRunBold = run.RunProperties?.Bold != null;\n\n         if (string.IsNullOrEmpty(runText))\n             continue;\n\n         if (runText == \"\\n\")\n         {\n             paraHtml.Append(\"\\n\");\n         }\n         else if (runText == \"\\t\")\n         {\n             paraHtml.Append(TabRepresentation);\n         }\n         else\n         {\n             if (isRunBold && !inBold)\n             {\n                 paraHtml.Append(\"<b>\");\n                 inBold = true;\n             }\n             else if (!isRunBold && inBold)\n             {\n                 paraHtml.Append(\"</b>\");\n                 inBold = false;\n             }\n             paraHtml.Append(runText);\n         }\n     }\n\n     if (inBold)\n     {\n         paraHtml.Append(\"</b>\");\n     }\n\n     // Clean up HTML\n     paraHtml.Replace(\"{\", \"[\");\n     paraHtml.Replace(\"}\", \"]\");\n     paraHtml.Replace(\"<b>\\r</b>\", \"\");\n     paraHtml.Replace(\"\\r</b>\", \"</b>\");\n     paraHtml.Replace(\"\\r\", \"\");\n     paraHtml.Replace(\"<b></b>\", \"\");\n     paraHtml.Replace(\"<t>. <t>\", \".<t>\");\n     paraHtml.Replace(\"<t>.<t>\", \".<t>\");\n     paraHtml.Replace(\"(<t>\", \"(\");\n     paraHtml.Replace(\" <t>\", TabRepresentation); // Preserve tabs\n\n     Console.WriteLine($\"Converted HTML: {paraHtml.ToString()}\");\n     return paraHtml.ToString();\n }\n ```\n\n\n**Observed behavior**\nindentation mismatched\n\n**Expected behavior**\nI want indentation to display as per the source document \n\n**Desktop (please complete the following information):**\n - OS: [e.g. Windows]\n - Office version [e.g. 16.0.15427.20178]\n - .NET Target: 4.6.3\n - DocumentFormat.OpenXml Version: (e.g. 3.3..00)\n\n**Additional context**\nAdd any other context about the problem here.\n i dont have permisison to add files here"},{"Id":"50972795716","Type":"PullRequestEvent","CreatedAt":"2025-06-16T20:37:57","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1934","RelatedDescription":"Closed pull request \"Bump dawidd6/action-download-artifact from 9 to 10\" (#1934) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [dawidd6/action-download-artifact](https://github.com/dawidd6/action-download-artifact) from 9 to 10.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/dawidd6/action-download-artifact/releases\">dawidd6/action-download-artifact's releases</a>.</em></p>\n<blockquote>\n<h2>v10</h2>\n<h2>What's Changed</h2>\n<ul>\n<li>Fix the download-commit test to actually look for a commit by <a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/330\">dawidd6/action-download-artifact#330</a></li>\n<li>Add the option &quot;ref&quot;, specifying either a commit or a branch by <a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/329\">dawidd6/action-download-artifact#329</a></li>\n</ul>\n<h2>New Contributors</h2>\n<ul>\n<li><a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> made their first contribution in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/330\">dawidd6/action-download-artifact#330</a></li>\n</ul>\n<p><strong>Full Changelog</strong>: <a href=\"https://github.com/dawidd6/action-download-artifact/compare/v9...v10\">https://github.com/dawidd6/action-download-artifact/compare/v9...v10</a></p>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/4c1e823582f43b179e2cbb49c3eade4e41f992e2\"><code>4c1e823</code></a> Add the option &quot;ref&quot;, specifying either a commit or a branch (<a href=\"https://redirect.github.com/dawidd6/action-download-artifact/issues/329\">#329</a>)</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/a708c3c6484b13d5e785f230924f842594a8ea4a\"><code>a708c3c</code></a> Fix the download-commit test to actually look for a commit (<a href=\"https://redirect.github.com/dawidd6/action-download-artifact/issues/330\">#330</a>)</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/19f6be5f04a702e84928b9c7db33da57bd5415c2\"><code>19f6be5</code></a> Update README.md</li>\n<li>See full diff in <a href=\"https://github.com/dawidd6/action-download-artifact/compare/v9...v10\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=dawidd6/action-download-artifact&package-manager=github_actions&previous-version=9&new-version=10)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"50972794824","Type":"PullRequestEvent","CreatedAt":"2025-06-16T20:37:56","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1938","RelatedDescription":"Opened pull request \"Bump dawidd6/action-download-artifact from 9 to 11\" (#1938) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [dawidd6/action-download-artifact](https://github.com/dawidd6/action-download-artifact) from 9 to 11.\n<details>\n<summary>Release notes</summary>\n<p><em>Sourced from <a href=\"https://github.com/dawidd6/action-download-artifact/releases\">dawidd6/action-download-artifact's releases</a>.</em></p>\n<blockquote>\n<h2>v11</h2>\n<p><strong>Full Changelog</strong>: <a href=\"https://github.com/dawidd6/action-download-artifact/compare/v10...v11\">https://github.com/dawidd6/action-download-artifact/compare/v10...v11</a></p>\n<h2>v10</h2>\n<h2>What's Changed</h2>\n<ul>\n<li>Fix the download-commit test to actually look for a commit by <a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/330\">dawidd6/action-download-artifact#330</a></li>\n<li>Add the option &quot;ref&quot;, specifying either a commit or a branch by <a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/329\">dawidd6/action-download-artifact#329</a></li>\n</ul>\n<h2>New Contributors</h2>\n<ul>\n<li><a href=\"https://github.com/mstorsjo\"><code>@​mstorsjo</code></a> made their first contribution in <a href=\"https://redirect.github.com/dawidd6/action-download-artifact/pull/330\">dawidd6/action-download-artifact#330</a></li>\n</ul>\n<p><strong>Full Changelog</strong>: <a href=\"https://github.com/dawidd6/action-download-artifact/compare/v9...v10\">https://github.com/dawidd6/action-download-artifact/compare/v9...v10</a></p>\n</blockquote>\n</details>\n<details>\n<summary>Commits</summary>\n<ul>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/ac66b43f0e6a346234dd65d4d0c8fbb31cb316e5\"><code>ac66b43</code></a> node_modules: upgrade</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/9b54a0a70c3d482a3d96da8a2f9fc08d0209c9ae\"><code>9b54a0a</code></a> Update README.md</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/4c1e823582f43b179e2cbb49c3eade4e41f992e2\"><code>4c1e823</code></a> Add the option &quot;ref&quot;, specifying either a commit or a branch (<a href=\"https://redirect.github.com/dawidd6/action-download-artifact/issues/329\">#329</a>)</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/a708c3c6484b13d5e785f230924f842594a8ea4a\"><code>a708c3c</code></a> Fix the download-commit test to actually look for a commit (<a href=\"https://redirect.github.com/dawidd6/action-download-artifact/issues/330\">#330</a>)</li>\n<li><a href=\"https://github.com/dawidd6/action-download-artifact/commit/19f6be5f04a702e84928b9c7db33da57bd5415c2\"><code>19f6be5</code></a> Update README.md</li>\n<li>See full diff in <a href=\"https://github.com/dawidd6/action-download-artifact/compare/v9...v11\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=dawidd6/action-download-artifact&package-manager=github_actions&previous-version=9&new-version=11)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"}],"ResultType":"GitHubEvent"}},"RunOn":"2025-06-18T03:30:20.5470263Z","RunDurationInMilliseconds":508}