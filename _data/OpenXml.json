{"Data":{"Sdk":{"Events":[{"Id":"41997946670","Type":"IssuesEvent","CreatedAt":"2024-09-17T11:01:37","Actor":"andrewtsybulia","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1792","RelatedDescription":"Opened issue \"FontName becomes OpenXmlUnknownElement\" (#1792) at dotnet/Open-XML-SDK","RelatedBody":"Hi team\r\n**Describe the bug**\r\nAfter updating to version 3.1.0, I've encountered a bug. When I create a **DocumentFormat.OpenXml.Spreadsheet.RunProperties** with **FontName** as a child element, it changes the **FontName** to **OpenXmlUnknownElement**.\r\n\r\n**Screenshots**\r\n![image](https://github.com/user-attachments/assets/192c235f-4f24-4305-b82e-b791533a4b30)\r\n\r\n**To Reproduce**\r\n```csharp\r\n    using System.Linq;\r\n    using DocumentFormat.OpenXml;\r\n    using DocumentFormat.OpenXml.Packaging;\r\n    using DocumentFormat.OpenXml.Spreadsheet;\r\n    using Xunit;\r\n\r\n    namespace MyNameSpace;\r\n\r\n    [Fact]\r\n    public void BuildFont_Should_Return_RunProperties_With_FontName()\r\n    {\r\n        // Arrange\r\n        var runProps = new RunProperties(new FontName());\r\n        var spreadsheetDocument = SpreadsheetDocument.Create($\"SampleWithRunProperties.xlsx\", SpreadsheetDocumentType.Workbook);\r\n        var workbookPart = spreadsheetDocument.AddWorkbookPart();\r\n        var worksheetPart = workbookPart.AddNewPart<WorksheetPart>();\r\n        worksheetPart.Worksheet = new Worksheet(new SheetData(new Row(new Cell(new InlineString(new Run(runProps))))));\r\n        workbookPart.Workbook = new Workbook(new Sheets(new Sheet()));\r\n        spreadsheetDocument.Save();\r\n\r\n        // Act\r\n        var result = worksheetPart.Worksheet.Descendants<RunProperties>().First().FirstChild;\r\n\r\n        // Assert\r\n        Assert.True(result is FontName);\r\n        Assert.True(result is not OpenXmlUnknownElement);\r\n\r\n        spreadsheetDocument.Dispose();\r\n    }\r\n```\r\n1. Run the test\r\n2. See error\r\n\r\n**Expected behavior**\r\nFontName becomes OpenXmlUnknownElement, I expect it to stay FontName.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 11 Enterprise 23H2\r\n - .NET Target: .Net 8.0\r\n - DocumentFormat.OpenXml Version: 3.1.0\r\n\r\n"},{"Id":"41903608915","Type":"IssuesEvent","CreatedAt":"2024-09-13T11:17:07","Actor":"ManikaSood","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1791","RelatedDescription":"Opened issue \"Rich text support in power point\" (#1791) at dotnet/Open-XML-SDK","RelatedBody":"Hi Team, \r\n\r\nWe are currently utilizing OpenXML SDK 2.5 and DocumentFormat.OpenXml (version 2.19.0) within our .NET application (C#) to generate reports in the PPTX format. Previously, our data source for the reports was plain text in JSON format. As part of an enhancement, we are now incorporating rich text into the JSON data source.\r\n\r\nHowever, we are encountering an issue: when generating reports with our existing implementation—where we use the \"Text\" => \"Run\" => \"Paragraph\" => \"TextBody\" control to display text—the generated report displays the raw HTML tags instead of interpreting them.\r\n\r\nFor instance, if we pass `<div><strong>test data</strong></div>` in our source JSON, the output should appear in bold as follows: **test data**. \r\nCurrently, the output includes the HTML tags as plain text: `<div><strong>test data</strong></div>`, rather than rendering the HTML correctly.\r\n\r\n**So just want to check if there is any way to handle the rich text in the Power point format so that the corresponding html tags will do their respective function in generated report.**\r\n\r\nWe would appreciate guidance on how to handle rich text in the PowerPoint format so that the HTML tags are properly interpreted and rendered in the generated PPTX report.\r\n\r\nYour assistance in achieving the desired output would be greatly valued.\r\n\r\nThanks in advance.\r\nManika Sood\r\n\r\n"},{"Id":"41840601798","Type":"IssuesEvent","CreatedAt":"2024-09-11T17:54:03","Actor":"VladiStep","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1790","RelatedDescription":"Opened issue \"External hyperlinks (`Relationship`) with space character within its address crashes Excel 2007.\" (#1790) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThis issue is a link to this issue - https://github.com/ClosedXML/ClosedXML/issues/2397\r\nFeel free to close this issue as invalid if it's necessary (I don't have enough time to properly describe this right now).\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**To Reproduce**\r\n// Please add a self-contained, minimum viable repro of the issue.\r\n// If you require external resources, please provide a gist or GitHub repro\r\n// An Xunit style test is preferred, but a console application would work too.\r\n\r\nSteps to reproduce the behavior:\r\n1. Go to '...'\r\n2. Click on '....'\r\n3. Scroll down to '....'\r\n4. See error\r\n\r\n**Observed behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: [e.g. Windows]\r\n - Office version [e.g. 16.0.15427.20178]\r\n - .NET Target: (e.g. .NET Framework, .NET Core, UWP, Xamarin...)\r\n - DocumentFormat.OpenXml Version: (e.g. 2.11.0)\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n"},{"Id":"41826099571","Type":"IssuesEvent","CreatedAt":"2024-09-11T11:06:52","Actor":"TrevorT","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1789","RelatedDescription":"Opened issue \"A basic OpenXml created Workbook breaks in 'Spreadsheet Compare'\" (#1789) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nI came across this in a more complicated scenario (creating a SpreadsheetDocument from an existing stream, modifying the doc and streaming it out to another different file), but I've distilled the issue to the below example.\r\nIn my test the Excel file is created and valid, but trying to use it in \"Spreadsheet Compare\" causes that app to crash with a \"Attempt to read past end of stream\" exception.\r\nOpening the generated file in Excel, and saving it again (unchanged) fixes the issue - so the save from within Excel is modifying (fixing) the document. \r\n\r\n**To Reproduce**\r\nUse the following test to create the workbook:\r\n```\r\n        [Fact]\r\n        public void CreateAndSaveSpreadsheet()\r\n        {\r\n            // Arrange\r\n            string outputFilename = Path.Combine(Path.GetDirectoryName(GetType().Assembly.Location)!, \"OutputFolder\", \"Blank Document Created.xlsx\");\r\n\r\n            if (File.Exists(outputFilename))\r\n                File.Delete(outputFilename);\r\n\r\n            // Act\r\n            using (SpreadsheetDocument spreadsheetDoc = SpreadsheetDocument.Create(outputFilename, SpreadsheetDocumentType.Workbook))\r\n            {\r\n                WorkbookPart workbookPart = spreadsheetDoc.AddWorkbookPart();\r\n                workbookPart.Workbook = new Workbook();\r\n\r\n                WorksheetPart worksheetPart = workbookPart.AddNewPart<WorksheetPart>();\r\n                worksheetPart.Worksheet = new Worksheet(new SheetData());\r\n\r\n                Sheets sheets = spreadsheetDoc.WorkbookPart.Workbook.AppendChild(new Sheets());\r\n\r\n                Sheet sheet = new Sheet()\r\n                              {\r\n                                  Id = spreadsheetDoc.WorkbookPart.GetIdOfPart(worksheetPart),\r\n                                  SheetId = 1,\r\n                                  Name = \"Sheet1\"\r\n                              };\r\n                sheets.Append(sheet);\r\n\r\n                // Save the Workbook\r\n                workbookPart.Workbook.Save();\r\n                spreadsheetDoc.Save();\r\n            }\r\n        }\r\n```\r\n\r\nSteps to reproduce the behavior:\r\n1. Run the test to create the (basically empty) Workbook.\r\n2. Run Spreadsheet Compare. Choose the above created file for one of the comparison files\r\n3. See error:\r\n![image](https://github.com/user-attachments/assets/9fa52709-ea37-42a5-877b-f7c783a1554c)\r\n4. To reproduce a 'fix': Open the created doc in Excel, save it unchanged, redo the Spreadsheet compare (no exception occurs)\r\n\r\n**Observed behavior**\r\nUnexpected exception.\r\n\r\n**Expected behavior**\r\nNo exception from spreadsheet compare.\r\nNo significant internal file changes when an OpenXml created Workbook is opened in Excel and saved unchanged.\r\n\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10\r\n - Office version: Office 365:  \r\n![image](https://github.com/user-attachments/assets/a8655a23-6601-403e-9ece-4d58a4f9a89e)\r\n - .NET Target: .Net 6.0\r\n - DocumentFormat.OpenXml Version: 2.20.0\r\n\r\n**Additional context**\r\nSome investigation has led me to believe that the presence of the `xmlns:x=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"`\r\nentry for the default namespace, and the corresponding x: namespace prefixes to the xml tags is the issue. \r\n![image](https://github.com/user-attachments/assets/439be7e4-ad5b-4383-8b34-c04ef91b96e0)\r\n\r\nIf I manually edit the internals of the xlsx (sheet1.xml ) file and change the default namespace to have no alias in the 'sheet1.xml' file (as below) the issue is fixed (Spreadsheet Compare does not fail).\r\n![image](https://github.com/user-attachments/assets/5d25b44f-5b3f-474f-8b68-0e19381c001b)\r\n\r\nI have found to no way to get OpenXml to remove the x alias for the default namespace declared in the document XML.\r\n"},{"Id":"41805143950","Type":"PullRequestEvent","CreatedAt":"2024-09-10T19:51:17","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1772","RelatedDescription":"Closed pull request \"Bump Microsoft.CodeAnalysis.PublicApiAnalyzers from 3.11.0-beta1.24219.2 to 3.11.0-beta1.24324.1\" (#1772) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [Microsoft.CodeAnalysis.PublicApiAnalyzers](https://github.com/dotnet/roslyn-analyzers) from 3.11.0-beta1.24219.2 to 3.11.0-beta1.24324.1.\n<details>\n<summary>Commits</summary>\n<ul>\n<li>See full diff in <a href=\"https://github.com/dotnet/roslyn-analyzers/commits\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=Microsoft.CodeAnalysis.PublicApiAnalyzers&package-manager=nuget&previous-version=3.11.0-beta1.24219.2&new-version=3.11.0-beta1.24324.1)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"41805143291","Type":"PullRequestEvent","CreatedAt":"2024-09-10T19:51:15","Actor":"dependabot[bot]","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1788","RelatedDescription":"Opened pull request \"Bump Microsoft.CodeAnalysis.PublicApiAnalyzers from 3.11.0-beta1.24219.2 to 3.11.0-beta1.24415.1\" (#1788) at dotnet/Open-XML-SDK","RelatedBody":"Bumps [Microsoft.CodeAnalysis.PublicApiAnalyzers](https://github.com/dotnet/roslyn-analyzers) from 3.11.0-beta1.24219.2 to 3.11.0-beta1.24415.1.\n<details>\n<summary>Commits</summary>\n<ul>\n<li>See full diff in <a href=\"https://github.com/dotnet/roslyn-analyzers/commits\">compare view</a></li>\n</ul>\n</details>\n<br />\n\n\n[![Dependabot compatibility score](https://dependabot-badges.githubapp.com/badges/compatibility_score?dependency-name=Microsoft.CodeAnalysis.PublicApiAnalyzers&package-manager=nuget&previous-version=3.11.0-beta1.24219.2&new-version=3.11.0-beta1.24415.1)](https://docs.github.com/en/github/managing-security-vulnerabilities/about-dependabot-security-updates#about-compatibility-scores)\n\nDependabot will resolve any conflicts with this PR as long as you don't alter it yourself. You can also trigger a rebase manually by commenting `@dependabot rebase`.\n\n[//]: # (dependabot-automerge-start)\n[//]: # (dependabot-automerge-end)\n\n---\n\n<details>\n<summary>Dependabot commands and options</summary>\n<br />\n\nYou can trigger Dependabot actions by commenting on this PR:\n- `@dependabot rebase` will rebase this PR\n- `@dependabot recreate` will recreate this PR, overwriting any edits that have been made to it\n- `@dependabot merge` will merge this PR after your CI passes on it\n- `@dependabot squash and merge` will squash and merge this PR after your CI passes on it\n- `@dependabot cancel merge` will cancel a previously requested merge and block automerging\n- `@dependabot reopen` will reopen this PR if it is closed\n- `@dependabot close` will close this PR and stop Dependabot recreating it. You can achieve the same result by closing it manually\n- `@dependabot show <dependency name> ignore conditions` will show all of the ignore conditions of the specified dependency\n- `@dependabot ignore this major version` will close this PR and stop Dependabot creating any more for this major version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this minor version` will close this PR and stop Dependabot creating any more for this minor version (unless you reopen the PR or upgrade to it yourself)\n- `@dependabot ignore this dependency` will close this PR and stop Dependabot creating any more for this dependency (unless you reopen the PR or upgrade to it yourself)\n\n\n</details>"},{"Id":"41758476171","Type":"IssuesEvent","CreatedAt":"2024-09-09T15:56:33","Actor":"SzymonSel","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1787","RelatedDescription":"Opened issue \"Cloning sheet doesn't clone Drawing part\" (#1787) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nI have a template xlsx file, with template sheet, which in turn are cloned and their content is replaced ie. Cell values and images. \r\nAfter opening the file, the cell values are unique for each cloned Sheet except for the images which are the same, namely the last replaced image.\r\n\r\n**Screenshots**\r\n<img width=\"194\" alt=\"image\" src=\"https://github.com/user-attachments/assets/ed70d85a-1577-4e2b-97d5-975815d3923a\">\r\n\r\n**To Reproduce**\r\nI have this code which clones a given Sheet:\r\n```\r\n    public static async void CloneSheet(SpreadsheetDocument spreadSheet, string sheetName, string newSheetName) {\r\n          // Get the source sheet\r\n          var sheets = spreadSheet.WorkbookPart.Workbook.Sheets;\r\n          var sourceSheet = sheets.Elements<Sheet>().FirstOrDefault(s => s.Name == sheetName);\r\n          if (sourceSheet == null) {\r\n              throw new ArgumentException($\"Sheet with name {sheetName} does not exist.\");\r\n          }\r\n\r\n          // Get the source worksheet part\r\n          var sourceSheetPart = (WorksheetPart)spreadSheet.WorkbookPart.GetPartById(sourceSheet.Id);\r\n\r\n          // Create a new worksheet part\r\n          var newSheetPart = spreadSheet.WorkbookPart.AddNewPart<WorksheetPart>();\r\n          newSheetPart.Worksheet = (Worksheet)sourceSheetPart.Worksheet.Clone();\r\n\r\n          // Clone the relationships\r\n          foreach (var rel in sourceSheetPart.Parts) {\r\n              newSheetPart.AddPart(rel.OpenXmlPart, rel.RelationshipId);\r\n          }\r\n\r\n          // Clone DrawingsPart and its related ImageParts\r\n          if (sourceSheetPart.DrawingsPart != null) {\r\n              var sourceDrawingsPart = sourceSheetPart.DrawingsPart;\r\n              DrawingsPart newDrawingsPart;\r\n              \r\n              if (newSheetPart.DrawingsPart == null) {\r\n                  newDrawingsPart = newSheetPart.AddNewPart<DrawingsPart>();\r\n              } else {\r\n                  newDrawingsPart = newSheetPart.DrawingsPart;\r\n              }\r\n\r\n              newDrawingsPart.WorksheetDrawing = (WorksheetDrawing)sourceDrawingsPart.WorksheetDrawing.Clone();\r\n\r\n              var imagePartsToClone = sourceDrawingsPart.ImageParts.ToList();\r\n\r\n              foreach (var imagePart in imagePartsToClone) {\r\n                  var newImagePart = newDrawingsPart.AddImagePart(imagePart.ContentType);\r\n\r\n\r\n                  using (var stream = imagePart.GetStream()) {\r\n                          newImagePart.FeedData(stream);\r\n                  }\r\n\r\n                  // Update the BlipFill.Blip.Embed.Value to reference the new image part\r\n                  foreach (var blip in newDrawingsPart.WorksheetDrawing.Descendants<DocumentFormat.OpenXml.Drawing.Blip>()) {\r\n                      if (blip.Embed.Value == sourceDrawingsPart.GetIdOfPart(imagePart)) {\r\n                          var newId = newDrawingsPart.GetIdOfPart(newImagePart);\r\n                          blip.Embed.Value = newId;\r\n                      }\r\n                  }\r\n              }\r\n          }\r\n\r\n          // Create a new sheet and add it to the workbook\r\n          var newSheetId = spreadSheet.WorkbookPart.GetIdOfPart(newSheetPart);\r\n          var newSheet = new Sheet {\r\n              Id = newSheetId,\r\n              SheetId = sheets.Elements<Sheet>().Max(s => s.SheetId.Value) + 1,\r\n              Name = newSheetName // todo: Ensure the new sheet name is unique\r\n          };\r\n\r\n          sheets.Append(newSheet);\r\n\r\n          // Save the workbook\r\n          spreadSheet.WorkbookPart.Workbook.Save();\r\n      }\r\n```\r\n\r\n**Observed behavior**\r\nWhat I discovered is that the `Clone()` method on the `sourceDrawingsPart.WorksheetDrawing` doesn't work and in effect, make all the cloned sheets share the DrawingsPart.\r\n\r\n**Expected behavior**\r\nHow can achieve DrawingsPart cloning to work?\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: MacOS, Windows\r\n - .NET Target: .NET Core, .NET Framework\r\n - DocumentFormat.OpenXml Version: 3.1.0, 3.0.2\r\n"},{"Id":"41734667070","Type":"IssuesEvent","CreatedAt":"2024-09-09T02:49:20","Actor":"snake-L","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1765","RelatedDescription":"Closed issue \"I am using the OpenXML SDK to read the PPT template for content replacement. After stress testing, I found that the memory usage is too high and the number of Gen0, Gen1, and Gen2 object collections is too frequent.\" (#1765) at dotnet/Open-XML-SDK","RelatedBody":"BenchmarkDotNet v0.13.12, Windows 11 (10.0.22631.3880/23H2/2023Update/SunValley3)\r\n11th Gen Intel Core i5-11400H 2.70GHz, 1 CPU, 12 logical and 6 physical cores\r\n.NET SDK 9.0.100-preview.3.24204.13\r\n  [Host]   : .NET 8.0.7 (8.0.724.31311), X64 RyuJIT AVX-512F+CD+BW+DQ+VL+VBMI\r\n  .NET 8.0 : .NET 8.0.7 (8.0.724.31311), X64 RyuJIT AVX-512F+CD+BW+DQ+VL+VBMI\r\n\r\nJob=.NET 8.0  Runtime=.NET 8.0  \r\n\r\n\r\n| Method |    Mean |    Error |   StdDev |      Gen0 |      Gen1 | Allocated |\r\n| ------ | ------: | -------: | -------: | --------: | --------: | --------: |\r\n| xxx    | 2.293 s | 0.0110 s | 0.0103 s | 3000.0000 | 1000.0000 |  22.34 MB |\r\n\r\n\r\n**code**\r\nRead specific tags and modify content as shown in the following figure.\r\n![image](https://github.com/user-attachments/assets/2a84b757-22e7-4185-be79-dba0e9388d9a)\r\n![image](https://github.com/user-attachments/assets/a14a80c9-86cc-4c1f-a2e3-1c86e873d9d4)\r\n![image](https://github.com/user-attachments/assets/14970d66-3752-4178-9310-08c68008f035)\r\n\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2024-09-18T03:30:21.3489354Z","RunDurationInMilliseconds":715}