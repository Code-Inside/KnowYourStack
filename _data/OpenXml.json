{"Data":{"Sdk":{"Events":[{"Id":"24158202176","Type":"IssuesEvent","CreatedAt":"2022-09-22T09:25:43","Actor":"Asbjoedt","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1208","RelatedDescription":"Opened issue \"Absolute path is not found\" (#1208) at OfficeDev/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThe SDK cannot find absolute path to local directory in workbook.xml even though it exists in the XML attribute is \"x15ac:absPath\".\r\n\r\nFor further context, I refer to question I made on Stackoverflow, where I was recommended to file an issue here:\r\nhttps://stackoverflow.com/questions/73633816/absolute-path-not-detected-in-open-xml-sdk/73641509?noredirect=1#comment130327161_73641509\r\n\r\n**Screenshots**\r\nSee question on Stackoverflow for screenshots.\r\n\r\n**To Reproduce**\r\n\r\nTo reproduce use this method on a spreadsheet with absolute path. You may find a data sample with absolute path here: \r\nhttps://github.com/Asbjoedt/CLISC/blob/master/Docs/Mappe1.xlsx\r\n\r\nMethod that ought to work\r\n```\r\nusing DocumentFormat.OpenXml.Packaging;\r\nusing DocumentFormat.OpenXml.Spreadsheet;\r\nusing DocumentFormat.OpenXml.Office2013.ExcelAc;\r\n\r\npublic bool Check_AbsolutePath(string filepath)\r\n{\r\n    bool absolutepath = false;\r\n\r\n    using (SpreadsheetDocument spreadsheet = SpreadsheetDocument.Open(filepath, false))\r\n    {\r\n        if (spreadsheet.WorkbookPart.Workbook.AbsolutePath != null)\r\n        {\r\n            Console.WriteLine(\"--> Absolute path to local directory detected\");\r\n            absolutepath = true;\r\n        }\r\n    }\r\n    return absolutepath;\r\n}\r\n```\r\n\r\n**Observed behavior**\r\nNo absolute path is found in spreadsheet despite workbook.xml has absolutepath. XML attribute is \"x15ac:absPath\". I need to remove absolute paths in spreadsheets, which I cannot do if they cannot be found.\r\n\r\n**Expected behavior**\r\nAbsolute path was found as get and i should be able to remove it by set \"\".\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 11\r\n - .NET Target: I dunno, I just use C# in Visual Studio as \"console application\"\r\n - DocumentFormat.OpenXml Version: 2.18.0\r\n\r\n**Additional context**\r\nThx for your attention, I hope you can fix this.\r\n"},{"Id":"24057964045","Type":"IssuesEvent","CreatedAt":"2022-09-16T18:49:42","Actor":"tomjebo","Repository":"OfficeDev/Open-XML-SDK","Organization":"OfficeDev","RawContent":null,"RelatedAction":"closed","RelatedUrl":"https://github.com/OfficeDev/Open-XML-SDK/issues/1205","RelatedDescription":"Closed issue \"Throw OpenXmlPackageException A shared part is referenced by multiple source parts with a different relationship type\" (#1205) at OfficeDev/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nThe OpenXML SDK will throw OpenXmlPackageException when open the special pptx file.\r\n\r\n```\r\nDocumentFormat.OpenXml.Packaging.OpenXmlPackageException: 'A shared part is referenced by multiple source parts with a different relationship type.'\r\n```\r\n\r\nAnd this pptx file can open well with Office PowerPoint.\r\n\r\n---\r\n\r\nWhy the OpenXML SDK throw OpenXmlPackageException ?\r\n\r\nBecause the Relationship define the same part with a different relationship type. Such the test file in [my repo](https://github.com/lindexi/lindexi_gd/tree/d50ffc8321cbe33c50752557684581f1b1dc78f8/WhulaylurnurCearkolaifonerebairkur), and the content in `slide1.xml.rels` is:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\r\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\r\n  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout\" Target=\"../slideLayouts/slideLayout1.xml\" />\r\n  <Relationship Id=\"rId5\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\" Target=\"NULL\" TargetMode=\"External\" />\r\n  <Relationship Id=\"rId21\" Type=\"http://schemas.microsoft.com/office/2006/relationships/recovered\" Target=\"../media/media1.mp3\" />\r\n  <Relationship Id=\"rId19\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"../media/media1.mp3\" />\r\n  <Relationship Id=\"rId20\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image1.png\" />\r\n</Relationships>\r\n```\r\n\r\nAnd you can find the Type of `media1.mp3` is `http://schemas.microsoft.com/office/2006/relationships/recovered` and `http://schemas.microsoft.com/office/2007/relationships/media`\r\n\r\n**Screenshots**\r\n![](https://user-images.githubusercontent.com/16054566/190082500-386c2389-08da-4675-8427-85c0c5ab9eed.png)\r\n\r\n\r\n**To Reproduce**\r\n\r\nMy test code: https://github.com/lindexi/lindexi_gd/tree/d50ffc8321cbe33c50752557684581f1b1dc78f8/WhulaylurnurCearkolaifonerebairkur\r\n\r\n1. Download my code from: https://github.com/lindexi/lindexi_gd/tree/d50ffc8321cbe33c50752557684581f1b1dc78f8/WhulaylurnurCearkolaifonerebairkur\r\n2. Run the code\r\n3. See error\r\n\r\n**Observed behavior**\r\n\r\nThrow the OpenXmlPackageException.\r\n\r\n```\r\nDocumentFormat.OpenXml.Packaging.OpenXmlPackageException: 'A shared part is referenced by multiple source parts with a different relationship type.'\r\n```\r\n\r\nCall stack:\r\n\r\n```\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPartContainer.LoadReferencedPartsAndRelationships(DocumentFormat.OpenXml.Packaging.OpenXmlPackage openXmlPackage, DocumentFormat.OpenXml.Packaging.OpenXmlPart sourcePart, DocumentFormat.OpenXml.Packaging.RelationshipCollection relationshipCollection, System.Collections.Generic.Dictionary<System.Uri, DocumentFormat.OpenXml.Packaging.OpenXmlPart> loadedParts)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Load(System.IO.Packaging.Package package)\tUnknown\r\n \t[Exception] DocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.PresentationDocument.Open(string path, bool isEditable, DocumentFormat.OpenXml.Packaging.OpenSettings openSettings)\tUnknown\r\n>\t[Exception] WhulaylurnurCearkolaifonerebairkur.dll!Program.<Main>$(string[] args) Line 3\tC#\r\n \tDocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.OpenXmlPackage.Load(System.IO.Packaging.Package package)\tUnknown\r\n \tDocumentFormat.OpenXml.dll!DocumentFormat.OpenXml.Packaging.PresentationDocument.Open(string path, bool isEditable, DocumentFormat.OpenXml.Packaging.OpenSettings openSettings)\tUnknown\r\n \tWhulaylurnurCearkolaifonerebairkur.dll!Program.<Main>$(string[] args) Line 3\tC#\r\n```\r\n\r\n**Expected behavior**\r\nThe OpenXML SDK can open the document. And I think we should handle the `http://schemas.microsoft.com/office/2006/relationships/recovered` type.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10 21H2 19044\r\n - Office version None.\r\n - .NET Target: dotnet 6.0.9\r\n - DocumentFormat.OpenXml Version: 2.18.0\r\n\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2022-09-24T03:30:26.0846464Z","RunDurationInMilliseconds":775}