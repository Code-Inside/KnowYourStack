{"Data":{"Sdk":{"Events":[{"Id":"40804374487","Type":"PullRequestEvent","CreatedAt":"2024-08-06T23:23:31","Actor":"mikeebowen","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1761","RelatedDescription":"Merged pull request \"Update CHANGELOG.md\" (#1761) at dotnet/Open-XML-SDK","RelatedBody":""},{"Id":"40737408989","Type":"IssuesEvent","CreatedAt":"2024-08-05T05:07:18","Actor":"bhargavgaglani07","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1770","RelatedDescription":"Opened issue \"Performance degradation for WordprocessingDocument (v3.1.0 vs v2.20.0 vs v2.5.0)\" (#1770) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\nUpdating a word document operation has degraded significantly in the latest version. In v2.5.0, updating a word document ([SampleDocument.docx](https://github.com/user-attachments/files/16490865/SampleDocument.docx)) takes on an average ~310ms but same operation takes around ~1610ms (5x) in v2.20.0 and ~1370ms (4x) in v3.1.0.\r\n\r\n**To Reproduce**\r\nUse below sample code with attached document ([SampleDocument.docx](https://github.com/user-attachments/files/16490865/SampleDocument.docx))\r\n\r\n```\r\n\r\nstring filePath = @\"SampleDocument.docx\";\r\nstring outPath = $@\"UpdatedSampleDocument.docx\";\r\nStopwatch stopwatch = new Stopwatch();\r\n\r\nvar bytes = File.ReadAllBytes(filePath);\r\nMemoryStream stream = new MemoryStream();\r\nstream.Position = 0;\r\nstream.Write(bytes, 0, bytes.Length);\r\n\r\nstopwatch.Start();\r\n\r\n// Open the document\r\nusing (WordprocessingDocument wordDocument = WordprocessingDocument.Open(stream, true))\r\n{\r\n    wordDocument.MainDocumentPart.Document.Body.PrependChild(new Paragraph(new ParagraphProperties(), new Run(new Text(DateTime.Now.ToString()))));\r\n    wordDocument.MainDocumentPart.Document.Body.PrependChild(new Paragraph(new ParagraphProperties(), new Run(new Text(DateTime.Now.ToString()))));\r\n    wordDocument.MainDocumentPart.Document.Body.PrependChild(new Paragraph(new ParagraphProperties(), new Run(new Text(DateTime.Now.ToString()))));\r\n    wordDocument.MainDocumentPart.Document.Body.PrependChild(new Paragraph(new ParagraphProperties(), new Run(new Text(DateTime.Now.ToString()))));\r\n    wordDocument.MainDocumentPart.Document.Body.PrependChild(new Paragraph(new ParagraphProperties(), new Run(new Text(DateTime.Now.ToString()))));\r\n    \r\n     //// Save the document\r\n\r\n    //// for v2.20.0\r\n    wordDocument.MainDocumentPart.Document.Save();\r\n    wordDocument.Package.Flush();\r\n\r\n    //// for v3.1.0 & v2.20.0\r\n    wordDocument.Save();\r\n}\r\n\r\nstopwatch.Stop();\r\n\r\nFile.WriteAllBytes(outPath, stream.ToArray());\r\nstream.Close();\r\nstream.Dispose();\r\nConsole.WriteLine($\"Time taken to save the document: {stopwatch.ElapsedMilliseconds} ms\");\r\n\r\n```\r\n\r\n**Observed behavior**\r\nUpgrading to the latest version has significant performance degradation for mentioned operation.\r\n\r\n**Expected behavior**\r\nUpgrading to the latest version should not degrade performance.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: windows\r\n - Office version: 16.0.17628.20188\r\n - .NET Target: 4.8\r\n - DocumentFormat.OpenXml Version: 2.5.0, 2.20.0, 3.1.0\r\n"},{"Id":"40707010585","Type":"PullRequestEvent","CreatedAt":"2024-08-02T19:59:59","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1767","RelatedDescription":"Merged pull request \"add c16:uniqueId to several chart complex types\" (#1767) at dotnet/Open-XML-SDK","RelatedBody":"Classes for the following complex types receive the `DocumentFormat.OpenXml.Office2016.Drawing.Charts.UniqueID` (`c16:uniqueId`) extension child: \r\n`CT_DLbl`, `CT_LineSer`, `CT_ScatterSer`, `CT_RadarSer`, `CT_BarSer`, `CT_AreaSer`, `CT_PieSer`, `CT_BubbleSer`, `CT_SurfaceSer`\r\n"},{"Id":"40678468163","Type":"IssuesEvent","CreatedAt":"2024-08-01T23:37:01","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1769","RelatedDescription":"Opened issue \"`pictureOptions` and `bubble3D` were removed from some complex types in O15 but not the SDK\" (#1769) at dotnet/Open-XML-SDK","RelatedBody":"Need to `[Obsolete]` the following: \r\n\r\n`pictureOptions` from `CT_LineSer`, `CT_RadarSer`, `CT_PieSer`, `CT_BubbleSer` and `CT_SurfaceSer`\r\n`bubble3D` from `CT_SurfaceSer`\r\n\r\nthese children have been removed in the O15 Office schemas but were never removed from the SDK.\r\n\r\nOnce obsoleted, they will be marked for deletion in the next major release."},{"Id":"40678231674","Type":"IssuesEvent","CreatedAt":"2024-08-01T23:21:31","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1768","RelatedDescription":"Opened issue \"Add c16:uniqueId for CT_DPt and CT_LegendEntry\" (#1768) at dotnet/Open-XML-SDK","RelatedBody":"Add the following c16:uniqueId extension child patches:\r\n\r\nCT_DPtExtensionList/CT_DPtExtension\r\nCT_LegendEntryExtensionList/CT_LegendEntryExtension\r\n\r\nThese are already in the O16 patch file on the backend, just uncomment for v4.0.\r\n"},{"Id":"40675005153","Type":"PullRequestEvent","CreatedAt":"2024-08-01T20:41:45","Actor":"tomjebo","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1767","RelatedDescription":"Opened pull request \"add c16:uniqueId to several chart complex types\" (#1767) at dotnet/Open-XML-SDK","RelatedBody":"The following complex types receive the c16:uniqueId extension child: \r\nCT_DLbl, CT_LineSer, CT_ScatterSer, CT_RadarSer, CT_BarSer, CT_AreaSer, CT_PieSer, CT_BubbleSer, CT_SurfaceSer\r\n"},{"Id":"40619358042","Type":"IssuesEvent","CreatedAt":"2024-07-31T10:39:33","Actor":"skrabbe001","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1766","RelatedDescription":"Opened issue \"DocumentFormat.OpenXml.Office2016.Drawing.Charts.UniqueID creates the wrong case in the resulting XML\" (#1766) at dotnet/Open-XML-SDK","RelatedBody":"DocumentFormat.OpenXml.Office2016.Drawing.Charts.UniqueID creates the wrong case in the resulting XML.\r\n\r\nThe case created by the SDK is \"UniqueID\" but it should be \"UniqueId\", otherwise the PowerPoint application (in some instances) reports an error.\r\n\r\nWhen creating unique identifiers for a chart series, then the following code creates a corrupted presentation:\r\n```\r\nusing C16 = DocumentFormat.OpenXml.Office2016.Drawing.Charts;\r\n\r\nvar uniqueId = new C16.UniqueID() { Val = $\"{{{seriesGuid}}}\" };\r\next.Append(uniqueId);\r\n```\r\n\r\nThis is a workaround for the time being:\r\n```\r\next.InnerXml = $\"<c16:uniqueId xmlns:c16=\\\"http://schemas.microsoft.com/office/drawing/2014/chart\\\" val=\\\"{{{seriesGuid}}}\\\" />\";\r\n```\r\n\r\nLibrary Version: 3.0.1"},{"Id":"40617400392","Type":"IssuesEvent","CreatedAt":"2024-07-31T09:39:21","Actor":"snake-L","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1765","RelatedDescription":"Opened issue \"I am using the OpenXML SDK to read the PPT template for content replacement. After stress testing, I found that the memory usage is too high and the number of Gen0, Gen1, and Gen2 object collections is too frequent.\" (#1765) at dotnet/Open-XML-SDK","RelatedBody":"BenchmarkDotNet v0.13.12, Windows 11 (10.0.22631.3880/23H2/2023Update/SunValley3)\r\n11th Gen Intel Core i5-11400H 2.70GHz, 1 CPU, 12 logical and 6 physical cores\r\n.NET SDK 9.0.100-preview.3.24204.13\r\n  [Host]   : .NET 8.0.7 (8.0.724.31311), X64 RyuJIT AVX-512F+CD+BW+DQ+VL+VBMI\r\n  .NET 8.0 : .NET 8.0.7 (8.0.724.31311), X64 RyuJIT AVX-512F+CD+BW+DQ+VL+VBMI\r\n\r\nJob=.NET 8.0  Runtime=.NET 8.0  \r\n\r\n\r\n| Method |    Mean |    Error |   StdDev |      Gen0 |      Gen1 | Allocated |\r\n| ------ | ------: | -------: | -------: | --------: | --------: | --------: |\r\n| xxx    | 2.293 s | 0.0110 s | 0.0103 s | 3000.0000 | 1000.0000 |  22.34 MB |\r\n\r\n\r\n**code**\r\nRead specific tags and modify content as shown in the following figure.\r\n![image](https://github.com/user-attachments/assets/2a84b757-22e7-4185-be79-dba0e9388d9a)\r\n![image](https://github.com/user-attachments/assets/a14a80c9-86cc-4c1f-a2e3-1c86e873d9d4)\r\n![image](https://github.com/user-attachments/assets/14970d66-3752-4178-9310-08c68008f035)\r\n\r\n\r\n"}],"ResultType":"GitHubEvent"}},"RunOn":"2024-08-08T03:30:20.5008825Z","RunDurationInMilliseconds":657}