{"Data":{"Sdk":{"Events":[{"Id":"30231454249","Type":"IssuesEvent","CreatedAt":"2023-07-06T07:15:41","Actor":"psyvision","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1488","RelatedDescription":"Opened issue \"New ImagePart media added with extension .bin \" (#1488) at dotnet/Open-XML-SDK","RelatedBody":"**Describe the bug**\r\n\r\nThis is a follow up to an original bug https://github.com/dotnet/Open-XML-SDK/issues/1305 _\"New ImagePart is created as .bin instead of real extension\"_ which is still an issue with the most recent 2.20.0 release.\r\n\r\nWhen adding a new `ImagePart` the media in the bundled package has an extension of `.bin` instead of `.jpg` etc.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**To Reproduce**\r\n\r\nCreate a new document and add an `ImagePart` using the following code:\r\n\r\n```csharp\r\n// Load an image and get the appropriate mime type\r\nvar image = System.Drawing.Image.LoadFromFile(\"myphoto.jpg\");\r\nvar codes = ImageCodecInfo.GetImageDecoders();\r\nvar mimeType = codes.First(c => c.FormatID == image.RawFormat.Guid).MimeType;\r\n\r\nvar imagePart = mainPart.AddImagePart(mimeType); // image/jpeg\r\n\r\nusing var stream = new MemoryStream();\r\nimage.Save(stream, image.RawFormat);\r\nstream.Position = 0;\r\nimagePart.FeedData(stream);\r\n```\r\n\r\n**Observed behavior**\r\nThe media is added to the word document package with .bin extension\r\n\r\n**Expected behavior**\r\nThe media is added to the word document package with .jpg extension\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Windows 10\r\n - Office version: 2306 - 16529.20154\r\n - .NET Target: .NET Core 6\r\n - DocumentFormat.OpenXml Version: 2.20.0\r\n\r\n"},{"Id":"30174594191","Type":"IssuesEvent","CreatedAt":"2023-07-04T02:34:51","Actor":"markholst","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"opened","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/issues/1487","RelatedDescription":"Opened issue \"System.IO.Packaging.PackageDigitalSignatureManager relies on obsolete Package object constructors\" (#1487) at dotnet/Open-XML-SDK","RelatedBody":"Hi there - we've just stumbled across this one and would appreciate your advice.\r\n\r\nWe're using System.IO.Packaging.PackageDigitalSignatureManager, which only takes a Package object. Are you also working with the relevant team to get this upgraded?\r\n\r\nAlso, is there an easy way to suppress this compiler error? I have tried a few options as identified in this article - https://stackoverflow.com/questions/10608309/disabling-obsolete-error-in-c-sharp. It seems like the only option available to us is to access this property through reflection? Without an easy way to suppress this compiler error, it almost breaks semver conventions and requires a bump to the major version.\r\n\r\nI think, without having a suitable alternative, it's probably too soon to set this as a compiler error.\r\n\r\n_Originally posted by @markholst in https://github.com/dotnet/Open-XML-SDK/discussions/1414#discussioncomment-6191287_"},{"Id":"30174136109","Type":"PullRequestEvent","CreatedAt":"2023-07-04T01:54:45","Actor":"twsouthwick","Repository":"dotnet/Open-XML-SDK","Organization":"dotnet","RawContent":null,"RelatedAction":"merged","RelatedUrl":"https://github.com/dotnet/Open-XML-SDK/pull/1486","RelatedDescription":"Merged pull request \"Add generated files check\" (#1486) at dotnet/Open-XML-SDK","RelatedBody":""}],"ResultType":"GitHubEvent"}},"RunOn":"2023-07-07T03:30:25.2254916Z","RunDurationInMilliseconds":869}